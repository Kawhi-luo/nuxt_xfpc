/*!
 * 
 *  Tue Dec 24 2019 21:24:38 GMT+0800 (GMT+08:00)
 *  version：3.1.0-beta
 *  tag：1577193878861
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.G=t():e.G=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=180)}([function(e,t,r){var n=r(4),i=r(27),o=r(19),a=r(20),s=r(28),l=function e(t,r,l){var c,u,f,p,h=t&e.F,d=t&e.G,y=t&e.P,m=t&e.B,g=d?n:t&e.S?n[r]||(n[r]={}):(n[r]||{}).prototype,v=d?i:i[r]||(i[r]={}),b=v.prototype||(v.prototype={});for(c in d&&(l=r),l)f=((u=!h&&g&&void 0!==g[c])?g:l)[c],p=m&&u?s(f,n):y&&"function"==typeof f?s(Function.call,f):f,g&&a(g,c,f,t&e.U),v[c]!=f&&o(v,c,p),y&&b[c]!=f&&(b[c]=f)};n.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,r){var n;void 0===(n=function(){return window.g2||(window.g2=window.egis),window.g2}.apply(t,[]))||(e.exports=n)},function(e,t,r){"use strict";var n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};void 0===(n=function(){"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return-1!==this.indexOf(e,this.length-e.length)}),"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e});var e={_showLoading:function(e){},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){for(var t in e)return!1;return!0},ajaxGet:function(t,r,n,i){var o=jQuery.extend({},t);return o.type="get",o.success=function(o,a,s){t.showLoading&&e._showLoading(!1),e.isFunction(r)&&r.call(n,o,a,s,i)},o.error=function(o,a,s){t.showLoading&&e._showLoading(!1),console.error(t.url+" request failed!"),e.isFunction(r)&&r.call(n,null,a,o,i)},t.showLoading&&e._showLoading(!0),jQuery.ajax(o)},ajaxPost:function(t,r,n,i){var o=jQuery.extend({},t);return o.type="post",o.success=function(o,a,s){e.isFunction(r)&&r.call(n,o,a,s,i),t.showLoading&&e._showLoading(!1)},o.error=function(o,a,s){e.isFunction(r)&&r.call(n,null,a,o,i),t.showLoading&&e._showLoading(!1)},t.showLoading&&e._showLoading(!0),jQuery.ajax(o)},cancelRequest:function(e){if(e instanceof XMLHttpRequest&&4!=e.readyState)try{e.abort()}catch(e){}},getConfig:function(t){var r;t=t||{};return e.ajaxGet({url:t.url,dataType:"json",async:!1},(function(e){r=e||{}})),r}};return Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var r in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),t)new RegExp("("+r+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[r]:("00"+t[r]).substr((""+t[r]).length)));return e},e.assertWithin=function(t,r){var n=function(e,t){return null!=t&&(t instanceof RegExp?t.test(e):!!function(e,t){return"null"==t.toLowerCase()&&(null==e||""==e)}(e,t)||void 0)}(t,r);if(null!=n)return n;if(r.indexOf("※")>=0)return function(t,r,n){for(var i=t.split(n),o=0,a=i.length;o<a;o++){var s=i[o];if(s&&e.assertWithin(r,s))return!0}return!1}(r,t,"※");var i=function(e,t){if(r=r.trim(),0==/[\[\(\)\]].*/i.test(r))return e==r;if(e=parseFloat(e),isNaN(e))return!1;var n=r.replace(/[\[\]\(\)]/g,"").split(",");return 1==n.length?e==parseFloat(n[0]):void 0}(t);if(null!=i)return i;var o=function(e,t){if(t&&(t=t.trim()),!/[\[\(\)\]].*/i.test(t))return e==t;if(e=parseFloat(e),isNaN(e))return!1;var r=t.replace(/[\[\]\(\)]/g,"").split(",");if(1==r.length)return e==parseFloat(r[0]);for(var n=parseFloat(r[0]),i=parseFloat(r[1]),o=[function(e,t){if(!isNaN(n)&&isNaN(i)){if(t.startsWith("["))return e>=n;if(t.startsWith("("))return e>n}},function(e,t){if(isNaN(n)&&!isNaN(i)){if(t.endsWith("]"))return e<=i;if(t.endsWith(")"))return e<i}},function(e,t){var r=!0;return t.startsWith("[")?r=r&&e>=n:t.startsWith("(")&&(r=r&&e>n),!!r&&(t.endsWith("]")?r=r&&e<=i:t.endsWith(")")&&(r=r&&e<i),r)}],a=void 0,s=0,l=o.length;s<l&&null==(a=o[s](e,t));s++);return a}(t,r);return null!=o&&o},e.getEquivalentNum=function(e,t,r){var n=parseInt(e),i=t,o=r=r||10;if(isNaN(n))return o;var a=n+"",s=a.length;o=(s-1)*t;for(var l=0;l<s;l++){o+=parseInt(a[l])*(i/=10)}return o<r&&(o=r),Math.round(o)},e.getValByVarPath=function(e){var t=null;if(e){for(var r=e.split("."),n=window,i=0,o=r.length;i<o;i++){var a=r[i];if("window"!==a){if(!n)break;n=n[a]}}t=n}return t},e.lastId=0,e.stamp=function(e){return e instanceof Object?(e._unique_id=e._unique_id||++this.lastId,e._unique_id):NaN},e.newUUID=function(){var e=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.newUUID32=function(){return this.newUUID().replace(/-/g,"")},e.replacePlaceHolder=function(e,t){if(!t)return"";var r=/([\w\_\-\d]+)/g,n=t.match(/(\$\{[\w\_\-\d]{0,}\})/g),i=t;if(n&&n.length>0)for(var o=0,a=n.length;o<a;o++){var s=n[o],l="",c=s.match(r);c&&1==c.length&&(l=e[c[0]]||""),i=i.replace(s,l)}return i},e.Browser=function(){function e(e,t){return-1!==e.indexOf(t)}var t,r="ActiveXObject"in window,n=function(e){return e&&!document.addEventListener}(r),o=navigator.userAgent.toLowerCase(),a=e(o,"webkit"),s=e(o,"chrome"),l=e(o,"phantom"),c=e(o,"android"),u=e(o,"android [23]"),f=e(o,"gecko"),p=("undefined"==typeof orientation?"undefined":i(orientation))!==void 0+"",h=!window.PointerEvent&&window.MSPointerEvent,d=function(e){return window.PointerEvent&&window.navigator.pointerEnabled||e}(h),y="devicePixelRatio"in window&&window.devicePixelRatio>1||"matchMedia"in window&&window.matchMedia("(min-resolution:144dpi)")&&window.matchMedia("(min-resolution:144dpi)").matches,m=document.documentElement,g=function(e,t){return e&&"transition"in t.style}(r,m),v=function(e){return"WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!e}(u),b="MozPerspective"in m.style,_="OTransition"in m.style,w=(t=[g,v,b,_,l],!window.L_DISABLE_3D&&(t[0]||t[1]||t[2]||t[3])&&!t[4]),S=function(e,t){return!window.L_NO_TOUCH&&!e&&(t||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)}(l,d);return{ie:r,ielt9:n,webkit:a,gecko:f&&!a&&!window.opera&&!r,android:c,android23:u,chrome:s,ie3d:g,webkit3d:v,gecko3d:b,opera3d:_,any3d:w,mobile:p,mobileWebkit:p&&a,mobileWebkit3d:p&&v,mobileOpera:p&&window.opera,touch:S,msPointer:h,pointer:d,retina:y}},e}.apply(t,[]))||(e.exports=n)},function(e,t,r){var n=r(6);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};e.exports=function(e){return"object"===(void 0===e?"undefined":r(e))?null!==e:"function"==typeof e}},function(e,t,r){var n=r(62)("wks"),i=r(47),o=r(4).Symbol,a="function"==typeof o;(e.exports=function(e){return n[e]||(n[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=n},function(e,t,r){var n=r(30),i=Math.min;e.exports=function(e){return e>0?i(n(e),9007199254740991):0}},function(e,t,r){"use strict";var n,i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=[r(15),r(2),r(36)],void 0===(i=function(e,t,r){var n=e.extend({options:{id:null,name:null,map:null},includes:r.prototype,initialize:function(r){e.setOptions(this,r),this._moveAttrFromOpts(["map","id","name"]),this.appEvent=null,this.map&&(this.appEvent=this.map.getAppEvent()),this.id=this.id||t.newUUID32(),this.loaded=!1},destroy:function(){for(var e in this.unload(),this)this[e]=null,delete this[e]},load:function(){this.loaded||(this.addListeners(),this.loaded=!0)},unload:function(){this.loaded&&(this.removeListeners(),this.loaded=!1)},isLoaded:function(){return this.loaded},_checkLoaded:function(){if(this.isLoaded())return!0;throw new Error("component id = "+this.id+" not loaded yet !")},addListeners:function(){},removeListeners:function(){}});return n.include({_moveAttrFromOpts:function(e,t){if((e=e||[]).constructor==Array)for(var r=0,n=e.length;r<n;r++){var i=e[r];i&&(this[i]=this.options[i],t||(this.options[i]=null,delete this.options[i]))}},isNotNull:function(e){return null!=e&&null!=(void 0===e?"undefined":o(e))}}),n}.apply(t,n))||(e.exports=i)},function(e,t,r){e.exports=!r(5)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,r){"use strict";var n,i;n=[r(2),r(1)],void 0===(i=function(e,t){var r={_wktReader:null,_wktWriter:null,_geoJSONReader:null,_geoJSONWriter:null,getWktReader:function(){return null==this._wktReader&&(this._wktReader=new jsts.io.WKTReader(new jsts.geom.GeometryFactory(new jsts.geom.PrecisionModel(1e5)))),this._wktReader},getWktWriter:function(){return null==this._wktWriter&&(this._wktWriter=new jsts.io.WKTWriter(new jsts.geom.GeometryFactory(new jsts.geom.PrecisionModel(1e5)))),this._wktWriter},getGeoJSONReader:function(){return null==this._geoJSONReader&&(this._geoJSONReader=new jsts.io.GeoJSONReader(new jsts.geom.GeometryFactory(new jsts.geom.PrecisionModel(1e5)))),this._geoJSONReader},getGeoJSONWriter:function(){return null==this._geoJSONWriter&&(this._geoJSONWriter=new jsts.io.GeoJSONWriter(new jsts.geom.GeometryFactory(new jsts.geom.PrecisionModel(1e5)))),this._geoJSONWriter}},n=/^\-?\d{0,}(\.\d{0,})?$/;return r.validateLngLat=function(t,r){if(n.test(t)&&n.test(r)){var i=parseFloat(t),o=parseFloat(r);if(e.assertWithin(i,"[-180,180]")&&e.assertWithin(o,"[-90,90]"))return[i,o]}return!1},r.validateCoordinate=function(e,t){return!(!n.test(e)||!n.test(t))&&[parseFloat(e),parseFloat(t)]},r.getSpiderfy=function(e,t,r,n,i){var o,a=1*(r=r||10),s=1*(i=i||28),l=1*(n=n||5)*2*Math.PI,c=0,u=[];for(o=t-1;o>=0;o--){c+=s/a+5e-4*o;var f=e[0]+a*Math.cos(c),p=e[1]+a*Math.sin(c);u[o]=[f,p],a+=l/c}return u},r.getCirclePonits=function(e){var t=e.center,r=e.count||128,n=parseFloat(e.radius),i=e.spatialReference||3857,o=2*Math.PI/r,a=360/r,s=[],l=t[0],c=t[1];if("4326"==i||"4490"==i)for(var u=0;u<r;u++){var f=a*u,p=this.getGeographyDistancePoint(t,f,n);s.push(p)}else for(u=0;u<r;u++){var h=o*u,d=l+n*Math.cos(h),y=c+n*Math.sin(h);s.push([d,y])}return s},r.getGeographyDistancePoint=function(t,r,n){if(!e.isArray(t))throw new Error("参数错误！");t[0]=l(t[0]),t[1]=l(t[1]),n/=6378137,r=r*Math.PI/180;var i=t[1]*Math.PI/180,o=t[0]*Math.PI/180,a=Math.asin(Math.sin(i)*Math.cos(n)+Math.cos(i)*Math.sin(n)*Math.cos(r)),s=o+Math.atan2(Math.sin(r)*Math.sin(n)*Math.cos(i),Math.cos(n)-Math.sin(i)*Math.sin(a));return isNaN(a)||isNaN(s)?null:[180*s/Math.PI,180*a/Math.PI];function l(e){var t=e;return Math.abs(t)<1e-5&&(t=1e-5),t}},r.getGeometryCenter=function(e){var r=new jsts.geom.GeometryFactory(new jsts.geom.PrecisionModel(1e5)),n=new jsts.io.WKTReader(r);if(e.getGeometryType()==t.sfs.GeometryType.Point)return e;if(e.getGeometryType()==t.sfs.GeometryType.Polyline)return e.middlePoint();if(e.getGeometryType()==t.sfs.GeometryType.Polygon||e.getGeometryType()==t.sfs.GeometryType.MultiPolygon){var i=n.read(e.asWkt()).getCentroid();return i=t.sfs.GeometryFormatter.fromWKT(i.toString())}},r.meter2Rad=function(e){return 360*e/(2*Math.PI*6378137)},r.measureLength=function(e){if(!e instanceof t.sfs.Polyline)throw new Error("参数类型错误！");var r=new t.sfs.CoordinateTransform;return new t.sfs.MeasureService({projectService:r}).length(e)},r.measureArea=function(e){if(!e instanceof t.sfs.Polygon)throw new Error("参数类型错误！");var r=new t.sfs.CoordinateTransform;return new t.sfs.MeasureService({projectService:r}).area(e)},r.simplify=function(e,t){var r=e.getLength()/e.getNumPoints()*3.82;return r>t&&(r=t),e=jsts.simplify.DouglasPeuckerSimplifier.simplify(e,r)},r.toJstsGeometry=function(e){return(r._getJstsGeometry(e)||{}).geometry||null},r.fromJstsGeometry=function(e){var t={g2geom:1,wkt:2,geojson:3};if(!((e=e||{}).jstsGeom instanceof jsts.geom.Geometry&&t[e.type]))throw new Error("参数错误！");return r._fromJstsGeometry({geometry:e.jstsGeom,type:t[e.type],spatialReference:e.spatialReference})},r._getJstsGeometry=function(e){if(!e)return null;var t,n;if(e instanceof jsts.geom.Geometry)n=e,t=0;else if(null!=r._getG2GeometryType(e)){var i=e.asWkt();n=r.getWktReader().read(i),t=1}else"string"==typeof e?(n=r.getWktReader().read(e),t=2):(n=r.getGeoJSONReader().read(e),t=3);if(n){var o=r.getGeoJSONWriter().write(n);if(o&&o.type){if("POLYGON"==o.type.toUpperCase())c(o.coordinates);else if("MULTIPOLYGON"==o.type.toUpperCase())for(var a=o.coordinates,s=0,l=a.length;s<l;s++){c(a[s])}n=r.getGeoJSONReader().read(o)}}return{type:t,geometry:n};function c(e){for(var t=0,r=e.length;t<r;t++){var n=e[t],i=n[0],o=n[n.length-1];i&&2==i.length&&o&&2==o.length&&(i[0]==o[0]&&i[1]==o[1]||n.push([i[0],i[1]]))}}},r._fromJstsGeometry=function(e){var r=e.geometry,n=e.type||1,i=null;if(r)switch(n){case 1:(i=t.sfs.GeometryFormatter.fromWKT(r.toString())).spatialReference=e.spatialReference||"4326";break;case 2:i=r.toString();break;case 3:"jsts.geom.GeometryCollection"==r.CLASS_NAME&&0==r.geometries.length&&(r=null),r&&(i=(i=t.sfs.GeometryFormatter.fromWKT(r.toString())).asGeoJson())}return i},r._getG2GeometryType=function(r){var n=t.sfs,i=null;for(var o in n){var a=n[o];if(e.isFunction(a)){if(r instanceof a){i=a;break}if(r.$type&&r.$type.split(",")[0]===o){i=a;break}}}return i},r.getG2GeometryType=function(e){return r._getG2GeometryType(e)},r.getGeometryEnvlop=function(e){if(!e||e.length<1)return null;for(var r=null,n=null,i=0,o=[],a=0,s=e.length;a<s;a++){var l=e[a];if(l){var c=this._getJstsGeometry(l);if(c){var u=c.geometry;if(i=c.type,o.push(u),u)if(r)r.expandToInclude(u.getEnvelopeInternal());else if("jsts.geom.Point"==u.CLASS_NAME){var f=u.coordinate.x,p=u.coordinate.y;r=new jsts.geom.Envelope(f-1e-6,f+1e-6,p-1e-6,p+1e-6)}else r=u.getEnvelopeInternal()}}}if(r){var h="POLYGON((";switch(h+=r.getMinX()+" "+r.getMinY()+",",h+=r.getMaxX()+" "+r.getMinY()+",",h+=r.getMaxX()+" "+r.getMaxY()+",",h+=r.getMinX()+" "+r.getMaxY()+",",h+=r.getMinX()+" "+r.getMinY(),h+="))",i){case 1:n=t.sfs.GeometryFormatter.fromWKT(h);break;case 2:n=h;break;case 3:n=(n=t.sfs.GeometryFormatter.fromWKT(h)).asGeoJson()}}return n},r.getPlotEnvlop=function(e,n){var i=null,o=null;n=n||4326;if(e)for(var a in e){var s=e[a];if(s){var l=u(s);l&&(o=o?o.union(l).getEnvelope():l)}}if(o){var c=o.toString();(i=t.sfs.GeometryFormatter.fromWKT(c)).spatialReference=n}return i;function u(e){for(var t=e.elements||[],n=[],i=null,o=0,a=t.length;o<a;o++){var s=t[o];if(s){var l=s.geometry;n.push(l.asWkt())}}if(n.length>0){var c=r._unionGeometry(n);i=r.getWktReader().read(c).getEnvelope()}return i}},r._unionGeometry=function(e){if(!e||e.length<1)return null;for(var r=0,n=e.length,i=null,o=null,a=0,s=360/(2*Math.PI*6378137);r<n;r++){var l,c=e[r],u=this._getJstsGeometry(c);u&&((l=u.geometry)instanceof jsts.geom.Point||(l=jsts.simplify.DouglasPeuckerSimplifier.simplify(l,s)),a=u.type),l&&(i?i.contains(l)||(i=i.within(l)?l:i.union(l)):i=l)}if(i)switch(a){case 1:o=t.sfs.GeometryFormatter.fromWKT(i.toString());break;case 2:o=i.toString();break;case 3:o=(o=t.sfs.GeometryFormatter.fromWKT(i.toString())).asGeoJson()}return o},r.esriGeom2TSGISGeom=function(e,r,n){var i=n;r.spatialReference&&(i=r.spatialReference.latestWkid);var o=ArcGISToGeoJSON.arcgisToGeoJSON(r);return t.sfs.GeometryFactory.createGeometryFromGeoJson(o,i)},r}.apply(t,n))||(e.exports=i)},function(e,t,r){var n=r(3),i=r(125),o=r(32),a=Object.defineProperty;t.f=r(10)?Object.defineProperty:function(e,t,r){if(n(e),t=o(t,!0),n(r),i)try{return a(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(33);e.exports=function(e){return Object(n(e))}},function(e,t,r){"use strict";var n,i;n=[r(2),r(11),r(85),r(44),r(1)],void 0===(i=function(e,t,r,n,i){var o={createBaseLayer:function(t,n,o){if(!e.isObject(t))throw new Error("参数类型错误!");var a=null;if("group"==t.type){var s=t.layers,l=t.id||e.newUUID();if("MBTileLayer"===t.layerClass){for(var c=[],u=0,f=s.length;u<f;u++){var p=g(s[u]);p._type=r.TYPES.BASE_LAYER_TAG,c.push(p)}a=c}else{for(var h=new i.carto.GroupLayer({id:l,name:t.title||"",zIndex:t.zIndex,layers:[]}),d=0,y=s.length;d<y;d++){var m=g(s[d]);h.addLayer(m)}a=h}}else(a=g(t)).name=t.title||"";return e.isArray(a)?a.forEach((function(e){e._type=r.TYPES.BASE_LAYER_TAG,e.layerGroups=t.layerGroups||""})):(a._type=r.TYPES.BASE_LAYER_TAG,a.layerGroups=t.layerGroups||""),a;function g(e){n&&(e.restHttp=n),o&&(e.map=o);var r=e.layerClass||"TileLayer",a=new i.carto[r](e);return t.zIndex&&a.setZIndex(t.zIndex),a}},getBaseLayer:function(e){for(var t=e.getMap().layers,n=[],i=0,o=t.length;i<o;i++){var a=t[i];a&&a._type==r.TYPES.BASE_LAYER_TAG&&n.push(a)}return n},removeBaseLayer:function(e){for(var t=o.getBaseLayer(e),r=e.getMap(),n=0,i=t.length;n<i;n++){var a=t[n];r.removeLayer(a)}return t},isBaseLayer:function(e){return e&&e._type===r.TYPES.BASE_LAYER_TAG},removeBaseLayerById:function(e,t){var r=o.getLayerById(e,t);r&&e.getMap().removeLayer(r)},ClearLayerByName:function(e,t){var r=e.getMap().findLayer(t);r&&r.clear()},ClearAllLayer:function(e){for(var t=0;t<e.getMap().layers.length;t++)e.getMap().layers[t].clear()},switchBaseLayer:function(t){if(!t||!t.layerOpts)throw new Error("参数类型错误！");var i=t.map,a=o.removeBaseLayer(i),s=[],l=t.restHttp;if(e.isArray(t.layerOpts))for(var c=0,u=t.layerOpts.length;c<u;c++){var f=t.layerOpts[c];if(e.isObject(f)){var p=o.createBaseLayer(f,l);i.addLayer(p),s.push(p)}}else{p=o.createBaseLayer(t.layerOpts,l);i.addLayer(p),s.push(p)}var h=i.getLayers();for(c=0,u=h.length;c<u;c++){var d=h[c];d._type!==r.TYPES.BASE_LAYER_TAG&&(d.getZIndex()>0||d.setZIndex(1))}var y={};y.old=a,y.new=s,i.fire(n.SWITCH_BASE_LAYER,y)},getLayerById:function(e,t){if(t){var r=e.getMap().layers,n={};for(var o in r){a(n,r[o],t)}return n.layer||null}return null;function a(e,t,r){if(!e.layer)if(t.id!=r){if(t instanceof i.carto.GroupLayer){var n=t.groupLayers;for(var o in n){a(e,n[o],r)}}}else e.layer=t}}},a={point:1,polyline:2,polygon:3},s=[{id:"default-point-group",name:"点图层组"},{id:"default-polyline-group",name:"线图层组"},{id:"default-polygon-group",name:"面图层组"}];o.defaultGroupLayers=s,o.initGroupLayers=function(e){if(!e._group_layer_initialized){for(var t=2;t>=0;t--){var r=s[t],n=new i.carto.GroupLayer({id:r.id,name:r.name,layers:[],zIndex:1});e.addLayer(n)}e._group_layer_initialized=!0}},o.addLayer2Group=function(e,t,r){var i=s[(a[r]||1)-1],l=o.getLayerById(e,i.id);return!!l&&(l.addLayer(t),e.fire(n.LAYER_CHANGED,{type:"add",layers:[t]}),!0)},o.removeLayerFromGroup=function(e,t,r){var i=s[(a[r]||1)-1],l=o.getLayerById(e,i.id);return!!l&&(l.removeLayer(t),e.fire(n.LAYER_CHANGED,{type:"remove",layers:[t]}),!0)},o.addImageLayer=function(e){var t=new i.carto.ImageLayer({id:e.id,name:e.name,imageType:702,extent:[e.pointArr[0].x,e.pointArr[0].y,e.pointArr[1].x,e.pointArr[1].y],crossOrigin:"anonymous",url:e.url});e.map.addLayer(t)},o.clearImageLayer=function(e,t){e.findLayer(t)&&e.getMap().removeLayer(e.findLayer(t))},o.addElementLayer=function(e){var t;null==e.map.findLayer(e.name)?(t=new i.carto.ElementLayer({map:e.map.getMap(),name:e.name,id:e.id}),e.map.getMap().addLayer(t)):t=e.map.findLayer(e.name);var r=G.utils.RenderUtil.geoinfoToElement(e.geoInfo,e.symbol,e.eleInfo);t.add(r)},o.getLayerExtent=function(e){e instanceof r.BaseLayer&&(e=e.getLayer());var n=function e(t){var r=[],n=[];if(t instanceof i.carto.FeatureLayer)r=t.features;else if(t instanceof i.carto.ElementLayer)r=t.elements;else{if(!(t instanceof i.carto.ClusterLayer)){if(t instanceof i.carto.GroupLayer){var o=t.groupLayers;for(var a in o){var s=o[a],l=e(s)||[];n=n.concat(l)}return n}throw new Error("图层类型错误！")}r=t.elements}for(var c in r){var u=r[c];u&&u.geometry&&n.push(u.geometry)}return n}(e);return t.getGeometryEnvlop(n)},o.setLayerSymbol=function(t,r,n){if(!r&&0==n.length)throw new Error("参数类型错误！");e.isEmptyObject(r.symbol)&&(r.symbol={});var a={TextSymbol:"TextSymbol",SimpleMarkerSymbol:"SimpleMarkerSymbol",PictureMarkerSymbol:"PicturemarkerSymbol",SimpleLineSymbol:"SimpleLineSymbol",SimpleFillSymbol:"SimpleFillSymbol"};if(r instanceof i.carto.GroupLayer){var s=r.id.substr(0,r.id.length-12);l(o.getLayerById(t,s+"elementLayer")),l(o.getLayerById(t,s+"featureLayer"))}else l(r);function l(e){if(e instanceof i.carto.ElementLayer)for(var t=0;t<n.length;t++){e.symbol[n[t].type]=n[t].options;var r=e.elements,o=a[n[t].type];if(r.length>0)for(var s=0;s<r.length;s++){(l=new i.sfs[o](n[t].options)).$type==r[s].symbol.$type&&(r[s].symbol=l,e.update(r[s],!0))}}else{o=a[n[0].type];var l=new i.sfs[o](n[0].options),c=new i.render.SimpleRenderer({symbol:l});e.featureRenders.length=0,e.render(c)}}},o.getLayerSymbol=function(t,r){if(!t&&!r)throw new Error("参数类型错误！");var n={};return e.isEmptyObject(t.symbol)?n={}:(n.type=r,n.options=t.symbol[r]),n};return o.selectElementOnMap=function(e,t,n){if(!e||0==t.length)throw new Error("传入参数错误");n||(n="intersects");for(var o=G.utils.GeometryUtil.toJstsGeometry(e),a={},s=0;s<t.length;s++){var l=t[s],c=l.getLayerId();l instanceof r.DistributeLayer&&(l=l.getLayer()),a[c]=u(l,o,n)}return a;function u(e,t,r){var n=[];if(e instanceof i.carto.ElementLayer||e instanceof i.carto.FeatureLayer)for(var o=e.getCount(),a=0;a<o;a++){var s=e.get(a),l=G.utils.GeometryUtil.toJstsGeometry(f(s));t[r](l)&&n.push(s)}else if(e instanceof i.carto.GroupLayer)for(var c=e.groupLayers,p=0,h=c.length;p<h;p++){var d=c[p];n=n.concat(u(d,t,r))}return n}function f(e){if(e instanceof i.sfs.PlotElement){var t=e.elements;return t[t.length-1].geometry}return e.geometry}},o.addElementLayerToMap=function(e,t){var r=new i.carto.ElementLayer({map:t,name:e.name,id:e.id,zIndex:e.zIndex,attr:e.attr,visible:e.visible,groupType:e.groupType});return r.attr=e.attr,"point"==e.groupType||"line"==e.groupType||"polygon"==e.groupType?o.addLayer2Group(t,r,e.groupType):t.addLayer(r),r},o}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n;void 0===(n=function(){var e={extend:function(e){var t,r,n,i;for(r=1,n=arguments.length;r<n;r++)for(t in i=arguments[r])e[t]=i[t];return e},create:Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}()};!function(){function t(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var r=0;function n(e){var t=+new Date,n=Math.max(0,16-(t-r));return r=t+n,window.setTimeout(e,n)}var i=window.requestAnimationFrame||t("RequestAnimationFrame")||n,o=window.cancelAnimationFrame||t("CancelAnimationFrame")||t("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};e.requestAnimFrame=function(e,t,r){if(!r||i!==n)return i.call(window,function(e,t){var r=Array.prototype.slice;if(e.bind)return e.bind.apply(e,r.call(arguments,1));var n=r.call(arguments,2);return function(){return e.apply(t,n.length?n.concat(r.call(arguments)):arguments)}}(e,t));e.call(t)},e.cancelAnimFrame=function(e){e&&o.call(window,e)}}();var t=function(){};return t.setOptions=function(t,r){for(var n in t.hasOwnProperty("options")||(t.options=t.options?e.create(t.options):{}),r)t.options[n]=r[n];return t.options},t.extend=function(t){var r=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},n=r.__super__=this.prototype,i=e.create(n);for(var o in i.constructor=r,r.prototype=i,this)this.hasOwnProperty(o)&&"prototype"!==o&&(r[o]=this[o]);return t.statics&&(e.extend(r,t.statics),delete t.statics),t.includes&&(e.extend.apply(null,[i].concat(t.includes)),delete t.includes),i.options&&(t.options=e.extend(e.create(i.options),t.options)),e.extend(i,t),i._initHooks=[],i.callInitHooks=function(){if(!this._initHooksCalled){n.callInitHooks&&n.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=i._initHooks.length;e<t;e++)i._initHooks[e].call(this)}},r},t.include=function(t){return t="prototype"in t?t.prototype:t,e.extend(this.prototype,t),this},t.mergeOptions=function(t){return e.extend(this.prototype.options,t),this},t.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),r="function"==typeof e?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(r),this},t.defaults=function(e,t,r){for(var n in t)t.hasOwnProperty(n)&&(r?null!=t[n]:null==e[n])&&(e[n]=t[n]);return e},t.inherits=function(e,t){var r=e.prototype;function n(){}for(var i in n.prototype=t.prototype,e.prototype=new n,r)e.prototype[i]=r[i];e.prototype.constructor=e,e.superClass=t},t.mixin=function(e,r,n){e="prototype"in e?e.prototype:e,r="prototype"in r?r.prototype:r,t.defaults(e,r,n)},t.prototype={equals:function(e,t){return r(e,t)&&r(t,e);function r(e,t){if(e&&e.constructor==Object){if(t&&t.constructor==Object){for(var n in e){var i=e[n],o=t[n];if(!(r(i,o)&&r(o,i)))return!1}return!0}return!1}return e===t}}},t}.apply(t,[]))||(e.exports=n)},function(e,t,r){"use strict";var n,i;n=[r(2),r(11),r(1)],void 0===(i=function(e,t,r){var n={symbol2ImageHtml:function(e,t){var n;t=t||{};var i=this,o=e.$type.split(",")[0],a={PictureMarkerSymbol:function(){if(e.source.indexOf("data:image/png;base64,")>-1)var t=e.source;else t="data:image/png;base64,"+e.source;return console.log(e.source),console.log(t),console.log("============================"),n='<img src="'+t+'" alt="">'},SimpleMarkerSymbol:function(){var r=e.size;return r=r>10?10:r,isNaN(t.size)||(r=t.size),n='<svg width="25px" height="25px" version="1.0.0">',n+="<circle",n+=' cx="12" ',n+=' cy="12" ',n+=' r="'+r+'" ',n+=' stroke="'+u(e.borderColor)+'" ',n+=' stroke-opacity="'+e.borderColor.a/255+'" ',n+=' stroke-width="'+e.borderThickness+'" ',n+=' fill="'+u(e.fillColor)+'"',n+=' fill-opacity="'+e.fillColor.a/255+'" ',n+="></svg>"},SimpleLineSymbol:function(){n='<svg width="30px" height="20px" version="1.0.0">',n+="<line",n+=' x1="5" y1="10"',n+=' x2="25" y2="10"',n+=' stroke="'+u(e.color)+'" ';var t=parseInt(e.style);return 1!=t&&5!=t&&(n+=' stroke-dasharray="5,5"'),n+=' stroke-opacity="'+e.color.a/255+'" ',n+=' stroke-width="'+e.width+'" ',n+="></svg>"},SimpleFillSymbol:function(){return n='<svg width="30px" height="20px" version="1.0.0">',n+="<polygon",n+=' points="0,0,0,20,25,20,25,0" ',n+=' stroke="'+u(e.borderColor)+'" ',n+=' stroke-opacity="'+e.borderColor.a/255+'" ',n+=' stroke-width="'+e.borderThickness+'" ',n+=' fill="'+u(e.fillColor)+'"',n+=' fill-opacity="'+e.fillColor.a/255+'" ',n+="></svg>"},CurrencySymbol:function(){var t=e.markerSymbol||e.fillSymbol;n=i.symbol2ImageHtml(t);var r=e.textSymbol;if(r){n+='<span style="',n+="position: relative;",n+="left: -20px;",n+="top: -8px;",n+="font-size: 10px;";var o="#fff";return r.foreground&&(o=r.foreground.toHex().substr(0,7)),n+="color:"+o+";",r.fontFamilyName&&(n+="font-family:"+r.fontFamilyName+";"),r.fontWeight&&(n+="font-weight:"+r.fontWeight+";"),n+='">10</span>'}}};if(e&&"pixelcluster"==e.$type){var s=e.fillStrokeWidth||10,l=new r.sfs.SimpleMarkerSymbol({borderColor:e.fillStrokeColor,fillColor:e.fillColor,borderThickness:s/2,size:s});n=function(e,r,n){var i=isNaN(e.borderThickness)?0:e.borderThickness,o=e.size,a=o+i,s=1;r=isNaN(r)?12:r,n=isNaN(n)?5:n;a>r&&(s=r/(a=r));i*=s,(o*=s)>n&&(i+=o-n,o=n);isNaN(t.size)||(o=t.size);var l=r,c='<svg width="25px" height="25px" version="1.0.0">';return c+="<circle",c+=' cx="'+l+'" ',c+=' cy="'+l+'" ',c+=' r="'+o+'" ',c+=' fill="rgb(255,255,255)"',c+=' fill-opacity="0" ',c+=' stroke="'+u(e.borderColor)+'"',c+=' stroke-width="'+i+'" ',c+=' stroke-opacity="'+e.borderColor.a/255+'" />',c+="<circle",c+=' cx="'+l+'" ',c+=' cy="'+l+'" ',c+=' r="'+o+'" ',c+=' fill="'+u(e.fillColor)+'"',c+=' fill-opacity="'+e.fillColor.a/255+'"/>',c+="</svg>"}(l,12,7),n+='<span style="',n+="position: relative;",n+="left: -16px;",n+="top: -8px;",n+="font-size: 10px;";var c="#fff";e.textFillColor&&(c=e.textFillColor.toHex().substr(0,7)),n+="color:"+c+";",n+='">1</span>'}else"function"==typeof a[o]&&(n=a[o]());return n;function u(e){if(e)return"rgb("+e.r+","+e.g+","+e.b+")"}},object2Symbol:function(t){if(0==arguments.length)throw new Error("参数错误！");if(1==arguments.length){t=arguments[0];if(e.isString(t))try{t=JSON.parse(t)}catch(e){}return n.object2Symbol(t.type,t.options)}var i=arguments[0],o=arguments[1],a={TextSymbol:function(e){return c(e,["foreground","borderColor"]),new r.sfs.TextSymbol(e)},PictureMarkerSymbol:function(t){var n=t.source||"",i=t.sourceKey||"";return i=i.trim(),t.width=isNaN(t.width)?20:t.width,t.height=isNaN(t.height)?20:t.height,t.offsetX=isNaN(t.offsetX)?t.width/2:t.offsetX,t.offsetY=isNaN(t.offsetY)?t.height/2:t.offsetY,i&&!n&&(i.indexOf(".")<0?t.source=window[i]||G.icons[i]:t.source=e.getValByVarPath(i)),new r.sfs.PictureMarkerSymbol(t)},SimpleMarkerSymbol:function(e){return e.size=isNaN(e.size)?5:e.size,e.offsetX=isNaN(e.offsetX)?e.size/2:e.offsetX,e.offsetY=isNaN(e.offsetY)?e.size/2:e.offsetY,c(e,["borderColor","fillColor"]),new r.sfs.SimpleMarkerSymbol(e)},SimpleLineSymbol:function(e){return c(e,["color"]),new r.sfs.SimpleLineSymbol(e)},SimpleFillSymbol:function(e){return c(e,["borderColor","fillColor"]),new r.sfs.SimpleFillSymbol(e)}},s=a[i||"PictureMarkerSymbol"];if(!e.isFunction(s))throw new Error("type值错误！");var l=jQuery.extend(!0,{},o);return s(l);function c(e,t){e=e||{};for(var r=0,i=(t=t||[]).length;r<i;r++){var o=t[r];e[o]&&(e[o]=n._getColor(e[o]))}}},symbol2Object:function(t){var r=null;if(t&&t.$type){var i=t.$type,o=/^(.*Symbol),http\:\/\/www.Gs.com$/;o.test(i)&&(r=o.exec(i)[1])}if(!r)throw new Error("参数类型错误！");var a=JSON.parse(JSON.stringify(t));delete a.$type,function(t){for(var r=["color","borderColor","fillColor","foreground"],i=0,o=r.length;i<o;i++){var a=r[i],s=t[a];e.isObject(s)&&(t[a]=n.color2Object(s))}}(a);return{type:{TextSymbol:"TextSymbol",SimpleMarkerSymbol:"SimpleMarkerSymbol",PictureMarkerSymbol:"PictureMarkerSymbol",SimpleLineSymbol:"SimpleLineSymbol",SimpleFillSymbol:"SimpleFillSymbol"}[r],options:a}},object2Color:function(e){return n._getColor(e)},color2Object:function(t){var n={};if(e.isString(t))try{t=r.sfs.Color.fromHex(t)}catch(e){}return t&&"Color,http://www.Gs.com"==t.$type&&(n.a=t.a,n.r=t.r,n.g=t.g,n.b=t.b),n},_getColor:function(t){if(e.isObject(t)){var n=jQuery.extend(!0,{},t);return n.alpha&&(n.a=n.alpha,delete n.alpha),new r.sfs.Color(n)}return"string"==typeof t?r.sfs.Color.fromHex(t):t},geoinfoToElement:function(i,o,a){var s;console.log(o),s=o.$type?o:n.object2Symbol(o.type,o.options),console.log(s);var l,c=r.sfs.GeometryFactory,u=e.isObject(i),f=e.isString(i);(a=a||{}).hasOwnProperty("id")||(a.id=e.newUUID32());var p=[];if(null!=t.getG2GeometryType(i)?l=i:u?l=c.createGeometryFromGeoJson(i):f&&(l=c.createGeometryFromWkt(i)),l){if(a.layer instanceof r.carto.FeatureLayer){var h=new r.sfs.Feature({geometry:l,values:a.property});return h.symbol=s,h.id=a.id,h.name=a.name,h}var d=new r.sfs.Element({geometry:l,symbol:s,id:a.id,name:a.name}),y=a.property,m=new r.sfs.Attribute({name:"data",value:y});return p.push(m),d.attributeSet.attributes=p,a.layer&&a.layer.add(d),d}throw new Error("geoinfo格式错误！")}};return n}.apply(t,n))||(e.exports=i)},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){"use strict";var n,i;n=[r(9)],void 0===(i=function(e){return e.extend({options:{map:null},initialize:function(t){e.prototype.initialize.call(this,t)},destroy:function(){e.prototype.destroy.call(this)}})}.apply(t,n))||(e.exports=i)},function(e,t,r){var n=r(12),i=r(46);e.exports=r(10)?function(e,t,r){return n.f(e,t,i(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){var n=r(4),i=r(19),o=r(23),a=r(47)("src"),s=r(184),l=(""+s).split("toString");r(27).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,r,s){var c="function"==typeof r;c&&(o(r,"name")||i(r,"name",t)),e[t]!==r&&(c&&(o(r,a)||i(r,a,e[t]?""+e[t]:l.join(String(t)))),e===n?e[t]=r:s?e[t]?e[t]=r:i(e,t,r):(delete e[t],i(e,t,r)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,r){var n=r(0),i=r(5),o=r(33),a=/"/g,s=function(e,t,r,n){var i=String(o(e)),s="<"+t;return""!==r&&(s+=" "+r+'="'+String(n).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var r={};r[e]=t(s),n(n.P+n.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",r)}},function(e,t,r){"use strict";var n;void 0===(n=function(){var e={},t=null;return e._getLogger=function(){return null==t&&e.setOptions({type:"console"}),t},e.setOptions=function(e){if(e)if("log4js"===e.type){if(!window.log4javascript)throw new Error("log4javascript is not defined!");var r={popup:new log4javascript.PopupAppender,inpage:new log4javascript.InPageAppender};t=window.log4javascript.getLogger("main"),log.addAppender(r[e.appender||"popup"])}else t=(e.type,window.console)},e.info=function(t){e._getLogger().info(t)},e.trace=function(t){e._getLogger().trace(t)},e.debug=function(t){e._getLogger().debug(t)},e.warn=function(t){e._getLogger().warn(t)},e.error=function(t){e._getLogger().error(t)},e.clear=function(){e._getLogger().clear(obj)},e}.apply(t,[]))||(e.exports=n)},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t,r){var n=r(63),i=r(33);e.exports=function(e){return n(i(e))}},function(e,t,r){var n=r(64),i=r(46),o=r(24),a=r(32),s=r(23),l=r(125),c=Object.getOwnPropertyDescriptor;t.f=r(10)?c:function(e,t){if(e=o(e),t=a(t,!0),l)try{return c(e,t)}catch(e){}if(s(e,t))return i(!n.f.call(e,t),e[t])}},function(e,t,r){var n=r(23),i=r(13),o=r(90)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),n(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t){var r=e.exports={version:"2.6.9"};"number"==typeof __e&&(__e=r)},function(e,t,r){var n=r(17);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,i){return e.call(t,r,n,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){"use strict";var n=r(5);e.exports=function(e,t){return!!e&&n((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,r){var n=r(6);e.exports=function(e,t){if(!n(e))return e;var r,i;if(t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;if("function"==typeof(r=e.valueOf)&&!n(i=r.call(e)))return i;if(!t&&"function"==typeof(r=e.toString)&&!n(i=r.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,r){var n=r(0),i=r(27),o=r(5);e.exports=function(e,t){var r=(i.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*o((function(){r(1)})),"Object",a)}},function(e,t,r){var n=r(28),i=r(63),o=r(13),a=r(8),s=r(106);e.exports=function(e,t){var r=1==e,l=2==e,c=3==e,u=4==e,f=6==e,p=5==e||f,h=t||s;return function(t,s,d){for(var y,m,g=o(t),v=i(g),b=n(s,d,3),_=a(v.length),w=0,S=r?h(t,_):l?h(t,0):void 0;_>w;w++)if((p||w in v)&&(m=b(y=v[w],w,g),e))if(r)S[w]=m;else if(m)switch(e){case 3:return!0;case 5:return y;case 6:return w;case 2:S.push(y)}else if(u)return!1;return f?-1:c||u?u:S}}},function(e,t,r){var n,i;n=[r(1)],void 0===(i=function(e){var t,r=Array.prototype.slice,n=function(e){this._$handlers={},e&&this.delegateMapEvents(e.map)};return(n.prototype={constructor:n,once:function(e,t,r){this._$handlers||(this._$handlers={});var n=this._$handlers;if(!t||!e)return this;n[e]||(n[e]=[]);for(var i=0;i<n[e].length;i++)if(n[e][i].h===t)return this;return n[e].push({h:t,one:!0,ctx:r||this}),this},addEventListener:function(e,t,r){this._$handlers||(this._$handlers={});var n=this._$handlers;if(!t||!e)return this;n[e]||(n[e]=[]);for(var i=0;i<n[e].length;i++)if(n[e][i].h===t)return this;return n[e].push({h:t,one:!1,ctx:r||this}),this},listens:function(e,t){this._$handlers||(this._$handlers={});var r=this._$handlers;if(t){for(var n=0;n<r[e].length;n++)if(r[e][n].h==t)return!0;return!1}return!(!r[e]||!r[e].length)},removeEventListener:function(e,t){this._$handlers||(this._$handlers={});var r=this._$handlers;if(!e)return this._$handlers={},this;if(t){if(r[e]){for(var n=[],i=0,o=r[e].length;i<o;i++)r[e][i].h!=t&&n.push(r[e][i]);r[e]=n}r[e]&&0===r[e].length&&delete r[e]}else delete r[e];return this},fireEvent:function(e){this._$handlers||(this._$handlers={});var t=[];if(this._$handlers[e]){var n=arguments,i=n.length;i>3&&(n=r.call(n,1));for(var o=this._$handlers[e],a=o.length,s=0;s<a;){var l=null;switch(i){case 1:l=o[s].h.call(o[s].ctx);break;case 2:l=o[s].h.call(o[s].ctx,n[1]);break;case 3:l=o[s].h.call(o[s].ctx,n[1],n[2]);break;default:l=o[s].h.apply(o[s].ctx,n)}t.push(l),o[s].one?(o.splice(s,1),a--):s++}}return t},fireWithContext:function(e){if(this._$handlers||(this._$handlers={}),this._$handlers[e]){var t=arguments,n=t.length;n>4&&(t=r.call(t,1,t.length-1));for(var i=t[t.length-1],o=this._$handlers[e],a=o.length,s=0;s<a;){switch(n){case 1:o[s].h.call(i);break;case 2:o[s].h.call(i,t[1]);break;case 3:o[s].h.call(i,t[1],t[2]);break;default:o[s].h.apply(i,t)}o[s].one?(o.splice(s,1),a--):s++}}return this}}).on=n.prototype.addEventListener,n.prototype.off=n.prototype.removeEventListener,n.prototype.fire=n.prototype.fireEvent,t={click:{args:["button","shift","screenX","screenY","mapX","mapY","handle"],var:"clickDelegates_",api:"MapClick"},dblclick:{args:["screenX","screenY","mapX","mapY"],var:"dblClickDelegates_",api:"MapDblClick"},mousemove:{args:["button","shift","screenX","screenY","mapX","mapY","handle"],var:"mouseMoveDelegates_",api:"MapMouseMove"},mousedown:{args:["button","shift","screenX","screenY","mapX","mapY","handle"],var:"mouseDownDelegates_",api:"MapMouseDown"},mouseup:{args:["button","shift","screenX","screenY","mapX","mapY","handle"],var:"mouseUpDelegates_",api:"MapMouseUp"},extentchanged:{args:["left","top","right","bottom"],var:"extentChangedDelegates_",api:"MapExtentChange"},resize:{args:["newSize","oldSize"],var:"resizeDelegates_",api:"MapResize"},resolutionchanged:{args:["newResolution","oldResolution","level"],var:"resolutionChangedDelegates_",api:"MapResolutionChange"}},n.prototype.delegateMapEvents=function(r){if(!(r instanceof e.carto.Map))throw new Error("map对象必须为g2.carto.Map类型！");var n=this,i={};for(var o in function(){for(var e in t){var r=t[e];this[r.var]=[],this[r.var]["_"+e+"_index"]=0}}.call(n),t){t[o];var a=s(o);r.on(o,a),i[o]=a}function s(e){var t=function(){for(var e=[],t=0,r=arguments.length;t<r;t++)e.push(arguments[t]);l.call(n,arguments.callee._event,e)};return t._event=e,t}function l(e,r){var n=t[e];if(n){for(var i=this[n.var],o=n.args,a={},s=0,l=o.length;s<l;s++)a[o[s]]=r[s];if("[object Array]"==Object.prototype.toString.call(i))for(s=0,l=i.length;s<l;s++){var c=i[s];if(c)try{c.callback.call(c.context,a)}catch(e){console.error(e)}}}}this._g2mapListeners=i},n.prototype.unDelegateMapEvents=function(t){if(t instanceof e.carto.Map&&this._g2mapListeners)for(var r in this._g2mapListeners)try{t.un(r,this._g2mapListeners[r])}catch(e){}},n.prototype._on=function(e,r,n){var i=!1;try{var o=t[e];if(o){var a=this[o.var],s="_"+e+"_index",l=a[s];a[l]={context:n,callback:r},a[s]=l+1,i=!0}}catch(e){console.error(e.message)}return i},n.prototype.isMapEvent=function(e){return t.hasOwnProperty(e)},n.prototype._off=function(e,r,n){var i=!1,o="[object Function]"==Object.prototype.toString.call(r),a=!!n;try{for(var s=this[t[e].var],l=s.length-1;l>=0;l--){var c=s[l];c&&u(c)&&(s[l]=void 0,s.splice(l,1),i=!0)}}catch(e){console.error(e.message)}function u(e){return e=e||{},o&&a?e.callback===r&&e.context===n:o?e.callback===r:!!a&&e.context===n}return i},n}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=Object.prototype.hasOwnProperty,o=Object.prototype.toString,a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,l=function(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===o.call(e)},c=function(e){if(!e||"[object Object]"!==o.call(e))return!1;var t,r=i.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&i.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!n)return!1;for(t in e);return void 0===t||i.call(e,t)},u=function(e,t){a&&"__proto__"===t.name?a(e,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):e[t.name]=t.newValue},f=function(e,t){if("__proto__"===t){if(!i.call(e,t))return;if(s)return s(e,t).value}return e[t]};e.exports=function e(){var t,r,i,o,a,s,p=arguments[0],h=1,d=arguments.length,y=!1;for("boolean"==typeof p&&(y=p,p=arguments[1]||{},h=2),(null==p||"object"!==(void 0===p?"undefined":n(p))&&"function"!=typeof p)&&(p={});h<d;++h)if(null!=(t=arguments[h]))for(r in t)i=f(p,r),p!==(o=f(t,r))&&(y&&o&&(c(o)||(a=l(o)))?(a?(a=!1,s=i&&l(i)?i:[]):s=i&&c(i)?i:{},u(p,{name:r,newValue:e(y,s,o)})):void 0!==o&&u(p,{name:r,newValue:o}));return p}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if(r(10)){var i=r(41),o=r(4),a=r(5),s=r(0),l=r(81),c=r(114),u=r(28),f=r(53),p=r(46),h=r(19),d=r(55),y=r(30),m=r(8),g=r(153),v=r(49),b=r(32),_=r(23),w=r(59),S=r(6),x=r(13),L=r(103),P=r(50),E=r(26),C=r(51).f,T=r(105),A=r(47),R=r(7),M=r(35),k=r(71),O=r(66),I=r(108),F=r(61),N=r(76),G=r(52),j=r(107),D=r(142),B=r(12),U=r(25),z=B.f,W=U.f,Y=o.RangeError,V=o.TypeError,q=o.Uint8Array,J=Array.prototype,H=c.ArrayBuffer,X=c.DataView,Q=M(0),Z=M(2),K=M(3),$=M(4),ee=M(5),te=M(6),re=k(!0),ne=k(!1),ie=I.values,oe=I.keys,ae=I.entries,se=J.lastIndexOf,le=J.reduce,ce=J.reduceRight,ue=J.join,fe=J.sort,pe=J.slice,he=J.toString,de=J.toLocaleString,ye=R("iterator"),me=R("toStringTag"),ge=A("typed_constructor"),ve=A("def_constructor"),be=l.CONSTR,_e=l.TYPED,we=l.VIEW,Se=M(1,(function(e,t){return Ce(O(e,e[ve]),t)})),xe=a((function(){return 1===new q(new Uint16Array([1]).buffer)[0]})),Le=!!q&&!!q.prototype.set&&a((function(){new q(1).set({})})),Pe=function(e,t){var r=y(e);if(r<0||r%t)throw Y("Wrong offset!");return r},Ee=function(e){if(S(e)&&_e in e)return e;throw V(e+" is not a typed array!")},Ce=function(e,t){if(!(S(e)&&ge in e))throw V("It is not a typed array constructor!");return new e(t)},Te=function(e,t){return Ae(O(e,e[ve]),t)},Ae=function(e,t){for(var r=0,n=t.length,i=Ce(e,n);n>r;)i[r]=t[r++];return i},Re=function(e,t,r){z(e,t,{get:function(){return this._d[r]}})},Me=function(e){var t,r,n,i,o,a,s=x(e),l=arguments.length,c=l>1?arguments[1]:void 0,f=void 0!==c,p=T(s);if(null!=p&&!L(p)){for(a=p.call(s),n=[],t=0;!(o=a.next()).done;t++)n.push(o.value);s=n}for(f&&l>2&&(c=u(c,arguments[2],2)),t=0,r=m(s.length),i=Ce(this,r);r>t;t++)i[t]=f?c(s[t],t):s[t];return i},ke=function(){for(var e=0,t=arguments.length,r=Ce(this,t);t>e;)r[e]=arguments[e++];return r},Oe=!!q&&a((function(){de.call(new q(1))})),Ie=function(){return de.apply(Oe?pe.call(Ee(this)):Ee(this),arguments)},Fe={copyWithin:function(e,t){return D.call(Ee(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return $(Ee(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return j.apply(Ee(this),arguments)},filter:function(e){return Te(this,Z(Ee(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ee(Ee(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return te(Ee(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Q(Ee(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ne(Ee(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return re(Ee(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return ue.apply(Ee(this),arguments)},lastIndexOf:function(e){return se.apply(Ee(this),arguments)},map:function(e){return Se(Ee(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return le.apply(Ee(this),arguments)},reduceRight:function(e){return ce.apply(Ee(this),arguments)},reverse:function(){for(var e,t=Ee(this).length,r=Math.floor(t/2),n=0;n<r;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return K(Ee(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return fe.call(Ee(this),e)},subarray:function(e,t){var r=Ee(this),n=r.length,i=v(e,n);return new(O(r,r[ve]))(r.buffer,r.byteOffset+i*r.BYTES_PER_ELEMENT,m((void 0===t?n:v(t,n))-i))}},Ne=function(e,t){return Te(this,pe.call(Ee(this),e,t))},Ge=function(e){Ee(this);var t=Pe(arguments[1],1),r=this.length,n=x(e),i=m(n.length),o=0;if(i+t>r)throw Y("Wrong length!");for(;o<i;)this[t+o]=n[o++]},je={entries:function(){return ae.call(Ee(this))},keys:function(){return oe.call(Ee(this))},values:function(){return ie.call(Ee(this))}},De=function(e,t){return S(e)&&e[_e]&&"symbol"!=(void 0===t?"undefined":n(t))&&t in e&&String(+t)==String(t)},Be=function(e,t){return De(e,t=b(t,!0))?p(2,e[t]):W(e,t)},Ue=function(e,t,r){return!(De(e,t=b(t,!0))&&S(r)&&_(r,"value"))||_(r,"get")||_(r,"set")||r.configurable||_(r,"writable")&&!r.writable||_(r,"enumerable")&&!r.enumerable?z(e,t,r):(e[t]=r.value,e)};be||(U.f=Be,B.f=Ue),s(s.S+s.F*!be,"Object",{getOwnPropertyDescriptor:Be,defineProperty:Ue}),a((function(){he.call({})}))&&(he=de=function(){return ue.call(this)});var ze=d({},Fe);d(ze,je),h(ze,ye,je.values),d(ze,{slice:Ne,set:Ge,constructor:function(){},toString:he,toLocaleString:Ie}),Re(ze,"buffer","b"),Re(ze,"byteOffset","o"),Re(ze,"byteLength","l"),Re(ze,"length","e"),z(ze,me,{get:function(){return this[_e]}}),e.exports=function(e,t,r,n){var c=e+((n=!!n)?"Clamped":"")+"Array",u="get"+e,p="set"+e,d=o[c],y=d||{},v=d&&E(d),b=!d||!l.ABV,_={},x=d&&d.prototype,L=function(e,r){z(e,r,{get:function(){return function(e,r){var n=e._d;return n.v[u](r*t+n.o,xe)}(this,r)},set:function(e){return function(e,r,i){var o=e._d;n&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[p](r*t+o.o,i,xe)}(this,r,e)},enumerable:!0})};b?(d=r((function(e,r,n,i){f(e,d,c,"_d");var o,a,s,l,u=0,p=0;if(S(r)){if(!(r instanceof H||"ArrayBuffer"==(l=w(r))||"SharedArrayBuffer"==l))return _e in r?Ae(d,r):Me.call(d,r);o=r,p=Pe(n,t);var y=r.byteLength;if(void 0===i){if(y%t)throw Y("Wrong length!");if((a=y-p)<0)throw Y("Wrong length!")}else if((a=m(i)*t)+p>y)throw Y("Wrong length!");s=a/t}else s=g(r),o=new H(a=s*t);for(h(e,"_d",{b:o,o:p,l:a,e:s,v:new X(o)});u<s;)L(e,u++)})),x=d.prototype=P(ze),h(x,"constructor",d)):a((function(){d(1)}))&&a((function(){new d(-1)}))&&N((function(e){new d,new d(null),new d(1.5),new d(e)}),!0)||(d=r((function(e,r,n,i){var o;return f(e,d,c),S(r)?r instanceof H||"ArrayBuffer"==(o=w(r))||"SharedArrayBuffer"==o?void 0!==i?new y(r,Pe(n,t),i):void 0!==n?new y(r,Pe(n,t)):new y(r):_e in r?Ae(d,r):Me.call(d,r):new y(g(r))})),Q(v!==Function.prototype?C(y).concat(C(v)):C(y),(function(e){e in d||h(d,e,y[e])})),d.prototype=x,i||(x.constructor=d));var T=x[ye],A=!!T&&("values"==T.name||null==T.name),R=je.values;h(d,ge,!0),h(x,_e,c),h(x,we,!0),h(x,ve,d),(n?new d(1)[me]==c:me in x)||z(x,me,{get:function(){return c}}),_[c]=d,s(s.G+s.W+s.F*(d!=y),_),s(s.S,c,{BYTES_PER_ELEMENT:t}),s(s.S+s.F*a((function(){y.of.call(d,1)})),c,{from:Me,of:ke}),"BYTES_PER_ELEMENT"in x||h(x,"BYTES_PER_ELEMENT",t),s(s.P,c,Fe),G(c),s(s.P+s.F*Le,c,{set:Ge}),s(s.P+s.F*!A,c,je),i||x.toString==he||(x.toString=he),s(s.P+s.F*a((function(){new d(1).slice()})),c,{slice:Ne}),s(s.P+s.F*(a((function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()}))||!a((function(){x.toLocaleString.call([1,2])}))),c,{toLocaleString:Ie}),F[c]=A?T:R,i||A||h(x,ye,R)}}else e.exports=function(){}},function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(148),o=r(0),a=r(62)("metadata"),s=a.store||(a.store=new(r(151))),l=function(e,t,r){var n=s.get(e);if(!n){if(!r)return;s.set(e,n=new i)}var o=n.get(t);if(!o){if(!r)return;n.set(t,o=new i)}return o};e.exports={store:s,map:l,has:function(e,t,r){var n=l(t,r,!1);return void 0!==n&&n.has(e)},get:function(e,t,r){var n=l(t,r,!1);return void 0===n?void 0:n.get(e)},set:function(e,t,r,n){l(r,n,!0).set(e,t)},keys:function(e,t){var r=l(e,t,!1),n=[];return r&&r.forEach((function(e,t){n.push(t)})),n},key:function(e){return void 0===e||"symbol"==(void 0===e?"undefined":n(e))?e:String(e)},exp:function(e){o(o.S,"Reflect",e)}}},function(e,t){e.exports=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.opts=t||{}}},function(e,t){e.exports=!1},function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(47)("meta"),o=r(6),a=r(23),s=r(12).f,l=0,c=Object.isExtensible||function(){return!0},u=!r(5)((function(){return c(Object.preventExtensions({}))})),f=function(e){s(e,i,{value:{i:"O"+ ++l,w:{}}})},p=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==(void 0===e?"undefined":n(e))?e:("string"==typeof e?"S":"P")+e;if(!a(e,i)){if(!c(e))return"F";if(!t)return"E";f(e)}return e[i].i},getWeak:function(e,t){if(!a(e,i)){if(!c(e))return!0;if(!t)return!1;f(e)}return e[i].w},onFreeze:function(e){return u&&p.NEED&&c(e)&&!a(e,i)&&f(e),e}}},function(e,t,r){var n=r(7)("unscopables"),i=Array.prototype;null==i[n]&&r(19)(i,n,{}),e.exports=function(e){i[n][e]=!0}},function(e,t,r){"use strict";var n;void 0===(n=function(){return{SWITCH_BASE_LAYER:"switch_base_layer",CLEAR_MAP:"clear_map",PLOT_CREATED:"plot_created",PLOT_UPDATED:"plot_updated",PLOT_DELETE:"plot_delete",PLOT_CANCELED:"plot_canceled",PLOT_CLICKED:"plot_clicked",COLLABORATIVE_PLOT_CREATED:"collaborative_plot_created",COLLABORATIVE_PLOT_UPDTAED:"collaborative_plot_updated",COLLABORATIVE_PLOT_DELETE:"collaborative_plot_delete",GLOBAL_VALUE_SETTED:"global_val_setted",LAYER_CHANGED:"some_layer_changed"}}.apply(t,[]))||(e.exports=n)},function(e,t){function r(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var n={},i="safety";function o(e){return e&&e.success?null:new Error(e.msg)}function a(e){for(var t=0,r=e.length;t<r;t++){var n=e[t],i=n.tag;for(var o in delete n.tag,i)"[object Object]"==Object.prototype.toString.call(i[o])?n[o]=i[o].tag:n[o]=i[o];n.id=n._id,delete n._id}return e}var s={};n.getMetas=function(e){var t,n=this;return new Promise((t=r(regeneratorRuntime.mark((function t(r,a){var l,c,u,f,p,h,d,y,m,g,v,b,_,w;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(l=new Array(e.tables.length),c={},u=0;u<e.tables.length;u++)f=e.tables[u],s.hasOwnProperty(f)?l[u]=s[f]:c[f]=u;if(!((p=Object.keys(c)).length>0)){t.next=14;break}return h={dataSetId:{$in:p}},d=e.url+"/dataSet/query",(y={}).eId=i,y.query=JSON.stringify(h),t.next=11,e.httpRequest.get(d,"json",y,"application/x-www-form-urlencoded",{});case 11:if(m=t.sent,null==(g=o(m)))for(v=m.data.result,b=0;b<v.length;b++)_=v[b],w=c[_.dataSetId],l[w]=_,s[_.dataSetId]=_;else a(g);case 14:r(l);case 15:case"end":return t.stop()}}),t,n)}))),function(e,r){return t.apply(this,arguments)}))},n.query=function(e){var t,n=this;return new Promise((t=r(regeneratorRuntime.mark((function t(r,s){var l,c,u,f,p,h,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(u in l=e.url+"/dataOperate/query",(c={}).eId=e.eId||i,c.dataSetId=e.table,e.data)f=Object.prototype.toString.call(e.data[u]),c[u]="[object Object]"==f||"[object Array]"==f?JSON.stringify(e.data[u]):e.data[u]||null;return t.next=7,e.httpRequest.post(l,"json",c,"application/x-www-form-urlencoded",{});case 7:p=t.sent,null==(h=o(p))?((d=p.data).total=d.totalCount,delete d.totalCount,d.list=a(d.result),delete d.result,e.dataParser&&(d=e.dataParser(d)),r(d)):s(h);case 10:case"end":return t.stop()}}),t,n)}))),function(e,r){return t.apply(this,arguments)}))},n.queryMulti=function(e){var t,n=this;return new Promise((t=r(regeneratorRuntime.mark((function t(r,s){var l,c,u,f,p,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=e.url+"/dataOperate/queryMulti",(c={}).eId=e.eId||i,c.data=JSON.stringify(e.data),t.next=6,e.httpRequest.post(l,"json",c,"application/x-www-form-urlencoded",{});case 6:if(u=t.sent,null==(f=o(u))){for(h in p=u.data)p[h]=a(p[h]);e.dataParser&&(p=e.dataParser(p)),r(p)}else s(f);case 9:case"end":return t.stop()}}),t,n)}))),function(e,r){return t.apply(this,arguments)}))},n.aggregateMulti=function(e){var t,n=this;return new Promise((t=r(regeneratorRuntime.mark((function t(r,s){var l,c,u,f,p,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l=e.url+"/dataStatics/aggregateMulti",(c={}).eId=e.eId||i,c.data=JSON.stringify(e.aggregateList),t.next=6,e.httpRequest.post(l,"json",c,"application/x-www-form-urlencoded",{});case 6:if(u=t.sent,null==(f=o(u))){for(h in p=u.data)p[h]=a(p[h]);e.dataParser&&(p=e.dataParser(p)),r(p)}else s(f);case 9:case"end":return t.stop()}}),t,n)}))),function(e,r){return t.apply(this,arguments)}))},n.clear=function(){for(var e in s)delete s[e]},e.exports=n},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(127),i=r(91);e.exports=Object.keys||function(e){return n(e,i)}},function(e,t,r){var n=r(30),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=n(e))<0?i(e+t,0):o(e,t)}},function(e,t,r){var n=r(3),i=r(128),o=r(91),a=r(90)("IE_PROTO"),s=function(){},l=function(){var e,t=r(88)("iframe"),n=o.length;for(t.style.display="none",r(92).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;n--;)delete l.prototype[o[n]];return l()};e.exports=Object.create||function(e,t){var r;return null!==e?(s.prototype=n(e),r=new s,s.prototype=null,r[a]=e):r=l(),void 0===t?r:i(r,t)}},function(e,t,r){var n=r(127),i=r(91).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){"use strict";var n=r(4),i=r(12),o=r(10),a=r(7)("species");e.exports=function(e){var t=n[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,r,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(r+": incorrect invocation!");return e}},function(e,t,r){var n=r(28),i=r(140),o=r(103),a=r(3),s=r(8),l=r(105),c={},u={};(t=e.exports=function(e,t,r,f,p){var h,d,y,m,g=p?function(){return e}:l(e),v=n(r,f,t?2:1),b=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(h=s(e.length);h>b;b++)if((m=t?v(a(d=e[b])[0],d[1]):v(e[b]))===c||m===u)return m}else for(y=g.call(e);!(d=y.next()).done;)if((m=i(y,v,d.value,t))===c||m===u)return m}).BREAK=c,t.RETURN=u},function(e,t,r){var n=r(20);e.exports=function(e,t,r){for(var i in t)n(e,i,t[i],r);return e}},function(e,t,r){var n=r(6);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,r){"use strict";var n,i;n=[r(11),r(2),r(1)],void 0===(i=function(e,t,r){var n={};function i(e,t){var r=e[0],n=e[1],i=t[0],o=t[1],a=Math.abs(r-i),s=Math.abs(n-o),l=s/Math.sqrt(Math.pow(a,2)+Math.pow(s,2)),c=Math.acos(l),u=Math.floor(180/(Math.PI/c));return i>r&&o>n&&(u=180-u),i==r&&o>n&&(u=180),i>r&&o==n&&(u=90),i<r&&o>n&&(u=180+u),i<r&&o==n&&(u=270),i<r&&o<n&&(u=360-u),180-u}function o(e,t,r){for(var n,o,a,s,l,c,u=0,f=0,p=1;p<e.length&&(n=e[p-1],o=e[p],a=n.x,s=n.y,l=o.x,c=o.y,!((u+=f=Math.sqrt(Math.pow(a-l,2)+Math.pow(s-c,2)))>=t));p++);var h=i([e[p-1].x,e[p-1].y],[e[p].x,e[p].y]),d=(t-(u-f))/f;return[n.x+(o.x-n.x)*d,n.y+(o.y-n.y)*d,h]}return n._getJstsGeometry=e._getJstsGeometry,n._fromJstsGeometry=e._fromJstsGeometry,n.unionGeometry=function(t){return e._unionGeometry(t)},n.differGeom=function(e,t){if(!e||!t)return null;var n,i,o=null,a=0,s=t.length,l=360/(2*Math.PI*6378137),c=this._getJstsGeometry(e);if(c)for(n=c.geometry,n=jsts.simplify.DouglasPeuckerSimplifier.simplify(n,l),i=c.type;a<s;a++){var u=this._getJstsGeometry(t[a]);if(u)(e=u.geometry)&&n&&(e=jsts.simplify.DouglasPeuckerSimplifier.simplify(e,l),n.within(e)?n=null:n.intersects(e)&&(n=n.difference(e)))}if(n)switch(i){case 1:o=r.sfs.GeometryFormatter.fromWKT(n.toString());break;case 2:o=n.toString();break;case 3:"jsts.geom.GeometryCollection"==n.CLASS_NAME&&0==n.geometries.length&&(n=null),n&&(o=(o=r.sfs.GeometryFormatter.fromWKT(n.toString())).asGeoJson())}return o},n.interGeom=function(e,t){if(!e||!t)return null;var n,i,o=null,a=0,s=t.length,l=360/(2*Math.PI*6378137),c=this._getJstsGeometry(e);if(c)for(n=c.geometry,n=jsts.simplify.DouglasPeuckerSimplifier.simplify(n,l),i=c.type;a<s;a++){var u=this._getJstsGeometry(t[a]);if(u)(e=u.geometry)&&n&&(e=jsts.simplify.DouglasPeuckerSimplifier.simplify(e,l),n.within(e)?n=e:n.intersects(e)&&(n=n.intersection(e)))}if(n)switch(i){case 1:o=r.sfs.GeometryFormatter.fromWKT(n.toString());break;case 2:o=n.toString();break;case 3:"jsts.geom.GeometryCollection"==n.CLASS_NAME&&0==n.geometries.length&&(n=null),n&&(o=(o=r.sfs.GeometryFormatter.fromWKT(n.toString())).asGeoJson())}return o},n.getBuffer=function(t){t.spatialReference=t.spatialReference||r.sfs.EnumSpatialReference.EPSG4326;e.getWktReader();var n=this._getJstsGeometry(t.geometry)||{};if(!n||!n.geometry)return null;var i=t.radius,o=t.spatialReference==r.sfs.EnumSpatialReference.EPSG4326||t.spatialReference==r.sfs.EnumSpatialReference.EPSG4490||!1,a=n.geometry,s=null;if(a instanceof jsts.geom.Point)if(o){var l=e.getCirclePonits({center:[a.getX(),a.getY()],radius:i,count:128,spatialReference:t.spatialReference});l.push([l[0][0],l[0][1]]);var c={type:"Polygon",coordinates:[l]};s=e.getGeoJSONReader().read(c)}else s=a.buffer(i);else a instanceof jsts.geom.Geometry&&(o&&(i=e.meter2Rad(i)),s=a.buffer(i));return this._fromJstsGeometry({geometry:s,type:n.type,spatialReference:t.spatialReference})},n.caculateDisatance=function(e,n,i){if(!t.isArray(e)||!t.isArray(n))throw new Error("参数类型错误！");i=isNaN(i)?4326:i;var o=new r.sfs.Point({x:e[0],y:e[1]}),a=new r.sfs.Point({x:n[0],y:n[1]}),s=new r.sfs.Polyline({spatialReference:i}),l=new r.sfs.Path({spatialReference:i});l.addPoint(o),l.addPoint(a),s.addGeometry(l);var c=new r.sfs.CoordinateTransform;return new r.sfs.MeasureService({projectService:c}).length(s)},n.point2SegmentDistance=function(e,t,r,n,i,o){var a,s,l={},c=(i-r)*(e-r)+(o-n)*(t-n);if(c<=0)return l.nearest=[r,n],l.distance=Math.sqrt((e-r)*(e-r)+(t-n)*(t-n)),l;if(c>=(i-r)*(i-r)+(o-n)*(o-n))return l.nearest=[i,o],l.distance=Math.sqrt((e-i)*(e-i)+(t-o)*(t-o)),l;if(r==i)a=r,s=t,l.nearest=[a,s],l.distance=Math.abs(e-a);else if(n==o)a=e,s=n,l.nearest=[a,s],l.distance=Math.abs(t-s);else{var u,f,p;s=(u=(n-o)/(r-i))*(a=(t-(p=-1/u)*e-(f=n-u*r))/(u-p))+f,l.nearest=[a,s],l.distance=Math.sqrt((e-a)*(e-a)+(t-s)*(t-s))}return l},n.getPointAlongPath=function(t){var n,a,s,l,c=new r.sfs.CoordinateTransform;try{var u;n=t.pathGeometry,a=t.pathSrid||3857,l=t.step,(u=n instanceof r.sfs.Polyline?n:r.sfs.GeometryFactory.createGeometryFromGeoJson(n)).spatialReference=t.pathSrid,3857!=a&&(u=c.transform(u,3857)),s=e.toJstsGeometry(u)}catch(e){throw new Error("参数错误！")}var f=[],p=s.points,h=l,d=s.getLength(),y=i([p[0].x,p[0].y],[p[1].x,p[1].y]);for(g(f,[p[0].x,p[0].y,y],a,3857);h<=d;){g(f,o(p,h,a),a,3857),h+=l}var m=i([p[p.length-2].x,p[p.length-2].y],[p[p.length-1].x,p[p.length-1].y]);return g(f,[p[p.length-1].x,p[p.length-1].y,m],a,3857),f;function g(e,t,n,i){var o=new r.sfs.Point({x:t[0],y:t[1],spatialReference:i});o=c.transform(o,n),t[0]=o.x,t[1]=o.y,t[2]=t[2],e.push(t)}},n.getPointOnPath=function(t){var n,i,a,s,l=new r.sfs.CoordinateTransform;try{var c;n=t.pathGeometry,i=t.pathSrid||3857,s=t.distance,(c=n instanceof r.sfs.Polyline?n:r.sfs.GeometryFactory.createGeometryFromGeoJson(n)).spatialReference=t.pathSrid,3857!=i&&(c=l.transform(c,3857)),a=e.toJstsGeometry(c)}catch(e){throw new Error("参数错误！")}var u,f=a.points,p=a.getLength()<s;if(!p){u=o(f,s);var h=new r.sfs.Point({x:u[0],y:u[1],spatialReference:3857});3857!=i&&(h=l.transform(h,i),u[0]=h.x,u[1]=h.y,u[2]=u[2])}return{point:u,arrival:p}},n}.apply(t,n))||(e.exports=i)},function(e,t,r){var n=r(12).f,i=r(23),o=r(7)("toStringTag");e.exports=function(e,t,r){e&&!i(e=r?e:e.prototype,o)&&n(e,o,{configurable:!0,value:t})}},function(e,t,r){var n=r(29),i=r(7)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,r,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?r:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,r){var n=r(0),i=r(33),o=r(5),a=r(94),s="["+a+"]",l=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),u=function(e,t,r){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()})),l=i[e]=s?t(f):a[e];r&&(i[r]=l),n(n.P+n.F*s,"String",i)},f=u.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(l,"")),2&t&&(e=e.replace(c,"")),e};e.exports=u},function(e,t){e.exports={}},function(e,t,r){var n=r(27),i=r(4),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:r(41)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,r){var n=r(29);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,r){"use strict";var n=r(3);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,r){var n=r(3),i=r(17),o=r(7)("species");e.exports=function(e,t){var r,a=n(e).constructor;return void 0===a||null==(r=n(a)[o])?t:i(r)}},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(116),__webpack_require__(2),__webpack_require__(11),__webpack_require__(385),__webpack_require__(22),__webpack_require__(16),__webpack_require__(1)],__WEBPACK_AMD_DEFINE_RESULT__=function(BaseLayer,CommonUtil,GeometryUtil,layerExtend,LoggerUtil,RenderUtil,g2){var layer=BaseLayer.extend({options:{idKey:"id",attributeField:"",geometryField:null,symbolConfigUrl:"",defaultSymbolKey:"default"},initialize:function(e){BaseLayer.prototype.initialize.call(this,e),this.type=this.constructor.type,CommonUtil.isObject(this.options.symbolConfig)&&(this.symbolConfig=jQuery.extend(!0,{},this.options.symbolConfig),delete this.options.symbolConfig),this.layer=new g2.carto.ElementLayer({id:this.options.layerId,name:this.options.layerName||"",map:this.map}),this.options.idKey.indexOf(".")<0?this._getRecordId=function(e){return e[this.options.idKey]}:this._getRecordId=function(e){if(e){var t=this.options.idKey.split("."),r=e;if(t.length>0)for(var n=0,i=t.length;n<i;n++){var o=t[n];if(!r||!o){r=null;break}r=r[o]}if(null!=r)return r;LoggerUtil.error("fail to  get id of "+JSON.stringify(e))}},this.currentSymbols=[],this.allSymbols=[],this.renderFields=[],this._getSymbolCfg();var t=new jsts.geom.GeometryFactory(new jsts.geom.PrecisionModel(1e5));this.wktReader=new jsts.io.WKTReader(t)},_addListeners:function(){BaseLayer.prototype._addListeners.call(this),this.map.listen("click",this._mapClickListener,this)},_removeListeners:function(){this.map.off("click",this._mapClickListener,this),BaseLayer.prototype._removeListeners.call(this)},_mapClickListener:function(e){var t=this.hitTest(e.screenX,e.screenY);t&&this.fire("click",{element:t.element,layer:t.layer})},_createSymbol:function(e,t){return RenderUtil.object2Symbol(e,t)},addElements:function(e,t){},_getGeometry:function(e,t,r){if(!e)return null;var n=this.options.geometryField,i=null;try{if(n){var o=e[n];try{"string"==typeof o?(o=this.wktReader.read(o).toString(),i=g2.sfs.GeometryFactory.createGeometryFromWkt(o,t)):i=g2.sfs.GeometryFactory.createGeometryFromGeoJson(o,t)}catch(e){}}else{var a,s;a=this._getXyVal(e,this.options.xField),s=this._getXyVal(e,this.options.yField),i=new g2.sfs.Point({x:a,y:s,spatialReference:t})}if(i instanceof g2.sfs.Point)GeometryUtil.validateCoordinate(i.x,i.y,t)||(i=null)}catch(t){LoggerUtil.warn("record "+e._id+" 没有坐标 ")}return t&&r&&t!=r&&(i=this.projService.transform(i,r)),i},_getXyVal:function _getXyVal(data,field){var val;try{val=field.indexOf(".")<0?data[field]:parseFloat(eval("data."+field))}catch(e){}return val},getSymbol:function(e,t){return this._getSymbol(e,t)},_getSymbol:function(e,t){var r;t=this._getSymbol_Zoom(t),r=this._getSymbol_DataObj(e,this.options.attributeField),r=this._getDataOrData2(r,e);var n=this._getSymbol_symKeyObj(this.renderFields,r),i=n.symKey,o=n.rangeStr;i=this._getSymbol_symKeyLookstr(i,"$_$");for(var a,s,l=1,c=this.allSymbols.length,u=[];l<c;l++){var f=this.allSymbols[l];if(f){var p=f.symbolKey;if(p==i){a=f;break}if(p.startsWith(i)&&p.indexOf("zoomLevel$=$")>=0){var h=p.split("$_$");o=h[h.length-1].split("$=$")[1];CommonUtil.assertWithin(t,o)&&(s=o,a=f),u.push(o)}}}var d=this.symbolConfig,y=d.defaultSymbol,m={};a?m={symbol:this._doGetSymbol(r,a,y),zoomRange:s,zoomRanges:u,symbolKey:a.symbolKey}:m={symbol:this._doGetSymbol(r,d,y),zoomRange:!1,symbolKey:this.options.defaultSymbolKey};return m},getHighlightSymbol:function(e){var t=null,r=this.getElementSymbol(e);if(r){var n=this.symbolConfig.highlight;n&&(t=this._generateNewSymbol(r,n))}return t},updateSymbol:function(e){try{var t,r=0;t=this.elements;for(var n=0,i=t.length;n<i;n++){var o=t[n];if(!1!==o._zoomRange){var a=this._getSymbol(o._data,e);a.zoomRange!==o._zoomRange&&(o.symbol=a.symbol,this.layer.update(o,!0),o._zoomRange=a.zoomRange,o._symbolKey=a.symbolKey,r++)}}r>0&&this._onSymbolsUpdated()}catch(e){LoggerUtil.error(e)}},removeElements:function(e){},setMetaData:function(e){this.metaData=e||{}},validateGeometry:function(e){return!!e&&!(e instanceof g2.sfs.Point&&(isNaN(e.x)||isNaN(e.y)))},destroy:function(){this.clear(),BaseLayer.prototype.destroy.call(this)}});return layer.include({getElementById:function(e){var t=this._getLayerElementById(this.layer,e);return t?t.element:null},getElementSymbol:function(e){var t,r,n=this.elements;for(t in n){var i=n[t];i.id==e&&(r=i)}return r&&r.symbol?r.symbol:null},getSymbolSize:function(e){var t=[];return e instanceof g2.sfs.SimpleMarkerSymbol?(t.push(2*e.size),t.push(2*e.size),t.push(e.offsetX||0),t.push(e.offsetY||0)):e instanceof g2.sfs.PictureMarkerSymbol&&(t.push(e.width),t.push(e.height),t.push(e.offsetX||0),t.push(e.offsetY||0)),t},clear:function(){this.layer.clear(),Object.prototype.hasOwnProperty.call(this,"elements")?this.elements=[]:Object.prototype.hasOwnProperty.call(this,"features")&&(this.features=[]),this._onSymbolsUpdated(),this._onElementChanged(),delete this.noneSpatialArr,this.noneSpatialArr=[]},getLayer:function(){return this.layer},getLayerId:function(){if(this.layer&&this.layer.getLayerId)return this.layer.getLayerId()},getVisible:function(){return this.layer.visible},setVisible:function(e){this.layer.setVisible(e||!1),e?this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:this.currentSymbols}):this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:[]})},getLayerName:function(){return this.layer.getLayerName()},getLayerType:function(){return this.layer.getLayerType()},find:function(e){var t=this.getLayer(),r=null;if(t instanceof g2.carto.GroupLayer)for(var n=t.groupLayers,i=0,o=n.length;i<o;i++){var a=n[i];if(a&&a.find){var s=a.find(e);if(s){r=s;break}}}else r=t.find(e);return r},getElements:function(){return this.elements},hitTest:function(e,t){return this.layer.hitTest(e,t)}}),layerExtend.includeGetSymbol(layer),layerExtend.includeFindElementById(layer),layerExtend.includeGenerateNewSymbol(layer),layerExtend.includeParseSymbolCfg(layer),layer}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(e,t,r){"use strict";var n;void 0===(n=function(){var e="api_dev",t="dev",r="pro",n={_getRelative:function(){var i={};return i[t]=n.getBasePath(),i[e]=n.getBasePath(),i[r]=n.getBasePath()+"/deps/tsemap",i[n._getMode()]},_getMode:function(){return window.devMode||r},getBasePath:function(){var e=window.webApp;return e&&e.lastIndexOf("/")!=e.length-1&&(e+="/"),e},getStaticPath:function(){return n._getRelative()+"resources/static/"},getLibPath:function(){var i={};return i[e]=n._getRelative()+"deps/emaplib",i[t]=i[e],i[r]=n._getRelative()+"deps/lib",i[n._getMode()]},_getRequireJsPath:function(e,t){if(window.require){var r=requirejs.s.contexts,n=null;for(var i in r)if(!t||t==i){var o=r[i];if(o.config.paths.hasOwnProperty(e)){n=o.nameToUrl(e);break}}return n}throw new Error("requirejs未引入！")},_extractCtrlModulePath:function(e){try{var t=n._getRequireJsPath(e);null==t&&e.indexOf("Ctrl")+"Ctrl".length==e.length&&(t=n.getRelativePath()+"controls/"+e+"/js/"+e+".js");var r="^(.*)/[^/]+/"+e+".js$";return new RegExp(r).test(t)?new RegExp(r).exec(t)[1]+"/":null}catch(e){}},getControlPath:function(e){return n._extractCtrlModulePath(e)},getModulePath:function(e){return n._extractCtrlModulePath(e)},getUiPath:function(t){return n._getMode()==e?n.getBasePath()+"/src/ui/"+t:n.getBasePath()+"/deps/tsemap/ui/"+t},loadCss:function(e){var t=document.getElementsByTagName("head")[0];if("[object Array]"==Object.prototype.toString.call(e))for(var r=0,n=e.length;r<n;r++){var i=e[r];if(!a(i)){var o=document.createElement("link");o.setAttribute("href",i),o.setAttribute("rel","stylesheet"),o.setAttribute("type","text/css"),t.appendChild(o)}}function a(e){var t=jQuery("link").filter((function(){return"stylesheet"==jQuery(this).attr("rel")}));if("[object String]"==Object.prototype.toString.call(e)){if(null==(e=s(e)))return!0;for(var r=0,n=t.length;r<n;r++){if(s(t.eq(r).attr("href"))==e)return!0}return!1}return!0}function s(e){var t=/^(.*\.css)(\?.*)?$/;return"[object String]"==Object.prototype.toString.call(e)&&t.test(e)?(e=t.exec(e)[1]).trim().replace(/\/\//g,"/").replace(/\\/g,"/"):null}},getLocaleValue:function(e){return t("app_local",e)||t("tsemap_local",e);function t(e,t){var r=null;try{var n=window.baseLocal[e];if(n&&"string"==typeof t){var i=t.split("."),o=0;for(r=n;r&&o<i.length;)r=r[i[o]],o++}}catch(e){r=null}return r=r||null}},getRelativePath:function(){return n._getScriptPath(/[\/^]tsemap[\-\._]?([\w\-\._]*)\.js\??/)},_getScriptPath:function(e){var t,r,n,i=document.getElementsByTagName("script"),o=null;for(t=0,r=i.length;t<r;t++)(n=i[t].src).match(e)&&(o=(o=n.split(e)[0])?o+"/":"");return o}};return n}.apply(t,[]))||(e.exports=n)},function(e,t,r){var n=r(15),i=n.extend({options:{},initialize:function(e){n.setOptions(this,e)},destroy:function(){},getLegends:function(){},add:function(e){},update:function(e){},remove:function(e){},clear:function(){},setVisible:function(e){},getVisible:function(){},onResolutionChanged:function(e){},onClick:function(e){},onMouseMove:function(e){},onMouseUp:function(e){},onMouseDown:function(e){}});e.exports=i},function(e,t,r){var n=r(1),i={emptyFeatureCol:function(){return{type:"FeatureCollection",features:[]}},featureSet2GeoJson:function(e){for(var t=this.emptyFeatureCol(),r=0;r<e.getCount();r++){var n=e.getFeature(r),i={};i.id=n.objectId,i.geometry=n.geometry.asGeoJson(),i.properties={};for(var o=0;o<n.fields.getCount();o++){var a=n.fields.getField(o).name,s=n.getValue(a);i.properties[a]=s}t.features.push(i)}return t},getFeatureById:function(e,t){for(var r={feature:null,index:-1},n=0;n<t.getCount();n++)if(e==t.getFeature(n).objectId){r.index=n,r.feature=t.getFeature(n);break}return r},createFields:function(e,t){for(var r=new n.sfs.Fields,i=0,o=e.length;i<o;i++){var a=new n.sfs.Field({name:e[i],alias:t[i]});r.add(a)}return r}};e.exports=i},function(e,t,r){var n=r(24),i=r(8),o=r(49);e.exports=function(e){return function(t,r,a){var s,l=n(t),c=i(l.length),u=o(a,c);if(e&&r!=r){for(;c>u;)if((s=l[u++])!=s)return!0}else for(;c>u;u++)if((e||u in l)&&l[u]===r)return e||u||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,r){var n=r(29);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,r){var n=r(30),i=r(33);e.exports=function(e){return function(t,r){var o,a,s=String(i(t)),l=n(r),c=s.length;return l<0||l>=c?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===c||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}}},function(e,t,r){var n=r(6),i=r(29),o=r(7)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,r){var n=r(7)("iterator"),i=!1;try{var o=[7][n]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var r=!1;try{var o=[7],a=o[n]();a.next=function(){return{done:r=!0}},o[n]=function(){return a},e(o)}catch(e){}return r}},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(59),o=RegExp.prototype.exec;e.exports=function(e,t){var r=e.exec;if("function"==typeof r){var a=r.call(e,t);if("object"!==(void 0===a?"undefined":n(a)))throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==i(e))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},function(e,t,r){"use strict";r(144);var n=r(20),i=r(19),o=r(5),a=r(33),s=r(7),l=r(109),c=s("species"),u=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();e.exports=function(e,t,r){var p=s(e),h=!o((function(){var t={};return t[p]=function(){return 7},7!=""[e](t)})),d=h?!o((function(){var t=!1,r=/a/;return r.exec=function(){return t=!0,null},"split"===e&&(r.constructor={},r.constructor[c]=function(){return r}),r[p](""),!t})):void 0;if(!h||!d||"replace"===e&&!u||"split"===e&&!f){var y=/./[p],m=r(a,p,""[e],(function(e,t,r,n,i){return t.exec===l?h&&!i?{done:!0,value:y.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}})),g=m[0],v=m[1];n(String.prototype,e,g),i(RegExp.prototype,p,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)})}}},function(e,t,r){var n=r(4).navigator;e.exports=n&&n.userAgent||""},function(e,t,r){"use strict";var n=r(4),i=r(0),o=r(20),a=r(55),s=r(42),l=r(54),c=r(53),u=r(6),f=r(5),p=r(76),h=r(58),d=r(95);e.exports=function(e,t,r,y,m,g){var v=n[e],b=v,_=m?"set":"add",w=b&&b.prototype,S={},x=function(e){var t=w[e];o(w,e,"delete"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,r){return t.call(this,0===e?0:e,r),this})};if("function"==typeof b&&(g||w.forEach&&!f((function(){(new b).entries().next()})))){var L=new b,P=L[_](g?{}:-0,1)!=L,E=f((function(){L.has(1)})),C=p((function(e){new b(e)})),T=!g&&f((function(){for(var e=new b,t=5;t--;)e[_](t,t);return!e.has(-0)}));C||((b=t((function(t,r){c(t,b,e);var n=d(new v,t,b);return null!=r&&l(r,m,n[_],n),n}))).prototype=w,w.constructor=b),(E||T)&&(x("delete"),x("has"),m&&x("get")),(T||P)&&x(_),g&&w.clear&&delete w.clear}else b=y.getConstructor(t,e,m,_),a(b.prototype,r),s.NEED=!0;return h(b,e),S[e]=b,i(i.G+i.W+i.F*(b!=v),S),g||y.setStrong(b,e,m),b}},function(e,t,r){for(var n,i=r(4),o=r(19),a=r(47),s=a("typed_array"),l=a("view"),c=!(!i.ArrayBuffer||!i.DataView),u=c,f=0,p="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(n=i[p[f++]])?(o(n.prototype,s,!0),o(n.prototype,l,!0)):u=!1;e.exports={ABV:c,CONSTR:u,TYPED:s,VIEW:l}},function(e,t,r){"use strict";e.exports=r(41)||!r(5)((function(){var e=Math.random();__defineSetter__.call(null,e,(function(){})),delete r(4)[e]}))},function(e,t,r){"use strict";var n=r(0);e.exports=function(e){n(n.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},function(e,t,r){"use strict";var n=r(0),i=r(17),o=r(28),a=r(54);e.exports=function(e){n(n.S,e,{from:function(e){var t,r,n,s,l=arguments[1];return i(this),(t=void 0!==l)&&i(l),null==e?new this:(r=[],t?(n=0,s=o(l,arguments[2],2),a(e,!1,(function(e){r.push(s(e,n++))}))):a(e,!1,r.push,r),new this(r))}})}},function(e,t,r){"use strict";var n,i;n=[r(116),r(67),r(117),r(386),r(387),r(388),r(390),r(391),r(119),r(392),r(393),r(394),r(395),r(396),r(397)],void 0===(i=function(e,t,r,n,i,o,a,s,l,c,u,f,p,h,d){var y={LayerFactory:f,BaseLayer:e,DistributeLayer:t,PointLayer:r,LineLayer:a,PolygonLayer:s,PointClusterLayer:i,FeaturePointLayer:n,PointDuplicateLayer:o,StatisticsLayer:l,PieStatisticsLayer:c,RingStatisticsLayer:u,ElementLayerProxy:p,ele:{PointElement:h,PolygonElement:d}};return y.TYPES={ELEMENT_POINT_LAYER:r.type,FEATURE_POINT_LAYER:n.type,ELEMENT_POINT_PIXEL_CLUSTER:i.type,ELEMENT_POINT_DUPLICATE:o.type,ELEMENT_POLYLINE_LAYER:a.type,ELEMENT_POLYGON_LAYER:s.type,PIE_STATISTICS_LAYER:c.type,RING_STATISTICS_LAYER:u.type,BASE_LAYER_TAG:"_base_layer_tag"},y}.apply(t,n))||(e.exports=i)},function(e,t,r){var n=r(1),i=r(2),o=function(e){this.$type="PlotSchema,http://www.Gs.com";var t=e||{};this.id=t.id,this.name=t.name,this.userId=t.userId,this.createTime=null,this.elements=[]};o.prototype.addElement=function(e){this.elements.push(e)},o.prototype.getCount=function(){return this.elements.length},o.prototype.getElement=function(e){return this.elements[e]},o.fromJson=function(e){var t=void 0;t=i.isString(e)?JSON.parse(e):e;for(var r=new o({id:t.id,name:t.name,userId:t.userId}),a=new n.core.Deserializer,s=0;s<t.elements.length;s++){var l=a.createJsInstance(t.elements[s]);r.addElement(l)}return r},e.exports=o},function(e,t,r){var n=r(433),i=r(2),o=r(1),a=r(37),s={};function l(e){return(e=e||{}).table?e.table+"."+e.column:"tag."+e.column}s.parseSqlFragment=function(e,t,r){var o=function(e,t,r){if(i.isArray(t))for(var n=0;n<t.length;n++){var o=t[n];if(o){var a=o.expr;if(a&&a.table&&!r.hasOwnProperty(a.table))throw new Error(e+"参数中字段【"+a.column+"】的表别名【"+a.table+"】错误！")}}},a={select:{prefix:"select ",suffix:" from a",resultKey:"columns",checker:o},where:{prefix:"select * from a where ",suffix:"",resultKey:"where",checker:function(e,t,r){if(!t||!i.isObject(t.left))throw new Error("错误的where格式！");!function e(t,r,n){if(r.hasOwnProperty("left"))e(t,r.left,n),r.right&&r.right.hasOwnProperty("left")&&e(t,r.right.left,n);else{var i=r.table;if(i&&!n.hasOwnProperty(i))throw new Error(t+"参数中字段【"+r.column+"】的表别名【"+i+"】错误！")}}(e,t,r)}},sort:{prefix:"select * from a where 1=1 order by ",suffix:"",resultKey:"orderby",checker:o}};if(a.hasOwnProperty(e)){var s,l=a[e],c=l.prefix+t+l.suffix;try{s=n.parse(c)[l.resultKey]}catch(t){throw new Error(e+"格式错误！")}return l.checker(e,s,r||{}),s}throw new Error("frag参数错误！")};var c={AND:{type:"relation",val:"$and"},OR:{type:"relation",val:"$or"},"=":{fn:function(e,t){t[l(e.left)]=e.right.value}},">":{fn:function(e,t){t[l(e.left)]={$gt:e.right.value}}},">=":{fn:function(e,t){t[l(e.left)]={$ge:e.right.value}}},"<":{fn:function(e,t){t[l(e.left)]={$lt:e.right.value}}},"<=":{fn:function(e,t){t[l(e.left)]={$le:e.right.value}}},"<>":{fn:function(e,t){t[l(e.left)]={$nin:[e.right.value]}}},IN:{fn:function(e,t){for(var r=[],n=0;n<e.right.value.length;n++){var i=e.right.value[n];r.push(i.value)}t[l(e.left)]={$in:r}}},"NOT IN":{fn:function(e,t){for(var r=[],n=0;n<e.right.value.length;n++){var i=e.right.value[n];r.push(i.value)}t[l(e.left)]={$nin:r}}},LIKE:{fn:function(e,t){var r=e.right.value.trim();r="^"+r.replace(/%/g,".*")+"$",t[l(e.left)]={$regex:r}}},"NOT LIKE":{fn:function(e,t){var r=e.right.value.trim();r="^"+r.replace(/%/g,".*")+"$",t[l(e.left)]={$regex:r}}},BETWEEN:{fn:function(e,t){for(var r=[],n=0;n<e.right.value.length;n++){var i=e.right.value[n];r.push(i.value)}var o=[],a=l(e.left),s={},c={};s[a]={$ge:r[0]},c[a]={$le:r[1]},o.push(s),o.push(c),t.$and=o}}},u={intersects:{key:"intersects",map:"$geoIntersects"},within:{key:"within",map:"$geoWithin"},near:{key:"near",map:"$geoNear"}};s.translateWhere=function(e){var t={};return function e(t,r){var n=c[t.operator];if("relation"===n.type){var i=n.val,o=[],a={},s={};e(t.left,a),e(t.right,s),Object.keys(a).length>0&&o.push(a),Object.keys(s).length>0&&o.push(s),r[i]=o}else"column_ref"==t.left.type&&n.fn(t,r)}(e,t),t=function(e){for(var t=["$and","$or"],r=a(!0,{},e);n(r););return r;function n(e){for(var r=!1,n=0;n<t.length;n++){var i=t[n];if(e.hasOwnProperty(i)){for(var o=e[i],a=[],s=0;s<o.length;s++){var l=o[s];l.hasOwnProperty(t[0])&&0==l[t[0]].length?delete l[t[0]]:l.hasOwnProperty(t[1])&&0==l[t[1]].length?delete l[t[1]]:l.hasOwnProperty(i)?(a=a.concat(l[i]),r=!0):a.push(l)}e[i]=a;break}}return r}}(t)},s.translateSelect=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].expr.column;"geom"==n?t.push(n):t.push("tag."+n)}return t.join(" ")},s.translateSort=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r].expr.column,i="ASC"==e[r].type?"":"-";t.push(i+"tag."+n)}return t.join(" ")},s.translateSortAggregate=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r].expr.column,i="ASC"==e[r].type?1:-1;t["tag."+n]=i}return t},s.parseGeometryFilter=function(e){var t={},r={},n=e.geometry;if(e.inputSr!=e.dataSr){var i=new o.sfs.CoordinateTransform,a=o.sfs.GeometryFactory.createGeometryFromGeoJson(e.geomtry);a.spatialReference=e.inputSr,n=i.transform(a,e.dataSr).asGeoJson()}return r[u[e.spatialRel].map]={$geometry:n},t.geom=r,t},e.exports=s},function(e,t,r){var n=r(6),i=r(4).document,o=n(i)&&n(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,r){var n=r(4),i=r(27),o=r(41),a=r(126),s=r(12).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,r){var n=r(62)("keys"),i=r(47);e.exports=function(e){return n[e]||(n[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(4).document;e.exports=n&&n.documentElement},function(e,t,r){var n=r(6),i=r(3),o=function(e,t){if(i(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=r(28)(Function.call,r(25).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,r){return o(e,r),t?e.__proto__=r:n(e,r),e}}({},!1):void 0),check:o}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,r){var n=r(6),i=r(93).set;e.exports=function(e,t,r){var o,a=t.constructor;return a!==r&&"function"==typeof a&&(o=a.prototype)!==r.prototype&&n(o)&&i&&i(e,o),e}},function(e,t,r){"use strict";var n=r(30),i=r(33);e.exports=function(e){var t=String(i(this)),r="",o=n(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(r+=t);return r}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var r=Math.expm1;e.exports=!r||r(10)>22025.465794806718||r(10)<22025.465794806718||-2e-17!=r(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:r},function(e,t,r){"use strict";var n=r(41),i=r(0),o=r(20),a=r(19),s=r(61),l=r(100),c=r(58),u=r(26),f=r(7)("iterator"),p=!([].keys&&"next"in[].keys()),h=function(){return this};e.exports=function(e,t,r,d,y,m,g){l(r,t,d);var v,b,_,w=function(e){if(!p&&e in P)return P[e];switch(e){case"keys":case"values":return function(){return new r(this,e)}}return function(){return new r(this,e)}},S=t+" Iterator",x="values"==y,L=!1,P=e.prototype,E=P[f]||P["@@iterator"]||y&&P[y],C=E||w(y),T=y?x?w("entries"):C:void 0,A="Array"==t&&P.entries||E;if(A&&(_=u(A.call(new e)))!==Object.prototype&&_.next&&(c(_,S,!0),n||"function"==typeof _[f]||a(_,f,h)),x&&E&&"values"!==E.name&&(L=!0,C=function(){return E.call(this)}),n&&!g||!p&&!L&&P[f]||a(P,f,C),s[t]=C,s[S]=h,y)if(v={values:x?C:w("values"),keys:m?C:w("keys"),entries:T},g)for(b in v)b in P||o(P,b,v[b]);else i(i.P+i.F*(p||L),t,v);return v}},function(e,t,r){"use strict";var n=r(50),i=r(46),o=r(58),a={};r(19)(a,r(7)("iterator"),(function(){return this})),e.exports=function(e,t,r){e.prototype=n(a,{next:i(1,r)}),o(e,t+" Iterator")}},function(e,t,r){var n=r(75),i=r(33);e.exports=function(e,t,r){if(n(t))throw TypeError("String#"+r+" doesn't accept regex!");return String(i(e))}},function(e,t,r){var n=r(7)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,r){var n=r(61),i=r(7)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[i]===e)}},function(e,t,r){"use strict";var n=r(12),i=r(46);e.exports=function(e,t,r){t in e?n.f(e,t,i(0,r)):e[t]=r}},function(e,t,r){var n=r(59),i=r(7)("iterator"),o=r(61);e.exports=r(27).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[n(e)]}},function(e,t,r){var n=r(273);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,r){"use strict";var n=r(13),i=r(49),o=r(8);e.exports=function(e){for(var t=n(this),r=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,r),l=a>2?arguments[2]:void 0,c=void 0===l?r:i(l,r);c>s;)t[s++]=e;return t}},function(e,t,r){"use strict";var n=r(43),i=r(143),o=r(61),a=r(24);e.exports=r(99)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,r=this._i++;return!e||r>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?r:"values"==t?e[r]:[r,e[r]])}),"values"),o.Arguments=o.Array,n("keys"),n("values"),n("entries")},function(e,t,r){"use strict";var n,i,o=r(65),a=RegExp.prototype.exec,s=String.prototype.replace,l=a,c=(n=/a/,i=/b*/g,a.call(n,"a"),a.call(i,"a"),0!==n.lastIndex||0!==i.lastIndex),u=void 0!==/()??/.exec("")[1];(c||u)&&(l=function(e){var t,r,n,i,l=this;return u&&(r=new RegExp("^"+l.source+"$(?!\\s)",o.call(l))),c&&(t=l.lastIndex),n=a.call(l,e),c&&n&&(l.lastIndex=l.global?n.index+n[0].length:t),u&&n&&n.length>1&&s.call(n[0],r,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(n[i]=void 0)})),n}),e.exports=l},function(e,t,r){"use strict";var n=r(74)(!0);e.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},function(e,t,r){var n,i,o,a=r(28),s=r(133),l=r(92),c=r(88),u=r(4),f=u.process,p=u.setImmediate,h=u.clearImmediate,d=u.MessageChannel,y=u.Dispatch,m=0,g={},v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},b=function(e){v.call(e.data)};p&&h||(p=function(e){for(var t=[],r=1;arguments.length>r;)t.push(arguments[r++]);return g[++m]=function(){s("function"==typeof e?e:Function(e),t)},n(m),m},h=function(e){delete g[e]},"process"==r(29)(f)?n=function(e){f.nextTick(a(v,e,1))}:y&&y.now?n=function(e){y.now(a(v,e,1))}:d?(o=(i=new d).port2,i.port1.onmessage=b,n=a(o.postMessage,o,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(n=function(e){u.postMessage(e+"","*")},u.addEventListener("message",b,!1)):n="onreadystatechange"in c("script")?function(e){l.appendChild(c("script")).onreadystatechange=function(){l.removeChild(this),v.call(e)}}:function(e){setTimeout(a(v,e,1),0)}),e.exports={set:p,clear:h}},function(e,t,r){var n=r(4),i=r(111).set,o=n.MutationObserver||n.WebKitMutationObserver,a=n.process,s=n.Promise,l="process"==r(29)(a);e.exports=function(){var e,t,r,c=function(){var n,i;for(l&&(n=a.domain)&&n.exit();e;){i=e.fn,e=e.next;try{i()}catch(n){throw e?r():t=void 0,n}}t=void 0,n&&n.enter()};if(l)r=function(){a.nextTick(c)};else if(!o||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);r=function(){u.then(c)}}else r=function(){i.call(n,c)};else{var f=!0,p=document.createTextNode("");new o(c).observe(p,{characterData:!0}),r=function(){p.data=f=!f}}return function(n){var i={fn:n,next:void 0};t&&(t.next=i),e||(e=i,r()),t=i}}},function(e,t,r){"use strict";var n=r(17);function i(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=n(t),this.reject=n(r)}e.exports.f=function(e){return new i(e)}},function(e,t,r){"use strict";var n=r(4),i=r(10),o=r(41),a=r(81),s=r(19),l=r(55),c=r(5),u=r(53),f=r(30),p=r(8),h=r(153),d=r(51).f,y=r(12).f,m=r(107),g=r(58),v="prototype",b="Wrong index!",_=n.ArrayBuffer,w=n.DataView,S=n.Math,x=n.RangeError,L=n.Infinity,P=_,E=S.abs,C=S.pow,T=S.floor,A=S.log,R=S.LN2,M=i?"_b":"buffer",k=i?"_l":"byteLength",O=i?"_o":"byteOffset";function I(e,t,r){var n,i,o,a=new Array(r),s=8*r-t-1,l=(1<<s)-1,c=l>>1,u=23===t?C(2,-24)-C(2,-77):0,f=0,p=e<0||0===e&&1/e<0?1:0;for((e=E(e))!=e||e===L?(i=e!=e?1:0,n=l):(n=T(A(e)/R),e*(o=C(2,-n))<1&&(n--,o*=2),(e+=n+c>=1?u/o:u*C(2,1-c))*o>=2&&(n++,o/=2),n+c>=l?(i=0,n=l):n+c>=1?(i=(e*o-1)*C(2,t),n+=c):(i=e*C(2,c-1)*C(2,t),n=0));t>=8;a[f++]=255&i,i/=256,t-=8);for(n=n<<t|i,s+=t;s>0;a[f++]=255&n,n/=256,s-=8);return a[--f]|=128*p,a}function F(e,t,r){var n,i=8*r-t-1,o=(1<<i)-1,a=o>>1,s=i-7,l=r-1,c=e[l--],u=127&c;for(c>>=7;s>0;u=256*u+e[l],l--,s-=8);for(n=u&(1<<-s)-1,u>>=-s,s+=t;s>0;n=256*n+e[l],l--,s-=8);if(0===u)u=1-a;else{if(u===o)return n?NaN:c?-L:L;n+=C(2,t),u-=a}return(c?-1:1)*n*C(2,u-t)}function N(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function G(e){return[255&e]}function j(e){return[255&e,e>>8&255]}function D(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function B(e){return I(e,52,8)}function U(e){return I(e,23,4)}function z(e,t,r){y(e[v],t,{get:function(){return this[r]}})}function W(e,t,r,n){var i=h(+r);if(i+t>e[k])throw x(b);var o=e[M]._b,a=i+e[O],s=o.slice(a,a+t);return n?s:s.reverse()}function Y(e,t,r,n,i,o){var a=h(+r);if(a+t>e[k])throw x(b);for(var s=e[M]._b,l=a+e[O],c=n(+i),u=0;u<t;u++)s[l+u]=c[o?u:t-u-1]}if(a.ABV){if(!c((function(){_(1)}))||!c((function(){new _(-1)}))||c((function(){return new _,new _(1.5),new _(NaN),"ArrayBuffer"!=_.name}))){for(var V,q=(_=function(e){return u(this,_),new P(h(e))})[v]=P[v],J=d(P),H=0;J.length>H;)(V=J[H++])in _||s(_,V,P[V]);o||(q.constructor=_)}var X=new w(new _(2)),Q=w[v].setInt8;X.setInt8(0,2147483648),X.setInt8(1,2147483649),!X.getInt8(0)&&X.getInt8(1)||l(w[v],{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else _=function(e){u(this,_,"ArrayBuffer");var t=h(e);this._b=m.call(new Array(t),0),this[k]=t},w=function(e,t,r){u(this,w,"DataView"),u(e,_,"DataView");var n=e[k],i=f(t);if(i<0||i>n)throw x("Wrong offset!");if(i+(r=void 0===r?n-i:p(r))>n)throw x("Wrong length!");this[M]=e,this[O]=i,this[k]=r},i&&(z(_,"byteLength","_l"),z(w,"buffer","_b"),z(w,"byteLength","_l"),z(w,"byteOffset","_o")),l(w[v],{getInt8:function(e){return W(this,1,e)[0]<<24>>24},getUint8:function(e){return W(this,1,e)[0]},getInt16:function(e){var t=W(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=W(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return N(W(this,4,e,arguments[1]))},getUint32:function(e){return N(W(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return F(W(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return F(W(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){Y(this,1,e,G,t)},setUint8:function(e,t){Y(this,1,e,G,t)},setInt16:function(e,t){Y(this,2,e,j,t,arguments[2])},setUint16:function(e,t){Y(this,2,e,j,t,arguments[2])},setInt32:function(e,t){Y(this,4,e,D,t,arguments[2])},setUint32:function(e,t){Y(this,4,e,D,t,arguments[2])},setFloat32:function(e,t){Y(this,4,e,U,t,arguments[2])},setFloat64:function(e,t){Y(this,8,e,B,t,arguments[2])}});g(_,"ArrayBuffer"),g(w,"DataView"),s(w[v],a.VIEW,!0),t.ArrayBuffer=_,t.DataView=w},function(e,t,r){"use strict";var n,i;n=[r(1),r(15),r(2),r(14),r(36),r(44),r(85)],void 0===(i=function(e,t,r,n,i,o,a){var s=function(e){this.initialize(e),this.callInitHooks()},l=e.carto.Map;return s.prototype={options:{},constructor:s,initialize:function(e){t.setOptions(this,e);var r=this.options.mapOpts||this.options;isNaN(r.defaultExtent.zoom)||(r.defaultExtent.level=r.defaultExtent.zoom),r.fullExtent&&(isNaN(r.fullExtent.zoom)||(r.fullExtent.level=r.fullExtent.zoom)),l.call(this,r),r.targetId&&this.init({targetId:r.targetId}),this.id=r.targetId,this.layerSet={},this.listen("postrender",(function(){try{var e=document.getElementsByClassName("ol-attribution"),t=e.length>0?e[0]:null;null!=t&&t.parentElement.removeChild(t)}catch(e){}}))},init:function(e){e&&e.targetId&&(this.options.targetId=e.targetId),l.prototype.init.call(this,e)},destroy:function(){},callInitHooks:function(){if(!this._initHooksCalled){this._initHooksCalled=!0;for(var e=0,t=this._initHooks.length;e<t;e++)this._initHooks[e].call(this)}}},t.defaults(s,t,!0),t.inherits(s,l),s.include({getMap:function(){return this},initialGroupLayers:function(){n.initGroupLayers(this)},getAppEvent:function(){return this._appEvent||(this._appEvent=new i({map:this})),this._appEvent},updateViewSize:function(){this.map.updateSize()},changeExtent:function(t,r){var n=this.getMap(),i=new e.sfs.Point({x:t[0],y:t[1],spatialReference:n.spatialReference});n.setCenter(i),n.zoomTo(parseInt(r))},clear:function(t){t=t||{};var n=this.getMap().layers,i=t.filterFn||!1,s=t.matchRegex||!1,l=t.ignoreRegex||!1,c={filterFn:function(e,t){t(e)&&d.call(this,e)},matchRegex:function(e,t){h(e.id,t)&&d.call(this,e)},ignoreRegex:function(e,t){h(e.id,t)||d.call(this,e)},all:d};this.fire(o.CLEAR_MAP);for(var u=0,f=n.length;u<f;u++){var p=n[u];if(p){if(p._type==a.TYPES.BASE_LAYER_TAG)continue;r.isFunction(i)?c.filterFn.call(this,p,i):r.isArray(s)?c.matchRegex.call(this,p,s):r.isArray(l)?c.ignoreRegex.call(this,p,l):c.all.call(this,p)}}function h(e,t){var r=!1;if(t&&t.length>0)for(var n=0,i=t.length;n<i;n++){var o=t[n];if(o instanceof RegExp&&o.test(e)){r=!0;break}}return r}function d(t){if(t instanceof e.carto.GroupLayer)for(var r=t.groupLayers,n=0,i=r.length;n<i;n++){var o=r[n];d.call(this,o)}else t&&t.clear()}},addLayer:function(e){var t=this,n=e;n instanceof a.BaseLayer?(n=e.getLayer(),l.prototype.addLayer.call(this,n),n._maxZoom&&n.setMaxZoom(n._maxZoom),this.layerSet[e.id]=e):r.isArray(n)?n.forEach((function(e){l.prototype.addLayer.call(t,e),e._maxZoom&&e.setMaxZoom(e._maxZoom),e._minZoom&&e.setMinZoom(e._minZoom),t.layerSet[e.id]=e})):(l.prototype.addLayer.call(this,e),e.groupLayers?e.groupLayers.forEach((function(e){e._maxZoom&&e.setMaxZoom(e._maxZoom),e._minZoom&&e.setMinZoom(e._minZoom)})):(e._maxZoom&&e.setMaxZoom(e._maxZoom),e._minZoom&&e.setMinZoom(e._minZoom)),this.layerSet[e.id]=e),this.fire(o.LAYER_CHANGED,{type:"add",layers:[e]})},removeLayer:function(e){var t=e;t instanceof a.BaseLayer&&(t=e.getLayer()),l.prototype.removeLayer.call(this,t),this.layerSet[e.id]=null,delete this.layerSet[e.id],this.fire(o.LAYER_CHANGED,{type:"remove",layers:[e]})},getLayerById:function(e){return this.layerSet.hasOwnProperty(e)?this.layerSet[e]:n.getLayerById(this,e)}}),s.include({addScaleLineCtrl:function(e){opts=opts||{};e=opts.className||"ol-scale-line";this.getMap().addScaleLineControl(e),this._scaleLineCtrlClass=e},removeScaleLineCtrl:function(){jQuery("#"+this.id).fin(".ol-overlaycontainer-stopevent ."+this._scaleLineCtrlClass).remove()}}),s.include({listen:function(e,t,r){this.getAppEvent().isMapEvent(e)?this.getAppEvent()._on(e,t,r):i.prototype.on.call(this,e,t,r)},off:function(e,t,r){this.getAppEvent().isMapEvent(e)?this.getAppEvent()._off(e,t,r):i.prototype.off.call(this,e,t,r)},fire:function(){i.prototype.fire.apply(this,arguments)},once:function(){i.prototype.once.apply(this,arguments)}}),s.include({_getMapCenter:function(){var e=this.getCenter();return r.isArray(e)?e:[e.x,e.y]}}),s}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(15),r(2),r(16),r(36),r(1)],void 0===(i=function(e,t,r,n,i){var o=e.extend({options:{id:null,name:null,spatialReference:null,dataSpatialReference:null,symbolUpdateCallback:function(e){},callbackContext:window},includes:n.prototype,initialize:function(t){e.setOptions(this,t),this.map=this.options.map,this.options.layerId=this.options.layerId||this.options.id,this.options.layerName=this.options.layerName||this.options.name,this.id=this.options.layerId,this.name=this.options.layerName,this.options.spatialReference=this.map.spatialReference,this.options.dataSpatialReference=this.options.dataSpatialReference||this.options.spatialReference,this.projService=new i.sfs.CoordinateTransform({}),this._invokeSymbolUpdateCallback=!0,this._currentExtent=[NaN,NaN,NaN,NaN],this._addListeners()},_addListeners:function(){},_removeListeners:function(){},_onSymbolsUpdated:function(){},destroy:function(){try{this._removeListeners()}catch(e){}}});return o.include({getElements:function(){},getElementById:function(e){},clear:function(){},getLayer:function(){},getLayerId:function(){},setVisible:function(e){},getVisible:function(){},setZIndex:function(e){return this.getLayer().setZIndex(e)},getZIndex:function(){return this.getLayer().getZIndex()},getLayerName:function(){},hitTest:function(e,t){},getLayerExtent:function(){return this._currentExtent},toggleInvokeSymbolUpdateCallback:function(e){"boolean"==typeof e||(e=!this._invokeSymbolUpdateCallback),this._invokeSymbolUpdateCallback=e}}),o.include({_getColor:function(e){return r._getColor(e)},_envelopeFromGeom:function(e){try{var t,r,n,i,o=e.shell.points;t=r=1e7,n=i=-1e7;for(var a=0,s=o.length;a<s;a++){var l=o[a];t=Math.min(t,l.x),r=Math.min(r,l.y),n=Math.max(n,l.x),i=Math.max(i,l.y)}return[t,r,n,i]}catch(e){return[NaN,NaN,NaN,NaN]}},invokeCallback:function(e,r){var n=this.options.callbackContext||window;"string"==typeof e&&(e=this.options[e]),t.isFunction(e)&&e.call(n,r)}}),o}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(67),r(2),r(11),r(118),r(22),r(1)],void 0===(i=function(e,t,r,n,i,o){var a=e.extend({options:{symbolConfig:!1,xField:"LONGITUDE",yField:"LATITUDE"},initialize:function(t){e.prototype.initialize.call(this,t),this.noneSpatialArr=[],this.elements=[],this.currentZoom=this.map.getZoomLevel()},_addListeners:function(){e.prototype._addListeners.call(this),this.map.listen("extentchanged",this._extentChangeListener,this)},_removeListeners:function(){this.map.off("extentchanged",this._extentChangeListener,this),e.prototype._removeListeners.call(this)},_extentChangeListener:function(){var e=this.map.getZoomLevel();this.updateSymbol(e),this.currentZoom=e},_mapClickListener:function(e){var t=this.hitTest(e.screenX,e.screenY);t&&this.fire("click",{element:t.element,layer:t.layer})},addElements:function(e,r){if(t.isArray(e)){r=r||{};for(var n=this.map.getZoomLevel(),a=this.options.spatialReference,s=r.dataSpatialReference||this.options.dataSpatialReference,l=0,c=e.length;l<c;l++){var u=e[l],f=this._getGeometry(u,s,a);if(this.validateGeometry(f)){var p=this._getSymbol(u,n),h=this._getRecordId(u),d=new o.sfs.Element({id:h,geometry:f,symbol:p.symbol});d._data=u,d._zoomRange=p.zoomRange,d._symbolKey=p.symbolKey,this.elements.push(d),this.layer.add(d)}else this.noneSpatialArr.push(u)}this._onSymbolsUpdated(),this._onElementChanged()}else i.error("dataArr is not an array")},removeElements:function(e){if(t.isArray(e)){for(var r=e.length-1;r>=0;r--){var n=e[r];this.layer.remove(n)}this._onSymbolsUpdated(),this._onElementChanged()}},hitTest:function(e,t){var r=[],n=this.layer.hitTest(e,t);return n&&r.push(n),r[0]||null},setVisible:function(e){this.layer.setVisible(e||!1),e?this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:this.currentSymbols}):this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:[]})},clear:function(){this.elements=[],e.prototype.clear.call(this)},destroy:function(){e.prototype.destroy.call(this)}});return Object.defineProperty(a,"type",{value:11,configurable:!1,writable:!1}),a}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(2)],void 0===(i=function(e){var t=function(e){this._cellSize=e,this._sqCellSize=e*e,this._grid={},this._objectPoint={}};return t.prototype={addObject:function(t,r){var n=this._getCoord(r.x),i=this._getCoord(r.y),o=this._grid,a=o[i]=o[i]||{},s=a[n]=a[n]||[],l=e.stamp(t);this._objectPoint[l]=r,s.push(t)},updateObject:function(e,t){this.removeObject(e),this.addObject(e,t)},removeObject:function(t,r){var n,i,o=this._getCoord(r.x),a=this._getCoord(r.y),s=this._grid,l=s[a]=s[a]||{},c=l[o]=l[o]||[];for(delete this._objectPoint[e.stamp(t)],n=0,i=c.length;n<i;n++)if(c[n]===t)return c.splice(n,1),1===i&&delete l[o],!0},eachObject:function(e,t){var r,n,i,o,a,s,l=this._grid;for(r in l)for(n in a=l[r])for(i=0,o=(s=a[n]).length;i<o;i++)e.call(t,s[i])&&(i--,o--)},eachCell:function(e,t){var r,n,i,o,a=this._grid;for(r in a)for(n in i=a[r])o=i[n],e.call(t,o,r,n)},getNearObject:function(t){var r,n,i,o,a,s,l,c,u=this._getCoord(t.x),f=this._getCoord(t.y),p=this._objectPoint,h=this._sqCellSize,d=null;for(r=f-1;r<=f+1;r++)if(o=this._grid[r])for(n=u-1;n<=u+1;n++)if(a=o[n])for(i=0,s=a.length;i<s;i++)l=a[i],(c=this._sqDist(p[e.stamp(l)],t))<h&&(h=c,d=l);return d},getObjects:function(e,t){var r=this._grid[e];return r?r[t]:null},_getCoord:function(e){return Math.floor(e/this._cellSize)},_sqDist:function(e,t){var r=t.x-e.x,n=t.y-e.y;return r*r+n*n},clear:function(){for(var e in this._grid){var t=this._grid[e];for(var r in t)t[r]=null,delete t[r];this._grid[e]=null,delete this._grid[e]}for(var e in this._objectPoint)delete this._objectPoint[e]},destroy:function(){for(var e in this.clear(),this._grid=null,delete this._grid,this._objectPoint)this._objectPoint[e]=null,delete this._objectPoint[e]}},t}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(116),r(2),r(1)],void 0===(i=function(e,t,r){return e.extend({options:{geometryField:"",xField:"LONGITUDE",yField:"LATITUDE",showZero:!1,symbolConfigUrl:""},initialize:function(r){e.prototype.initialize.call(this,r),t.isObject(this.options.symbolConfig)&&(this.symbolConfig=jQuery(!0,{},this.options.symbolConfig),delete this.options.symbolConfig),this.currentSymbols=[],this.statisticsData=null,this._visible=!0},_addListeners:function(){},_removeListeners:function(){},updateStatistics:function(e){},setVisible:function(e){},getVisible:function(){return this._visible},clear:function(){this.statisticsData=null},_updateLayer:function(e){},getLayer:function(){},_mergeStatisticsData:function(e,t){for(var r in t){var n=t[r],i=e[r];i?jQuery.extend(!0,i,n):e[r]=n}},_onSymbolsUpdated:function(){},_onElementChanged:function(){var e=this.getElements(),t=[];if(e&&e.length>0){for(var r=0,n=e.length;r<n;r++){var i=e[r];i&&i.geometry&&t.push(i.geometry)}var o=G.utils.GeometryUtil.getGeometryEnvlop(t);this._currentExtent=this._envelopeFromGeom(o)}else this._currentExtent=[NaN,NaN,NaN,NaN]},destroy:function(){if(this.clear(),this._removeListeners(),this.statisticsDataType){for(var t in this.statisticsDataType)delete this.statisticsDataType[t];this.statisticsDataType=null}if(this.statisticsData){for(var t in this.statisticsData)delete this.statisticsData[t];this.statisticsData=null}for(var t in this.options)delete this.options[t];for(var t in this)delete this[t];e.prototype.destroy.call(this)}})}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(1)],void 0===(i=function(e){var t={TEXT:"text",TAILEDTEXT:"tailedtext",POINT:"point",POLYLINE:"line",POLYGON:"polygon",COMPOSITE:"composite"};(e=e||{}).algm=e.algm||{};var r={Text:{title:"文本",algorithm:"PointAlgorithm",type:t.TEXT},TAILEDTEXT:{title:"文本",algorithm:"PointAlgorithm",type:t.TAILEDTEXT},Point:{title:"点",algorithm:"PointAlgorithm",type:t.POINT},Polyline:{title:"折线",algorithm:"PolylineAlgorithm",type:t.POLYLINE},Curve:{title:"曲线",algorithm:"CurveAlgorithm",type:t.POLYLINE},Camber:{title:"弧线",algorithm:"CamberAlgorithm",type:t.POLYLINE},FreePolyline:{title:"自由标绘线",algorithm:"PolylineAlgorithm",type:t.POLYLINE},Polygon:{title:"多边形",algorithm:"PolygonAlgorithm",type:t.POLYGON},Circle:{title:"圆",algorithm:"CircleAlgorithm",type:t.POLYGON},Rectangle:{title:"矩形",algorithm:"RectangleAlgorithm",type:t.POLYGON},Ellipse:{title:"椭圆",algorithm:"EllipseAlgorithm",type:t.POLYGON},Sector:{title:"扇形",algorithm:"SectorAlgorithm",type:t.POLYGON},Arc:{title:"圆弧",algorithm:"ArcAlgorithm",type:t.POLYGON},CloseCurve:{title:"封闭曲线",algorithm:"CloseCurveAlgorithm",type:t.POLYGON},FreePolygon:{title:"自由标绘面",algorithm:"PolygonAlgorithm",type:t.POLYGON},DoubleArrow:{title:"双箭头",algorithm:"DoubleArrowAlgorithm",type:t.POLYGON},SwallowTailArrow:{title:"燕尾箭头",algorithm:"SwallowtailArrowAlgorithm",type:t.POLYGON},MultiArrow:{title:"多箭头",algorithm:"MultiArrowAlgorithm",type:t.POLYGON},BeelineArrow:{title:"细直箭头",algorithm:"BeelineArrowAlgorithm",type:t.COMPOSITE},CurveArrow:{title:"单曲箭头",algorithm:"CurveArrowAlgorithm",type:t.COMPOSITE},SimpleArrow:{title:"单箭头",algorithm:"SimpleArrowAlgorithm",type:t.POLYGON},SlightnessArrow:{title:"直箭头",algorithm:"SlightnessArrowAlgorithm",type:t.POLYGON},ShockWay:{title:"突击方向",algorithm:"ShockWayAlgorithm",type:t.POLYGON},Arsenal:{title:"武警",algorithm:"ArsenalProperty",type:t.COMPOSITE},ExpertProtect:{title:"专家",algorithm:"ExpertProtectAlgorithm",type:t.COMPOSITE},Engineer:{title:"工程",algorithm:"PowerRepairAlgorithm",type:t.COMPOSITE},Army:{title:"军队",algorithm:"ArmyAlgorithm",type:t.COMPOSITE},FireProtect:{title:"消防",algorithm:"FireProtectAlgorithm",type:t.COMPOSITE},MedicalCure:{title:"医疗",algorithm:"MedicalCureAlgorithm",type:t.COMPOSITE},PowerRepair:{title:"电力抢修",algorithm:"PowerRepairAlgorithm",type:t.COMPOSITE},ProChymic:{title:"防化",algorithm:"ProchymicAlgorithm",type:t.COMPOSITE},ProSuccor:{title:"专业救援",algorithm:"ProsuccorAlgorithm",type:t.COMPOSITE},AirWay:{title:"空中运输",algorithm:"AirwayAlgorithm",type:t.COMPOSITE},Cannon:{title:"炮弹路线",algorithm:"CannonAlgorithm",type:t.POLYLINE},AirMobile:{title:"空中机动",algorithm:"AirMobileAlgorithm",type:t.COMPOSITE},ArtilleryManenCampment:{title:"高射炮兵营地",algorithm:"ArtilleryManenCampmentAlgorithm",type:t.COMPOSITE},MotorbikeTeam:{title:"摩托化行军纵队",algorithm:"MotorbikeTeamAlgorithm",type:t.COMPOSITE},AntiairCraftForces:{title:"防空兵行军纵队",algorithm:"AntiAirCraftForceAlgorithm",type:t.COMPOSITE},TankAndMusketer:{title:"坦克及步战车进攻队形",algorithm:"TankAndMusketerAlgorithm",type:t.COMPOSITE},AttackOrder:{title:"进攻队形",algorithm:"AttackOrderAlgorithm",type:t.COMPOSITE},AttackTurnDefend2:{title:"由进攻转入防守2",algorithm:"AttackTurnDefend2Algorithm",type:t.POLYLINE},AttackTurnDefend1:{title:"由进攻转入防守1",algorithm:"AttackTurnDefend1Algorithm",type:t.POLYLINE},Artillery:{title:"炮兵行军纵队",algorithm:"ArtilleryAlgorithm",type:t.COMPOSITE},RecceSearch:{title:"侦查搜索",algorithm:"RecceSearchAlgorithm",type:t.POLYLINE},Patroller:{title:"流动哨",algorithm:"PatrolLeralAlgorithm",type:t.POLYLINE},TankAttack:{title:"坦克营进攻队形",algorithm:"TankAttackAlgorithm",type:t.COMPOSITE},Musketry:{title:"步兵战斗车连",algorithm:"MusketryAlgorithm",type:t.POLYLINE},NavalShips:{title:"水上救援舰艇",algorithm:"NavalShipsAlgorithm",type:t.COMPOSITE},PedrailColumn:{title:"救援车辆纵队",algorithm:"PedrailColumnAlgorithm",type:t.COMPOSITE},PipeLaying:{title:"输油管线",algorithm:"PipeLayingAlgorithm",type:t.POLYLINE},PolygonText:{title:"警戒区域",algorithm:"PolygonTextAlgorithm",type:t.COMPOSITE},Railage:{title:"铁路输送",algorithm:"RailAgeAlgorithm",type:t.COMPOSITE},RoundsLine:{title:"海上搜救队形",algorithm:"RoundsLineAlgorithm",type:t.POLYLINE},CommunicateLine:{title:"通信光缆线路",algorithm:"CommunicateLineAlgorithm",type:t.COMPOSITE},PatrolLine:{title:"隔离线1",algorithm:"PatrolLineAlgorithm",type:t.POLYLINE},WarBoundary:{title:"隔离线2",algorithm:"WarBoundaryAlgorithm",type:t.POLYLINE},FinderLine:{title:"海上封锁线",algorithm:"FinderLineAlgorithm",type:t.POLYLINE},FixedPipeLaying:{title:"固定输油管线",algorithm:"FixedPipeLayingAlgorithm",type:t.COMPOSITE},LandMobile:{title:"陆地机动技术",algorithm:"LandMobileAlgorithm",type:t.COMPOSITE},ForbidFlyLine:{title:"警戒线",algorithm:"ForbidFlyLineAlgorithm",type:t.COMPOSITE},LineAbatis3:{title:"大型输电线路",algorithm:"LineAbatis3Algorithm",type:t.POLYLINE},LineAbatis2:{title:"中型输电线路",algorithm:"LineAbatis2Algorithm",type:t.POLYLINE},LineAbatis1:{title:"小型输电线路",algorithm:"LineAbatis1Algorithm",type:t.POLYLINE},LaighStake:{title:"生态隔离线",algorithm:"LaighstakeAlgorithm",type:t.POLYLINE},HelicopterTransport:{title:"直升机输送",algorithm:"HelicopterTransportAlgorithm",type:t.COMPOSITE},MissileMarch:{title:"事故车辆行进路线",algorithm:"MissileMarchAlgorithm",type:t.COMPOSITE},HighWay:{title:"公路运输",algorithm:"HighwayAlgorithm",type:t.COMPOSITE},MusketerByTank:{title:"灾民撤离",algorithm:"MusketerByTankAlgorithm",type:t.COMPOSITE},TankMusColumn:{title:"专业救援队形2",algorithm:"TankMusColumnAlgorithm",type:t.COMPOSITE},Trench:{title:"危险路段",algorithm:"TrenchAlgorithm",type:t.POLYLINE},Waterage:{title:"水路运输",algorithm:"WaterAgeAlgorithm",type:t.COMPOSITE},RendezvousArea1:{title:"集结区域",algorithm:"RendezvousArea1Algorithm",type:t.POLYLINE},RendezvousArea2:{title:"事故区域蔓延",algorithm:"RendezvousArea2Algorithm",type:t.POLYLINE},RendezvousArea3:{title:"事故区域控制",algorithm:"RendezvousArea3Algorithm",type:t.POLYLINE},RendezvousArea4:{title:"物质集散地",algorithm:"RendezvousArea4Algorithm",type:t.POLYLINE},OriginalBirth:{title:"空中救援队伍",algorithm:"OriginalBirthAlgorithm",type:t.POLYLINE},SeaMobile:{title:"海上机动技术",algorithm:"SeaMobileAlgorithm",type:t.COMPOSITE},Stake:{title:"在建铁路",algorithm:"StakeAlgorithm",type:t.POLYLINE},UnderProp2:{title:"支撑点2",algorithm:"UnderProp2Algorithm",type:t.POLYLINE},UnderProp3:{title:"支撑点3",algorithm:"UnderProp3Algorithm",type:t.POLYLINE},ImportantPlace:{title:"要点",algorithm:"ImportantPlaceAlgorithm",type:t.COMPOSITE},CurrentTaskLine:{title:"遭破坏的线路",algorithm:"CurrentTaskLineAlgorithm",type:t.POLYLINE},LatterTaskLine:{title:"遭破坏的道路",algorithm:"LatterTaskLineAlgorithm",type:t.POLYLINE}},n={};for(var i in r)n[i]=i;return{PATTERNS:t,TYPES:r,TYPES_KEYS:n,COMMANDNAMES:{NoopTool:"NoopTool",PlotEdit:"PlotEdit"}}}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n;void 0===(n=function(){var e={x_PI:52.35987755982988,PI:3.141592653589793,a:6378245,ee:.006693421622965943,bd09togcj02:function(t){var r=+t.split(",")[0]-.0065,n=+t.split(",")[1]-.006,i=Math.sqrt(r*r+n*n)-2e-5*Math.sin(n*e.x_PI),o=Math.atan2(n,r)-3e-6*Math.cos(r*e.x_PI);return i*Math.cos(o)+","+i*Math.sin(o)},gcj02tobd09:function(t){var r=+t.split(",")[0],n=+t.split(",")[1],i=Math.sqrt(n*n+r*r)+2e-5*Math.sin(r*e.x_PI),o=Math.atan2(r,n)+3e-6*Math.cos(n*e.x_PI);return i*Math.cos(o)+.0065+","+(i*Math.sin(o)+.006)},wgs84togcj02:function(t){var r=+t.split(",")[0],n=+t.split(",")[1];if(e.out_of_china(n,r))return n+","+r;var i=e.transformlat(n-105,r-35),o=e.transformlng(n-105,r-35),a=r/180*e.PI,s=Math.sin(a);s=1-e.ee*s*s;var l=Math.sqrt(s);return i=180*i/(e.a*(1-e.ee)/(s*l)*e.PI),n+(o=180*o/(e.a/l*Math.cos(a)*e.PI))+","+(r+i)},gcj02towgs84:function(t){var r=+t.split(",")[0],n=+t.split(",")[1];if(e.out_of_china(r,n))return r+","+n;var i=e.transformlat(r-105,n-35),o=e.transformlng(r-105,n-35),a=n/180*e.PI,s=Math.sin(a);s=1-e.ee*s*s;var l=Math.sqrt(s);return i=180*i/(e.a*(1-e.ee)/(s*l)*e.PI),2*r-(r+(o=180*o/(e.a/l*Math.cos(a)*e.PI)))+","+(2*n-(n+i))},transformlat:function(t,r){var n=2*(t=+t)-100+3*(r=+r)+.2*r*r+.1*t*r+.2*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*e.PI)+20*Math.sin(2*t*e.PI))/3,n+=2*(20*Math.sin(r*e.PI)+40*Math.sin(r/3*e.PI))/3,n+=2*(160*Math.sin(r/12*e.PI)+320*Math.sin(r*e.PI/30))/3},transformlng:function(t,r){var n=300+(t=+t)+2*(r=+r)+.1*t*t+.1*t*r+.1*Math.sqrt(Math.abs(t));return n+=2*(20*Math.sin(6*t*e.PI)+20*Math.sin(2*t*e.PI))/3,n+=2*(20*Math.sin(t*e.PI)+40*Math.sin(t/3*e.PI))/3,n+=2*(150*Math.sin(t/12*e.PI)+300*Math.sin(t/30*e.PI))/3},out_of_china:function(e,t){t=+t;return!((e=+e)>73.66&&e<135.05&&t>3.86&&t<53.55)}};return e}.apply(t,[]))||(e.exports=n)},function(e,t,r){var n=r(15),i=r(2),o=r(167),a=r(1),s=n.extend({options:{},initialize:function(e){n.setOptions(this,e)},destroy:function(){},buildElement:function(e){var t=this.buildGeometry(e),r=this.buildSymbol(e),n=this.buildAttributeSet(e),o=null;return t&&((o=new a.sfs.Element({id:e[this.options.idField]||i.newUUID32(),geometry:t,symbol:r})).attributeSet=n),o},buildElementFromGeoJSON:function(e){var t=void 0;try{t=this.buildElement(e)}catch(e){console.warn(e)}return t},buildElementFromEsriJSON:function(e){e=(new o).fromArcgis(e);var t=void 0;try{t=this.buildElement(e)}catch(e){console.warn(e)}return t},buildElementFromKml:function(e){e=(new o).fromKml(e);var t=void 0;try{t=this.buildElement(e)}catch(e){console.warn(e)}return t},buildFeature:function(e,t){var r=new a.sfs.Fields,n=[],o=void 0;try{o=this.buildGeometry(e)}catch(e){console.warn(e)}var s=new a.sfs.Feature({objectId:e[this.options.idField]||i.newUUID32(),fields:r,values:n,geometry:o});if(t){var l=this.buildAttributeSet(e);s.attributeSet=l}else for(var c in e){var u=new a.sfs.Field({name:c}),f=new a.sfs.Value;f.setValue(e[c]),r.add(u),n.push(f)}return s},buildFeatureFromGeoJSON:function(e,t){return this.buildFeature(e,t)},buildFeatureFromEsriJSON:function(e,t){return e=(new o).fromArcgis(e),this.buildFeature(e,t)},buildFeatureFromKml:function(e,t){return e=(new o).fromKml(e),this.buildFeature(e,t)},buildGeometry:function(e){return this.options.geometryBuilder.build(e)},buildSymbol:function(e){return this.options.symbolBuilder.build(e)},buildAttributeSet:function(e){var t=new a.sfs.AttributeSet;for(var r in e){var n=new a.sfs.Attribute({name:r,value:e[r]});t.add(n)}return t}});e.exports=s},function(e,t,r){var n=r(9),i=r(36),o=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.featureTypeList=[],this.listenEvents={},this._last_mouse_over=null;var t=this;this.eventDispatcher={listens:function(e){return t.listens(e)},listener:function(e,r){var n=t._getFeatureType(e);return n&&n.listeners[r]?n.listeners[r]:null},fire:function(e,r){t.fire(e,r)}}},destroy:function(){n.prototype.destroy.call(this)},load:function(){n.prototype.load.call(this),this.map.initialGroupLayers()},unload:function(){this.removeAll(),n.prototype.unload.call(this)},add:function(e){},update:function(e){},clear:function(e){var t=this._getFeatureType(e);t&&t.renderer.clear()},clearAll:function(){for(var e=this.featureTypeList.length-1;e>=0;e--){this.featureTypeList[e].renderer.clear()}},remove:function(e){for(var t=0;t<this.featureTypeList.length;t++){var r=this.featureTypeList[t];if(r.featureType==e){r.renderer.destroy(),r.renderer=null,this.featureTypeList.splice(t,1);break}}},removeAll:function(){for(var e=this.featureTypeList.length-1;e>=0;e--){var t=this.featureTypeList[e];t.renderer.destroy(),t.renderer=null,this.featureTypeList.splice(e,1)}this.featureTypeList=[]},getLayer:function(e){},setVisible:function(e,t){var r=this._getFeatureType(e);return!!r&&(r.renderer.setVisible(!!t),!0)},getVisible:function(e){var t=this._getFeatureType(e);if(t)return t.renderer.getVisible()},on:function(e,t,r){this.listenEvents[e]=!0,i.prototype.on.call(this,e,t,r)},off:function(e,t,r){this.listenEvents[e]=!1,i.prototype.off.call(this,e,t,r)},listens:function(e){if(this.listenEvents[e])return!0;for(var t=this.featureTypeList.length-1;t>=0;t--){var r=this.featureTypeList[t];if(r.listeners&&r.listeners.hasOwnProperty(e))return!0}return!1},_getFeatureType:function(e){for(var t=0;t<this.featureTypeList.length;t++){var r=this.featureTypeList[t];if(r.featureType==e)return r}return null}});e.exports=o},function(e,t){var r,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t,r){e.exports=!r(10)&&!r(5)((function(){return 7!=Object.defineProperty(r(88)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,r){t.f=r(7)},function(e,t,r){var n=r(23),i=r(24),o=r(71)(!1),a=r(90)("IE_PROTO");e.exports=function(e,t){var r,s=i(e),l=0,c=[];for(r in s)r!=a&&n(s,r)&&c.push(r);for(;t.length>l;)n(s,r=t[l++])&&(~o(c,r)||c.push(r));return c}},function(e,t,r){var n=r(12),i=r(3),o=r(48);e.exports=r(10)?Object.defineProperties:function(e,t){i(e);for(var r,a=o(t),s=a.length,l=0;s>l;)n.f(e,r=a[l++],t[r]);return e}},function(e,t,r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(24),o=r(51).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":n(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?function(e){try{return o(e)}catch(e){return s.slice()}}(e):o(i(e))}},function(e,t,r){"use strict";var n=r(10),i=r(48),o=r(72),a=r(64),s=r(13),l=r(63),c=Object.assign;e.exports=!c||r(5)((function(){var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach((function(e){t[e]=e})),7!=c({},e)[r]||Object.keys(c({},t)).join("")!=n}))?function(e,t){for(var r=s(e),c=arguments.length,u=1,f=o.f,p=a.f;c>u;)for(var h,d=l(arguments[u++]),y=f?i(d).concat(f(d)):i(d),m=y.length,g=0;m>g;)h=y[g++],n&&!p.call(d,h)||(r[h]=d[h]);return r}:c},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,r){"use strict";var n=r(17),i=r(6),o=r(133),a=[].slice,s={},l=function(e,t,r){if(!(t in s)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";s[t]=Function("F,a","return new F("+n.join(",")+")")}return s[t](e,r)};e.exports=Function.bind||function(e){var t=n(this),r=a.call(arguments,1),s=function n(){var i=r.concat(a.call(arguments));return this instanceof n?l(t,i.length,i):o(t,i,e)};return i(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t){e.exports=function(e,t,r){var n=void 0===r;switch(t.length){case 0:return n?e():e.call(r);case 1:return n?e(t[0]):e.call(r,t[0]);case 2:return n?e(t[0],t[1]):e.call(r,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(r,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(r,t[0],t[1],t[2],t[3])}return e.apply(r,t)}},function(e,t,r){var n=r(4).parseInt,i=r(60).trim,o=r(94),a=/^[-+]?0[xX]/;e.exports=8!==n(o+"08")||22!==n(o+"0x16")?function(e,t){var r=i(String(e),3);return n(r,t>>>0||(a.test(r)?16:10))}:n},function(e,t,r){var n=r(4).parseFloat,i=r(60).trim;e.exports=1/n(r(94)+"-0")!=-1/0?function(e){var t=i(String(e),3),r=n(t);return 0===r&&"-"==t.charAt(0)?-0:r}:n},function(e,t,r){var n=r(29);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=n(e))throw TypeError(t);return+e}},function(e,t,r){var n=r(6),i=Math.floor;e.exports=function(e){return!n(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,r){var n=r(97),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),l=i(2,-126);e.exports=Math.fround||function(e){var t,r,i=Math.abs(e),c=n(e);return i<l?c*(i/l/a+1/o-1/o)*l*a:(r=(t=(1+a/o)*i)-(t-i))>s||r!=r?c*(1/0):c*r}},function(e,t,r){var n=r(3);e.exports=function(e,t,r,i){try{return i?t(n(r)[0],r[1]):t(r)}catch(t){var o=e.return;throw void 0!==o&&n(o.call(e)),t}}},function(e,t,r){var n=r(17),i=r(13),o=r(63),a=r(8);e.exports=function(e,t,r,s,l){n(t);var c=i(e),u=o(c),f=a(c.length),p=l?f-1:0,h=l?-1:1;if(r<2)for(;;){if(p in u){s=u[p],p+=h;break}if(p+=h,l?p<0:f<=p)throw TypeError("Reduce of empty array with no initial value")}for(;l?p>=0:f>p;p+=h)p in u&&(s=t(s,u[p],p,c));return s}},function(e,t,r){"use strict";var n=r(13),i=r(49),o=r(8);e.exports=[].copyWithin||function(e,t){var r=n(this),a=o(r.length),s=i(e,a),l=i(t,a),c=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===c?a:i(c,a))-l,a-s),f=1;for(l<s&&s<l+u&&(f=-1,l+=u-1,s+=u-1);u-- >0;)l in r?r[s]=r[l]:delete r[s],s+=f,l+=f;return r}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,r){"use strict";var n=r(109);r(0)({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},function(e,t,r){r(10)&&"g"!=/./g.flags&&r(12).f(RegExp.prototype,"flags",{configurable:!0,get:r(65)})},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,r){var n=r(3),i=r(6),o=r(113);e.exports=function(e,t){if(n(e),i(t)&&t.constructor===e)return t;var r=o.f(e);return(0,r.resolve)(t),r.promise}},function(e,t,r){"use strict";var n=r(149),i=r(56);e.exports=r(80)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=n.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(i(this,"Map"),0===e?0:e,t)}},n,!0)},function(e,t,r){"use strict";var n=r(12).f,i=r(50),o=r(55),a=r(28),s=r(53),l=r(54),c=r(99),u=r(143),f=r(52),p=r(10),h=r(42).fastKey,d=r(56),y=p?"_s":"size",m=function(e,t){var r,n=h(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,c){var u=e((function(e,n){s(e,u,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[y]=0,null!=n&&l(n,r,e[c],e)}));return o(u.prototype,{clear:function(){for(var e=d(this,t),r=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete r[n.i];e._f=e._l=void 0,e[y]=0},delete:function(e){var r=d(this,t),n=m(r,e);if(n){var i=n.n,o=n.p;delete r._i[n.i],n.r=!0,o&&(o.n=i),i&&(i.p=o),r._f==n&&(r._f=i),r._l==n&&(r._l=o),r[y]--}return!!n},forEach:function(e){d(this,t);for(var r,n=a(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!m(d(this,t),e)}}),p&&n(u.prototype,"size",{get:function(){return d(this,t)[y]}}),u},def:function(e,t,r){var n,i,o=m(e,t);return o?o.v=r:(e._l=o={i:i=h(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=o),n&&(n.n=o),e[y]++,"F"!==i&&(e._i[i]=o)),e},getEntry:m,setStrong:function(e,t,r){c(e,t,(function(e,r){this._t=d(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),r?"entries":"values",!r,!0),f(t)}}},function(e,t,r){"use strict";var n=r(149),i=r(56);e.exports=r(80)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,"Set"),e=0===e?0:e,e)}},n)},function(e,t,r){"use strict";var n,i=r(4),o=r(35)(0),a=r(20),s=r(42),l=r(130),c=r(152),u=r(6),f=r(56),p=r(56),h=!i.ActiveXObject&&"ActiveXObject"in i,d=s.getWeak,y=Object.isExtensible,m=c.ufstore,g=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},v={get:function(e){if(u(e)){var t=d(e);return!0===t?m(f(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return c.def(f(this,"WeakMap"),e,t)}},b=e.exports=r(80)("WeakMap",g,v,c,!0,!0);p&&h&&(l((n=c.getConstructor(g,"WeakMap")).prototype,v),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=b.prototype,r=t[e];a(t,e,(function(t,i){if(u(t)&&!y(t)){this._f||(this._f=new n);var o=this._f[e](t,i);return"set"==e?this:o}return r.call(this,t,i)}))})))},function(e,t,r){"use strict";var n=r(55),i=r(42).getWeak,o=r(3),a=r(6),s=r(53),l=r(54),c=r(35),u=r(23),f=r(56),p=c(5),h=c(6),d=0,y=function(e){return e._l||(e._l=new m)},m=function(){this.a=[]},g=function(e,t){return p(e.a,(function(e){return e[0]===t}))};m.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var r=g(this,e);r?r[1]=t:this.a.push([e,t])},delete:function(e){var t=h(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,r,o){var c=e((function(e,n){s(e,c,t,"_i"),e._t=t,e._i=d++,e._l=void 0,null!=n&&l(n,r,e[o],e)}));return n(c.prototype,{delete:function(e){if(!a(e))return!1;var r=i(e);return!0===r?y(f(this,t)).delete(e):r&&u(r,this._i)&&delete r[this._i]},has:function(e){if(!a(e))return!1;var r=i(e);return!0===r?y(f(this,t)).has(e):r&&u(r,this._i)}}),c},def:function(e,t,r){var n=i(o(t),!0);return!0===n?y(e).set(t,r):n[e._i]=r,e},ufstore:y}},function(e,t,r){var n=r(30),i=r(8);e.exports=function(e){if(void 0===e)return 0;var t=n(e),r=i(t);if(t!==r)throw RangeError("Wrong length!");return r}},function(e,t,r){var n=r(51),i=r(72),o=r(3),a=r(4).Reflect;e.exports=a&&a.ownKeys||function(e){var t=n.f(o(e)),r=i.f;return r?t.concat(r(e)):t}},function(e,t,r){"use strict";var n=r(73),i=r(6),o=r(8),a=r(28),s=r(7)("isConcatSpreadable");e.exports=function e(t,r,l,c,u,f,p,h){for(var d,y,m=u,g=0,v=!!p&&a(p,h,3);g<c;){if(g in l){if(d=v?v(l[g],g,r):l[g],y=!1,i(d)&&(y=void 0!==(y=d[s])?!!y:n(d)),y&&f>0)m=e(t,r,d,o(d.length),m,f-1)-1;else{if(m>=9007199254740991)throw TypeError();t[m]=d}m++}g++}return m}},function(e,t,r){var n=r(8),i=r(96),o=r(33);e.exports=function(e,t,r,a){var s=String(o(e)),l=s.length,c=void 0===r?" ":String(r),u=n(t);if(u<=l||""==c)return s;var f=u-l,p=i.call(c,Math.ceil(f/c.length));return p.length>f&&(p=p.slice(0,f)),a?p+s:s+p}},function(e,t,r){var n=r(10),i=r(48),o=r(24),a=r(64).f;e.exports=function(e){return function(t){for(var r,s=o(t),l=i(s),c=l.length,u=0,f=[];c>u;)r=l[u++],n&&!a.call(s,r)||f.push(e?[r,s[r]]:s[r]);return f}}},function(e,t,r){var n=r(59),i=r(159);e.exports=function(e){return function(){if(n(this)!=e)throw TypeError(e+"#toJSON isn't generic");return i(this)}}},function(e,t,r){var n=r(54);e.exports=function(e,t){var r=[];return n(e,!1,r.push,r,t),r}},function(e,t){e.exports=Math.scale||function(e,t,r,n,i){return 0===arguments.length||e!=e||t!=t||r!=r||n!=n||i!=i?NaN:e===1/0||e===-1/0?e:(e-t)*(i-n)/(r-t)+n}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.get=function(e,t,r,n,i){},e.prototype.post=function(e,t,r,n,i){},e.prototype.put=function(e,t,r,n,i){},e.prototype.delete=function(e,t,r,n,i){},e}();e.exports=r},function(e,t,r){"use strict";var n,i;n=[r(115),r(2),r(15),r(1)],void 0===(i=function(e,t,r,n){var i=function(e){r.setOptions(this,e)};return i.prototype={options:{},addTo:function(e){this.remove(),this.options.gmap=e;var t=this._fcontainer=this.onAdd(e),r=this.getPosition();if("[object String]"===Object.prototype.toString.call(r)){var n=e._controlCorners[r];$(n).append($(t))}else{n=e._controlCorners.drift;$(n).append($(t)),r&&"[object Object]"===Object.prototype.toString.call(r)&&!$.isEmptyObject(r)&&($(t).css(r),$(t).css({position:"absolute"})),$(t).css({"pointer-events":"auto"}),$(t).addClass("gs-container-subdrift")}return this.created&&this.created(),this},remove:function(){return this.options.gmap?(jQuery(this._fcontainer).remove(),this.onRemove&&this.onRemove(this.options.gmap),this.options.gmap=null,this):this},constructor:i,getPosition:function(){return this.options.position},setPosition:function(e){jQuery(this._fcontainer).remove(),this.onRemove&&this.onRemove(this.options.gmap),this.options.position=e,this.addTo(this.options.gmap)},onAdd:function(){var e=document.createElement("div");return this.options.id&&(e.id=this.options.id),this.options.className&&(e.className=this.options.className),this.container=e,this.container},getFontainer:function(){return this._fcontainer},getID:function(){var e=this.options?this.options:this.options.id;return(e=e||ctrl.id)||(e="ctr"+t.stamp(this)),e}},e.include({addControl:function(e){if(e instanceof G.base.ControlBase){if(this._controls.push(e),!(e.getID?e.getID():"ctr"+t.stamp(e)))throw new Error("参数类型错误！");return e.addTo?e.addTo(this):e.onAdd(),this}return n.carto.Map.prototype.addControl.call(this,e)},removeControl:function(e){if(e instanceof G.base.ControlBase){for(var t=!1,r=this._controls.length-1;r>=0;r--){var i=this._controls[r];if(i===e||i.id===e){i.remove?i.remove():i.onRemove(),this._controls.splice(r,1),t=!0;break}}return t}return n.carto.Map.prototype.removeControl.call(this,e)},getControlById:function(e){for(var t=this._controls.length,r=null,n=0;n<t;n++){var i=this._controls[n];if(i.id===e){r=i;break}}return r},_initControlPos:function(){var e=this._controlCorners={},t=jQuery("#"+this.id),r=t;r.append('<div class="Corners"></div>');var n=r.find(".Corners").last();n.css({position:"absolute",width:"100%",height:"100%"}),this._setContainerParentStyles(n[0],t[0]);function i(t,r){var i="gs-container-"+t+r;n.append('<div class="'+i+'"></div>'),e[t+r]=n.find("."+i)[0]}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right"),function(){n.append('<div class="gs-container-drift"></div>');var t=r.find(".gs-container-drift");e.drift=t[0]}()},_clearPos:function(){jQuery("#"+this.id+" .Corners").remove(),jQuery("#"+this.id+" .Drift").remove()},_setContainerParentStyles:function(e,t){console.log(e),e.style.top="0px",e.style.left="0px"}}),e.addInitHook((function(){this._controls=[],!0===this.options.initControlContainer&&this._initControlPos&&this._initControlPos()})),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(2),r(68),r(22)],void 0===(i=function(e,t,r){var n="class",i="plugin",o={_mergeAndCheckBeans:function(n,i){var o={};if(e.isArray(n))for(var a=0,s=n.length;a<s;a++){(f=n[a])&&(o[f.id]=f)}if(e.isArray(i)){var l=0;for(s=i.length;l<s;l++){(f=i[l])&&(o[f.id]&&r.info("override bean :"+f.id),o[f.id]=f)}}var c=[];if(this._isPackMode())for(var u in o){(f=o[u])&&(f.path?this._isGlobalVar(f.path)||(f.path=h.call(this,f.path)):delete f.path,c.push(f))}else for(var u in o){var f;if(f=o[u]){if(!e.isString(f.path)){var p=this._getBeanTypeById(f.id);f.path=this.getResourcePath()+"/js/"+p+"/"+f.id+".js"}this._isGlobalVar(f.path)||(f.path=h.call(this,f.path)),c.push(f)}}function h(r){var n={base:t.getBasePath(),resource:this.getResourcePath()};return e.replacePlaceHolder(n,r)}this.options.beans=c},_isPackMode:function(){return e.isObject(this.BEANS)},_extractBeanPath:function(){for(var t=this.options.beans,r=[],n=0,i=t.length;n<i;n++){var o=t[n];e.isString(o.path)&&(this._isGlobalVar(o.path)||r.push(o.path))}return r},_isGlobalVar:function(t){return e.isString(t)&&/^var\:.*$/.test(t)},getBean:function(e){return this._beans[e]||null},_initializeBean:function(r,o){var a=this._beans[r],s=!1,l=this.options.beans;if(null==a)for(var c=0,u=l.length;c<u;c++){var f=l[c],p=f.properties||[];if(f&&f.id==r){try{if(f.type==n){if(a=o[c],this._beans[f.id]=a,e.isArray(p)&&p.length>0&&e.isObject(a.prototype)){var h=a.prototype.options||{},d=m.call(this,p,o,l);for(var y in d=g.call(this,f,d))h[y]=d[y];a.prototype.options=h}}else if(f.type==i)s=!0,a=o[c],this._beans[f.id]=a;else{d=m.call(this,p,o,l);d=g.call(this,f,d),e.isFunction(o[c])?a=new o[c](d):e.isObject(o[c])&&(a=o[c]),this._beans[f.id]=a}}catch(e){throw new Error("failed to construct bean ["+r+"]\r\n message: "+e.message)}break}}
//!isPlugin 处理第三方库无返回值的情况
if(!s&&null==a)throw new Error("bean ["+r+"] cannot be initialized !");return a;function m(t,r,n){for(var i={},o={},a=0,s=n.length;a<s;a++){var l=n[a];if(l&&l.id)o["${"+l.id+"}"]=l.id}for(a=0,s=t.length;a<s;a++){var c=t[a],u=c.name,f=c.value;if(e.isString(f))if(o.hasOwnProperty(f)){var p=o[f];i[u]=this._initializeBean(p,r)}else{var h=/([\w\_\-\d]+)/g,d=f.match(/(\$\{[\w\.\_\-\d]{0,}\})/g);if(e.isArray(d))for(var y=0,m=d.length;y<m;y++){var g=d[y],v=g.match(h);if(e.isArray(v)&&v.length>0){var b=v.join("."),_=e.getValByVarPath(b);f=f==="${"+b+"}"?_:f.replace(g,_)}}i[u]=f}else i[u]=f}return i}function g(e,r){return r.appEvent=this.appEvent,r.locale=t.getLocaleValue(this.options.name)||{},r.parentOpts=this.options,v.call(this,e.id,r),r}function v(e,t){var r={component:function(e){e.map=this.map},dispatcher:function(e){},view:function(e){e.imgPath=this._imgPath,e.cssPath=this._cssPath,e.htmlPath=this._htmlPath,e.configPath=this._configPath},service:function(e){e.configPath=this._configPath}},n=this._getBeanTypeById(e);n&&r[n]&&r[n].call(this,t)}},_getBeanTypeById:function(e){var t={"^.*component$":"component","^.*dispatcher$":"dispatcher","^.*view$":"view","^.*service$":"service"},r="misc";for(var n in e&&(e=e.toLowerCase()),t)if(new RegExp(n,"i").test(e)){r=t[n];break}return r},_initializeBeans:function(){for(var t=[],r=this.options.beans,n=this.BEANS,i=0,o=0,a=r.length;o<a;o++){var s=r[o];if(e.isString(s.path))this._isGlobalVar(s.path)?t.push(e.getValByVarPath(s.path.replace(/var:/g,""))):t.push(arguments[i++]);else{var l=n[s.id];if(!l)throw new Error("bean :"+s.id+" clazz not defined!");t.push(l)}}for(o=0,a=r.length;o<a;o++){s=r[o];this._initializeBean(s.id,t)}},_activateDispatchers:function(){for(var e in this._beans){this._beans[e]&&"dispatcher"===this._getBeanTypeById(e)&&this.getBean(e).dispatch()}},_destroyBeans:function(){for(var e in this._beans){var t=this._beans[e];if(t.destroy)try{t.destroy()}catch(e){}this._beans[e]=null,delete this._beans[e]}}};function a(r){var n=r.beans;delete r.beans,r.hasOwnProperty("resourcePath")&&(this.BEANS=null,this.setResourcePath(r.resourcePath));var i=this.getResourcePath();this._staticPath=r.staticPath||t.getStaticPath(),this._cssPath=r.cssPath||i+"css/",this._configPath=r.configPath||i+"config/",this._imgPath=r.imgPath||i+"img/",this._htmlPath=r.htmlPath||i+"html/";var o={};e.isString(this.options.config)&&(o=e.getConfig({url:this._configPath+this.options.config,async:!1}));var a=null;if(e.isObject(o))for(var s in a=o.beans,delete o.beans,o)this.options.hasOwnProperty(s)||(this.options[s]=o[s]);this._beans={},this._mergeAndCheckBeans(a,n)}function s(){var t=this,r=this._extractBeanPath();function n(){this._initializeBeans.apply(this,arguments),this._activateDispatchers(),this.fire("BEAN_INITIALIZED",{})}window.hasOwnProperty("requireNoConflict")?window.requireNoConflict(r,(function(){n.apply(t,arguments)})):e.isFunction(window.require)&&e.isFunction(window.define)?window.require(r,(function(){n.apply(t,arguments)})):n.apply(t,[])}function l(){this._destroyBeans()}return{enable:function(e){if(e&&e.prototype){if(e.prototype.initialize){var t=e.prototype.initialize;e.prototype.initialize=function(e){t.apply(this,arguments),a.apply(this,arguments)}}if("Control"==e.prototype.TYPE){var r=e.prototype.onAdd;e.prototype.onAdd=function(){r.call(this),s.call(this)};var n=e.prototype.onRemove;e.prototype.onRemove=function(){n.call(this),l.call(this)}}else if("Module"==e.prototype.TYPE){var i=e.prototype.onOpen;e.prototype.onOpen=function(){i.call(this),s.call(this)};var c=e.prototype.onClose;e.prototype.onClose=function(){c.call(this),l.call(this)}}for(var u in o)e.prototype[u]=o[u]}}}}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(411),r(2),r(14),r(16),r(57),r(11),r(1)],void 0===(i=function(e,t,r,n,i,o,a,s){var l=e.extend({options:{collision:"visibility",symbol:{type:"SimpleLineSymbol",options:{color:{a:250,r:0,g:0,b:0},style:5,width:2}}},initialize:function(t){e.prototype.initialize.call(this,t),this._tailLables=[],this._tailOpts={tailLength:!0,tailAlign:!0,tailAngle:!0,symbol:!0,showArrow:!0,arrowSymbol:!0,arrowShape:!0,arrowLength:!0,arrowScale:!0,arrowAngle:!0,domClassName:!0,domStyle:!0},this._lastLevel=this.map.getZoomLevel(),this.map.listen("extentchanged",this._onExtentChange,this);try{this.map.map.listen("pointerdrag",this._onMapDragg,this)}catch(e){}},clear:function(){for(var e=0,t=this._tailLables.length;e<t;e++)try{this._tailLables[e].destroy()}catch(e){}this._tailLables=[]},destroy:function(){this.map.off("extentchanged",this._onExtentChange,this);try{this.map.map.un("pointerdrag",this._onMapDragg,this)}catch(e){}e.prototype.destroy.call(this)}});return l.include({_onExtentChange:function(e){var t="";t=this._lastLevel==this.map.getZoomLevel()?"updateDom":"update";for(var r=0,n=this._tailLables.length;r<n;r++)try{this._tailLables[r][t]()}catch(e){}this._lastLevel=this.map.getZoomLevel(),this._detectCollision()},_onMapDragg:function(e){e.pixel,e.coordinate;for(var t=0,r=this._tailLables.length;t<r;t++)try{this._tailLables[t].updateDom()}catch(e){}this._detectCollision()},_detectCollision:function(){({none:function(){},visibility:function(){for(var e=[],t=0,r=this._tailLables.length;t<r;t++){var n=this._tailLables[t];i(n,e)?n.toggleVisible(!1):(n.toggleVisible(!0),e.push(n))}function i(e,t){for(var r=!1,n=0,i=t.length;n<i;n++){var o=t[n];if(e.intersects(o)){r=!0;break}}return r}}})[this.options.collision].call(this)},_getLayer:function(){if(!this._layer){var e=this.options.layerId,t=n.getLayerById(this.map,e);t||(t=new s.carto.ElementLayer({map:this.map,id:e}),this.map.addLayer(t)),this._layer=t}return this._layer},_getTailedLabel:function(e){for(var t=null,r=this._tailLables.length-1;r>=0;r--){var n=this._tailLables[r];if(n&&n.getId()==e){t=n;break}}return t}}),l.include({add:function(e){var r=jQuery.extend(!0,{},e);for(var n in this._tailOpts)r[n]=r[n]||this.options[n];r.layer=this._getLayer(),r.map=this.map;var i=new t(r);return i.setContent(r.label),this._tailLables.push(i),this._detectCollision(),i.getId()},update:function(e,t,r){var n=!1,i=this._getTailedLabel(e);return null!=i&&(i.setContent(t),null!=r&&i.update(r||{}),n=!0),n},remove:function(e){for(var t=!1,r=this._tailLables.length-1;r>=0;r--){var n=this._tailLables[r];if(n&&n.getId()==e){n.destroy(),this._tailLables.splice(r,1),t=!0;break}}return t},removeAll:function(){for(var e=this._tailLables.length-1;e>=0;e--){var t=this._tailLables[e];t&&(t.destroy(),this._tailLables.splice(e,1))}}}),l}.apply(t,n))||(e.exports=i)},function(e,t,r){var n=r(2),i=r(1),o={};o=Object.assign(o,{verify:function(e,t){if(!n.isArray(e))return!1;if(!this._verifyCoordsReg(e))return!1;var r=this.getBbox(t);return this._isCoordWithinBbox(e,r)},getBbox:function(e){var t=[-179.999999,-89.999999],r=[179.999999,89.999999],n=this._transformFromWgs84(t,e);n.toString()==t.toString()&&(n=[-180,-90]);var i=this._transformFromWgs84(r,e);return i.toString()==r.toString()&&(i=[180,90]),n.concat(i)},withinChina:function(e,t){if(!this.verify(e,t))return!1;var r=this._transformToWgs84(e,t);return this._isWithinChinaWgs84(r)},_transformToWgs84:function(e,t){return this._transform(e,t,4326)},_transformFromWgs84:function(e,t){return this._transform(e,4326,t)},_transform:function(e,t,r){var n=new i.sfs.CoordinateTransform,o=new i.sfs.Point({x:e[0],y:e[1]});o.setSpatialReference(t);var a=n.transform(o,r);return[a.x,a.y]},_isWithinChinaWgs84:function(e){for(var t=[[79.4462,42.8899,96.33,49.2204],[109.6872,39.3742,135.0002,54.1415],[73.1246,29.5297,124.143255,42.8899],[82.9684,26.7186,97.0352,29.5297],[97.0253,20.414096,124.367395,29.5297],[107.975793,17.871542,111.744104,20.414096],[108.168592,3.231964,119.373474,20.541749]],r=[[101.8652,20.0988,106.665,22.284],[106.4525,20.4878,108.051,21.5422],[109.0323,50.3257,119.127,55.8175],[127.4568,49.5574,137.0227,55.8175],[131.2662,42.5692,137.0227,44.8922],[125.178223,34.560859,130.209961,39.926588],[128.605957,39.429884,132.077635,41.804078],[131.879881,41.754922,135.703123,44.527843],[131.432559,36.949891,139.350583,42.455887]],n=0;n<t.length;n++){var i=t[n];if(this._isCoordWithinBbox(e,i)){for(var o=0;o<r.length;o++){var a=r[o];if(this._isCoordWithinBbox(e,a))return!1}return!0}}return!1},_isCoordWithinBbox:function(e,t){var r=e[0],n=e[1],i=t[0],o=t[1],a=t[2],s=t[3];return r<=a&&r>=i&&n>=o&&n<=s},_verifyCoordsReg:function(e){for(var t=/^[+-]?[\d]+([\.][\d]+)?([Ee][+-]?[\d]+)?$/,r=!0,i=0;i<e.length;i++){var o=e[i];if(!n.isString(o)&&isNaN(o)){r=!1;break}if(!t.test(o)){r=!1;break}}return r}}),e.exports=o},function(e,t,r){var n=r(420),i=r(421),o={};o=Object.assign(o,{fromKml:function(e){return i.kml(e)},fromGpx:function(e){return i.gpx(e)},fromArcgis:function(e,t){return n.arcgisToGeoJSON(e,t)},toArcgis:function(e,t){return n.geojsonToArcGIS(e,t)}}),e.exports=o},function(e,t,r){var n=r(15),i=r(1),o=r(16),a=n.extend({options:{},initialize:function(e){n.setOptions(this,e);var t="SimpleMarkerSymbol",r={borderColor:{a:200,r:200,g:200,b:200},fillColor:{a:200,r:0,g:100,b:255},borderThickness:1,size:4};this.defaultSymbols={Point:o.object2Symbol(t,r),Polyline:i.sfs.SimpleLineSymbol(),Polygon:i.sfs.SimpleFillSymbol()}},build:function(e){},destroy:function(){}});e.exports=a},function(module,exports,__webpack_require__){var Class=__webpack_require__(15),GeometryUtil=__webpack_require__(11),CoordUtil=__webpack_require__(166),g2=__webpack_require__(1),GeometryBuilder=Class.extend({options:{sourceSr:4326,targetSr:4326,geometryField:["geom"],geometryType:"Point"},initialize:function(e){Class.setOptions(this,e),this.projService=new g2.sfs.CoordinateTransform({})},destroy:function(){},getGeometryType:function(){return this.options.geometryType},build:function(e){var t=this._build(e);if(!this.check(t))throw t=null,"无效坐标";return t},check:function(e){var t=this._check(e);return t},_build:function(e){var t=this.options.sourceSr,r=this.options.targetSr,n=this.options.geometryField,i=null;try{if(1==n.length){var o=e[n[0]];try{"string"==typeof o?(o=this.wktReader.read(o).toString(),i=g2.sfs.GeometryFactory.createGeometryFromWkt(o,t)):i=g2.sfs.GeometryFactory.createGeometryFromGeoJson(o,t)}catch(e){}}else if(2==n.length){var a,s;a=this._getXyVal(e,n[0]),s=this._getXyVal(e,n[1]),i=new g2.sfs.Point({x:a,y:s,spatialReference:t})}}catch(e){throw e}return t&&r&&t!=r&&(i=this.projService.transform(i,r)),i},_check:function(e){var t=this.options.sourceSr,r=!0;if(e instanceof g2.sfs.Point){var n=GeometryUtil.validateCoordinate(e.x,e.y,t);if(!n)throw r=!1,new Error("无效坐标！");if(!CoordUtil.verify(n,t))throw r=!1,new Error("无效坐标！")}return r},_getXyVal:function _getXyVal(data,field){var val;try{val=field.indexOf(".")<0?data[field]:parseFloat(eval("data."+field))}catch(e){}return val}});module.exports=GeometryBuilder},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getPageList=function(e){},t.prototype.getList=function(e){},t.prototype.getListBatch=function(e){},t}(r(40));e.exports=n},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getDistrict=function(e){},t.prototype.getSubDistrict=function(e){},t.prototype.getDistrictByPoint=function(e){},t.prototype.districtStatistics=function(e){},t}(r(40));e.exports=n},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.stat=function(e){},t}(r(40));e.exports=n},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.rescueDispatch=function(e){},t.prototype.materialDispatch=function(e){},t}(r(40));e.exports=n},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getTyphoonsByYear=function(e){},t.prototype.getTyphoonInfo=function(e){},t.prototype.getCurrent=function(){},t}(r(40));e.exports=n},function(e,t,r){"use strict";function n(e,t,r,i){this.message=e,this.expected=t,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(n,Error),n.buildMessage=function(e,t){var r={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}return"Expected "+function(e){var t,n,i,o=new Array(e.length);for(t=0;t<e.length;t++)o[t]=(i=e[t],r[i.type](i));if(o.sort(),o.length>0){for(t=1,n=1;t<o.length;t++)o[t-1]!==o[t]&&(o[n]=o[t],n++);o.length=n}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:n,parse:function(e,t){t=void 0!==t?t:{};var r,i={},o={start:to},a=to,s=function(e){return e.params=Ta,e},l=function(e){return e},c=function(e,t){for(var r=e,n=0;n<t.length;n++)r._next=t[n][3],r=r._next;return e},u="(",f=Hi("(",!1),p=")",h=Hi(")",!1),d=";",y=Hi(";",!1),m=function(e,t,r,n){return{type:"create_table",name:e,columns:t,tableOptions:r,partitionOptions:n}},g=function(e,t){return Pa(e,t)},v=function(e,t,r){var n=[];return r.forEach((function(e){n.push(e[1])})),{name:e,type:t,ext:n}},b=function(e){if("function"===e.type){var t=[];return e.args.value.forEach((function(e){t.push(e.value)})),{type:e.name,args:t}}return{type:e}},_=function(e,t){var r=e;return t.forEach((function(e){var t=e[1];Object.keys(t).forEach((function(e){r[e]=t[e].column}))})),r},w="=",S=Hi("=",!1),x=function(e,t){var r={},n="column_ref"===e.type?e.column:e.value,i="column_ref"===t.type?t.column:t.value;return r[n]=i,r},L=function(e,t){var r=[e];return t.forEach((function(e){r.push(e)})),r},P="key",E=Hi("KEY",!0),C="index",T=Hi("INDEX",!0),A=function(e,t,r){var n=[];return r.forEach((function(e){n.push(e.expr.column)})),{type:e,name:t,columns:n}},R=function(e,t){return{type:"delete",from:e,where:t}},M=function(e){return e[2]},k=function(e,t,r,n,i,o,a){return{type:"select",distinct:e,columns:t,from:r,where:n,groupby:i,orderby:o,limit:a}},O=Qi("column_clause"),I=function(){return"*"},F=function(e,t){return Pa(e,t)},N=function(e,t){return{expr:e,as:t}},G=function(e){return e},j=function(e){return e},D=function(e,t){return t.unshift(e),t},B=function(e){return e},U=function(e,t,r){return t.join=e,t.on=r,t},z=function(e,t){return"var"==e.type?(e.as=t,e):{db:e.db,table:e.table,as:t}},W=function(){return"LEFT JOIN"},Y=function(){return"INNER JOIN"},V="`",q=Hi("`",!1),J=function(e,t){var r={db:"",table:e};return t&&(r.db=e,r.table=t[3]),r},H=function(e){return e.db="",e.table=e.name,e},X=function(e){return e},Q=function(e,t){var r={expr:e,type:"ASC"};return"DESC"==t&&(r.type="DESC"),r},Z=function(e,t){var r=[e];return t?r.push(t[2]):r.unshift({type:"number",value:0}),r},K=function(e,t,r){return{type:"update",db:e.db,table:e.table,set:t,where:r}},$=function(e,t){return{column:e,value:t}},ee=function(e,t,r,n){return{type:e,db:t.db,table:t.table,columns:r,values:n}},te=function(){return"insert"},re=function(){return"replace"},ne=function(e){return e},ie=function(e,t){var r={type:"expr_list"},n=function(e,t,r){for(var n,i=Pa(e,t),o=[],a=0;a<i.length;a++)"param"==(n=i[a]).type?(n.room=r,n.pos=a):o.push(n);return o}(e,t,r);return r.value=n,r},oe="",ae=function(){return{type:"expr_list",value:[]}},se=function(e,t){return Ea(e,t)},le="!",ce=Hi("!",!1),ue=function(e){return{type:"unary_expr",operator:"NOT",expr:e}},fe=function(e,t){if(t){return"arithmetic"==t.type?Ea(e,t.tail):La(t.op,e,t.right)}return e},pe=function(e){return{type:"arithmetic",tail:e}},he=">=",de=Hi(">=",!1),ye=">",me=Hi(">",!1),ge="<=",ve=Hi("<=",!1),be="<>",_e=Hi("<>",!1),we="<",Se=Hi("<",!1),xe="!=",Le=Hi("!=",!1),Pe=function(e,t){return{op:e,right:t}},Ee=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}},Ce=function(e){return e[0]+" "+e[2]},Te=function(e,t){return{op:e,right:t}},Ae=function(e,t){return{op:e,right:t}},Re="+",Me=Hi("+",!1),ke="-",Oe=Hi("-",!1),Ie=function(e,t){return Ea(e,t)},Fe="*",Ne=Hi("*",!1),Ge="/",je=Hi("/",!1),De="%",Be=Hi("%",!1),Ue=function(e){return e.paren=!0,e},ze=function(e,t){return{type:"column_ref",table:e,column:t}},We=function(e){return{type:"column_ref",table:"",column:e}},Ye=function(e){return!0===Ca[e.toUpperCase()]},Ve=function(e){return e},qe=/^[^`]/,Je=Xi(["`"],!0,!1),He=function(e){return e.join("")},Xe=function(e,t){return e+t.join("")},Qe=/^[A-Za-z_]/,Ze=Xi([["A","Z"],["a","z"],"_"],!1,!1),Ke=/^[A-Za-z0-9_]/,$e=Xi([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),et=/^[A-Za-z0-9_:]/,tt=Xi([["A","Z"],["a","z"],["0","9"],"_",":"],!1,!1),rt=Qi("PARAM[:param, ?]"),nt=":",it=Hi(":",!1),ot="?",at=Hi("?",!1),st=function(e){var t={type:"param",value:e.length>1?e[1]:e[0]};return Ta.push(t),t},lt=function(e,t){return{type:"aggr_func",name:e,args:{expr:t}}},ct=/^[0-9a-zA-Z_]/,ut=Xi([["0","9"],["a","z"],["A","Z"],"_"],!1,!1),ft=function(e){return e.join("")},pt=function(e,t){return{type:"aggr_func",name:e,args:t}},ht=function(e){return{expr:e}},dt=function(e,t){return{distinct:e,expr:t}},yt=function(){return{type:"star",value:"*"}},mt=function(e,t){return{type:"function",name:e,args:t}},gt=function(){return{type:"null",value:null}},vt=function(){return{type:"bool",value:!0}},bt=function(){return{type:"bool",value:!1}},_t='"',wt=Hi('"',!1),St="'",xt=Hi("'",!1),Lt=function(e){return{type:"string",value:e[1].join("")}},Pt=/^[^'\\\0-\x1F\x7F]/,Et=Xi(["'","\\",["\0",""],""],!0,!1),Ct=/^[^"\\\0-\x1F\x7F]/,Tt=Xi(['"',"\\",["\0",""],""],!0,!1),At="\\'",Rt=Hi("\\'",!1),Mt=function(){return"'"},kt='\\"',Ot=Hi('\\"',!1),It=function(){return'"'},Ft="\\\\",Nt=Hi("\\\\",!1),Gt=function(){return"\\"},jt="\\/",Dt=Hi("\\/",!1),Bt=function(){return"/"},Ut="\\b",zt=Hi("\\b",!1),Wt=function(){return"\b"},Yt="\\f",Vt=Hi("\\f",!1),qt=function(){return"\f"},Jt="\\n",Ht=Hi("\\n",!1),Xt=function(){return"\n"},Qt="\\r",Zt=Hi("\\r",!1),Kt=function(){return"\r"},$t="\\t",er=Hi("\\t",!1),tr=function(){return"\t"},rr="\\u",nr=Hi("\\u",!1),ir=function(e,t,r,n){return String.fromCharCode(parseInt("0x"+e+t+r+n))},or=(Xi(["\n","\r"],!1,!1),function(e){return{type:"number",value:e}}),ar=Qi("LITERAL INT"),sr=function(e){return{type:"number",value:e}},lr=function(e,t,r){var n=parseFloat(e+t+r);return n%1!=0?n.toString():n.toString()+".0"},cr=function(e,t){var r=parseFloat(e+t);return r%1!=0?r.toString():r.toString()+".0"},ur=function(e,t){return parseFloat(e+t).toString()},fr=function(e){return parseFloat(e).toString()},pr=function(e,t){return e+t},hr=function(e,t,r){return"-"+t+r},dr=function(e,t){return"-"+t},yr=".",mr=Hi(".",!1),gr=function(e){return"."+e},vr=function(e,t){return e+t},br=function(e){return e.join("")},_r=Qi("NUMBER"),wr=/^[0-9]/,Sr=Xi([["0","9"]],!1,!1),xr=/^[1-9]/,Lr=Xi([["1","9"]],!1,!1),Pr=Qi("HEX"),Er=/^[0-9a-fA-F]/,Cr=Xi([["0","9"],["a","f"],["A","F"]],!1,!1),Tr=/^[eE]/,Ar=Xi(["e","E"],!1,!1),Rr=/^[+\-]/,Mr=Xi(["+","-"],!1,!1),kr=function(e,t){return e+t},Or="null",Ir=Hi("NULL",!0),Fr="true",Nr=Hi("TRUE",!0),Gr="false",jr=Hi("FALSE",!0),Dr=(Hi("SHOW",!0),Hi("DROP",!0),"select"),Br=Hi("SELECT",!0),Ur="update",zr=Hi("UPDATE",!0),Wr="create",Yr=Hi("CREATE",!0),Vr="delete",qr=Hi("DELETE",!0),Jr="insert",Hr=Hi("INSERT",!0),Xr="replace",Qr=Hi("REPLACE",!0),Zr=(Hi("EXPLAIN",!0),"into"),Kr=Hi("INTO",!0),$r="from",en=Hi("FROM",!0),tn="set",rn=Hi("SET",!0),nn="as",on=Hi("AS",!0),an="table",sn=Hi("TABLE",!0),ln="on",cn=Hi("ON",!0),un="left",fn=Hi("LEFT",!0),pn="inner",hn=Hi("INNER",!0),dn="join",yn=Hi("JOIN",!0),mn="union",gn=Hi("UNION",!0),vn="values",bn=Hi("VALUES",!0),_n="if",wn=Hi("IF",!0),Sn="exists",xn=Hi("EXISTS",!0),Ln="where",Pn=Hi("WHERE",!0),En="group",Cn=Hi("GROUP",!0),Tn="by",An=Hi("BY",!0),Rn="order",Mn=Hi("ORDER",!0),kn=(Hi("HAVING",!0),"limit"),On=Hi("LIMIT",!0),In="asc",Fn=Hi("ASC",!0),Nn=function(){return"ASC"},Gn="desc",jn=Hi("DESC",!0),Dn=function(){return"DESC"},Bn="all",Un=Hi("ALL",!0),zn=function(){return"ALL"},Wn="distinct",Yn=Hi("DISTINCT",!0),Vn=function(){return"DISTINCT"},qn="between",Jn=Hi("BETWEEN",!0),Hn=function(){return"BETWEEN"},Xn="in",Qn=Hi("IN",!0),Zn=function(){return"IN"},Kn="is",$n=Hi("IS",!0),ei=function(){return"IS"},ti="like",ri=Hi("LIKE",!0),ni=function(){return"LIKE"},ii="contains",oi=Hi("CONTAINS",!0),ai=function(){return"CONTAINS"},si="not",li=Hi("NOT",!0),ci=function(){return"NOT"},ui="and",fi=Hi("AND",!0),pi=function(){return"AND"},hi="or",di=Hi("OR",!0),yi=function(){return"OR"},mi="count",gi=Hi("COUNT",!0),vi=function(){return"COUNT"},bi=(Hi("MAX",!0),Hi("MIN",!0),Hi("SUM",!0),Hi("AVG",!0),","),_i=Hi(",",!1),wi="[",Si=Hi("[",!1),xi="]",Li=Hi("]",!1),Pi=Qi("WHITE_SPACE"),Ei=/^[ \t\n\r]/,Ci=Xi([" ","\t","\n","\r"],!1,!1),Ti=(Qi("EOF"),function(e){return{stmt:e,vars:Aa}}),Ai=function(){return Aa=[],!0},Ri=function(e,t){return{type:"assign",left:e,right:t}},Mi=function(e){return{type:"return",expr:e}},ki=function(e,t,r,n){return{type:"join",ltable:e,rtable:r,op:t,on:n}},Oi=function(e,t){return{type:"function",name:e,args:{type:"expr_list",value:t}}},Ii=function(e){return{type:"array",value:e}},Fi=function(e,t){return Aa.push(e),{type:"var",name:e,members:t}},Ni=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r][1]);return t},Gi="$",ji=Hi("$",!1),Di="return",Bi=Hi("return",!0),Ui=":=",zi=Hi(":=",!1),Wi=0,Yi=[{line:1,column:1}],Vi=0,qi=[],Ji=0;if("startRule"in t){if(!(t.startRule in o))throw new Error("Can't start parsing from rule \""+t.startRule+'".');a=o[t.startRule]}function Hi(e,t){return{type:"literal",text:e,ignoreCase:t}}function Xi(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Qi(e){return{type:"other",description:e}}function Zi(t){var r,n=Yi[t];if(n)return n;for(r=t-1;!Yi[r];)r--;for(n={line:(n=Yi[r]).line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Yi[t]=n,n}function Ki(e,t){var r=Zi(e),n=Zi(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function $i(e){Wi<Vi||(Wi>Vi&&(Vi=Wi,qi=[]),qi.push(e))}function eo(e,t,r){return new n(n.buildMessage(e,t),e,t,r)}function to(){var t,r,n;return t=Wi,(r=ya())!==i?((n=function(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=io())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=ra())!==i&&(s=ya())!==i&&(l=io())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=ra())!==i&&(s=ya())!==i&&(l=io())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,t=c(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())===i&&(n=function(){var t,r,n,o,a;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,6).toLowerCase()===Ur?(r=e.substr(Wi,6),Wi+=6):(r=i,0===Ji&&$i(zr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&(n=fo())!==i&&ya()!==i&&function(){var t,r,n,o;t=Wi,e.substr(Wi,3).toLowerCase()===tn?(r=e.substr(Wi,3),Wi+=3):(r=i,0===Ji&&$i(rn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}()!==i&&ya()!==i&&(o=function(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=go())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=go())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=go())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,t=F(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())!==i&&ya()!==i&&(a=ho())!==i?(t,r=K(n,o,a),t=r):(Wi=t,t=i);return t}())===i&&(n=function(){var t,r,n,o;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,6).toLowerCase()===Vr?(r=e.substr(Wi,6),Wi+=6):(r=i,0===Ji&&$i(qr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&(n=so())!==i&&ya()!==i?((o=ho())===i&&(o=null),o!==i?(t,r=R(n,o),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())===i&&(n=function(){var t,r,n,o,a;t=Wi,(r=function(){var t,r;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,6).toLowerCase()===Jr?(r=e.substr(Wi,6),Wi+=6):(r=i,0===Ji&&$i(Hr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(t,r=te());(t=r)===i&&(t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,7).toLowerCase()===Xr?(r=e.substr(Wi,7),Wi+=7):(r=i,0===Ji&&$i(Qr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(t,r=re()),t=r);return t}())!==i&&ya()!==i&&function(){var t,r,n,o;t=Wi,e.substr(Wi,4).toLowerCase()===Zr?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(Kr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}()!==i&&ya()!==i&&(n=fo())!==i&&ya()!==i&&ha()!==i&&ya()!==i&&(o=function(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=Io())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=Io())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=Io())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,t=F(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())!==i&&ya()!==i&&da()!==i&&ya()!==i&&(a=function(){var t,r,n;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,6).toLowerCase()===vn?(r=e.substr(Wi,6),Wi+=6):(r=i,0===Ji&&$i(bn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&(n=function(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=vo())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=vo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=vo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,t=F(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())!==i?(t,r=j(n),t=r):(Wi=t,t=i);return t}())!==i?(t,r=ee(r,n,o,a),t=r):(Wi=t,t=i);return t}())===i&&(n=function(){var t,r,n,o,a,s,l,c,v,b,w,S,x,P;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,6).toLowerCase()===Wr?(r=e.substr(Wi,6),Wi+=6):(r=i,0===Ji&&$i(Yr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===an?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(sn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}()!==i&&ya()!==i?(n=Wi,(o=function(){var t,r,n,o;t=Wi,e.substr(Wi,2).toLowerCase()===_n?(r=e.substr(Wi,2),Wi+=2):(r=i,0===Ji&&$i(wn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(a=ya())!==i&&(s=la())!==i&&(l=ya())!==i&&(c=function(){var t,r,n,o;t=Wi,e.substr(Wi,6).toLowerCase()===Sn?(r=e.substr(Wi,6),Wi+=6):(r=i,0===Ji&&$i(xn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(v=ya())!==i?n=o=[o,a,s,l,c,v]:(Wi=n,n=i),n===i&&(n=null),n!==i&&(o=fo())!==i&&(a=ya())!==i?(40===e.charCodeAt(Wi)?(s=u,Wi++):(s=i,0===Ji&&$i(f)),s!==i&&(l=ya())!==i&&(c=function(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=ro())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=ro())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=ro())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,t=g(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())!==i&&(v=ya())!==i?(41===e.charCodeAt(Wi)?(b=p,Wi++):(b=i,0===Ji&&$i(h)),b!==i&&ya()!==i?((w=function(){var e,t,r,n,o,a;if(e=Wi,(t=no())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=no())!==i?n=o=[o,a]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=no())!==i?n=o=[o,a]:(Wi=n,n=i);r!==i?(e,t=_(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())===i&&(w=null),w!==i&&ya()!==i?((S=function(){var e,t,r,n,o,a;if(e=Wi,(t=Mo())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=Mo())!==i?n=o=[o,a]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=Mo())!==i?n=o=[o,a]:(Wi=n,n=i);r!==i?(e,t=L(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())===i&&(S=null),S!==i&&ya()!==i?(59===e.charCodeAt(Wi)?(x=d,Wi++):(x=i,0===Ji&&$i(y)),x===i&&(x=null),x!==i?((P=ya())===i&&(P=null),P!==i?(t,r=m(o,c,w,S),t=r):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i);return t}()),n!==i?(t,t=r=s(n)):(Wi=t,t=i)):(Wi=t,t=i),t===i&&(t=Wi,(r=function(){var e,t;e=[],t=ga();for(;t!==i;)e.push(t),t=ga();return e}())!==i&&(t,r=l(r)),t=r),t}function ro(){var t,r,n,o,a,s,l;if((t=function(){var t,r,n,o,a,s,l,c;t=Wi,r=Wi,n=Wi,o=[],a=No();for(;a!==i;)o.push(a),a=No();o!==i&&(a=ya())!==i?(e.substr(Wi,3).toLowerCase()===P?(s=e.substr(Wi,3),Wi+=3):(s=i,0===Ji&&$i(E)),s===i&&(e.substr(Wi,5).toLowerCase()===C?(s=e.substr(Wi,5),Wi+=5):(s=i,0===Ji&&$i(T))),s!==i?n=o=[o,a,s]:(Wi=n,n=i)):(Wi=n,n=i);r=n!==i?e.substring(r,Wi):n;r!==i&&(n=ya())!==i&&(o=Io())!==i&&(a=ya())!==i?(40===e.charCodeAt(Wi)?(s=u,Wi++):(s=i,0===Ji&&$i(f)),s!==i&&(l=oo())!==i?(41===e.charCodeAt(Wi)?(c=p,Wi++):(c=i,0===Ji&&$i(h)),c!==i?(t,r=A(r,o,l),t=r):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i);return t}())===i)if(t=Wi,(r=Io())!==i)if(ya()!==i)if((n=function(){var e,t;e=Wi,(t=Uo())===i&&(t=Oo());t!==i&&(e,t=b(t));return e=t}())!==i){for(o=[],a=Wi,(s=ya())!==i?((l=zo())===i&&(l=No()),l!==i?a=s=[s,l]:(Wi=a,a=i)):(Wi=a,a=i);a!==i;)o.push(a),a=Wi,(s=ya())!==i?((l=zo())===i&&(l=No()),l!==i?a=s=[s,l]:(Wi=a,a=i)):(Wi=a,a=i);o!==i?(t,t=r=v(r,n,o)):(Wi=t,t=i)}else Wi=t,t=i;else Wi=t,t=i;else Wi=t,t=i;return t}function no(){var t,r,n,o;return t=Wi,(r=Mo())!==i&&ya()!==i?(61===e.charCodeAt(Wi)?(n=w,Wi++):(n=i,0===Ji&&$i(S)),n===i&&(n=null),n!==i&&ya()!==i&&(o=Mo())!==i?(t,t=r=x(r,o)):(Wi=t,t=i)):(Wi=t,t=i),t}function io(){var t,r,n,o,a,s,l;return(t=function(){var t,r,n,o,a,s,l,c,u;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,6).toLowerCase()===Dr?(r=e.substr(Wi,6),Wi+=6):(r=i,0===Ji&&$i(Br));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i?((n=ia())===i&&(n=null),n!==i&&ya()!==i&&(o=oo())!==i&&ya()!==i?((a=so())===i&&(a=null),a!==i&&ya()!==i?((s=ho())===i&&(s=null),s!==i&&ya()!==i?((l=function(){var t,r,n;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===En?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(Cn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&na()!==i&&ya()!==i&&(n=function(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=ko())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=ko())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=ko())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,t=F(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())!==i?(t,r=j(n),t=r):(Wi=t,t=i);return t}())===i&&(l=null),l!==i&&ya()!==i?((c=function(){var t,r,n;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===Rn?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(Mn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&na()!==i&&ya()!==i&&(n=function(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=yo())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=yo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=yo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,t=F(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())!==i?(t,r=j(n),t=r):(Wi=t,t=i);return t}())===i&&(c=null),c!==i&&ya()!==i?((u=function(){var t,r,n,o,a,s,l;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===kn?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(On));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&(n=mo())!==i&&ya()!==i?(o=Wi,(a=pa())!==i&&(s=ya())!==i&&(l=mo())!==i?o=a=[a,s,l]:(Wi=o,o=i),o===i&&(o=null),o!==i?(t,r=Z(n,o),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())===i&&(u=null),u!==i?(t,r=k(n,o,a,s,l,c,u),t=r):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i);return t}())===i&&(t=Wi,r=Wi,40===e.charCodeAt(Wi)?(n=u,Wi++):(n=i,0===Ji&&$i(f)),n!==i&&(o=ya())!==i&&(a=io())!==i&&(s=ya())!==i?(41===e.charCodeAt(Wi)?(l=p,Wi++):(l=i,0===Ji&&$i(h)),l!==i?r=n=[n,o,a,s,l]:(Wi=r,r=i)):(Wi=r,r=i),r!==i&&(t,r=M(r)),t=r),t}function oo(){var t,r,n,o,a,s,l,c;if(Ji++,t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,3).toLowerCase()===Bn?(r=e.substr(Wi,3),Wi+=3):(r=i,0===Ji&&$i(Un));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,r=zn(),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())===i&&(r=Wi,(n=function(){var t;42===e.charCodeAt(Wi)?(t=Fe,Wi++):(t=i,0===Ji&&$i(Ne));return t}())!==i?(o=Wi,Ji++,a=Go(),Ji--,a===i?o=void 0:(Wi=o,o=i),o!==i?r=n=[n,o]:(Wi=r,r=i)):(Wi=r,r=i)),r!==i&&(t,r=I()),(t=r)===i)if(t=Wi,(r=ao())!==i){for(n=[],o=Wi,(a=ya())!==i&&(s=pa())!==i&&(l=ya())!==i&&(c=ao())!==i?o=a=[a,s,l,c]:(Wi=o,o=i);o!==i;)n.push(o),o=Wi,(a=ya())!==i&&(s=pa())!==i&&(l=ya())!==i&&(c=ao())!==i?o=a=[a,s,l,c]:(Wi=o,o=i);n!==i?(t,t=r=F(r,n)):(Wi=t,t=i)}else Wi=t,t=i;return Ji--,t===i&&(r=i,0===Ji&&$i(O)),t}function ao(){var e,t,r;return e=Wi,(t=Co())!==i&&ya()!==i?((r=function(){var e,t,r;e=Wi,(t=ea())===i&&(t=null);t!==i&&ya()!==i&&(r=Oo())!==i?(e,t=G(r),e=t):(Wi=e,e=i);return e}())===i&&(r=null),r!==i?(e,e=t=N(t,r)):(Wi=e,e=i)):(Wi=e,e=i),e}function so(){var t,r;return t=Wi,function(){var t,r,n,o;t=Wi,e.substr(Wi,4).toLowerCase()===$r?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(en));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}()!==i&&ya()!==i&&(r=function(){var e,t,r,n;if(e=Wi,(t=co())!==i){for(r=[],n=lo();n!==i;)r.push(n),n=lo();r!==i?(e,t=D(t,r),e=t):(Wi=e,e=i)}else Wi=e,e=i;return e}())!==i?(t,t=j(r)):(Wi=t,t=i),t}function lo(){var e,t,r;return e=Wi,ya()!==i&&(t=pa())!==i&&ya()!==i&&(r=co())!==i?(e,e=B(r)):(Wi=e,e=i),e===i&&(e=Wi,ya()!==i&&(t=function(){var e,t,r,n;e=Wi,(t=uo())!==i&&ya()!==i&&(r=co())!==i&&ya()!==i?((n=po())===i&&(n=null),n!==i?(e,t=U(t,r,n),e=t):(Wi=e,e=i)):(Wi=e,e=i);return e}())!==i?(e,e=B(t)):(Wi=e,e=i)),e}function co(){var e,t,r,n;return e=Wi,(t=fo())!==i&&ya()!==i?((r=ea())===i&&(r=null),r!==i&&ya()!==i?((n=Oo())===i&&(n=null),n!==i?(e,e=t=z(t,n)):(Wi=e,e=i)):(Wi=e,e=i)):(Wi=e,e=i),e}function uo(){var t,r,n,o;return t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,4).toLowerCase()===un?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(fn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(n=ya())!==i&&(o=ta())!==i?(t,t=r=W()):(Wi=t,t=i),t===i&&(t=Wi,r=Wi,(n=function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===pn?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(hn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(o=ya())!==i?r=n=[n,o]:(Wi=r,r=i),r===i&&(r=null),r!==i&&(n=ta())!==i?(t,t=r=Y()):(Wi=t,t=i)),t}function fo(){var t,r,n,o,a,s,l,c;return t=Wi,96===e.charCodeAt(Wi)?(r=V,Wi++):(r=i,0===Ji&&$i(q)),r===i&&(r=null),r!==i&&(n=Oo())!==i?(o=Wi,(a=ya())!==i&&(s=fa())!==i&&(l=ya())!==i&&(c=No())!==i?o=a=[a,s,l,c]:(Wi=o,o=i),o===i&&(o=null),o!==i?(96===e.charCodeAt(Wi)?(a=V,Wi++):(a=i,0===Ji&&$i(q)),a===i&&(a=null),a!==i?(t,t=r=J(n,o)):(Wi=t,t=i)):(Wi=t,t=i)):(Wi=t,t=i),t===i&&(t=Wi,(r=xa())!==i&&(t,r=H(r)),t=r),t}function po(){var t,r;return t=Wi,function(){var t,r,n,o;t=Wi,e.substr(Wi,2).toLowerCase()===ln?(r=e.substr(Wi,2),Wi+=2):(r=i,0===Ji&&$i(cn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}()!==i&&ya()!==i&&(r=_o())!==i?(t,t=X(r)):(Wi=t,t=i),t}function ho(){var t,r;return t=Wi,function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===Ln?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(Pn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}()!==i&&ya()!==i&&(r=_o())!==i?(t,t=X(r)):(Wi=t,t=i),t}function yo(){var t,r,n;return t=Wi,(r=_o())!==i&&ya()!==i?((n=function(){var t,r,n,o;t=Wi,e.substr(Wi,4).toLowerCase()===Gn?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(jn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,r=Dn(),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())===i&&(n=function(){var t,r,n,o;t=Wi,e.substr(Wi,3).toLowerCase()===In?(r=e.substr(Wi,3),Wi+=3):(r=i,0===Ji&&$i(Fn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,r=Nn(),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}()),n===i&&(n=null),n!==i?(t,t=r=Q(r,n)):(Wi=t,t=i)):(Wi=t,t=i),t}function mo(){var e;return(e=function(){var e,t;Ji++,e=Wi,(t=Jo())!==i&&(e,t=sr(t));Ji--,(e=t)===i&&(t=i,0===Ji&&$i(ar));return e}())===i&&(e=Bo()),e}function go(){var t,r,n,o;return t=Wi,(r=Fo())!==i&&ya()!==i?(61===e.charCodeAt(Wi)?(n=w,Wi++):(n=i,0===Ji&&$i(S)),n!==i&&ya()!==i&&(o=Co())!==i?(t,t=r=$(r,o)):(Wi=t,t=i)):(Wi=t,t=i),t}function vo(){var e,t;return e=Wi,ha()!==i&&ya()!==i&&(t=bo())!==i&&ya()!==i&&da()!==i?(e,e=ne(t)):(Wi=e,e=i),e}function bo(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=_o())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=_o())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=_o())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=ie(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function _o(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=wo())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=ua())!==i&&(s=ya())!==i&&(l=wo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=ua())!==i&&(s=ya())!==i&&(l=wo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=se(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function wo(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=So())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=ca())!==i&&(s=ya())!==i&&(l=So())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=ca())!==i&&(s=ya())!==i&&(l=So())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=se(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function So(){var t,r,n,o,a;return t=Wi,(r=la())===i&&(r=Wi,33===e.charCodeAt(Wi)?(n=le,Wi++):(n=i,0===Ji&&$i(ce)),n!==i?(o=Wi,Ji++,61===e.charCodeAt(Wi)?(a=w,Wi++):(a=i,0===Ji&&$i(S)),Ji--,a===i?o=void 0:(Wi=o,o=i),o!==i?r=n=[n,o]:(Wi=r,r=i)):(Wi=r,r=i)),r!==i&&(n=ya())!==i&&(o=So())!==i?(t,t=r=ue(o)):(Wi=t,t=i),t===i&&(t=xo()),t}function xo(){var t,r,n;return t=Wi,(r=Co())!==i&&ya()!==i?((n=function(){var t;(t=function(){var e,t,r,n,o,a,s;e=Wi,t=[],r=Wi,(n=ya())!==i&&(o=Lo())!==i&&(a=ya())!==i&&(s=Co())!==i?r=n=[n,o,a,s]:(Wi=r,r=i);if(r!==i)for(;r!==i;)t.push(r),r=Wi,(n=ya())!==i&&(o=Lo())!==i&&(a=ya())!==i&&(s=Co())!==i?r=n=[n,o,a,s]:(Wi=r,r=i);else t=i;t!==i&&(e,t=pe(t));return e=t}())===i&&(t=function(){var e,t,r,n;e=Wi,(t=Po())!==i&&ya()!==i&&(r=ha())!==i&&ya()!==i&&(n=bo())!==i&&ya()!==i&&da()!==i?(e,t=Te(t,n),e=t):(Wi=e,e=i);e===i&&(e=Wi,(t=Po())!==i&&ya()!==i&&(r=xa())!==i?(e,t=Ae(t,r),e=t):(Wi=e,e=i));return e}())===i&&(t=function(){var t,r,n,o;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,7).toLowerCase()===qn?(r=e.substr(Wi,7),Wi+=7):(r=i,0===Ji&&$i(Jn));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,r=Hn(),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&(n=Co())!==i&&ya()!==i&&ca()!==i&&ya()!==i&&(o=Co())!==i?(t,r=Ee(r,n,o),t=r):(Wi=t,t=i);return t}())===i&&(t=function(){var t,r,n;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,2).toLowerCase()===Kn?(r=e.substr(Wi,2),Wi+=2):(r=i,0===Ji&&$i($n));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,r=ei(),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&(n=Co())!==i?(t,r=Pe(r,n),t=r):(Wi=t,t=i);return t}())===i&&(t=function(){var e,t,r;e=Wi,(t=function(){var e,t,r,n,o;e=Wi,t=Wi,(r=la())!==i&&(n=ya())!==i&&(o=aa())!==i?t=r=[r,n,o]:(Wi=t,t=i);t!==i&&(e,t=Ce(t));(e=t)===i&&(e=aa());return e}())!==i&&ya()!==i&&(r=xo())!==i?(e,t=Pe(t,r),e=t):(Wi=e,e=i);return e}())===i&&(t=function(){var e,t,r,n;e=Wi,(t=Eo())!==i&&ya()!==i&&(r=ha())!==i&&ya()!==i&&(n=bo())!==i&&ya()!==i&&da()!==i?(e,t=Te(t,n),e=t):(Wi=e,e=i);e===i&&(e=Wi,(t=Eo())!==i&&ya()!==i&&(r=xa())!==i?(e,t=Ae(t,r),e=t):(Wi=e,e=i));return e}());return t}())===i&&(n=null),n!==i?(t,t=r=fe(r,n)):(Wi=t,t=i)):(Wi=t,t=i),t}function Lo(){var t;return e.substr(Wi,2)===he?(t=he,Wi+=2):(t=i,0===Ji&&$i(de)),t===i&&(62===e.charCodeAt(Wi)?(t=ye,Wi++):(t=i,0===Ji&&$i(me)),t===i&&(e.substr(Wi,2)===ge?(t=ge,Wi+=2):(t=i,0===Ji&&$i(ve)),t===i&&(e.substr(Wi,2)===be?(t=be,Wi+=2):(t=i,0===Ji&&$i(_e)),t===i&&(60===e.charCodeAt(Wi)?(t=we,Wi++):(t=i,0===Ji&&$i(Se)),t===i&&(61===e.charCodeAt(Wi)?(t=w,Wi++):(t=i,0===Ji&&$i(S)),t===i&&(e.substr(Wi,2)===xe?(t=xe,Wi+=2):(t=i,0===Ji&&$i(Le)))))))),t}function Po(){var e,t,r,n,o;return e=Wi,t=Wi,(r=la())!==i&&(n=ya())!==i&&(o=oa())!==i?t=r=[r,n,o]:(Wi=t,t=i),t!==i&&(e,t=Ce(t)),(e=t)===i&&(e=oa()),e}function Eo(){var e,t,r,n,o;return e=Wi,t=Wi,(r=la())!==i&&(n=ya())!==i&&(o=sa())!==i?t=r=[r,n,o]:(Wi=t,t=i),t!==i&&(e,t=Ce(t)),(e=t)===i&&(e=sa()),e}function Co(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=Ao())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=To())!==i&&(s=ya())!==i&&(l=Ao())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=To())!==i&&(s=ya())!==i&&(l=Ao())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=se(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function To(){var t;return 43===e.charCodeAt(Wi)?(t=Re,Wi++):(t=i,0===Ji&&$i(Me)),t===i&&(45===e.charCodeAt(Wi)?(t=ke,Wi++):(t=i,0===Ji&&$i(Oe))),t}function Ao(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=Mo())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=Ro())!==i&&(s=ya())!==i&&(l=Mo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=Ro())!==i&&(s=ya())!==i&&(l=Mo())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=Ie(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function Ro(){var t;return 42===e.charCodeAt(Wi)?(t=Fe,Wi++):(t=i,0===Ji&&$i(Ne)),t===i&&(47===e.charCodeAt(Wi)?(t=Ge,Wi++):(t=i,0===Ji&&$i(je)),t===i&&(37===e.charCodeAt(Wi)?(t=De,Wi++):(t=i,0===Ji&&$i(Be)))),t}function Mo(){var t,r;return(t=zo())===i&&(t=function(){var t;(t=function(){var t,r,n;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===mi?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(gi));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,r=vi(),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&ya()!==i&&ha()!==i&&ya()!==i&&(n=function(){var t,r,n;t=Wi,(r=function(){var t,r;t=Wi,42===e.charCodeAt(Wi)?(r=Fe,Wi++):(r=i,0===Ji&&$i(Ne));r!==i&&(t,r=yt());return t=r}())!==i&&(t,r=ht(r));(t=r)===i&&(t=Wi,(r=ia())===i&&(r=null),r!==i&&ya()!==i&&(n=ko())!==i?(t,r=dt(r,n),t=r):(Wi=t,t=i));return t}())!==i&&ya()!==i&&da()!==i?(t,r=pt(r,n),t=r):(Wi=t,t=i);return t}())===i&&(t=function(){var t,r,n;t=Wi,(r=function(){var t,r,n;t=Wi,r=[],ct.test(e.charAt(Wi))?(n=e.charAt(Wi),Wi++):(n=i,0===Ji&&$i(ut));if(n!==i)for(;n!==i;)r.push(n),ct.test(e.charAt(Wi))?(n=e.charAt(Wi),Wi++):(n=i,0===Ji&&$i(ut));else r=i;r!==i&&(t,r=ft(r));return t=r}())!==i&&ya()!==i&&ha()!==i&&ya()!==i&&(n=Co())!==i&&ya()!==i&&da()!==i?(t,r=lt(r,n),t=r):(Wi=t,t=i);return t}());return t}())===i&&(t=Uo())===i&&(t=ko())===i&&(t=Bo())===i&&(t=Wi,ha()!==i&&ya()!==i&&(r=_o())!==i&&ya()!==i&&da()!==i?(t,t=Ue(r)):(Wi=t,t=i),t===i&&(t=xa())),t}function ko(){var e,t,r;return e=Wi,(t=Oo())!==i&&ya()!==i&&fa()!==i&&ya()!==i&&(r=Io())!==i?(e,e=t=ze(t,r)):(Wi=e,e=i),e===i&&(e=Wi,(t=Io())!==i&&(e,t=We(t)),e=t),e}function Oo(){var e,t;return e=Wi,(t=No())!==i?(Wi,(Ye(t)?i:void 0)!==i?(e,e=t=Ve(t)):(Wi=e,e=i)):(Wi=e,e=i),e}function Io(){var t,r,n,o;if(t=Wi,(r=Fo())!==i?(Wi,(n=(n=Ye(r))?i:void 0)!==i?(t,t=r=Ve(r)):(Wi=t,t=i)):(Wi=t,t=i),t===i)if(t=Wi,96===e.charCodeAt(Wi)?(r=V,Wi++):(r=i,0===Ji&&$i(q)),r!==i){if(n=[],qe.test(e.charAt(Wi))?(o=e.charAt(Wi),Wi++):(o=i,0===Ji&&$i(Je)),o!==i)for(;o!==i;)n.push(o),qe.test(e.charAt(Wi))?(o=e.charAt(Wi),Wi++):(o=i,0===Ji&&$i(Je));else n=i;n!==i?(96===e.charCodeAt(Wi)?(o=V,Wi++):(o=i,0===Ji&&$i(q)),o!==i?(t,t=r=He(n)):(Wi=t,t=i)):(Wi=t,t=i)}else Wi=t,t=i;return t}function Fo(){var e,t,r,n;if(e=Wi,(t=Go())!==i){for(r=[],n=Do();n!==i;)r.push(n),n=Do();r!==i?(e,e=t=Xe(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function No(){var e,t,r,n;if(e=Wi,(t=Go())!==i){for(r=[],n=jo();n!==i;)r.push(n),n=jo();r!==i?(e,e=t=Xe(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function Go(){var t;return Qe.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(Ze)),t}function jo(){var t;return Ke.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i($e)),t}function Do(){var t;return et.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(tt)),t}function Bo(){var t,r,n;return Ji++,t=Wi,58===e.charCodeAt(Wi)?(r=nt,Wi++):(r=i,0===Ji&&$i(it)),r!==i&&(n=No())!==i?t=r=[r,n]:(Wi=t,t=i),t===i&&(t=Wi,63===e.charCodeAt(Wi)?(r=ot,Wi++):(r=i,0===Ji&&$i(at)),r!==i&&(t,r=st(r)),t=r),Ji--,t===i&&(r=i,0===Ji&&$i(rt)),t}function Uo(){var e,t,r;return e=Wi,(t=Oo())!==i&&ya()!==i&&ha()!==i&&ya()!==i&&(r=function(){var e,t;return(e=bo())===i&&(e=Wi,(t=oe)!==i&&(e,t=ae()),e=t),e}())!==i&&ya()!==i&&da()!==i?(e,e=t=mt(t,r)):(Wi=e,e=i),e}function zo(){var t;return(t=function(){var t,r,n,o,a;t=Wi,r=Wi,34===e.charCodeAt(Wi)?(n=_t,Wi++):(n=i,0===Ji&&$i(wt));if(n!==i){for(o=[],a=Yo();a!==i;)o.push(a),a=Yo();o!==i?(34===e.charCodeAt(Wi)?(a=_t,Wi++):(a=i,0===Ji&&$i(wt)),a!==i?r=n=[n,o,a]:(Wi=r,r=i)):(Wi=r,r=i)}else Wi=r,r=i;if(r===i)if(r=Wi,39===e.charCodeAt(Wi)?(n=St,Wi++):(n=i,0===Ji&&$i(xt)),n!==i){for(o=[],a=Wo();a!==i;)o.push(a),a=Wo();o!==i?(39===e.charCodeAt(Wi)?(a=St,Wi++):(a=i,0===Ji&&$i(xt)),a!==i?r=n=[n,o,a]:(Wi=r,r=i)):(Wi=r,r=i)}else Wi=r,r=i;r!==i&&(t,r=Lt(r));return t=r}())===i&&(t=qo())===i&&(t=function(){var t,r;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,4).toLowerCase()===Fr?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(Nr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(t,r=vt());(t=r)===i&&(t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,5).toLowerCase()===Gr?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(jr));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(t,r=bt()),t=r);return t}())===i&&(t=function(){var t,r;t=Wi,(r=function(){var t,r,n,o;t=Wi,e.substr(Wi,4).toLowerCase()===Or?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(Ir));r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(t,r=gt());return t=r}()),t}function Wo(){var t;return Pt.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(Et)),t===i&&(t=Vo()),t}function Yo(){var t;return Ct.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(Tt)),t===i&&(t=Vo()),t}function Vo(){var t,r,n,o,a,s;return t=Wi,e.substr(Wi,2)===At?(r=At,Wi+=2):(r=i,0===Ji&&$i(Rt)),r!==i&&(t,r=Mt()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===kt?(r=kt,Wi+=2):(r=i,0===Ji&&$i(Ot)),r!==i&&(t,r=It()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===Ft?(r=Ft,Wi+=2):(r=i,0===Ji&&$i(Nt)),r!==i&&(t,r=Gt()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===jt?(r=jt,Wi+=2):(r=i,0===Ji&&$i(Dt)),r!==i&&(t,r=Bt()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===Ut?(r=Ut,Wi+=2):(r=i,0===Ji&&$i(zt)),r!==i&&(t,r=Wt()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===Yt?(r=Yt,Wi+=2):(r=i,0===Ji&&$i(Vt)),r!==i&&(t,r=qt()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===Jt?(r=Jt,Wi+=2):(r=i,0===Ji&&$i(Ht)),r!==i&&(t,r=Xt()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===Qt?(r=Qt,Wi+=2):(r=i,0===Ji&&$i(Zt)),r!==i&&(t,r=Kt()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===$t?(r=$t,Wi+=2):(r=i,0===Ji&&$i(er)),r!==i&&(t,r=tr()),(t=r)===i&&(t=Wi,e.substr(Wi,2)===rr?(r=rr,Wi+=2):(r=i,0===Ji&&$i(nr)),r!==i&&(n=$o())!==i&&(o=$o())!==i&&(a=$o())!==i&&(s=$o())!==i?(t,t=r=ir(n,o,a,s)):(Wi=t,t=i)))))))))),t}function qo(){var e,t;return e=Wi,(t=function(){var e,t,r,n;e=Wi,(t=Jo())!==i&&(r=Ho())!==i&&(n=Xo())!==i&&ya()!==i?(e,t=lr(t,r,n),e=t):(Wi=e,e=i);e===i&&(e=Wi,(t=Jo())!==i&&(r=Ho())!==i&&(n=ya())!==i?(e,t=cr(t,r),e=t):(Wi=e,e=i),e===i&&(e=Wi,(t=Jo())!==i&&(r=Xo())!==i&&(n=ya())!==i?(e,t=ur(t,r),e=t):(Wi=e,e=i),e===i&&(e=Wi,(t=Jo())!==i&&(r=ya())!==i?(e,t=fr(t),e=t):(Wi=e,e=i))));return e}())!==i&&(e,t=or(t)),e=t}function Jo(){var t,r,n,o;return t=Wi,(r=Ko())!==i&&(n=Qo())!==i?(t,t=r=pr(r,n)):(Wi=t,t=i),t===i&&(t=Zo())===i&&(t=Wi,45===e.charCodeAt(Wi)?(r=ke,Wi++):(r=i,0===Ji&&$i(Oe)),r===i&&(43===e.charCodeAt(Wi)?(r=Re,Wi++):(r=i,0===Ji&&$i(Me))),r!==i&&(n=Ko())!==i&&(o=Qo())!==i?(t,t=r=hr(r,n,o)):(Wi=t,t=i),t===i&&(t=Wi,45===e.charCodeAt(Wi)?(r=ke,Wi++):(r=i,0===Ji&&$i(Oe)),r===i&&(43===e.charCodeAt(Wi)?(r=Re,Wi++):(r=i,0===Ji&&$i(Me))),r!==i&&(n=Zo())!==i?(t,t=r=dr(r,n)):(Wi=t,t=i))),t}function Ho(){var t,r,n;return t=Wi,46===e.charCodeAt(Wi)?(r=yr,Wi++):(r=i,0===Ji&&$i(mr)),r!==i&&(n=Qo())!==i?(t,t=r=gr(n)):(Wi=t,t=i),t}function Xo(){var t,r,n;return t=Wi,(r=function(){var t,r,n;t=Wi,Tr.test(e.charAt(Wi))?(r=e.charAt(Wi),Wi++):(r=i,0===Ji&&$i(Ar));r!==i?(Rr.test(e.charAt(Wi))?(n=e.charAt(Wi),Wi++):(n=i,0===Ji&&$i(Mr)),n===i&&(n=null),n!==i?(t,r=kr(r,n),t=r):(Wi=t,t=i)):(Wi=t,t=i);return t}())!==i&&(n=Qo())!==i?(t,t=r=vr(r,n)):(Wi=t,t=i),t}function Qo(){var e,t,r;if(e=Wi,t=[],(r=Zo())!==i)for(;r!==i;)t.push(r),r=Zo();else t=i;return t!==i&&(e,t=br(t)),e=t}function Zo(){var t;return Ji++,wr.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(Sr)),Ji--,t===i&&(i,0===Ji&&$i(_r)),t}function Ko(){var t;return Ji++,xr.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(Lr)),Ji--,t===i&&(i,0===Ji&&$i(_r)),t}function $o(){var t;return Ji++,Er.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(Cr)),Ji--,t===i&&(i,0===Ji&&$i(Pr)),t}function ea(){var t,r,n,o;return t=Wi,e.substr(Wi,2).toLowerCase()===nn?(r=e.substr(Wi,2),Wi+=2):(r=i,0===Ji&&$i(on)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i),t}function ta(){var t,r,n,o;return t=Wi,e.substr(Wi,4).toLowerCase()===dn?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(yn)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i),t}function ra(){var t,r,n,o;return t=Wi,e.substr(Wi,5).toLowerCase()===mn?(r=e.substr(Wi,5),Wi+=5):(r=i,0===Ji&&$i(gn)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i),t}function na(){var t,r,n,o;return t=Wi,e.substr(Wi,2).toLowerCase()===Tn?(r=e.substr(Wi,2),Wi+=2):(r=i,0===Ji&&$i(An)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?t=r=[r,n]:(Wi=t,t=i)):(Wi=t,t=i),t}function ia(){var t,r,n,o;return t=Wi,e.substr(Wi,8).toLowerCase()===Wn?(r=e.substr(Wi,8),Wi+=8):(r=i,0===Ji&&$i(Yn)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,t=r=Vn()):(Wi=t,t=i)):(Wi=t,t=i),t}function oa(){var t,r,n,o;return t=Wi,e.substr(Wi,2).toLowerCase()===Xn?(r=e.substr(Wi,2),Wi+=2):(r=i,0===Ji&&$i(Qn)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,t=r=Zn()):(Wi=t,t=i)):(Wi=t,t=i),t}function aa(){var t,r,n,o;return t=Wi,e.substr(Wi,4).toLowerCase()===ti?(r=e.substr(Wi,4),Wi+=4):(r=i,0===Ji&&$i(ri)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,t=r=ni()):(Wi=t,t=i)):(Wi=t,t=i),t}function sa(){var t,r,n,o;return t=Wi,e.substr(Wi,8).toLowerCase()===ii?(r=e.substr(Wi,8),Wi+=8):(r=i,0===Ji&&$i(oi)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,t=r=ai()):(Wi=t,t=i)):(Wi=t,t=i),t}function la(){var t,r,n,o;return t=Wi,e.substr(Wi,3).toLowerCase()===si?(r=e.substr(Wi,3),Wi+=3):(r=i,0===Ji&&$i(li)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,t=r=ci()):(Wi=t,t=i)):(Wi=t,t=i),t}function ca(){var t,r,n,o;return t=Wi,e.substr(Wi,3).toLowerCase()===ui?(r=e.substr(Wi,3),Wi+=3):(r=i,0===Ji&&$i(fi)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,t=r=pi()):(Wi=t,t=i)):(Wi=t,t=i),t}function ua(){var t,r,n,o;return t=Wi,e.substr(Wi,2).toLowerCase()===hi?(r=e.substr(Wi,2),Wi+=2):(r=i,0===Ji&&$i(di)),r!==i?(n=Wi,Ji++,o=Go(),Ji--,o===i?n=void 0:(Wi=n,n=i),n!==i?(t,t=r=yi()):(Wi=t,t=i)):(Wi=t,t=i),t}function fa(){var t;return 46===e.charCodeAt(Wi)?(t=yr,Wi++):(t=i,0===Ji&&$i(mr)),t}function pa(){var t;return 44===e.charCodeAt(Wi)?(t=bi,Wi++):(t=i,0===Ji&&$i(_i)),t}function ha(){var t;return 40===e.charCodeAt(Wi)?(t=u,Wi++):(t=i,0===Ji&&$i(f)),t}function da(){var t;return 41===e.charCodeAt(Wi)?(t=p,Wi++):(t=i,0===Ji&&$i(h)),t}function ya(){var e,t;for(e=[],t=ma();t!==i;)e.push(t),t=ma();return e}function ma(){var t;return Ji++,Ei.test(e.charAt(Wi))?(t=e.charAt(Wi),Wi++):(t=i,0===Ji&&$i(Ci)),Ji--,t===i&&(i,0===Ji&&$i(Pi)),t}function ga(){var t,r,n,o;return t=Wi,r=Wi,Ji++,n=function(){var e,t;e=Wi,(t=oe)!==i&&(e,t=Ai());return e=t}(),Ji--,n!==i?(Wi=r,r=void 0):r=i,r!==i&&(n=ya())!==i?((o=function(){var t,r,n;t=Wi,(r=xa())!==i&&ya()!==i&&function(){var t;e.substr(Wi,2)===Ui?(t=Ui,Wi+=2):(t=i,0===Ji&&$i(zi));return t}()!==i&&ya()!==i&&(n=va())!==i?(t,r=Ri(r,n),t=r):(Wi=t,t=i);return t}())===i&&(o=function(){var t,r,n;t=Wi,(r=function(){var t;e.substr(Wi,6).toLowerCase()===Di?(t=e.substr(Wi,6),Wi+=6):(t=i,0===Ji&&$i(Bi));return t}())!==i&&ya()!==i&&(n=va())!==i?(t,r=Mi(n),t=r):(Wi=t,t=i);return t}()),o!==i?(t,t=r=Ti(o)):(Wi=t,t=i)):(Wi=t,t=i),t}function va(){var t;return(t=io())===i&&(t=function(){var e,t,r,n,o;e=Wi,(t=xa())!==i&&ya()!==i&&(r=uo())!==i&&ya()!==i&&(n=xa())!==i&&ya()!==i&&(o=po())!==i?(e,t=ki(t,r,n,o),e=t):(Wi=e,e=i);return e}())===i&&(t=ba())===i&&(t=function(){var t,r,n;t=Wi,(r=function(){var t;return 91===e.charCodeAt(Wi)?(t=wi,Wi++):(t=i,0===Ji&&$i(Si)),t}())!==i&&ya()!==i&&(n=Sa())!==i&&ya()!==i&&function(){var t;return 93===e.charCodeAt(Wi)?(t=xi,Wi++):(t=i,0===Ji&&$i(Li)),t}()!==i?(t,r=Ii(n),t=r):(Wi=t,t=i);return t}()),t}function ba(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=_a())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=To())!==i&&(s=ya())!==i&&(l=_a())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=To())!==i&&(s=ya())!==i&&(l=_a())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=se(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function _a(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=wa())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=Ro())!==i&&(s=ya())!==i&&(l=wa())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=Ro())!==i&&(s=ya())!==i&&(l=wa())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=se(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function wa(){var e,t;return(e=zo())===i&&(e=xa())===i&&(e=function(){var e,t,r;e=Wi,(t=Oo())!==i&&ya()!==i&&ha()!==i&&ya()!==i&&(r=Sa())!==i&&ya()!==i&&da()!==i?(e,t=Oi(t,r),e=t):(Wi=e,e=i);return e}())===i&&(e=Bo())===i&&(e=Wi,ha()!==i&&ya()!==i&&(t=ba())!==i&&ya()!==i&&da()!==i?(e,e=Ue(t)):(Wi=e,e=i)),e}function Sa(){var e,t,r,n,o,a,s,l;if(e=Wi,(t=wa())!==i){for(r=[],n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=wa())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);n!==i;)r.push(n),n=Wi,(o=ya())!==i&&(a=pa())!==i&&(s=ya())!==i&&(l=wa())!==i?n=o=[o,a,s,l]:(Wi=n,n=i);r!==i?(e,e=t=F(t,r)):(Wi=e,e=i)}else Wi=e,e=i;return e}function xa(){var t,r,n;return t=Wi,function(){var t;36===e.charCodeAt(Wi)?(t=Gi,Wi++):(t=i,0===Ji&&$i(ji));return t}()!==i&&(r=No())!==i&&(n=function(){var t,r,n,o,a;t=Wi,r=[],n=Wi,46===e.charCodeAt(Wi)?(o=yr,Wi++):(o=i,0===Ji&&$i(mr));o!==i&&(a=No())!==i?n=o=[o,a]:(Wi=n,n=i);for(;n!==i;)r.push(n),n=Wi,46===e.charCodeAt(Wi)?(o=yr,Wi++):(o=i,0===Ji&&$i(mr)),o!==i&&(a=No())!==i?n=o=[o,a]:(Wi=n,n=i);r!==i&&(t,r=Ni(r));return t=r}())!==i?(t,t=Fi(r,n)):(Wi=t,t=i),t}function La(e,t,r){return{type:"binary_expr",operator:e,left:t,right:r}}function Pa(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}function Ea(e,t){for(var r=e,n=0;n<t.length;n++)r=La(t[n][1],r,t[n][3]);return r}var Ca={SHOW:!0,DROP:!0,SELECT:!0,UPDATE:!0,CREATE:!0,DELETE:!0,INSERT:!0,REPLACE:!0,EXPLAIN:!0,ALL:!0,DISTINCT:!0,AS:!0,TABLE:!0,INTO:!0,FROM:!0,SET:!0,LEFT:!0,ON:!0,INNER:!0,JOIN:!0,UNION:!0,VALUES:!0,EXISTS:!0,WHERE:!0,GROUP:!0,BY:!0,HAVING:!0,ORDER:!0,ASC:!0,DESC:!0,LIMIT:!0,BETWEEN:!0,IN:!0,IS:!0,LIKE:!0,CONTAINS:!0,NOT:!0,AND:!0,OR:!0,TRUE:!0,FALSE:!0,NULL:!0},Ta=[],Aa=[];if((r=a())!==i&&Wi===e.length)return r;throw r!==i&&Wi<e.length&&$i({type:"end"}),eo(qi,Vi<e.length?e.charAt(Vi):null,Vi<e.length?Ki(Vi,Vi+1):Ki(Vi,Vi))}}},function(e,t){"function"==typeof Symbol&&Symbol.iterator;var r={"\0":"\\0","'":"\\'",'"':'\\"',"\b":"\\b","\n":"\\n","\r":"\\r","\t":"\\t","":"\\Z","\\":"\\\\"};function n(e){var t=e.type,n=e.value;return"string"===t?n="'"+function(e){for(var t,n,i=[],o=0;o<e.length;o++)t=e[o],(n=r[t])&&(t=n),i.push(t);return i.join("")}(n)+"'":"bool"===t?n=n?"TRUE":"FALSE":"null"===t?n="NULL":"star"===t&&(n="*"),e.paren?"("+n+")":n}function i(e){for(var t=[],r=0;r<e.length;r++)t.push(o(e[r]));return t}function o(e){var t;switch(e.type){case"unary_expr":t=function(e){var t=e.operator+" "+o(e.expr);return e.paren?"("+t+")":t}(e);break;case"binary_expr":t=function(e){var t=e.operator,r=e.left,n=e.right,i=o(r),a=o(n);Array.isArray(a)&&("="===t&&(t="IN"),a="BETWEEN"===t?a[0]+" AND "+a[1]:"("+a.join(", ")+")");var s=i+" "+t+" "+a;return e.paren?"("+s+")":s}(e);break;case"aggr_func":t=function(e){var t=e.args,r=o(t.expr),n=e.name;return"COUNT"===n&&t.distinct&&(r="DISTINCT "+r),n+"("+r+")"}(e);break;case"function":t=function(e){var t=o(e.args),r=e.name+"("+t.join(", ")+")";return e.paren?"("+r+")":r}(e);break;case"column_ref":t=function(e){var t=e.column;return e.table&&(t=e.table+"."+t),e.paren?"("+t+")":t}(e);break;case"expr_list":t=i(e.value);break;case"var":throw new Error("unsupported type `var`");case"param":t=function(e){return"?"===e.value?"?":":"+e.value}(e);break;default:t=n(e)}return t}function a(e,t){var r,n,a=e.distinct,s=e.columns,l=e.from,c=e.where,u=e.groupby,f=e.orderby,p=e.limit,h=[];if(t=t||{},h.push("SELECT"),a&&h.push(a),"*"===s)h.push("*");else{for(n=[],v=0;v<s.length;v++){var d=s[v];r=o(d.expr),d.as&&(r+=" AS "+d.as),n.push(r)}h.push(n.join(", "))}if(Array.isArray(l)){var y=l[0];for(h.push("FROM"),n=[],r=y.table,!1!==t.keep_db&&y.db&&(r=y.db+"."+r),y.as&&(r+=" AS "+y.as),n.push(r),v=1;v<l.length;v++){var m=l[v];r=m.join?" "+m.join+" ":", ",!1!==t.keep_db&&m.db&&(r+=m.db+"."),r+=m.table,m.as&&(r+=" AS "+m.as),m.on&&(r+=" ON "+o(m.on)),n.push(r)}h.push(n.join(""))}if(c&&h.push("WHERE "+o(c)),Array.isArray(u)){var g=i(u);h.push("GROUP BY "+g.join(", "))}if(Array.isArray(f)){n=[];for(var v=0;v<f.length;v++){var b=f[v];r=o(b.expr),r+=" "+b.type,n.push(r)}h.push("ORDER BY "+n.join(", "))}return Array.isArray(p)&&(r=!1!==t.offset?"LIMIT "+p[0].value+", "+p[1].value:"LIMIT "+(p[0].value+p[1].value),h.push(r)),h.join(" ")}e.exports=function(e,t){var r,n={keep_db:!0,offset:!1};for(var i in t)n[i]=t[i];switch(e.type){case"select":r=function(e,t){var r=a(e,t),n=[];for(n.push(r);e._next;)r=a(e._next,t),n.push("UNION"),n.push(r),e=e._next;return n.join(" ")}(e,n);break;case"update":r=function(e,t){var r=["UPDATE"];!1===(t=t||{}).keep_db?r.push(e.table):r.push(e.db+"."+e.table),r.push("SET");var n,i,a=[],s=e.set;for(n=0;n<s.length;n++)i=s[n].column+" = "+o(s[n].value),a.push(i);return r.push(a.join(", ")),e.where&&(i="WHERE ",i+=o(e.where),r.push(i)),r.join(" ")}(e,n);break;case"insert":case"replace":r=function(e,t){t=t||{};var r,n=[];n.push(e.type.toUpperCase()),n.push("INTO"),!1===t.keep_db?n.push(e.table):n.push(e.db+"."+e.table),n.push("("+e.columns.join(", ")+")"),n.push("VALUES");var i=[],a=e.values;for(r=0;r<a.length;r++){for(var s=a[r].value,l=[],c=0;c<s.length;c++)l.push(o(s[c]));i.push("("+l.join(", ")+")")}return n.push(i.join(", ")),n.join(" ")}(e,n);break;case"delete":default:throw new Error("ERROR TYPE :"+e.type+", NOT SUPPORTED")}return r},e.exports.exprToSQL=o},function(e,t,r){var n=r(37),i={TIANDITU:{VEC_C:{layers:"vec",matrixSet:"c",format:"tiles",tileType:102,crossOrigin:"*",url:"http://t0.tianditu.gov.cn/vec_c/wmts?tk={token}",projection:"EPSG:4326",token:""},CVA_C:{layers:"cva",matrixSet:"c",format:"tiles",tileType:102,crossOrigin:"*",url:"http://t0.tianditu.gov.cn/cva_c/wmts?tk={token}",projection:"EPSG:4326",token:""},IMG_C:{layers:"img",matrixSet:"c",format:"tiles",tileType:102,crossOrigin:"*",url:"http://t0.tianditu.gov.cn/img_c/wmts?tk={token}",projection:"EPSG:4326",token:""},CIA_C:{layers:"cia",matrixSet:"c",format:"tiles",tileType:102,crossOrigin:"*",url:"http://t0.tianditu.gov.cn/cia_c/wmts?tk={token}",projection:"EPSG:4326",token:""},TER_C:{layers:"ter",matrixSet:"c",format:"tiles",tileType:102,crossOrigin:"*",url:"http://t0.tianditu.gov.cn/ter_c/wmts?tk={token}",projection:"EPSG:4326",token:""},CTA_C:{layers:"cta",matrixSet:"c",format:"tiles",tileType:102,crossOrigin:"*",url:"http://t0.tianditu.gov.cn/cta_c/wmts?tk={token}",projection:"EPSG:4326",token:""}},BAIDU:{},GAODE:{},GOOGLE:{},WMS:{},WMTS:{layers:"",matrixSet:"",format:"",tileType:102,crossOrigin:"*",url:"",projection:"EPSG:4326"},XYZ:{},extend:function(e,t){var r=e.split("."),o=i;try{for(var a=0;a<r.length;a++)o=o[r[a]]}catch(t){throw new Error("key = "+e+" 不存在！")}var s=n(!0,{},o);return n(!0,s,t||{})}};e.exports=i},function(e,t,r){var n=r(179),i=r(70),o=(r(14),r(2),r(1),n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.gvInstance=null,this.gvOptions=null,this.initListeners()},destroy:function(){this.clear(),this.destroyGvInstance(),this.featureCol=null,this.gvOptions=null,n.prototype.destroy.call(this)},getGvInstance:function(e){},destroyGvInstance:function(){this.gvInstance&&(this.gvInstance.unbind(this.options.map),this.removeListeners(),this.gvInstance=null)},getGvOptions:function(){return this.gvOptions=this.options.renderOption.style||this.options.renderOption.chart,this.gvOptions},render:function(){var e=this.featureSet,t=i.featureSet2GeoJson(e),r=new gv.source.GeoJsonSource(t),n=this.getGvInstance();n.setDataSource(r),n.render()},clear:function(){this.layer.clear(),this.featureSet.features=[]},setVisible:function(e){var t=this.getGvInstance();return!!t&&(t.setVisible(!!e),!0)},getVisible:function(){var e=this.getGvInstance();if(e)return e.getVisible()},addListeners:function(){this.gvInstance&&(this.gvInstance.on("click",this.onClick),this.gvInstance.on("mouseover",this.onMouseOver),this.gvInstance.on("mouseout",this.onMouseOut))},removeListeners:function(){this.gvInstance&&(this.gvInstance.un("click",this.onClick),this.gvInstance.un("mouseover",this.onMouseOver),this.gvInstance.un("mouseout",this.onMouseOut))}}));e.exports=o},function(e,t,r){var n=r(69),i=r(70),o=r(1),a=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.featureSet=new o.sfs.FeatureSet,this.layer=new o.carto.FeatureLayer({}),this.fields=null},destroy:function(){this.featureSet=null,this.layer=null},add:function(e){for(var t=e.length,r=0;r<t;r++){var n=e[r],i=this.options.featureBuilder.buildFeature(n);i._original_data=n,this.featureSet.add(i)}this.layer.addFeatures(this.featureSet),this.render()},update:function(e){for(var t=e.length,r=0;r<t;r++){var n=e[r],o=i.getFeatureById(n[this.options.idField],this.featureSet);o.index>=0&&this.featureSet.features.splice(o.index,1);var a=this.options.featureBuilder.buildFeature(n);a._original_data=n,this.featureSet.add(a)}this.layer.addFeatures(this.featureSet),this.render()},remove:function(e){this.layer.clear();var t=i.getFeatureById(e,this.featureSet);t.index>=0&&this.featureSet.features.splice(t.index,1),this.render()},getLayer:function(){return this.layer},onResolutionChanged:function(e){var t=this.options.renderOption.zoomRange||[],r=-1,n=-1,i=Math.round(e.level);if(null!=this.lastLevel){if(i!=this.lastLevel){for(var o=0;o<t.length;o++){var a=t[o];i>=a.range[0]&&i<=a.range[1]&&(n=o),this.lastLevel>=a.range[0]&&this.lastLevel<=a.range[1]&&(r=o)}n!=r&&this.options.eventDispatcher.fire("zoomrangechange",{range:t[n]}),this.lastLevel=i}}else this.lastLevel=i},initListeners:function(){var e=this;this.onClick=function(t){e.options.eventDispatcher.listens("click")&&e.fireEvent("click",t)},this.onMouseOver=function(t){e.options.eventDispatcher.listens("mouseover")&&e.fireEvent("mouseover",t)},this.onMouseOut=function(t){e.options.eventDispatcher.listens("mouseout")&&e.fireEvent("mouseout",t)}},fireEvent:function(e,t){var r={};for(var n in t)r[n]=t[n];r.featureType=this.options.id,r.featureName=this.options.name,this.options.eventDispatcher.fire(e,r)}});e.exports=a},function(e,t,r){r(181),e.exports=r(383)},function(e,t,r){"use strict";(function(e){if(r(182),r(379),r(380),e._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");e._babelPolyfill=!0;var t="defineProperty";function n(e,r,n){e[r]||Object[t](e,r,{writable:!0,configurable:!0,value:n})}n(String.prototype,"padLeft","".padStart),n(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach((function(e){[][e]&&n(Array,e,Function.call.bind([][e]))}))}).call(this,r(124))},function(e,t,r){r(183),r(186),r(187),r(188),r(189),r(190),r(191),r(192),r(193),r(194),r(195),r(196),r(197),r(198),r(199),r(200),r(201),r(202),r(203),r(204),r(205),r(206),r(207),r(208),r(209),r(210),r(211),r(212),r(213),r(214),r(215),r(216),r(217),r(218),r(219),r(220),r(221),r(222),r(223),r(224),r(225),r(226),r(227),r(228),r(229),r(230),r(231),r(232),r(233),r(234),r(235),r(236),r(237),r(238),r(239),r(240),r(241),r(242),r(243),r(244),r(245),r(246),r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254),r(255),r(256),r(257),r(258),r(259),r(260),r(261),r(263),r(264),r(266),r(267),r(268),r(269),r(270),r(271),r(272),r(274),r(275),r(276),r(277),r(278),r(279),r(280),r(281),r(282),r(283),r(284),r(285),r(286),r(108),r(287),r(144),r(288),r(145),r(289),r(290),r(291),r(292),r(293),r(148),r(150),r(151),r(294),r(295),r(296),r(297),r(298),r(299),r(300),r(301),r(302),r(303),r(304),r(305),r(306),r(307),r(308),r(309),r(310),r(311),r(312),r(313),r(314),r(315),r(316),r(317),r(318),r(319),r(320),r(321),r(322),r(323),r(324),r(325),r(326),r(327),r(328),r(329),r(330),r(331),r(332),r(333),r(334),r(335),r(336),r(337),r(338),r(339),r(340),r(341),r(342),r(343),r(344),r(345),r(346),r(347),r(348),r(349),r(350),r(351),r(352),r(353),r(354),r(355),r(356),r(357),r(358),r(359),r(360),r(361),r(362),r(363),r(364),r(365),r(366),r(367),r(368),r(369),r(370),r(371),r(372),r(373),r(374),r(375),r(376),r(377),r(378),e.exports=r(27)},function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=r(4),o=r(23),a=r(10),s=r(0),l=r(20),c=r(42).KEY,u=r(5),f=r(62),p=r(58),h=r(47),d=r(7),y=r(126),m=r(89),g=r(185),v=r(73),b=r(3),_=r(6),w=r(13),S=r(24),x=r(32),L=r(46),P=r(50),E=r(129),C=r(25),T=r(72),A=r(12),R=r(48),M=C.f,k=A.f,O=E.f,I=i.Symbol,F=i.JSON,N=F&&F.stringify,G=d("_hidden"),j=d("toPrimitive"),D={}.propertyIsEnumerable,B=f("symbol-registry"),U=f("symbols"),z=f("op-symbols"),W=Object.prototype,Y="function"==typeof I&&!!T.f,V=i.QObject,q=!V||!V.prototype||!V.prototype.findChild,J=a&&u((function(){return 7!=P(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=M(W,t);n&&delete W[t],k(e,t,r),n&&e!==W&&k(W,t,n)}:k,H=function(e){var t=U[e]=P(I.prototype);return t._k=e,t},X=Y&&"symbol"==n(I.iterator)?function(e){return"symbol"==(void 0===e?"undefined":n(e))}:function(e){return e instanceof I},Q=function(e,t,r){return e===W&&Q(z,t,r),b(e),t=x(t,!0),b(r),o(U,t)?(r.enumerable?(o(e,G)&&e[G][t]&&(e[G][t]=!1),r=P(r,{enumerable:L(0,!1)})):(o(e,G)||k(e,G,L(1,{})),e[G][t]=!0),J(e,t,r)):k(e,t,r)},Z=function(e,t){b(e);for(var r,n=g(t=S(t)),i=0,o=n.length;o>i;)Q(e,r=n[i++],t[r]);return e},K=function(e){var t=D.call(this,e=x(e,!0));return!(this===W&&o(U,e)&&!o(z,e))&&(!(t||!o(this,e)||!o(U,e)||o(this,G)&&this[G][e])||t)},$=function(e,t){if(e=S(e),t=x(t,!0),e!==W||!o(U,t)||o(z,t)){var r=M(e,t);return!r||!o(U,t)||o(e,G)&&e[G][t]||(r.enumerable=!0),r}},ee=function(e){for(var t,r=O(S(e)),n=[],i=0;r.length>i;)o(U,t=r[i++])||t==G||t==c||n.push(t);return n},te=function(e){for(var t,r=e===W,n=O(r?z:S(e)),i=[],a=0;n.length>a;)!o(U,t=n[a++])||r&&!o(W,t)||i.push(U[t]);return i};Y||(l((I=function(){if(this instanceof I)throw TypeError("Symbol is not a constructor!");var e=h(arguments.length>0?arguments[0]:void 0),t=function t(r){this===W&&t.call(z,r),o(this,G)&&o(this[G],e)&&(this[G][e]=!1),J(this,e,L(1,r))};return a&&q&&J(W,e,{configurable:!0,set:t}),H(e)}).prototype,"toString",(function(){return this._k})),C.f=$,A.f=Q,r(51).f=E.f=ee,r(64).f=K,T.f=te,a&&!r(41)&&l(W,"propertyIsEnumerable",K,!0),y.f=function(e){return H(d(e))}),s(s.G+s.W+s.F*!Y,{Symbol:I});for(var re="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;re.length>ne;)d(re[ne++]);for(var ie=R(d.store),oe=0;ie.length>oe;)m(ie[oe++]);s(s.S+s.F*!Y,"Symbol",{for:function(e){return o(B,e+="")?B[e]:B[e]=I(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in B)if(B[t]===e)return t},useSetter:function(){q=!0},useSimple:function(){q=!1}}),s(s.S+s.F*!Y,"Object",{create:function(e,t){return void 0===t?P(e):Z(P(e),t)},defineProperty:Q,defineProperties:Z,getOwnPropertyDescriptor:$,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var ae=u((function(){T.f(1)}));s(s.S+s.F*ae,"Object",{getOwnPropertySymbols:function(e){return T.f(w(e))}}),F&&s(s.S+s.F*(!Y||u((function(){var e=I();return"[null]"!=N([e])||"{}"!=N({a:e})||"{}"!=N(Object(e))}))),"JSON",{stringify:function(e){for(var t,r,n=[e],i=1;arguments.length>i;)n.push(arguments[i++]);if(r=t=n[1],(_(t)||void 0!==e)&&!X(e))return v(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!X(t))return t}),n[1]=t,N.apply(F,n)}}),I.prototype[j]||r(19)(I.prototype,j,I.prototype.valueOf),p(I,"Symbol"),p(Math,"Math",!0),p(i.JSON,"JSON",!0)},function(e,t,r){e.exports=r(62)("native-function-to-string",Function.toString)},function(e,t,r){var n=r(48),i=r(72),o=r(64);e.exports=function(e){var t=n(e),r=i.f;if(r)for(var a,s=r(e),l=o.f,c=0;s.length>c;)l.call(e,a=s[c++])&&t.push(a);return t}},function(e,t,r){var n=r(0);n(n.S,"Object",{create:r(50)})},function(e,t,r){var n=r(0);n(n.S+n.F*!r(10),"Object",{defineProperty:r(12).f})},function(e,t,r){var n=r(0);n(n.S+n.F*!r(10),"Object",{defineProperties:r(128)})},function(e,t,r){var n=r(24),i=r(25).f;r(34)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(n(e),t)}}))},function(e,t,r){var n=r(13),i=r(26);r(34)("getPrototypeOf",(function(){return function(e){return i(n(e))}}))},function(e,t,r){var n=r(13),i=r(48);r(34)("keys",(function(){return function(e){return i(n(e))}}))},function(e,t,r){r(34)("getOwnPropertyNames",(function(){return r(129).f}))},function(e,t,r){var n=r(6),i=r(42).onFreeze;r(34)("freeze",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},function(e,t,r){var n=r(6),i=r(42).onFreeze;r(34)("seal",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},function(e,t,r){var n=r(6),i=r(42).onFreeze;r(34)("preventExtensions",(function(e){return function(t){return e&&n(t)?e(i(t)):t}}))},function(e,t,r){var n=r(6);r(34)("isFrozen",(function(e){return function(t){return!n(t)||!!e&&e(t)}}))},function(e,t,r){var n=r(6);r(34)("isSealed",(function(e){return function(t){return!n(t)||!!e&&e(t)}}))},function(e,t,r){var n=r(6);r(34)("isExtensible",(function(e){return function(t){return!!n(t)&&(!e||e(t))}}))},function(e,t,r){var n=r(0);n(n.S+n.F,"Object",{assign:r(130)})},function(e,t,r){var n=r(0);n(n.S,"Object",{is:r(131)})},function(e,t,r){var n=r(0);n(n.S,"Object",{setPrototypeOf:r(93).set})},function(e,t,r){"use strict";var n=r(59),i={};i[r(7)("toStringTag")]="z",i+""!="[object z]"&&r(20)(Object.prototype,"toString",(function(){return"[object "+n(this)+"]"}),!0)},function(e,t,r){var n=r(0);n(n.P,"Function",{bind:r(132)})},function(e,t,r){var n=r(12).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||r(10)&&n(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,r){"use strict";var n=r(6),i=r(26),o=r(7)("hasInstance"),a=Function.prototype;o in a||r(12).f(a,o,{value:function(e){if("function"!=typeof this||!n(e))return!1;if(!n(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,r){var n=r(0),i=r(134);n(n.G+n.F*(parseInt!=i),{parseInt:i})},function(e,t,r){var n=r(0),i=r(135);n(n.G+n.F*(parseFloat!=i),{parseFloat:i})},function(e,t,r){"use strict";var n=r(4),i=r(23),o=r(29),a=r(95),s=r(32),l=r(5),c=r(51).f,u=r(25).f,f=r(12).f,p=r(60).trim,h=n.Number,d=h,y=h.prototype,m="Number"==o(r(50)(y)),g="trim"in String.prototype,v=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var r,n,i,o=(t=g?t.trim():p(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(r=t.charCodeAt(2))||120===r)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:n=2,i=49;break;case 79:case 111:n=8,i=55;break;default:return+t}for(var a,l=t.slice(2),c=0,u=l.length;c<u;c++)if((a=l.charCodeAt(c))<48||a>i)return NaN;return parseInt(l,n)}}return+t};if(!h(" 0o1")||!h("0b1")||h("+0x1")){h=function(e){var t=arguments.length<1?0:e,r=this;return r instanceof h&&(m?l((function(){y.valueOf.call(r)})):"Number"!=o(r))?a(new d(v(t)),r,h):v(t)};for(var b,_=r(10)?c(d):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;_.length>w;w++)i(d,b=_[w])&&!i(h,b)&&f(h,b,u(d,b));h.prototype=y,y.constructor=h,r(20)(n,"Number",h)}},function(e,t,r){"use strict";var n=r(0),i=r(30),o=r(136),a=r(96),s=1..toFixed,l=Math.floor,c=[0,0,0,0,0,0],u="Number.toFixed: incorrect invocation!",f=function(e,t){for(var r=-1,n=t;++r<6;)n+=e*c[r],c[r]=n%1e7,n=l(n/1e7)},p=function(e){for(var t=6,r=0;--t>=0;)r+=c[t],c[t]=l(r/e),r=r%e*1e7},h=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==c[e]){var r=String(c[e]);t=""===t?r:t+a.call("0",7-r.length)+r}return t},d=function e(t,r,n){return 0===r?n:r%2==1?e(t,r-1,n*t):e(t*t,r/2,n)};n(n.P+n.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!r(5)((function(){s.call({})}))),"Number",{toFixed:function(e){var t,r,n,s,l=o(this,u),c=i(e),y="",m="0";if(c<0||c>20)throw RangeError(u);if(l!=l)return"NaN";if(l<=-1e21||l>=1e21)return String(l);if(l<0&&(y="-",l=-l),l>1e-21)if(r=(t=function(e){for(var t=0,r=e;r>=4096;)t+=12,r/=4096;for(;r>=2;)t+=1,r/=2;return t}(l*d(2,69,1))-69)<0?l*d(2,-t,1):l/d(2,t,1),r*=4503599627370496,(t=52-t)>0){for(f(0,r),n=c;n>=7;)f(1e7,0),n-=7;for(f(d(10,n,1),0),n=t-1;n>=23;)p(1<<23),n-=23;p(1<<n),f(1,1),p(2),m=h()}else f(0,r),f(1<<-t,0),m=h()+a.call("0",c);return m=c>0?y+((s=m.length)<=c?"0."+a.call("0",c-s)+m:m.slice(0,s-c)+"."+m.slice(s-c)):y+m}})},function(e,t,r){"use strict";var n=r(0),i=r(5),o=r(136),a=1..toPrecision;n(n.P+n.F*(i((function(){return"1"!==a.call(1,void 0)}))||!i((function(){a.call({})}))),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},function(e,t,r){var n=r(0);n(n.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,r){var n=r(0),i=r(4).isFinite;n(n.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,r){var n=r(0);n(n.S,"Number",{isInteger:r(137)})},function(e,t,r){var n=r(0);n(n.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,r){var n=r(0),i=r(137),o=Math.abs;n(n.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,r){var n=r(0);n(n.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,r){var n=r(0);n(n.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,r){var n=r(0),i=r(135);n(n.S+n.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,r){var n=r(0),i=r(134);n(n.S+n.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,r){var n=r(0),i=r(138),o=Math.sqrt,a=Math.acosh;n(n.S+n.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,r){var n=r(0),i=Math.asinh;n(n.S+n.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,r){var n=r(0),i=Math.atanh;n(n.S+n.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,r){var n=r(0),i=r(97);n(n.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,r){var n=r(0),i=Math.exp;n(n.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,r){var n=r(0),i=r(98);n(n.S+n.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,r){var n=r(0);n(n.S,"Math",{fround:r(139)})},function(e,t,r){var n=r(0),i=Math.abs;n(n.S,"Math",{hypot:function(e,t){for(var r,n,o=0,a=0,s=arguments.length,l=0;a<s;)l<(r=i(arguments[a++]))?(o=o*(n=l/r)*n+1,l=r):o+=r>0?(n=r/l)*n:r;return l===1/0?1/0:l*Math.sqrt(o)}})},function(e,t,r){var n=r(0),i=Math.imul;n(n.S+n.F*r(5)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n;return 0|i*o+((65535&r>>>16)*o+i*(65535&n>>>16)<<16>>>0)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,r){var n=r(0);n(n.S,"Math",{log1p:r(138)})},function(e,t,r){var n=r(0);n(n.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,r){var n=r(0);n(n.S,"Math",{sign:r(97)})},function(e,t,r){var n=r(0),i=r(98),o=Math.exp;n(n.S+n.F*r(5)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,r){var n=r(0),i=r(98),o=Math.exp;n(n.S,"Math",{tanh:function(e){var t=i(e=+e),r=i(-e);return t==1/0?1:r==1/0?-1:(t-r)/(o(e)+o(-e))}})},function(e,t,r){var n=r(0);n(n.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,r){var n=r(0),i=r(49),o=String.fromCharCode,a=String.fromCodePoint;n(n.S+n.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,a=0;n>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");r.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return r.join("")}})},function(e,t,r){var n=r(0),i=r(24),o=r(8);n(n.S,"String",{raw:function(e){for(var t=i(e.raw),r=o(t.length),n=arguments.length,a=[],s=0;r>s;)a.push(String(t[s++])),s<n&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,r){"use strict";r(60)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,r){"use strict";var n=r(74)(!0);r(99)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(e=n(t,r),this._i+=e.length,{value:e,done:!1})}))},function(e,t,r){"use strict";var n=r(0),i=r(74)(!1);n(n.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,r){"use strict";var n=r(0),i=r(8),o=r(101),a="".endsWith;n(n.P+n.F*r(102)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=i(t.length),s=void 0===r?n:Math.min(i(r),n),l=String(e);return a?a.call(t,l,s):t.slice(s-l.length,s)===l}})},function(e,t,r){"use strict";var n=r(0),i=r(101);n(n.P+n.F*r(102)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,r){var n=r(0);n(n.P,"String",{repeat:r(96)})},function(e,t,r){"use strict";var n=r(0),i=r(8),o=r(101),a="".startsWith;n(n.P+n.F*r(102)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),r=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return a?a.call(t,n,r):t.slice(r,r+n.length)===n}})},function(e,t,r){"use strict";r(21)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,r){"use strict";r(21)("big",(function(e){return function(){return e(this,"big","","")}}))},function(e,t,r){"use strict";r(21)("blink",(function(e){return function(){return e(this,"blink","","")}}))},function(e,t,r){"use strict";r(21)("bold",(function(e){return function(){return e(this,"b","","")}}))},function(e,t,r){"use strict";r(21)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},function(e,t,r){"use strict";r(21)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,r){"use strict";r(21)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,r){"use strict";r(21)("italics",(function(e){return function(){return e(this,"i","","")}}))},function(e,t,r){"use strict";r(21)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},function(e,t,r){"use strict";r(21)("small",(function(e){return function(){return e(this,"small","","")}}))},function(e,t,r){"use strict";r(21)("strike",(function(e){return function(){return e(this,"strike","","")}}))},function(e,t,r){"use strict";r(21)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,r){"use strict";r(21)("sup",(function(e){return function(){return e(this,"sup","","")}}))},function(e,t,r){var n=r(0);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,r){"use strict";var n=r(0),i=r(13),o=r(32);n(n.P+n.F*r(5)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),r=o(t);return"number"!=typeof r||isFinite(r)?t.toISOString():null}})},function(e,t,r){var n=r(0),i=r(262);n(n.P+n.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,r){"use strict";var n=r(5),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=n((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))}))||!n((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),r=e.getUTCMilliseconds(),n=t<0?"-":t>9999?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(r>99?r:"0"+a(r))+"Z"}:o},function(e,t,r){var n=Date.prototype,i=n.toString,o=n.getTime;new Date(NaN)+""!="Invalid Date"&&r(20)(n,"toString",(function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"}))},function(e,t,r){var n=r(7)("toPrimitive"),i=Date.prototype;n in i||r(19)(i,n,r(265))},function(e,t,r){"use strict";var n=r(3),i=r(32);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(n(this),"number"!=e)}},function(e,t,r){var n=r(0);n(n.S,"Array",{isArray:r(73)})},function(e,t,r){"use strict";var n=r(28),i=r(0),o=r(13),a=r(140),s=r(103),l=r(8),c=r(104),u=r(105);i(i.S+i.F*!r(76)((function(e){Array.from(e)})),"Array",{from:function(e){var t,r,i,f,p=o(e),h="function"==typeof this?this:Array,d=arguments.length,y=d>1?arguments[1]:void 0,m=void 0!==y,g=0,v=u(p);if(m&&(y=n(y,d>2?arguments[2]:void 0,2)),null==v||h==Array&&s(v))for(r=new h(t=l(p.length));t>g;g++)c(r,g,m?y(p[g],g):p[g]);else for(f=v.call(p),r=new h;!(i=f.next()).done;g++)c(r,g,m?a(f,y,[i.value,g],!0):i.value);return r.length=g,r}})},function(e,t,r){"use strict";var n=r(0),i=r(104);n(n.S+n.F*r(5)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,r=new("function"==typeof this?this:Array)(t);t>e;)i(r,e,arguments[e++]);return r.length=t,r}})},function(e,t,r){"use strict";var n=r(0),i=r(24),o=[].join;n(n.P+n.F*(r(63)!=Object||!r(31)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,r){"use strict";var n=r(0),i=r(92),o=r(29),a=r(49),s=r(8),l=[].slice;n(n.P+n.F*r(5)((function(){i&&l.call(i)})),"Array",{slice:function(e,t){var r=s(this.length),n=o(this);if(t=void 0===t?r:t,"Array"==n)return l.call(this,e,t);for(var i=a(e,r),c=a(t,r),u=s(c-i),f=new Array(u),p=0;p<u;p++)f[p]="String"==n?this.charAt(i+p):this[i+p];return f}})},function(e,t,r){"use strict";var n=r(0),i=r(17),o=r(13),a=r(5),s=[].sort,l=[1,2,3];n(n.P+n.F*(a((function(){l.sort(void 0)}))||!a((function(){l.sort(null)}))||!r(31)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,r){"use strict";var n=r(0),i=r(35)(0),o=r(31)([].forEach,!0);n(n.P+n.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,r){var n=r(6),i=r(73),o=r(7)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),n(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,r){"use strict";var n=r(0),i=r(35)(1);n(n.P+n.F*!r(31)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(35)(2);n(n.P+n.F*!r(31)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(35)(3);n(n.P+n.F*!r(31)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(35)(4);n(n.P+n.F*!r(31)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(141);n(n.P+n.F*!r(31)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,r){"use strict";var n=r(0),i=r(141);n(n.P+n.F*!r(31)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,r){"use strict";var n=r(0),i=r(71)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(a||!r(31)(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,r){"use strict";var n=r(0),i=r(24),o=r(30),a=r(8),s=[].lastIndexOf,l=!!s&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(l||!r(31)(s)),"Array",{lastIndexOf:function(e){if(l)return s.apply(this,arguments)||0;var t=i(this),r=a(t.length),n=r-1;for(arguments.length>1&&(n=Math.min(n,o(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}})},function(e,t,r){var n=r(0);n(n.P,"Array",{copyWithin:r(142)}),r(43)("copyWithin")},function(e,t,r){var n=r(0);n(n.P,"Array",{fill:r(107)}),r(43)("fill")},function(e,t,r){"use strict";var n=r(0),i=r(35)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),n(n.P+n.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(43)("find")},function(e,t,r){"use strict";var n=r(0),i=r(35)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),n(n.P+n.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(43)(o)},function(e,t,r){r(52)("Array")},function(e,t,r){var n=r(4),i=r(95),o=r(12).f,a=r(51).f,s=r(75),l=r(65),c=n.RegExp,u=c,f=c.prototype,p=/a/g,h=/a/g,d=new c(p)!==p;if(r(10)&&(!d||r(5)((function(){return h[r(7)("match")]=!1,c(p)!=p||c(h)==h||"/a/i"!=c(p,"i")})))){c=function(e,t){var r=this instanceof c,n=s(e),o=void 0===t;return!r&&n&&e.constructor===c&&o?e:i(d?new u(n&&!o?e.source:e,t):u((n=e instanceof c)?e.source:e,n&&o?l.call(e):t),r?this:f,c)};for(var y=function(e){e in c||o(c,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},m=a(u),g=0;m.length>g;)y(m[g++]);f.constructor=c,c.prototype=f,r(20)(n,"RegExp",c)}r(52)("RegExp")},function(e,t,r){"use strict";r(145);var n=r(3),i=r(65),o=r(10),a=/./.toString,s=function(e){r(20)(RegExp.prototype,"toString",e,!0)};r(5)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?s((function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):"toString"!=a.name&&s((function(){return a.call(this)}))},function(e,t,r){"use strict";var n=r(3),i=r(8),o=r(110),a=r(77);r(78)("match",1,(function(e,t,r,s){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=s(r,e,this);if(t.done)return t.value;var l=n(e),c=String(this);if(!l.global)return a(l,c);var u=l.unicode;l.lastIndex=0;for(var f,p=[],h=0;null!==(f=a(l,c));){var d=String(f[0]);p[h]=d,""===d&&(l.lastIndex=o(c,i(l.lastIndex),u)),h++}return 0===h?null:p}]}))},function(e,t,r){"use strict";var n=r(3),i=r(13),o=r(8),a=r(30),s=r(110),l=r(77),c=Math.max,u=Math.min,f=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,h=/\$([$&`']|\d\d?)/g;r(78)("replace",2,(function(e,t,r,d){return[function(n,i){var o=e(this),a=null==n?void 0:n[t];return void 0!==a?a.call(n,o,i):r.call(String(o),n,i)},function(e,t){var i=d(r,e,this,t);if(i.done)return i.value;var f=n(e),p=String(this),h="function"==typeof t;h||(t=String(t));var m=f.global;if(m){var g=f.unicode;f.lastIndex=0}for(var v=[];;){var b=l(f,p);if(null===b)break;if(v.push(b),!m)break;""===String(b[0])&&(f.lastIndex=s(p,o(f.lastIndex),g))}for(var _,w="",S=0,x=0;x<v.length;x++){b=v[x];for(var L=String(b[0]),P=c(u(a(b.index),p.length),0),E=[],C=1;C<b.length;C++)E.push(void 0===(_=b[C])?_:String(_));var T=b.groups;if(h){var A=[L].concat(E,P,p);void 0!==T&&A.push(T);var R=String(t.apply(void 0,A))}else R=y(L,p,P,E,T,t);P>=S&&(w+=p.slice(S,P)+R,S=P+L.length)}return w+p.slice(S)}];function y(e,t,n,o,a,s){var l=n+e.length,c=o.length,u=h;return void 0!==a&&(a=i(a),u=p),r.call(s,u,(function(r,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(l);case"<":s=a[i.slice(1,-1)];break;default:var u=+i;if(0===u)return r;if(u>c){var p=f(u/10);return 0===p?r:p<=c?void 0===o[p-1]?i.charAt(1):o[p-1]+i.charAt(1):r}s=o[u-1]}return void 0===s?"":s}))}}))},function(e,t,r){"use strict";var n=r(3),i=r(131),o=r(77);r(78)("search",1,(function(e,t,r,a){return[function(r){var n=e(this),i=null==r?void 0:r[t];return void 0!==i?i.call(r,n):new RegExp(r)[t](String(n))},function(e){var t=a(r,e,this);if(t.done)return t.value;var s=n(e),l=String(this),c=s.lastIndex;i(c,0)||(s.lastIndex=0);var u=o(s,l);return i(s.lastIndex,c)||(s.lastIndex=c),null===u?-1:u.index}]}))},function(e,t,r){"use strict";var n=r(75),i=r(3),o=r(66),a=r(110),s=r(8),l=r(77),c=r(109),u=r(5),f=Math.min,p=[].push,h=!u((function(){RegExp(4294967295,"y")}));r(78)("split",2,(function(e,t,r,u){var d;return d="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!n(e))return r.call(i,e,t);for(var o,a,s,l=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,h=void 0===t?4294967295:t>>>0,d=new RegExp(e.source,u+"g");(o=c.call(d,i))&&!((a=d.lastIndex)>f&&(l.push(i.slice(f,o.index)),o.length>1&&o.index<i.length&&p.apply(l,o.slice(1)),s=o[0].length,f=a,l.length>=h));)d.lastIndex===o.index&&d.lastIndex++;return f===i.length?!s&&d.test("")||l.push(""):l.push(i.slice(f)),l.length>h?l.slice(0,h):l}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)}:r,[function(r,n){var i=e(this),o=null==r?void 0:r[t];return void 0!==o?o.call(r,i,n):d.call(String(i),r,n)},function(e,t){var n=u(d,e,this,t,d!==r);if(n.done)return n.value;var c=i(e),p=String(this),y=o(c,RegExp),m=c.unicode,g=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(h?"y":"g"),v=new y(h?c:"^(?:"+c.source+")",g),b=void 0===t?4294967295:t>>>0;if(0===b)return[];if(0===p.length)return null===l(v,p)?[p]:[];for(var _=0,w=0,S=[];w<p.length;){v.lastIndex=h?w:0;var x,L=l(v,h?p:p.slice(w));if(null===L||(x=f(s(v.lastIndex+(h?0:w)),p.length))===_)w=a(p,w,m);else{if(S.push(p.slice(_,w)),S.length===b)return S;for(var P=1;P<=L.length-1;P++)if(S.push(L[P]),S.length===b)return S;w=_=x}}return S.push(p.slice(_)),S}]}))},function(e,t,r){"use strict";var n,i,o,a,s=r(41),l=r(4),c=r(28),u=r(59),f=r(0),p=r(6),h=r(17),d=r(53),y=r(54),m=r(66),g=r(111).set,v=r(112)(),b=r(113),_=r(146),w=r(79),S=r(147),x=l.TypeError,L=l.process,P=L&&L.versions,E=P&&P.v8||"",C=l.Promise,T="process"==u(L),A=function(){},R=i=b.f,M=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[r(7)("species")]=function(e){e(A,A)};return(T||"function"==typeof PromiseRejectionEvent)&&e.then(A)instanceof t&&0!==E.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),k=function(e){var t;return!(!p(e)||"function"!=typeof(t=e.then))&&t},O=function(e,t){if(!e._n){e._n=!0;var r=e._c;v((function(){for(var n=e._v,i=1==e._s,o=0,a=function(t){var r,o,a,s=i?t.ok:t.fail,l=t.resolve,c=t.reject,u=t.domain;try{s?(i||(2==e._h&&N(e),e._h=1),!0===s?r=n:(u&&u.enter(),r=s(n),u&&(u.exit(),a=!0)),r===t.promise?c(x("Promise-chain cycle")):(o=k(r))?o.call(r,l,c):l(r)):c(n)}catch(e){u&&!a&&u.exit(),c(e)}};r.length>o;)a(r[o++]);e._c=[],e._n=!1,t&&!e._h&&I(e)}))}},I=function(e){g.call(l,(function(){var t,r,n,i=e._v,o=F(e);if(o&&(t=_((function(){T?L.emit("unhandledRejection",i,e):(r=l.onunhandledrejection)?r({promise:e,reason:i}):(n=l.console)&&n.error&&n.error("Unhandled promise rejection",i)})),e._h=T||F(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},F=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){g.call(l,(function(){var t;T?L.emit("rejectionHandled",e):(t=l.onrejectionhandled)&&t({promise:e,reason:e._v})}))},G=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),O(t,!0))},j=function e(t){var r,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw x("Promise can't be resolved itself");(r=k(t))?v((function(){var i={_w:n,_d:!1};try{r.call(t,c(e,i,1),c(G,i,1))}catch(e){G.call(i,e)}})):(n._v=t,n._s=1,O(n,!1))}catch(e){G.call({_w:n,_d:!1},e)}}};M||(C=function(e){d(this,C,"Promise","_h"),h(e),n.call(this);try{e(c(j,this,1),c(G,this,1))}catch(e){G.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=r(55)(C.prototype,{then:function(e,t){var r=R(m(this,C));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=T?L.domain:void 0,this._c.push(r),this._a&&this._a.push(r),this._s&&O(this,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n;this.promise=e,this.resolve=c(j,e,1),this.reject=c(G,e,1)},b.f=R=function(e){return e===C||e===a?new o(e):i(e)}),f(f.G+f.W+f.F*!M,{Promise:C}),r(58)(C,"Promise"),r(52)("Promise"),a=r(27).Promise,f(f.S+f.F*!M,"Promise",{reject:function(e){var t=R(this);return(0,t.reject)(e),t.promise}}),f(f.S+f.F*(s||!M),"Promise",{resolve:function(e){return S(s&&this===a?C:this,e)}}),f(f.S+f.F*!(M&&r(76)((function(e){C.all(e).catch(A)}))),"Promise",{all:function(e){var t=this,r=R(t),n=r.resolve,i=r.reject,o=_((function(){var r=[],o=0,a=1;y(e,!1,(function(e){var s=o++,l=!1;r.push(void 0),a++,t.resolve(e).then((function(e){l||(l=!0,r[s]=e,--a||n(r))}),i)})),--a||n(r)}));return o.e&&i(o.v),r.promise},race:function(e){var t=this,r=R(t),n=r.reject,i=_((function(){y(e,!1,(function(e){t.resolve(e).then(r.resolve,n)}))}));return i.e&&n(i.v),r.promise}})},function(e,t,r){"use strict";var n=r(152),i=r(56);r(80)("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(i(this,"WeakSet"),e,!0)}},n,!1,!0)},function(e,t,r){"use strict";var n=r(0),i=r(81),o=r(114),a=r(3),s=r(49),l=r(8),c=r(6),u=r(4).ArrayBuffer,f=r(66),p=o.ArrayBuffer,h=o.DataView,d=i.ABV&&u.isView,y=p.prototype.slice,m=i.VIEW;n(n.G+n.W+n.F*(u!==p),{ArrayBuffer:p}),n(n.S+n.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return d&&d(e)||c(e)&&m in e}}),n(n.P+n.U+n.F*r(5)((function(){return!new p(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(e,t){if(void 0!==y&&void 0===t)return y.call(a(this),e);for(var r=a(this).byteLength,n=s(e,r),i=s(void 0===t?r:t,r),o=new(f(this,p))(l(i-n)),c=new h(this),u=new h(o),d=0;n<i;)u.setUint8(d++,c.getUint8(n++));return o}}),r(52)("ArrayBuffer")},function(e,t,r){var n=r(0);n(n.G+n.W+n.F*!r(81).ABV,{DataView:r(114).DataView})},function(e,t,r){r(38)("Int8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){r(38)("Uint8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){r(38)("Uint8",1,(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0)},function(e,t,r){r(38)("Int16",2,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){r(38)("Uint16",2,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){r(38)("Int32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){r(38)("Uint32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){r(38)("Float32",4,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){r(38)("Float64",8,(function(e){return function(t,r,n){return e(this,t,r,n)}}))},function(e,t,r){var n=r(0),i=r(17),o=r(3),a=(r(4).Reflect||{}).apply,s=Function.apply;n(n.S+n.F*!r(5)((function(){a((function(){}))})),"Reflect",{apply:function(e,t,r){var n=i(e),l=o(r);return a?a(n,t,l):s.call(n,t,l)}})},function(e,t,r){var n=r(0),i=r(50),o=r(17),a=r(3),s=r(6),l=r(5),c=r(132),u=(r(4).Reflect||{}).construct,f=l((function(){function e(){}return!(u((function(){}),[],e)instanceof e)})),p=!l((function(){u((function(){}))}));n(n.S+n.F*(f||p),"Reflect",{construct:function(e,t){o(e),a(t);var r=arguments.length<3?e:o(arguments[2]);if(p&&!f)return u(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(c.apply(e,n))}var l=r.prototype,h=i(s(l)?l:Object.prototype),d=Function.apply.call(e,h,t);return s(d)?d:h}})},function(e,t,r){var n=r(12),i=r(0),o=r(3),a=r(32);i(i.S+i.F*r(5)((function(){Reflect.defineProperty(n.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,r){o(e),t=a(t,!0),o(r);try{return n.f(e,t,r),!0}catch(e){return!1}}})},function(e,t,r){var n=r(0),i=r(25).f,o=r(3);n(n.S,"Reflect",{deleteProperty:function(e,t){var r=i(o(e),t);return!(r&&!r.configurable)&&delete e[t]}})},function(e,t,r){"use strict";var n=r(0),i=r(3),o=function(e){this._t=i(e),this._i=0;var t,r=this._k=[];for(t in e)r.push(t)};r(100)(o,"Object",(function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}})),n(n.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,r){var n=r(25),i=r(26),o=r(23),a=r(0),s=r(6),l=r(3);a(a.S,"Reflect",{get:function e(t,r){var a,c,u=arguments.length<3?t:arguments[2];return l(t)===u?t[r]:(a=n.f(t,r))?o(a,"value")?a.value:void 0!==a.get?a.get.call(u):void 0:s(c=i(t))?e(c,r,u):void 0}})},function(e,t,r){var n=r(25),i=r(0),o=r(3);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return n.f(o(e),t)}})},function(e,t,r){var n=r(0),i=r(26),o=r(3);n(n.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},function(e,t,r){var n=r(0);n(n.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,r){var n=r(0),i=r(3),o=Object.isExtensible;n(n.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,r){var n=r(0);n(n.S,"Reflect",{ownKeys:r(154)})},function(e,t,r){var n=r(0),i=r(3),o=Object.preventExtensions;n(n.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},function(e,t,r){var n=r(12),i=r(25),o=r(26),a=r(23),s=r(0),l=r(46),c=r(3),u=r(6);s(s.S,"Reflect",{set:function e(t,r,s){var f,p,h=arguments.length<4?t:arguments[3],d=i.f(c(t),r);if(!d){if(u(p=o(t)))return e(p,r,s,h);d=l(0)}if(a(d,"value")){if(!1===d.writable||!u(h))return!1;if(f=i.f(h,r)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,n.f(h,r,f)}else n.f(h,r,l(0,s));return!0}return void 0!==d.set&&(d.set.call(h,s),!0)}})},function(e,t,r){var n=r(0),i=r(93);i&&n(n.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,r){"use strict";var n=r(0),i=r(71)(!0);n(n.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),r(43)("includes")},function(e,t,r){"use strict";var n=r(0),i=r(155),o=r(13),a=r(8),s=r(17),l=r(106);n(n.P,"Array",{flatMap:function(e){var t,r,n=o(this);return s(e),t=a(n.length),r=l(n,0),i(r,n,n,t,0,1,e,arguments[1]),r}}),r(43)("flatMap")},function(e,t,r){"use strict";var n=r(0),i=r(155),o=r(13),a=r(8),s=r(30),l=r(106);n(n.P,"Array",{flatten:function(){var e=arguments[0],t=o(this),r=a(t.length),n=l(t,0);return i(n,t,t,r,0,void 0===e?1:s(e)),n}}),r(43)("flatten")},function(e,t,r){"use strict";var n=r(0),i=r(74)(!0);n(n.P,"String",{at:function(e){return i(this,e)}})},function(e,t,r){"use strict";var n=r(0),i=r(156),o=r(79),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);n(n.P+n.F*a,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,r){"use strict";var n=r(0),i=r(156),o=r(79),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);n(n.P+n.F*a,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,r){"use strict";r(60)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},function(e,t,r){"use strict";r(60)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,r){"use strict";var n=r(0),i=r(33),o=r(8),a=r(75),s=r(65),l=RegExp.prototype,c=function(e,t){this._r=e,this._s=t};r(100)(c,"RegExp String",(function(){var e=this._r.exec(this._s);return{value:e,done:null===e}})),n(n.P,"String",{matchAll:function(e){if(i(this),!a(e))throw TypeError(e+" is not a regexp!");var t=String(this),r="flags"in l?String(e.flags):s.call(e),n=new RegExp(e.source,~r.indexOf("g")?r:"g"+r);return n.lastIndex=o(e.lastIndex),new c(n,t)}})},function(e,t,r){r(89)("asyncIterator")},function(e,t,r){r(89)("observable")},function(e,t,r){var n=r(0),i=r(154),o=r(24),a=r(25),s=r(104);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,r,n=o(e),l=a.f,c=i(n),u={},f=0;c.length>f;)void 0!==(r=l(n,t=c[f++]))&&s(u,t,r);return u}})},function(e,t,r){var n=r(0),i=r(157)(!1);n(n.S,"Object",{values:function(e){return i(e)}})},function(e,t,r){var n=r(0),i=r(157)(!0);n(n.S,"Object",{entries:function(e){return i(e)}})},function(e,t,r){"use strict";var n=r(0),i=r(13),o=r(17),a=r(12);r(10)&&n(n.P+r(82),"Object",{__defineGetter__:function(e,t){a.f(i(this),e,{get:o(t),enumerable:!0,configurable:!0})}})},function(e,t,r){"use strict";var n=r(0),i=r(13),o=r(17),a=r(12);r(10)&&n(n.P+r(82),"Object",{__defineSetter__:function(e,t){a.f(i(this),e,{set:o(t),enumerable:!0,configurable:!0})}})},function(e,t,r){"use strict";var n=r(0),i=r(13),o=r(32),a=r(26),s=r(25).f;r(10)&&n(n.P+r(82),"Object",{__lookupGetter__:function(e){var t,r=i(this),n=o(e,!0);do{if(t=s(r,n))return t.get}while(r=a(r))}})},function(e,t,r){"use strict";var n=r(0),i=r(13),o=r(32),a=r(26),s=r(25).f;r(10)&&n(n.P+r(82),"Object",{__lookupSetter__:function(e){var t,r=i(this),n=o(e,!0);do{if(t=s(r,n))return t.set}while(r=a(r))}})},function(e,t,r){var n=r(0);n(n.P+n.R,"Map",{toJSON:r(158)("Map")})},function(e,t,r){var n=r(0);n(n.P+n.R,"Set",{toJSON:r(158)("Set")})},function(e,t,r){r(83)("Map")},function(e,t,r){r(83)("Set")},function(e,t,r){r(83)("WeakMap")},function(e,t,r){r(83)("WeakSet")},function(e,t,r){r(84)("Map")},function(e,t,r){r(84)("Set")},function(e,t,r){r(84)("WeakMap")},function(e,t,r){r(84)("WeakSet")},function(e,t,r){var n=r(0);n(n.G,{global:r(4)})},function(e,t,r){var n=r(0);n(n.S,"System",{global:r(4)})},function(e,t,r){var n=r(0),i=r(29);n(n.S,"Error",{isError:function(e){return"Error"===i(e)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{clamp:function(e,t,r){return Math.min(r,Math.max(t,e))}})},function(e,t,r){var n=r(0);n(n.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(e,t,r){var n=r(0),i=180/Math.PI;n(n.S,"Math",{degrees:function(e){return e*i}})},function(e,t,r){var n=r(0),i=r(160),o=r(139);n(n.S,"Math",{fscale:function(e,t,r,n,a){return o(i(e,t,r,n,a))}})},function(e,t,r){var n=r(0);n(n.S,"Math",{iaddh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)+(n>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(e,t,r){var n=r(0);n(n.S,"Math",{isubh:function(e,t,r,n){var i=e>>>0,o=r>>>0;return(t>>>0)-(n>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(e,t,r){var n=r(0);n(n.S,"Math",{imulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>16,s=n>>16,l=(a*o>>>0)+(i*o>>>16);return a*s+(l>>16)+((i*s>>>0)+(65535&l)>>16)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(e,t,r){var n=r(0),i=Math.PI/180;n(n.S,"Math",{radians:function(e){return e*i}})},function(e,t,r){var n=r(0);n(n.S,"Math",{scale:r(160)})},function(e,t,r){var n=r(0);n(n.S,"Math",{umulh:function(e,t){var r=+e,n=+t,i=65535&r,o=65535&n,a=r>>>16,s=n>>>16,l=(a*o>>>0)+(i*o>>>16);return a*s+(l>>>16)+((i*s>>>0)+(65535&l)>>>16)}})},function(e,t,r){var n=r(0);n(n.S,"Math",{signbit:function(e){return(e=+e)!=e?e:0==e?1/e==1/0:e>0}})},function(e,t,r){"use strict";var n=r(0),i=r(27),o=r(4),a=r(66),s=r(147);n(n.P+n.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),r="function"==typeof e;return this.then(r?function(r){return s(t,e()).then((function(){return r}))}:e,r?function(r){return s(t,e()).then((function(){throw r}))}:e)}})},function(e,t,r){"use strict";var n=r(0),i=r(113),o=r(146);n(n.S,"Promise",{try:function(e){var t=i.f(this),r=o(e);return(r.e?t.reject:t.resolve)(r.v),t.promise}})},function(e,t,r){var n=r(39),i=r(3),o=n.key,a=n.set;n.exp({defineMetadata:function(e,t,r,n){a(e,t,i(r),o(n))}})},function(e,t,r){var n=r(39),i=r(3),o=n.key,a=n.map,s=n.store;n.exp({deleteMetadata:function(e,t){var r=arguments.length<3?void 0:o(arguments[2]),n=a(i(t),r,!1);if(void 0===n||!n.delete(e))return!1;if(n.size)return!0;var l=s.get(t);return l.delete(r),!!l.size||s.delete(t)}})},function(e,t,r){var n=r(39),i=r(3),o=r(26),a=n.has,s=n.get,l=n.key,c=function e(t,r,n){if(a(t,r,n))return s(t,r,n);var i=o(r);return null!==i?e(t,i,n):void 0};n.exp({getMetadata:function(e,t){return c(e,i(t),arguments.length<3?void 0:l(arguments[2]))}})},function(e,t,r){var n=r(150),i=r(159),o=r(39),a=r(3),s=r(26),l=o.keys,c=o.key,u=function e(t,r){var o=l(t,r),a=s(t);if(null===a)return o;var c=e(a,r);return c.length?o.length?i(new n(o.concat(c))):c:o};o.exp({getMetadataKeys:function(e){return u(a(e),arguments.length<2?void 0:c(arguments[1]))}})},function(e,t,r){var n=r(39),i=r(3),o=n.get,a=n.key;n.exp({getOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,r){var n=r(39),i=r(3),o=n.keys,a=n.key;n.exp({getOwnMetadataKeys:function(e){return o(i(e),arguments.length<2?void 0:a(arguments[1]))}})},function(e,t,r){var n=r(39),i=r(3),o=r(26),a=n.has,s=n.key,l=function e(t,r,n){if(a(t,r,n))return!0;var i=o(r);return null!==i&&e(t,i,n)};n.exp({hasMetadata:function(e,t){return l(e,i(t),arguments.length<3?void 0:s(arguments[2]))}})},function(e,t,r){var n=r(39),i=r(3),o=n.has,a=n.key;n.exp({hasOwnMetadata:function(e,t){return o(e,i(t),arguments.length<3?void 0:a(arguments[2]))}})},function(e,t,r){var n=r(39),i=r(3),o=r(17),a=n.key,s=n.set;n.exp({metadata:function(e,t){return function(r,n){s(e,t,(void 0!==n?i:o)(r),a(n))}}})},function(e,t,r){var n=r(0),i=r(112)(),o=r(4).process,a="process"==r(29)(o);n(n.G,{asap:function(e){var t=a&&o.domain;i(t?t.bind(e):e)}})},function(e,t,r){"use strict";var n=r(0),i=r(4),o=r(27),a=r(112)(),s=r(7)("observable"),l=r(17),c=r(3),u=r(53),f=r(55),p=r(19),h=r(54),d=h.RETURN,y=function(e){return null==e?void 0:l(e)},m=function(e){var t=e._c;t&&(e._c=void 0,t())},g=function(e){return void 0===e._o},v=function(e){g(e)||(e._o=void 0,m(e))},b=function(e,t){c(e),this._c=void 0,this._o=e,e=new _(this);try{var r=t(e),n=r;null!=r&&("function"==typeof r.unsubscribe?r=function(){n.unsubscribe()}:l(r),this._c=r)}catch(t){return void e.error(t)}g(this)&&m(this)};b.prototype=f({},{unsubscribe:function(){v(this)}});var _=function(e){this._s=e};_.prototype=f({},{next:function(e){var t=this._s;if(!g(t)){var r=t._o;try{var n=y(r.next);if(n)return n.call(r,e)}catch(e){try{v(t)}finally{throw e}}}},error:function(e){var t=this._s;if(g(t))throw e;var r=t._o;t._o=void 0;try{var n=y(r.error);if(!n)throw e;e=n.call(r,e)}catch(e){try{m(t)}finally{throw e}}return m(t),e},complete:function(e){var t=this._s;if(!g(t)){var r=t._o;t._o=void 0;try{var n=y(r.complete);e=n?n.call(r,e):void 0}catch(e){try{m(t)}finally{throw e}}return m(t),e}}});var w=function(e){u(this,w,"Observable","_f")._f=l(e)};f(w.prototype,{subscribe:function(e){return new b(e,this._f)},forEach:function(e){var t=this;return new(o.Promise||i.Promise)((function(r,n){l(e);var i=t.subscribe({next:function(t){try{return e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:r})}))}}),f(w,{from:function(e){var t="function"==typeof this?this:w,r=y(c(e)[s]);if(r){var n=c(r.call(e));return n.constructor===t?n:new t((function(e){return n.subscribe(e)}))}return new t((function(t){var r=!1;return a((function(){if(!r){try{if(h(e,!1,(function(e){if(t.next(e),r)return d}))===d)return}catch(e){if(r)throw e;return void t.error(e)}t.complete()}})),function(){r=!0}}))},of:function(){for(var e=0,t=arguments.length,r=new Array(t);e<t;)r[e]=arguments[e++];return new("function"==typeof this?this:w)((function(e){var t=!1;return a((function(){if(!t){for(var n=0;n<r.length;++n)if(e.next(r[n]),t)return;e.complete()}})),function(){t=!0}}))}}),p(w.prototype,s,(function(){return this})),n(n.G,{Observable:w}),r(52)("Observable")},function(e,t,r){var n=r(4),i=r(0),o=r(79),a=[].slice,s=/MSIE .\./.test(o),l=function(e){return function(t,r){var n=arguments.length>2,i=!!n&&a.call(arguments,2);return e(n?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,r)}};i(i.G+i.B+i.F*s,{setTimeout:l(n.setTimeout),setInterval:l(n.setInterval)})},function(e,t,r){var n=r(0),i=r(111);n(n.G+n.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,r){for(var n=r(108),i=r(48),o=r(20),a=r(4),s=r(19),l=r(61),c=r(7),u=c("iterator"),f=c("toStringTag"),p=l.Array,h={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(h),y=0;y<d.length;y++){var m,g=d[y],v=h[g],b=a[g],_=b&&b.prototype;if(_&&(_[u]||s(_,u,p),_[f]||s(_,f,g),l[g]=p,v))for(m in n)_[m]||o(_,m,n[m],!0)}},function(e,t,r){(function(e,t){var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){"use strict";var n,i=Object.prototype,o=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",l=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag",u="object"===r(t),f=e.regeneratorRuntime;if(f)u&&(t.exports=f);else{(f=e.regeneratorRuntime=u?t.exports:{}).wrap=w;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",m={},g={};g[s]=function(){return this};var v=Object.getPrototypeOf,b=v&&v(v(k([])));b&&b!==i&&o.call(b,s)&&(g=b);var _=P.prototype=x.prototype=Object.create(g);L.prototype=_.constructor=P,P.constructor=L,P[c]=L.displayName="GeneratorFunction",f.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===L||"GeneratorFunction"===(t.displayName||t.name))},f.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,P):(e.__proto__=P,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(_),e},f.awrap=function(e){return{__await:e}},E(C.prototype),C.prototype[l]=function(){return this},f.AsyncIterator=C,f.async=function(e,t,r,n){var i=new C(w(e,t,r,n));return f.isGeneratorFunction(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(_),_[c]="Generator",_[s]=function(){return this},_.toString=function(){return"[object Generator]"},f.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},f.values=k,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(R),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;R(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:k(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),m}}}function w(e,t,r,n){var i=t&&t.prototype instanceof x?t:x,o=Object.create(i.prototype),a=new M(n||[]);return o._invoke=function(e,t,r){var n=p;return function(i,o){if(n===d)throw new Error("Generator is already running");if(n===y){if("throw"===i)throw o;return O()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=T(a,r);if(s){if(s===m)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===p)throw n=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var l=S(e,t,r);if("normal"===l.type){if(n=r.done?y:h,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(n=y,r.method="throw",r.arg=l.arg)}}}(e,r,a),o}function S(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function x(){}function L(){}function P(){}function E(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function C(t){function n(e,i,a,s){var l=S(t[e],t,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"===(void 0===u?"undefined":r(u))&&o.call(u,"__await")?Promise.resolve(u.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):Promise.resolve(u).then((function(e){c.value=e,a(c)}),s)}s(l.arg)}var i;"object"===r(e.process)&&e.process.domain&&(n=e.process.domain.bind(n)),this._invoke=function(e,t){function r(){return new Promise((function(r,i){n(e,t,r,i)}))}return i=i?i.then(r,r):r()}}function T(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,T(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=S(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function k(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:n,done:!0}}}("object"===(void 0===e?"undefined":r(e))?e:"object"===("undefined"==typeof window?"undefined":r(window))?window:"object"===("undefined"==typeof self?"undefined":r(self))?self:this)}).call(this,r(124),r(161)(e))},function(e,t,r){r(381),e.exports=r(27).RegExp.escape},function(e,t,r){var n=r(0),i=r(382)(/[\\^$*+?.()|[\]{}]/g,"\\$&");n(n.S,"RegExp",{escape:function(e){return i(e)}})},function(e,t){e.exports=function(e,t){var r=t===Object(t)?function(e){return t[e]}:t;return function(t){return String(t).replace(e,r)}}},function(e,t,r){var n=r(384),i=r(115),o=r(398),a=r(85),s=r(406),l=r(419),c=r(423),u=r(427),f=r(442),p=r(445),h=r(448),d=r(456),y=r(470),m=r(472),g=r(482),v=r(487);(t={}).Map=i,t.base=o,t.plot=s,t.utils=l,t.data=f,t.misc=p,t.lys=a,t.components=h,t.common=d,t.interact=y,t.render=m,t.model=g,t.biz=v,t.servicev2=u,t.service=c,t.version=n,window.G=t,e.exports=t},function(e,t){e.exports="3.1.0-beta"},function(module,exports,__webpack_require__){"use strict";var __WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(2),__webpack_require__(22),__webpack_require__(1)],__WEBPACK_AMD_DEFINE_RESULT__=function(CommonUtil,LoggerUtil,g2){var extend={includeGetSymbol:function includeGetSymbol(component){component.include({_getSymbol_Zoom:function(e){return isNaN(e)&&(e=this.map.getZoomLevel()),e},_getSymbol_DataObj:function(e,t){if(t)return e[this.options.attributeField]},_getDataOrData2:function(e,t){return null==e?t:e},_getSymbol_symKeyLookstr:function(e,t){return e.endsWith(t)&&(e=e.substr(0,e.length-3)),e},_getSymbol_symKeyObj:function(e,t){for(var r,n,i=0,o=e.length,a="",s=0;i<o;i++){var l=e[i];if(l){var c=t[l.field],u=l.values;if(u){for(r=u.length,s=0,n=null;s<r&&(n=u[s],!CommonUtil.assertWithin(c,n));s++);n&&(a+=l.field+"$=$"+u[s]+"$_$")}}}return{symKey:a,rangeStr:n}},_getSymbolObjByKey:function(e){for(var t=0,r=this.allSymbols.length;t<r;t++){var n=this.allSymbols[t];if(n&&n.symbolKey==e)return n}return null},_doGetSymbol:function(e,t,r){var n=t.label,i=t.symbol||r;if(n&&n.enable){var o=n.options||{};o.text=this._getLabelText(e,n.textFormat);var a={textSymbol:this._createSymbol("TextSymbol",o)};return i instanceof g2.sfs.SimpleMarkerSymbol||i instanceof g2.sfs.PictureMarkerSymbol?a.markerSymbol=i:i instanceof g2.sfs.SimpleLineSymbol?a.lineSymbol=i:i instanceof g2.sfs.SimpleFillSymbol&&(a.fillSymbol=i),new g2.sfs.CurrencySymbol(a)}return i},_onSymbolsUpdated:function(){if(this._invokeSymbolUpdateCallback){for(var e,t=0,r=(e=this.layer.elements).length,n=[];t<r;t++){var i=e[t]._symbolKey;if(i){if(this._getSymbolObj(i,n))continue;var o=this._getSymbolObj(i,this.allSymbols);n.push(o)}}this.currentSymbols=null,this.currentSymbols=n,this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:n})}},_onElementChanged:function(){var e=this.elements||this.features,t=[];if(0==e.length)this._currentExtent=[NaN,NaN,NaN,NaN];else{for(var r=0,n=e.length;r<n;r++){var i=e[r];i&&i.geometry&&t.push(i.geometry)}var o=G.utils.GeometryUtil.getGeometryEnvlop(t);this._currentExtent=this._envelopeFromGeom(o)}},_fetchSymbolConfig:function _fetchSymbolConfig(data,renderer){if(!renderer)return null;if("zoomLevel"==renderer.type)return renderer;var valueCfg=renderer.values,key,value=eval("data."+renderer.field);for(key in valueCfg)if(CommonUtil.assertWithin(value,key)){var cfg=valueCfg[key];return cfg.renderer?this._fetchSymbolConfig(data,cfg.renderer):cfg}return null},_getLabelText:function(e,t){if(!t)return"";var r=/([\w\_\-\d]+)/g,n=t.match(/(\$\{[\w\_\-\d]{0,}\})/g),i=t;if(n&&n.length>0)for(var o=0,a=n.length;o<a;o++){var s=n[o],l="",c=s.match(r);c&&1==c.length&&(l=e[c[0]]||""),i=i.replace(s,l)}return i}})},includeFindElementById:function(e){e.include({_getElementLayerById:function(e,t){var r=e.find(t),n=void 0;return null!=r&&(n={element:r,layer:e}),n},_getGroupLayerLayerById:function(e,t){var r=e.groupLayers;for(var n in r){var i=this._getLayerElementById(r[n],t);if(i)return i}return i},_getFeatureLayerById:function(e,t){for(var r=e.features,n=0,i=r.length;n<i;n++){var o=r[n];if(o&&o.objectId==t)return{element:o,layer:e}}},_getLayerElementById:function(e,t){var r=void 0;return e instanceof g2.carto.ElementLayer||e instanceof g2.carto.ClusterLayer?r=this._getElementLayerById(e,t):e instanceof g2.carto.GroupLayer?r=this._getGroupLayerLayerById(e,t):e instanceof g2.carto.FeatureLayer?r=this._getFeatureLayerById(e,t):(LoggerUtil.error("Unkown Type layer!!!"),LoggerUtil.error(e,t)),r}})},includeParseSymbolCfg:function includeParseSymbolCfg(component){component.include({_getSymbolObj:function(e,t){for(var r=t||this.allSymbols,n=0,i=r.length;n<i;n++){var o=r[n];if(o&&o.symbolKey==e)return o}return null},_getSymbolCfg:function(e,t){this.symbolConfig?(this._parseSymbolCfg(this.symbolConfig),CommonUtil.isFunction(e)&&e.call(t||window,this.symbolConfig)):CommonUtil.ajaxGet({url:this.options.symbolConfigUrl,dataType:"json",async:!1},(function(r){this._parseSymbolCfg(r),CommonUtil.isFunction(e)&&e.call(t||window,r)}),this)},_setValid_SymOptsSource:function(e){e&&e.sourceKey&&!e.source&&(e.source="")},_getValidObj:function(e){return null==e?{}:e},_parseSymbolCfg:function _parseSymbolCfg(cfg){var selfObj=this;if(cfg){this.symbolConfig=null,delete this.symbolConfig,this.symbolConfig_=null,delete this.symbolConfig_,this.symbolConfig_=jQuery.extend(!0,{},cfg);var defaultSym=this._getValidObj(cfg.default);defaultSym.type&&defaultSym.options&&(cfg.defaultSymbol=this._createSymbol(defaultSym.type,defaultSym.options));var tmpLabel=this._getValidObj(cfg.label);cfg.label=jQuery.extend(!0,{enable:!1,options:{},textFormat:""},tmpLabel),this.renderFields=[];var allSymbols=[{symbolKey:this.options.defaultSymbolKey,title:cfg.title,symbol:cfg.defaultSymbol,label:cfg.label}];this.allSymbols=allSymbols,_handlerRenderer(cfg,cfg,"",this._createSymbol,this.renderFields,this),this.symbolConfig=cfg}function _handlerRenderer(e,t,r,n,i,o){var a,s=e.renderer;if(!s)return!1;if("zoomLevel"==s.type)t.renderZoom=!0,r+="zoomLevel$=$";else{var l=s.field;ensureFieldUnique(i,s),r+=l+"$=$"}var c=s.values;for(a in c){var u=c[a],f=r;if(f+=a+"$_$",u.renderer)_handlerRenderer(u,t,f,n,i,o);else{var p=jQuery.extend(!0,{},t.default);u.symbol=selfObj._getValidObj(u.symbol);var h=u.symbol.options;if(selfObj._setValid_SymOptsSource(h),p=jQuery.extend(!0,p,u.symbol),u.symbol=n.call(o,p.type,p.options),u.title=u.title||e.title,u.symbolKey=f.substr(0,f.length-3),t.label.enable)if(!1===u.label);else{var d=jQuery.extend(!0,{},t.label);u.label=selfObj._getValidObj(u.label),d=jQuery.extend(!0,d,u.label),u.label=d}else u.label=!1;allSymbols.push({symbolKey:u.symbolKey,title:u.title,symbol:u.symbol,label:u.label})}}return!0}function ensureFieldUnique(fields,cfg){for(var k=0,len=fields.length;k<len;k++){var field=fields[k];if(field&&field.field==cfg.field)return}var values=[],vals=cfg.values||{};for(var k in vals){var regVal=null;try{var reg=eval(k);reg instanceof RegExp&&(regVal=reg)}catch(e){}values.push(regVal||k)}var field={field:cfg.field,values:values};fields.push(field)}}})},includeGenerateNewSymbol:function(e){e.include({_getIconSource:function(e){if(e)return e.indexOf(".")<0?G.icons[e]:G.utils.CommonUtil.getValByVarPath(e)},_generateNewSymbol:function(e,t){var r=null,n={},i=e.$type.split(",")[0],o=this;function a(e,t){var r;return e&&(r=o._generateNewSymbol(e,t)),r}var s=function(e,t){var r=null;if(CommonUtil.isObject(t))e==t.type&&(r=t);else if(CommonUtil.isArray(t))for(var n=0,i=t.length;n<i;n++){var o=t[n];if(o&&o.type==e){r=o;break}}return r||{}}(i,t);jQuery.extend(!0,n,s.options||{});var l={PictureMarkerSymbol:function(){var t=e.sourceKey+"_hl";return n.source=o._getIconSource(t),o._createSymbol(i,n)},SimpleMarkerSymbol:function(){return o._createSymbol(i,n)},SimpleLineSymbol:function(){return o._createSymbol(i,n)},SimpleFillSymbol:function(){return o._createSymbol(i,n)},CurrencySymbol:function(){var r,n,i,o=e.fillSymbol||null,s=e.markerSymbol||null,l=e.textSymbol||null;return r=a(o,t),n=a(s,t),i=a(l,t),new g2.sfs.CurrencySymbol({fillSymbol:r,markerSymbol:n,textSymbol:i})}};return"function"==typeof l[i]&&(r=l[i]()),r}})}};return extend}.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},function(e,t,r){"use strict";var n,i;n=[r(67),r(2),r(22),r(1)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{symbolConfig:!1,xField:"longitude",yField:"latitude",metaData:{}},initialize:function(t){this.noneSpatialArr=[],this.features=[],e.prototype.initialize.call(this,t),this.metaData=this.options.metaData||{},delete this.options.metaData,this.currentZoom=this.map.getZoomLevel(),this.layer=new n.carto.GroupLayer({id:this.options.layerId,name:this.options.layerName||"",map:this.map,layers:[]}),this.featureLayersHolder={}},_addListeners:function(){e.prototype._addListeners.call(this),this.map.listen("extentchanged",this._getExtentChangeListener())},_removeListeners:function(){this.map.off("extentchanged",this._getExtentChangeListener()),e.prototype._removeListeners.call(this)},_getExtentChangeListener:function(){if(!this._extentChangeListener){var e=this;this._extentChangeListener=function(t){var r=e.map.getZoomLevel();e.updateSymbol(r),e.currentZoom=r}}return this._extentChangeListener},_getMapClickListener:function(){if(!this._mapClickListener){this._mapClickListener=function(){}}return this._mapClickListener},addElements:function(e,t){if(e){t=t||{};var i=this._getFields(this.metaData);this.metaFields=i;var o,a,s,l=0;a=(new Date).getTime();for(var c=e.length,u=i.getCount(),f=this.map.getZoomLevel(),p=this.options.attributeField,h=this.options.spatialReference,d=t.dataSpatialReference||this.options.dataSpatialReference,y=0;y<e.length;y++){var m=e[y],g=this._getGeometry(m,d,h);if(this.validateGeometry(g)){var v,b=[];v=p?m[p]||{}:m;for(var _=0;_<u;_++){var w=i.fields[_],S=new n.sfs.Value;S.setValue(v[w.name]||null),b.push(S)}var x=this._getRecordId(m),L=new n.sfs.Feature({fields:i,values:b,geometry:g,objectId:x});L._data=m,this.features.push(L),o=(new Date).getTime();var P=this._getSymbol(v,f);l+=(new Date).getTime()-o,this._addFeature(L,P)}else this.noneSpatialArr.push(m)}r.info("feature count :"+c),r.info("fetch symbol costs :"+l),this._addFeatures2Layer(),this._updateFeatureLayers({visible:!0}),this._onSymbolsUpdated(),this._onElementChanged(),s=(new Date).getTime(),r.info("total costs :"+(s-a))}},_addFeature:function(e,t){if(t&&t.symbol){var r=t.symbolKey||this.options.defaultSymbolKey,i=this.featureLayersHolder[r]||{},o=i.layer;if(!o)o=new n.carto.FeatureLayer({map:this.map,visible:!1,cache:!0}),this.layer.addLayer(o),i={renderer:new n.render.SimpleRenderer({symbol:t.symbol}),layer:o,zoomRanges:t.zoomRanges},this.featureLayersHolder[r]=i;i.featureSet||(i.featureSet=new n.sfs.FeatureSet({fields:this.metaFields})),i.featureSet.add(e)}},_addFeatures2Layer:function(){for(var e in this.featureLayersHolder){var t=this.featureLayersHolder[e],r=t.featureSet,n=t.layer;t.featureSet=null,r&&n.addFeatures(r)}},_updateFeatureLayers:function(e){var t,r=(e=e||{}).visible||!1;for(t in this.featureLayersHolder){var n=this.featureLayersHolder[t];r?n&&(n.layer.setVisible(!0),n.layer.render(n.renderer)):n.layer.setVisible(!1)}this.layer.setVisible(r)},_getFields:function(e){var t=new n.sfs.Fields;if(e)for(var r=e.model||[],i=r.length,o=0;o<i;o++){var a=r[o];if(a){var s=new n.sfs.Field({name:a.fieldName,alias:a.fieldNote,dataType:a.fieldType,isShape:!1});t.add(s)}}return t},getElementSymbol:function(e){var t,r=this.featureLayersHolder;for(t in r){var n=r[t];if(n){var i=n.layer,o=n.renderer;if(i&&o)for(var a=i.features,s=0,l=a.length;s<l;s++){var c=a[s];if(c&&c.objectId==e)return o.symbol}}}return null},updateSymbol:function(e){var r,i=this.featureLayersHolder,o=0;for(r in i)if(!(r.indexOf("zoomLevel$=$")<0)){for(var a,s=i[r],l=r.split("$_$"),c=l[l.length-1].split("$=$")[1],u=s.zoomRanges,f=l.slice(0,l.length-1),p=0,h=u.length;p<h;p++){var d=u[p];if(t.assertWithin(e,d)){a=d,f.push("zoomLevel$=$"+d);break}}if(a!=c){var y=f.join("$_$"),m=this._getSymbolObjByKey(y),g=new n.render.SimpleRenderer({symbol:m.symbol});s.renderer=g,s.layer.render(s.renderer),delete i[r],i[m.symbolKey]=s,o++}}o>0&&this._onSymbolsUpdated()},_createSymbol:function(t,r){return e.prototype._createSymbol.call(this,t,r)},removeElements:function(e){if(t.isArray(e)){for(var n=e.length-1;n>=0;n--){var i,o=e[n];i="string"==typeof o?o:o.objectId;var a=this._getLayerElementById(this.layer,i);if(a&&a.layer&&a.element)try{a.layer.remove(a.element)}catch(e){r.warn("fail to delete feature with objectId:"+i+"!")}}this._onSymbolsUpdated(),this._onElementChanged()}},_onSymbolsUpdated:function(){var e,t=this.featureLayersHolder,r=[];for(e in t){var n=t[e];if(n){var i=n.layer;if(i&&i.visible&&i.features.length>0){var o=this._getSymbolObj(e);o&&r.push(o)}}}this.currentSymbols=null,this.currentSymbols=r,this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:r})},hitTest:function(e,t){var r=this.getLayer(),i=[];if(r&&r.visible)if(r instanceof n.carto.GroupLayer)for(var o=r.groupLayers,a=o.length-1;a>=0;a--){s(o[a],e,t,i)}else s(r,e,t,i);function s(e,t,r,n){var i=e.hitTest(t,r);i&&n.push(i)}return i[0]||void 0},getElements:function(){return this.features},clear:function(){this.features=[];for(var t=this.layer.groupLayers,r=0,n=t.length;r<n;r++){var i=t[r];i&&i.clear&&i.clear()}e.prototype.clear.call(this)},destroy:function(){e.prototype.destroy.call(this)}});return Object.defineProperty(i,"type",{value:12,configurable:!1,writable:!1}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(117),r(2),r(22),r(1)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{},initialize:function(t){e.prototype.initialize.call(this,t),this._defaultClusterStyle={textFillColor:{alpha:255,r:255,g:255,b:255},fillColor:{alpha:200,r:0,g:0,b:255},fillStrokeColor:{alpha:100,r:0,g:0,b:255},fillStrokeWidth:10,distance:10,clusterLevel:10};var r=this.symbolConfig.cluster||this._defaultClusterStyle;this._clusterSymbol=jQuery.extend(!0,{$type:"pixelcluster"},r),this._clusterSymbol.fillStrokeColor=this._getColor(this._clusterSymbol.fillStrokeColor),this._clusterSymbol.fillColor=this._getColor(this._clusterSymbol.fillColor),this._clusterSymbol.textFillColor=this._getColor(this._clusterSymbol.textFillColor);var i=["textFillColor","fillColor","fillStrokeColor"];for(var o in i){var a=r[i[o]];a&&(r[i[o]]=this._getColor(a).toArray())}var s={id:this.options.layerId,name:this.options.layerName,map:this.map},l=jQuery.extend(s,r);this.layer=new n.carto.ClusterLayer(l),isNaN(l.clusterLevel)||this.layer.setClusterLevel(l.clusterLevel)},_addListeners:function(){e.prototype._addListeners.call(this)},_removeListeners:function(){e.prototype._removeListeners.call(this)},_zoomChangeListener:function(e){this.updateSymbol(this.map.getZoomLevel())},addElements:function(e,i){if(t.isArray(e)){i=i||{};for(var o=this.map.getZoomLevel(),a=this.options.spatialReference,s=i.dataSpatialReference||this.options.dataSpatialReference,l=0,c=e.length;l<c;l++){var u=e[l],f=this._getGeometry(u,s,a);if(f){var p=this._getSymbol(u,o),h=this._getRecordId(u),d=new n.sfs.Element({id:h,geometry:f,symbol:p.symbol});d._data=u,d._zoomRange=p.zoomRange,d._symbolKey=p.symbolKey,this.elements.push(d)}else this.noneSpatialArr.push(u)}this.layer.addElements(this.elements),this._onSymbolsUpdated(),this._onElementChanged()}else r.error("dataArr is not an array")},removeElements:function(e){if(t.isArray(e)){for(var r=e.length-1;r>=0;r--){var n=e[r];this.layer.remove(n)}this._onSymbolsUpdated(),this._onElementChanged()}},_onSymbolsUpdated:function(){for(var e=this.layer.elements,t=0,r=e.length,n=[];t<r;t++){var i=e[t]._symbolKey;if(i){if(this._getSymbolObj(i,n))continue;var o=this._getSymbolObj(i,this.allSymbols);n.push(o)}}n.length>0&&n.push({symbolKey:"pixel-cluster",symbol:this._clusterSymbol,title:this.options.layerName+"像素聚合"}),this.currentSymbols=null,this.currentSymbols=n,this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:n})},clear:function(){e.prototype.clear.call(this)},destroy:function(){e.prototype.destroy.call(this)}});return Object.defineProperty(i,"type",{value:13,configurable:!1,writable:!1}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(117),r(389),r(2),r(11),r(118),r(22),r(1)],void 0===(i=function(e,t,r,n,i,o,a){var s=e.extend({options:{spiderfyDistance:1,spiderfyLevel:10,enableCoincidenceClusterLevel:"[0,10000]",coincidenceClusterHoverThreshold:15,coincidenceClusterWeight:1.2,coincidenceClusterMarkerSym:{borderColor:{alpha:150,r:150,g:120,b:226},fillColor:{alpha:220,r:106,g:63,b:214}},coincidenceClusterTextSym:{fontSize:12,foreground:{alpha:255,r:255,g:255,b:255},borderColor:{alpha:1,r:255,g:255,b:255}},showSpiderLeg:!0,spiderfyThreshold:5,circleRadius:30,spiderfyLegSym:{style:0,width:2,color:{alpha:"150",r:0,g:0,b:255}}},initialize:function(r){e.prototype.initialize.call(this,r),this.options.enalbeSpiderfy=!0,this.options.enableCoincidenceCluster=!0,t.init.call(this)},destroy:function(){this._clearSpiderfy(!0),e.prototype.destroy.call(this)},addElements:function(e,t){if(r.isArray(e)){t=t||{};var n=this.map.getZoomLevel(),i=this.options.spatialReference,s=t.dataSpatialReference||this.options.dataSpatialReference,l=!1;this.options.enalbeSpiderfy&&(n>=this.options.spiderfyLevel?l="spiderfy":this.options.enableCoincidenceCluster&&r.assertWithin(this.map.getZoomLevel(),this.options.enableCoincidenceClusterLevel)&&(l="cluster"));for(var c=0,u=e.length;c<u;c++){var f=e[c],p=this._getGeometry(f,s,i);if(this.validateGeometry(p)){var h=this._getSymbol(f,n),d=this._getRecordId(f),y=new a.sfs.Element({id:d,geometry:p,symbol:h.symbol});y._data=f,y._zoomRange=h.zoomRange,y._symbolKey=h.symbolKey,this.elements.push(y),l||this.layer.add(y)}else this.noneSpatialArr.push(f)}l&&this._updateSpiderfy(l),this._onSymbolsUpdated(),this._onElementChanged()}else o.error("dataArr is not an array")},hitTest:function(e,t){var r,n=[];((r=this.layer.hitTest(e,t))&&n.push(r),this.coincidenceHoverLayer)&&((r=this.coincidenceHoverLayer.hitTest(e,t))&&n.push(r));return n[0]||null},clear:function(){this._clearSpiderfy(),this.elements=[],e.prototype.clear.call(this)},setVisible:function(e){this.layer.setVisible(e||!1),this.options.enalbeSpiderfy&&(this.spiderfyAttachLayer&&this.spiderfyAttachLayer.setVisible(e||!1),this.coincidenceClusterLayer&&this.coincidenceClusterLayer.setVisible(e||!1),this.coincidenceHoverLayer&&this.coincidenceHoverLayer.setVisible(e||!1)),e?this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:this.currentSymbols}):this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:[]})}});return s.include({_extentChangeListener:function(){var e=this.map.getZoomLevel();if(e!==this.currentZoom){if(this.updateSymbol(e),this._applySpiderfy(this.currentZoom,e)){if(null!=this.currentClusterObj){var t=this._getCurrentClusterElementIdOnUpdate();if(null!=t){this.coincidenceHoverLayer.clear();var r=this.coincidenceClusterLayer.find(t);r&&(this._addHoverSpiderfy(r),this.currentClusterObj=this._extractClusterElement(r),this._toggleCurrentClusterElement(!1))}}this.fire("clusterChange",jQuery.extend(!0,{},this.currentClusterObj))}this.currentZoom=e}},_mapClickListener:function(e){var t=this.hitTest(e.screenX,e.screenY),r=!1,n=!0;if(t&&(this.fire("click",{element:t.element,layer:t.layer}),r=!0,n=this._applyToggleCurrentClusterElement(t.element)),n&&(this._toggleCurrentClusterElement(!0),this.coincidenceHoverLayer.clear()),!r&&this.coincidenceClusterLayer){var i=this.coincidenceClusterLayer.hitTest(e.screenX,e.screenY);if(i){var o=i.element;if(o)return void(this._addHoverSpiderfy(o)&&(this.currentClusterObj=this._extractClusterElement(o),this._toggleCurrentClusterElement(!1)))}}},_getLayerElementById:function(e,t){var r=this.elements;for(var n in r){var i=r[n];if(i.id==t)return{element:i,layer:e}}},_getElementsCenter:function(e){for(var t=0,r=0,n=e.length,i=0;i<n;i++){var o=e[i];t+=o.geometry.x,r+=o.geometry.y}return[t/n,r/n]}}),t.include(s),Object.defineProperty(s,"type",{value:14,configurable:!1,writable:!1}),s}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(2),r(11),r(118),r(1)],void 0===(i=function(e,t,r,n){var i={init:function(){this.distanceGrid=new r(this.options.spiderfyDistance),this.options.showSpiderLeg&&(this.spiderfyAttachLayer=new n.carto.ElementLayer({id:this.options.layerId+"-spiderfyattach",name:this.options.layerName+"重复点自动排列的辅助图层",map:this.map}),this.map.addLayer(this.spiderfyAttachLayer)),this.options.enableCoincidenceCluster&&(this.coincidenceClusterLayer=new n.carto.ElementLayer({id:this.options.layerId+"-coincidence-cluster",name:this.options.layerName+"重复点聚合图层",map:this.map}),this.map.addLayer(this.coincidenceClusterLayer),this.coincidenceHoverLayer=new n.carto.ElementLayer({id:this.options.layerId+"-coincidence-hover",name:this.options.layerName+"重复点滑过展开",map:this.map}),this.map.addLayer(this.coincidenceHoverLayer)),this.options.spiderfyLegSym&&(this.options.spiderfyLegSym=new n.sfs.SimpleLineSymbol({style:this.options.spiderfyLegSym.style,width:this.options.spiderfyLegSym.width,color:this._getColor(this.options.spiderfyLegSym.color)})),this.currentClusterObj=null},include:function(r){var i=r.prototype,o={_applySpiderfy:function(t,r){if(t===r)return!1;if(!this.options.enalbeSpiderfy)return!1;if(!this.getVisible())return!1;var n=this.options.spiderfyLevel,i=(this.options.spiderfyDistance,!1);return this.options.enableCoincidenceCluster?r>=n?i="spiderfy":e.assertWithin(r,this.options.enableCoincidenceClusterLevel)?i="cluster":this._disableSpiderfy():r>=n?i="spiderfy":t>=n&&r<n&&this._disableSpiderfy(),console.log(i),i&&this._updateSpiderfy(i),!0},_updateSpiderfy:function(e){if("spiderfy"===e||"cluster"===e){this._clearSpiderfy(!1),this.layer.clear();for(var r=this,i=this.options.spatialReference,o=this.options.spiderfyThreshold||5,a=0,s=this.elements.length;a<s;a++){var l=this.elements[a],c=l.geometry,u=this.map.getPixelFromCoordinate([c.x,c.y]);this.distanceGrid.addObject(l,{x:u[0],y:u[1]})}switch(e){case"spiderfy":this.distanceGrid.eachCell((function(e,a,s){if(e.length<2)r.layer.addElements(e);else{var l,c=r._getElementsCenter(e),u=new n.sfs.Point({x:c[0],y:c[1],spatialReference:i}),f=e.length,p=r.options.showSpiderLeg,h=r.map.getPixelFromCoordinate(c);if(f<=o){var d=r.options.circleRadius||20;l=t.getCirclePonits({center:h,radius:d,count:f})}else l=t.getSpiderfy(h,f,11,5,28);for(var y=0;y<f;y++)try{var m=e[y],g=r.map.getCoordinateFromPixel(l[y]),v=new n.sfs.Point({x:g[0],y:g[1],spatialReference:i}),b=new n.sfs.Element({id:m.id,geometry:v,symbol:m.symbol});if(b._data=m._data,r.layer.add(b),p){var _=new n.sfs.Polyline({spatialReference:i}),w=new n.sfs.Path({spatialReference:i});w.addPoint(u),w.addPoint(v),_.addGeometry(w);var S=r.options.spiderfyLegSym,x=new n.sfs.Element({geometry:_,symbol:S});r.spiderfyAttachLayer.add(x)}}catch(e){}}}));break;case"cluster":this.distanceGrid.eachCell((function(e,t,o){if(e.length<2)r.layer.addElements(e);else{var a=r._getElementsCenter(e),s=new n.sfs.Point({x:a[0],y:a[1],spatialReference:i}),l=r.getCoincidenceClusterSym(e),c=t+"_"+o,u=new n.sfs.Element({id:c,geometry:s,symbol:l});u._indexs=[t,o],r.coincidenceClusterLayer.add(u)}}))}}},_addHoverSpiderfy:function(e){var r=e._indexs;if(!r||2!=r.length)return!1;var i=this.distanceGrid.getObjects(r[0],r[1]),o=this.options.spatialReference;if(i.length>this.options.coincidenceClusterHoverThreshold)return!1;var a,s=this._getElementsCenter(i),l=new n.sfs.Point({x:s[0],y:s[1],spatialReference:o}),c=i.length,u=this.options.showSpiderLeg,f=this.options.spiderfyLegSym,p=this.map.getPixelFromCoordinate(s);if(c<=(this.options.spiderfyThreshold||5)){var h=this.options.circleRadius||20;a=t.getCirclePonits({center:p,radius:h,count:c})}else a=t.getSpiderfy(p,c,11,5,28);for(var d=0;d<c;d++){var y=i[d],m=this.map.getCoordinateFromPixel(a[d]),g=new n.sfs.Point({x:m[0],y:m[1],spatialReference:o}),v=new n.sfs.Polyline({spatialReference:o}),b=new n.sfs.Path({spatialReference:o});if(b.addPoint(l),b.addPoint(g),u){v.addGeometry(b);f=this.options.spiderfyLegSym;var _=new n.sfs.Element({geometry:v,symbol:f});this.coincidenceHoverLayer.add(_)}var w=new n.sfs.Element({id:y.id,geometry:g,symbol:y.symbol});this.coincidenceHoverLayer.add(w)}return!0},getCoincidenceClusterSym:function(t){var r=(t=t||[]).length,i=this.options.coincidenceClusterMarkerSym||{},o=this.options.coincidenceClusterTextSym||{},a=r+"";i.borderColor&&(i.borderColor=this._getColor(i.borderColor)),i.fillColor&&(i.fillColor=this._getColor(i.fillColor)),o.foreground&&(o.foreground=this._getColor(o.foreground)),o.borderColor&&(o.borderColor=this._getColor(o.borderColor));var s=o.fontSize||15,l=s*this.options.coincidenceClusterWeight,c=e.getEquivalentNum(a,l,l),u={borderColor:new n.sfs.Color({a:150,r:50,g:175,b:254}),fillColor:new n.sfs.Color({a:220,r:4,g:131,b:232}),borderThickness:c,size:c},f={text:a,fontSize:s,fontWeight:1,offsetX:0,offsetY:0,foreground:new n.sfs.Color({a:255,r:255,g:255,b:255}),borderColor:new n.sfs.Color({a:1,r:255,g:255,b:255}),borderThickness:0};jQuery.extend(!0,u,i),jQuery.extend(!0,f,o);var p=new n.sfs.SimpleMarkerSymbol(u),h=new n.sfs.TextSymbol(f);return new n.sfs.CurrencySymbol({markerSymbol:p,textSymbol:h})},_clearSpiderfy:function(e){if(this.options.enalbeSpiderfy){if(this.spiderfyAttachLayer&&(this.spiderfyAttachLayer.clear(),e&&this.map.removeLayer(this.spiderfyAttachLayer)),this.coincidenceClusterLayer){var t=this.coincidenceClusterLayer.elements;for(var r in t){var n=t[r];n&&(n._indexs=null,delete n._indexs)}this.coincidenceClusterLayer.clear(),e&&this.map.removeLayer(this.coincidenceClusterLayer)}this.coincidenceHoverLayer&&(this.coincidenceHoverLayer.clear(),e&&this.map.removeLayer(this.coincidenceHoverLayer)),this.distanceGrid&&(e?this.distanceGrid.destroy():this.distanceGrid.clear())}},_disableSpiderfy:function(){this.layer.clear(),this.layer.addElements(this.elements),this._clearSpiderfy()},_toggleCurrentClusterElement:function(e){if(null!=this.currentClusterObj){var t=this.coincidenceClusterLayer.find(this.currentClusterObj.id);!0===e?(this.coincidenceClusterLayer.showElement(t,!0),this.currentClusterObj=null):this.coincidenceClusterLayer.showElement(t,!1)}},_applyToggleCurrentClusterElement:function(e){var t=!0;if(null!=this.currentClusterObj)for(var r=this.coincidenceClusterLayer.find(this.currentClusterObj.id)._indexs,n=this.distanceGrid.getObjects(r[0],r[1]),i=0;i<n.length;i++)if(e.id===n[i].id){t=!1;break}return t},_extractClusterElement:function(e){if(e){var t={};t.id=e.id,t.elementSet={};for(var r=e._indexs,n=this.distanceGrid.getObjects(r[0],r[1]),i=0;i<n.length;i++){var o=n[i],a=this.coincidenceHoverLayer.find(o.id);t.elementSet[o.id]=a?{x:a.geometry.x,y:a.geometry.y}:{}}return t}return null},_getCurrentClusterElementIdOnUpdate:function(){var e=null;if(null!=this.currentClusterObj){var t=this.currentClusterObj.elementSet,r=null;this.distanceGrid.eachCell((function(e,n,i){var o=Object.keys(t).length,a=0,s=e.length;for(var l in t)for(var c=0;c<s;c++)if(e[c]&&e[c].id===l){a++;break}a>Math.round(o/2)&&(r=n+"_"+i)})),e=r||null}return e}};for(var a in o)i[a]=o[a]}};return i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(67),r(2),r(22),r(1)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{symbolConfig:!1},initialize:function(t){this.noneSpatialArr=[],this.elements=[],e.prototype.initialize.call(this,t)},_addListeners:function(){e.prototype._addListeners.call(this),this.map.listen("resolutionchanged",this._getZoomChangeLisener())},_removeListeners:function(){this.map.off("resolutionchanged",this._getZoomChangeLisener()),e.prototype._removeListeners.call(this)},_getZoomChangeLisener:function(){if(!this._zoomChangeLisener){var e=this;this._zoomChangeLisener=function(t){e.updateSymbol(t.level)}}return this._zoomChangeLisener},addElements:function(e,i){if(t.isArray(e)){i=i||{};for(var o=this.map.getZoomLevel(),a=this.options.spatialReference,s=i.dataSpatialReference||this.options.dataSpatialReference,l=0,c=e.length;l<c;l++){var u=e[l],f=this._getGeometry(u,s,a);if(f){var p=this._getSymbol(u,o),h=this._getRecordId(u),d=new n.sfs.Element({id:h,geometry:f,symbol:p.symbol});d._data=u,d._zoomRange=p.zoomRange,d._symbolKey=p.symbolKey,this.elements.push(d),this.layer.add(d)}else this.noneSpatialArr.push(u)}this._onSymbolsUpdated(),this._onElementChanged()}else r.error("dataArr is not an array")},getGeometry:function(e,t,r){if(!e)return null;var i=e[this.options.geometryField],o=null;try{"string"==typeof i?(i=this.wktReader.read(i).toString(),o=n.sfs.GeometryFactory.createGeometryFromWkt(i,t)):o=n.sfs.GeometryFactory.createGeometryFromGeoJson(i,t)}catch(e){}return t&&r&&t!=r&&(o=this.projService.transform(o,r)),o}});return Object.defineProperty(i,"type",{value:21,configurable:!1,writable:!1}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(67),r(2),r(22),r(1)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{symbolConfig:!1},initialize:function(t){this.noneSpatialArr=[],this.elements=[],e.prototype.initialize.call(this,t)},_addListeners:function(){e.prototype._addListeners.call(this),this.map.listen("resolutionchanged",this._getZoomChangeLisener())},_removeListeners:function(){this.map.off("resolutionchanged",this._getZoomChangeLisener()),e.prototype._removeListeners.call(this)},_getZoomChangeLisener:function(){if(!this._zoomChangeLisener){var e=this;this._zoomChangeLisener=function(t){e.updateSymbol(t.level)}}return this._zoomChangeLisener},addElements:function(e,i){if(t.isArray(e)){i=i||{};for(var o=this.map.getZoomLevel(),a=this.options.spatialReference,s=i.dataSpatialReference||this.options.dataSpatialReference,l=0,c=e.length;l<c;l++){var u=e[l],f=this._getGeometry(u,s,a);if(f){var p=this._getSymbol(u,o),h=this._getRecordId(u),d=new n.sfs.Element({id:h,geometry:f,symbol:p.symbol});d._data=u,d._zoomRange=p.zoomRange,d._symbolKey=p.symbolKey,this.elements.push(d),this.layer.add(d)}else this.noneSpatialArr.push(u)}this._onSymbolsUpdated(),this._onElementChanged()}else r.error("dataArr is not an array")},_getGeometry:function(e,t,r){if(!e)return null;var i=e[this.options.geometryField],o=null;try{"string"==typeof i?(i=this.wktReader.read(i).toString(),o=n.sfs.GeometryFactory.createGeometryFromWkt(i,t)):o=n.sfs.GeometryFactory.createGeometryFromGeoJson(i,t)}catch(e){}return t&&r&&t!=r&&(o=this.projService.transform(o,r)),o}});return Object.defineProperty(i,"type",{value:31,configurable:!1,writable:!1}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(119),r(2),r(1)],void 0===(i=function(e,t,r){var n=e.extend({options:{geometryField:""},initialize:function(t){e.prototype.initialize.call(this,t),this.layer=new r.carto.ElementLayer({id:this.options.layerId,name:this.options.layerName,map:this.map}),this._addListeners()},_addListeners:function(){e.prototype._addListeners.call(this),this.map.listen("click",this._getMapClickListener())},_removeListeners:function(){this.map.off("click",this._getMapClickListener()),e.prototype._removeListeners.call(this)},_getMapClickListener:function(){if(!this._mapClickListener){var e=this;this._mapClickListener=function(t){var r=e.layer.hitTest(t.screenX,t.screenY);r&&e.fire("click",{id:r.element.id,element:r.element,layer:r.layer})}}return this._mapClickListener},updateStatistics:function(e){e&&this._updateStatistics(e)},_updateStatistics:function(e){if(e){var t=jQuery.extend(!0,{},e.statisticsData),r=e.symbol;"string"==typeof r&&(r=this.symbolConfig[r]),r=jQuery.extend(!0,{},r),this.statisticsData=t,this.layer.clear(!0),this._updateLayer(r),this._onSymbolsUpdated(e),this._onElementChanged()}},setVisible:function(e){this.layer.setVisible(!!e),this._visible=!!e,e?this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:this.currentSymbols}):this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:[]})},clear:function(t){this.layer.clear(),this.statisticsData=null,e.prototype.clear.call(this),t||(this._onSymbolsUpdated(),this._onElementChanged())},_updateLayer:function(e){var t,n=e.symbol,i=e.label;for(t in this.statisticsData){var o=this.statisticsData[t],a=this._getGeometry(o,this.options),s=this.getRingTextSymbol(o.value,n,i),l=new r.sfs.Element({id:t,geometry:a,symbol:s});l._data=o,this.layer.add(l)}},_onSymbolsUpdated:function(e){if(this.currentSymbols=null,e&&this.layer.elements.length>0){var t=this.layer.elements[0];this.currentSymbols=[{title:e.title,symbol:t.symbol,symbolKey:e.key}]}else this.currentSymbols=[];this.invokeCallback("symbolUpdateCallback",{layerId:this.options.layerId,symbols:this.currentSymbols})},getLayer:function(){return this.layer},getElements:function(){return this.layer.elements},_getGeometry:function(e,t){var n=null;if(this.options.geometryField){var i=e[this.options.geometryField];i&&(i instanceof String?(n=r.sfs.GeometryFactory.createGeometryFromWkt(i)).setSpatialReference(t.spatialReference):(n=r.sfs.GeometryFactory.createGeometryFromGeoJson(i)).setSpatialReference(t.spatialReference))}else n=new r.sfs.Point({x:e[t.xField],y:e[t.yField],spatialReference:t.spatialReference});return t.spatialReference&&t.destSpatialReference&&t.spatialReference!=t.destSpatialReference&&(n=this.projService.transform(n,t.destSpatialReference)),n},getRingTextSymbol:function(e,n,i){e+="",i=i||{},(n=n||{}).borderColor&&(n.borderColor=this._getColor(n.borderColor)),n.fillColor&&(n.fillColor=this._getColor(n.fillColor)),i.foreground&&(i.foreground=this._getColor(i.foreground)),i.borderColor&&(i.borderColor=this._getColor(i.borderColor));var o=i.fontSize||15,a=2*o/3,s=t.getEquivalentNum(e,a,a),l={borderColor:new r.sfs.Color({a:150,r:50,g:175,b:254}),fillColor:new r.sfs.Color({a:220,r:4,g:131,b:232}),borderThickness:s/2,size:s},c={text:e,fontSize:o,fontWeight:1,offsetX:0,offsetY:0,foreground:new r.sfs.Color({a:255,r:255,g:255,b:255}),borderColor:new r.sfs.Color({a:1,r:255,g:255,b:255}),borderThickness:0};jQuery.extend(!0,l,n),jQuery.extend(!0,c,i);var u=new r.sfs.SimpleMarkerSymbol(l),f=new r.sfs.TextSymbol(c);return new r.sfs.CurrencySymbol({markerSymbol:u,textSymbol:f})},destroy:function(){e.prototype.destroy.call(this)}});return Object.defineProperty(n,"type",{value:41,configurable:!1,writable:!1}),n}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(119),r(2),r(1)],void 0===(i=function(e,t,r){var n=e.extend({options:{geometryField:"",onPieClick:"",clickContext:window},initialize:function(t){e.prototype.initialize.call(this,t),this.statisticsDataType={},this.layer=new r.carto.FeatureLayer({id:this.options.layerId,map:this.map,visible:!1}),this._addListeners()},_addListeners:function(){e.prototype._addListeners.call(this)},_removeListeners:function(){e.prototype._removeListeners.call(this)},updateStatistics:function(e){e&&this._updateStatistics(e)},_updateStatistics:function(e){if(e){var t=jQuery.extend(!0,{},e.statisticsData),r=e.symbol;"string"==typeof r&&(r=this.symbolConfig[r]),r=jQuery.extend(!0,{},r);var n=0;for(var i in t){var o=t[i];if(o){0!=n||this.statisticsData?this._mergeStatisticsData(this.statisticsData,o):this.statisticsData=o;var a=i.split(",");for(var s in a)this.statisticsDataType[a[s]]=!0;n++}}this._updateLayer(r),this._onElementChanged()}},setVisible:function(e){this.renderer&&this.renderer.show(!!e),this._visible=!!e},clear:function(){this.layer.clear(),this.renderer=null,e.prototype.clear.call(this),this._onElementChanged()},_updateLayer:function(e){for(var n=e,i=this,o=new r.sfs.Fields,a=[],s=[],l=n.fields,c=0,u=l.length;c<u;c++){var f=l[c];if(f&&this.statisticsDataType[f.name]){var p=new r.sfs.Field({name:f.name,alias:f.alias});o.add(p),a.push(p),s.push(f.color)}}var h=new r.sfs.Field({name:"districtCode",alias:"政区编码"});o.add(h),this.layer.clear();var d=o.fields.length;if(!(d<1)){var y=0;for(var m in this.statisticsData){var g=this.statisticsData[m];if(g&&g.items){for(var v=g.items,b=[],_=0;_<d-1;_++){var w=v[(o.getField(_)||{}).name];isNaN(w)&&(w=0);var S=new r.sfs.Value;S.setValue(w),b.push(S)}var x=new r.sfs.Value;x.setValue(m),b.push(x);var L=new r.sfs.Feature({fields:o,values:b,geometry:this._getGeometry(g,this.options),objectId:y++});this.layer.add(L)}}if(!(y<1)){var P=new r.render.PieChart({fields:a,options:{type:1,color:s,name:n.title,labelStyle:n.labelStyle||{color:"#000",fontSize:10}}});this.renderer=new r.render.ChartRenderer({map:this.map,chartTemplate:P}),this.layer.render(this.renderer),this.setVisible(this._visible),P.onClick=function(e){var r=e.feature,n={id:r.values[r.values.length-1].getValue()};i.fire("click",n),t.isFunction(i.options.onPieClick)&&i.options.onPieClick.call(i.options.clickContext||window,n)}}}},getLayer:function(){return this.layer},getElements:function(){return this.layer.features},_getGeometry:function(e,t){var n=null;if(this.options.geometryField){var i=e[this.options.geometryField];i&&(i instanceof String?(n=r.sfs.GeometryFactory.createGeometryFromWkt(i)).setSpatialReference(t.spatialReference):(n=r.sfs.GeometryFactory.createGeometryFromGeoJson(i)).setSpatialReference(t.spatialReference))}else{var o=new r.sfs.Point({x:parseFloat(e[t.xField]),y:parseFloat(e[t.yField]),spatialReference:t.spatialReference}),a=new r.sfs.Envelope({minx:o.x-.1,maxx:o.x+.1,miny:o.y-.1,maxy:o.y+.1,spatialReference:t.spatialReference});n=r.sfs.GeometryFactory.createGeometryFromWkt(a.asWkt())}return t.spatialReference&&t.destSpatialReference&&t.spatialReference!=t.destSpatialReference&&(n=this.projService.transform(n,t.destSpatialReference)),n},destroy:function(){e.prototype.destroy.call(this)}});return Object.defineProperty(n,"type",{value:42,configurable:!1,writable:!1}),n}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n;void 0===(n=function(){var e=function(e){this.map=e};return e.prototype.createLayer=function(e,t){var r,n=this._getClazzObj()[e],i=t||{};if(i.hasOwnProperty("map")||(i.map=this.map),!n)throw new Error("未定义的图层类型！"+e);return(r=new n(i)).getLayer().layerGroups=i.layerGroups||"add",r},e.prototype.createLayerByClass=function(e,t){var r,n;if(-1!=e.indexOf("lys")?(r=/^((g2)|(G))\.lys\.(.*)$/,n=e+""):(r=/^((g2)|(G))\.carto\.(.*)$/,n=e+""),!r.test(n))throw new Error("错误的图层类名！");var i,o=n.match(r);i=-1!=e.indexOf("lys")?window[o[1]].lys[o[4]]:window[o[1]].carto[o[4]];var a=t||{};a.hasOwnProperty("map")||(a.map=this.map);var s=new i(a);a.attr&&(s.attr=a.attr);var l={opacity:"setOpacity",visible:"setVisible",zIndex:"setZIndex"},c=s instanceof G.lys.BaseLayer?s.getLayer():s;for(var u in l)t.hasOwnProperty(u)&&c[l[u]]&&c[l[u]](t[u]);return s},e.prototype._getClazzObj=function(){if(!this._classObj){var e={};e[G.lys.TYPES.ELEMENT_POINT_LAYER]=G.lys.PointLayer,e[G.lys.TYPES.FEATURE_POINT_LAYER]=G.lys.FeaturePointLayer,e[G.lys.TYPES.ELEMENT_POINT_PIXEL_CLUSTER]=G.lys.PointClusterLayer,e[G.lys.TYPES.ELEMENT_POINT_DUPLICATE]=G.lys.PointDuplicateLayer,e[G.lys.TYPES.ELEMENT_POLYLINE_LAYER]=G.lys.LineLayer,e[G.lys.TYPES.ELEMENT_POLYGON_LAYER]=G.lys.PolygonLayer,e[G.lys.TYPES.PIE_STATISTICS_LAYER]=G.lys.PieStatisticsLayer,e[G.lys.TYPES.RING_STATISTICS_LAYER]=G.lys.RingStatisticsLayer,this._classObj=e}return this._classObj},e}.apply(t,[]))||(e.exports=n)},function(e,t,r){"use strict";var n,i;n=[r(15),r(36),r(115),r(1)],void 0===(i=function(e,t,r,n){function i(e){n.carto.ElementLayer.call(this,e)}return i.prototype={options:{hasEvent:!1},constructor:i,addTo:function(e){e instanceof r?this.map=this.options.g2map=e.getMap():e instanceof n.carto.Map&&(this.map=this.options.g2map=e),this.options.g2map&&(this.onAdd&&this.onAdd(),this.options.hasEvent&&this.addhitTest&&this.addhitTest(),this.options.g2map.addLayer(this))},remove:function(){this.options.g2map&&(this.onRemove&&this.onRemove(),this.options.hasEvent&&this.removehitTest&&this.removehitTest(),this.options.g2map.removeLayer(this))}},e.defaults(i,e,!0),e.mixin(i,t.prototype),e.mixin(i,n.carto.ElementLayer),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=[r(15),r(1)],void 0===(i=function(e,t){function r(r,n){e.setOptions(this,n),this.coords=r,this.options.geometry=this.getGeometry(),t.sfs.Element.call(this,this.options)}return r.prototype={options:{},constructor:r,getGeometry:function(){var e=Object.prototype.toString;return this.coords instanceof t.sfs.Point?this.coords:"[object Array]"===e.call(this.coords)?new t.sfs.Point({x:this.coords[0],y:this.coords[1],spatialReference:this.options.spatialReference}):"[object String]"===e.call(this.coords)&&this.coords.indexOf("point")>-1?t.sfs.GeometryFactory.createGeometryFromWkt(this.coords):("function"==typeof this.coords||this.coords&&"object"==o(this.coords))&&"Point"==this.coords.type?t.sfs.GeometryFactory.createGeometryFromGeoJson(this.coords):void console.error("数据类型错误，只支持数组坐标、g2.sfs.Point、geojson、wkt")},envelope:function(){return this.getGeometry().envelope()},toString:function(){return this.getGeometry().asWkt()}},e.inherits(r,t.sfs.Element),r}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=[r(15),r(1)],void 0===(i=function(e,t){function r(r,n){e.setOptions(this,n),this.coords=r,this.options.geometry=this.getGeometry(),t.sfs.Element.call(this,this.options)}return r.prototype={options:{},constructor:r,getGeometry:function(){var e=Object.prototype.toString;return this.coords instanceof t.sfs.Polygon?this.coords:"[object Array]"===e.call(this.coords)?this._areaPolygon(this.coords):"[object String]"===e.call(this.coords)&&this.coords.indexOf("polygon")>-1?t.sfs.GeometryFactory.createGeometryFromWkt(this.coords):("function"==typeof this.coords||this.coords&&"object"==o(this.coords))&&"Polygon"==this.coords.type?t.sfs.GeometryFactory.createGeometryFromGeoJson(this.coords):void console.error("数据类型错误，只支持数组坐标、g2.sfs.Polygon、geojson、wkt")},_ring:function(e){var r=new t.sfs.Ring;return e.map((function(e){var n=e instanceof t.sfs.Point?e:new t.sfs.Point({x:e[0],y:e[1]});r.addPoint(n)})),r},_areaPolygon:function(e){var r=new t.sfs.Polygon;return e&&e[0]&&e[0][0]&&2==e[0][0].length?e.map($.proxy((function(e){r.addGeometry(this._ring(e))}),this)):r.addGeometry(this._ring(e)),r},envelope:function(){return this.getGeometry().envelope()},toString:function(){return this.getGeometry().asWkt()}},e.inherits(r,t.sfs.Element),r}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n={Class:r(15),ComponentBase:r(9),IHttpRequest:r(162),HttpRequest:r(399),AppEvent:r(36),AppEvents:r(44),UiComponent:r(401),PureComponent:r(18),ControlBase:r(402),ModuleBase:r(403),ServiceBase:r(404),ContainerManager:r(163),subUiComponent:r(405)};e.exports=n},function(e,t,r){var n=r(37),i=r(400).fetch;function o(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}var a=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype._request=function(e,t,r,a,s,l){var c,u,f=this;return new Promise((c=regeneratorRuntime.mark((function c(u,p){var h,d,y;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(c.prev=0,(h={}).method=e,h.headers={},s=s||"application/json",h.headers["Content-Type"]=s,n(h.headers,l||{}),"POST"!=e){c.next=19;break}c.t0=s,c.next="application/json"===c.t0?11:"application/x-www-form-urlencoded"===c.t0?13:15;break;case 11:return h.body=JSON.stringify(a),c.abrupt("break",17);case 13:return h.body=f._parseFormParams(a),c.abrupt("break",17);case 15:return h.body=a,c.abrupt("break",17);case 17:c.next=22;break;case 19:t.indexOf("?")<0&&(t+="?"),t+="&",t+=f._parseFormParams(a);case 22:return c.next=24,i(t,h);case 24:d=c.sent,r=r||"json",o(d),y=null,c.t1=r,c.next="json"===c.t1?31:"blob"===c.t1?33:"text"===c.t1?35:(c.t1,35);break;case 31:return y=d.json(),c.abrupt("break",36);case 33:return y=d.blob(),c.abrupt("break",36);case 35:y=d.text();case 36:u(y),c.next=42;break;case 39:c.prev=39,c.t2=c.catch(0),p(c.t2);case 42:case"end":return c.stop()}}),c,f,[[0,39]])})),u=function(){var e=c.apply(this,arguments);return new Promise((function(t,r){return function n(i,o){try{var a=e[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));t(s)}("next")}))},function(e,t){return u.apply(this,arguments)}))},t.prototype._parseFormParams=function(e){var t="";for(var r in e)t+=r,t+="="+e[r],t+="&";return t},t.prototype.get=function(e,t,r,n,i){return this._request("GET",e,t,r,n,i)},t.prototype.post=function(e,t,r,n,i){return this._request("POST",e,t,r,n,i)},t.prototype.put=function(e,t,r,n,i){return this._request("PUT",e,t,r,n,i)},t.prototype.delete=function(e,t,r,n,i){return this._request("DELETE",e,t,r,n,i)},t}(r(162));e.exports=a},function(e,t,r){"use strict";r.r(t),r.d(t,"Headers",(function(){return c})),r.d(t,"Request",(function(){return m})),r.d(t,"Response",(function(){return v})),r.d(t,"DOMException",(function(){return _})),r.d(t,"fetch",(function(){return w}));var n={searchParams:"URLSearchParams"in self,iterable:"Symbol"in self&&"iterator"in Symbol,blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in self,arrayBuffer:"ArrayBuffer"in self};if(n.arrayBuffer)var i=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(e){return e&&i.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function s(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n.iterable&&(t[Symbol.iterator]=function(){return t}),t}function c(e){this.map={},e instanceof c?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function u(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function f(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function p(e){var t=new FileReader,r=f(t);return t.readAsArrayBuffer(e),r}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function d(){return this.bodyUsed=!1,this._initBody=function(e){this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:n.blob&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:n.formData&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():n.arrayBuffer&&n.blob&&function(e){return e&&DataView.prototype.isPrototypeOf(e)}(e)?(this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):n.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||o(e))?this._bodyArrayBuffer=h(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n.blob&&(this.blob=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?u(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var e,t,r,n=u(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,r=f(t),t.readAsText(e),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}c.prototype.append=function(e,t){e=a(e),t=s(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},c.prototype.delete=function(e){delete this.map[a(e)]},c.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},c.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},c.prototype.set=function(e,t){this.map[a(e)]=s(t)},c.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},c.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),l(e)},c.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),l(e)},c.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),l(e)},n.iterable&&(c.prototype[Symbol.iterator]=c.prototype.entries);var y=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function m(e,t){var r,n,i=(t=t||{}).body;if(e instanceof m){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new c(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new c(t.headers)),this.method=(r=t.method||this.method||"GET",n=r.toUpperCase(),y.indexOf(n)>-1?n:r),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function v(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new c(t.headers),this.url=t.url||"",this._initBody(e)}m.prototype.clone=function(){return new m(this,{body:this._bodyInit})},d.call(m.prototype),d.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new c(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var b=[301,302,303,307,308];v.redirect=function(e,t){if(-1===b.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})};var _=self.DOMException;try{new _}catch(e){(_=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack}).prototype=Object.create(Error.prototype),_.prototype.constructor=_}function w(e,t){return new Promise((function(r,i){var o=new m(e,t);if(o.signal&&o.signal.aborted)return i(new _("Aborted","AbortError"));var a=new XMLHttpRequest;function s(){a.abort()}a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new c,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}})),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new v(i,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.onabort=function(){i(new _("Aborted","AbortError"))},a.open(o.method,o.url,!0),"include"===o.credentials?a.withCredentials=!0:"omit"===o.credentials&&(a.withCredentials=!1),"responseType"in a&&n.blob&&(a.responseType="blob"),o.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",s),a.onreadystatechange=function(){4===a.readyState&&o.signal.removeEventListener("abort",s)}),a.send(void 0===o._bodyInit?null:o._bodyInit)}))}w.polyfill=!0,self.fetch||(self.fetch=w,self.Headers=c,self.Request=m,self.Response=v)},function(e,t,r){"use strict";var n,i;n=[r(9),r(2),r(68),r(163)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{map:null,htmlPath:"",cssPath:"",cssName:""},includes:n.prototype,initialize:function(n){e.prototype.initialize.call(this,n),this._cssPath=n.cssPath,this._htmlPath=n.htmlPath;var i=this.options.cssName;if(i){var o=[];if(t.isArray(i))for(var a=0,s=i.length;a<s;a++)o.push(this._cssPath+i[a]);else t.isString(i)&&o.push(this._cssPath+this.options.cssName);r.loadCss(o)}},destroy:function(){try{this.remove()}catch(e){}e.prototype.destroy.call(this)}});return i.include({loadHtml:function(e,r,n){var i=this;jQuery(e).load(r,(function(){t.isFunction(n)&&n.call(i)}))}}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(9),r(164),r(2),r(68)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{style:{},dragable:!1,staticPath:"",cssPath:"",configPath:"",imgPath:"",htmlPath:"",resourcePath:""},TYPE:"Control",initialize:function(t){e.prototype.initialize.call(this,t)},onAdd:function(){try{this.onRemove()}catch(e){}},onRemove:function(){},destroy:function(){this.onRemove(),e.prototype.destroy.call(this)}});return i.include({getResourcePath:function(){if(!this._resourcePath){var e=this.options.name||"Anonymous";e.endsWith("Ctrl")||(e+="Ctrl"),this._resourcePath=n.getControlPath(e)}return this._resourcePath},setResourcePath:function(e){e?(this._resourcePath=(e+"").replace(/([\/\\]+)/g,"/"),this._resourcePath.endsWith("/")||(this._resourcePath=this._resourcePath+"/")):this._resourcePath=null}}),t.enable(i),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";(function(e){var n,i;n=[r(9),r(164),r(68),r(2)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{staticPath:"",cssPath:"",configPath:"",imgPath:"",htmlPath:"",resourcePath:""},TYPE:"Module",initialize:function(t){e.prototype.initialize.call(this,t)},onOpen:function(){},onClose:function(){},destroy:function(){this.onClose()},getResourcePath:function(){if(!this._resourcePath){var e=this.options.name||"Anonymous";e.endsWith("Module")||(e+="Module"),this._resourcePath=r.getModulePath(e)}return this._resourcePath},setResourcePath:function(e){e?(this._resourcePath=(e+"").replace(/([\/\\]+)/g,"/"),this._resourcePath.endsWith("/")||(this._resourcePath=this._resourcePath+"/")):this._resourcePath=null}});return t.enable(i),i}.apply(t,n))||(e.exports=i)}).call(this,r(161)(e))},function(e,t,r){"use strict";var n,i;n=[r(15),r(2)],void 0===(i=function(e,t){return e.extend({options:{url:"",params:void 0,dataType:"jsonp"},initialize:function(t){e.setOptions(this,t)},execute:function(e){var t=$.Deferred(),r=$.extend(!0,{},this.options,e);return r.success=this._getResult(t,r),r.error=this._getError(t,r),$.ajax(r),t},_getResult:function(e,r){var n=this;return function(i){var o=r.context?r.context:n;if(t.isFunction(r.callback)){var a=r.stripData?r.stripData(i):n.stripData(i);r.callback.call(o,a)}else{null==(a=r.stripData?r.stripData(i):n.stripData(i))&&e.reject(a),e.resolveWith(o,[a])}}},_getError:function(e,t){return function(r,n,i){var o=t.context?t.context:this;e.rejectWith(o,[r]),t.error&&t.error()}},stripData:function(e){return e||[]},destroy:function(){for(var e in this)this[e]=null,delete this[e]}})}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(15)],void 0===(i=function(e){return e.extend({options:{el:void 0},addTo:function(e){this.options.el=e,this._container1=this.onAdd(map),$(this.options.el).append($(this._container1))},remove:function(){this.onRemove(),$(this._container1).remove()}})}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(407),r(86),r(120),r(414),r(418)],void 0===(i=function(e,t,r,n,i){var o={PlotComponent:e,PlotSchema:t,PlotSyncComponent:n,CollaborativePlotComponent:i};return Object.defineProperty(o,"TYPES",{value:r.TYPES_KEYS,configurable:!1,writable:!1}),o}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(2),r(14),r(22),r(16),r(408),r(409),r(120),r(86),r(18),r(410),r(44),r(1)],void 0===(i=function(e,t,r,n,i,o,a,s,l,c,u,f){var p=a.PATTERNS,h=(a.TYPES,a.TYPES_KEYS),d=l.extend({options:{layerId:"plot-layer",symbols:{text:{type:"TextSymbol",options:{fontFamilyName:"宋体",fontSize:12,foreground:{a:255,r:0,g:0,b:255},borderColor:{a:1,r:255,g:255,b:255},borderThickness:0}},point:{type:"SimpleMarkerSymbol",options:{style:"circle",borderColor:{a:153,r:0,g:0,b:0},fillColor:{a:153,r:65,g:105,b:225},borderThickness:2,size:4}},line:{type:"SimpleLineSymbol",options:{color:{a:153,r:0,g:0,b:255},width:2,style:5}},polygon:{type:"SimpleFillSymbol",options:{borderColor:{a:153,r:0,g:0,b:255},fillColor:{a:150,r:19,g:181,b:177},borderThickness:0,opacity:1}},tailedtext:{type:"SimpleMarkerSymbol",options:{borderColor:{a:200,r:0,g:0,b:0},fillColor:{a:153,r:65,g:105,b:225},borderThickness:1,size:3}}}},initialize:function(e){l.prototype.initialize.call(this,e),this._plotLayer=this.getLayer(),this._initTools(),this._currentTool=null,this.map.listen("click",this._mapClickHandler,this),this._freedrawtoolpolygon=new i,this._freedrawtoolpolyline=new o,this._addTailedComponent(this.map)},destroy:function(){this.map.off("click",this._mapClickHandler,this),this.options.tailedLabelComponent.destroy(),l.prototype.destroy.call(this)}});return d.include({plotText:function(e){e=e||{};var t=this._getAlgorithm(h.Point);if(null==t)throw new Error("参数类型错误！");this._plotEditTool.deactivate();var r=this.map.getMap(),n={};n.pattern=p.TEXT,n.type=h.Point,n.algorithm=t,n.symbol=e.symbol,n.text=e.text||"";var i=new f.sfs.Point({spatialReference:r.spatialReference});n.geometry=i,n.callback=e.callback,n.context=e.context,this._constructPlotTool(n).onClick()},plotTailedText:function(e){console.log("ploattailedText添加一次"),e=e||{};var t=this._getAlgorithm(h.TAILEDTEXT);if(null==t)throw new Error("参数类型错误！");this._plotEditTool.deactivate();var r=this.map.getMap(),n={};n.pattern=p.TAILEDTEXT,n.type=h.Point,n.algorithm=t,n.symbol=e.symbol,n.text=e.text||"";var i=new f.sfs.Point({spatialReference:r.spatialReference});n.geometry=i,n.callback=this.addTailedEle,n.context=e.context,this._constructPlotTool(n).onClick()},addTailedEle:function(e,t){t.options.tailedLabelComponent.layer;var r=e.id,n={},i={type:"Point",coordinates:[e.elements[0].geometry.x,e.elements[0].geometry.y]};n.geometry=i,n.label="自定义文本内容",n.id=r;t.options.tailedLabelComponent.add(n);console.log(e);var o=t.options.tailedLabelComponent._getTailedLabel(r);e.tailedLabelAttr=o.serialize(),o.on("updateTailedLabelAttr",(function(){var e=this._id;t.getPlotElementById(e).tailedLabelAttr=this.serialize()})),o.on("tailedLabelClick",(function(){var e=this._id;t.fire("openTailedLabelEdit",t.getPlotElementById(e))}))},plotMarker:function(e){e=e||{};var t=this._getAlgorithm(h.Point);if(null==t)throw new Error("参数类型错误！");this._plotEditTool.deactivate();var r=this.map.getMap(),n={};n.pattern=p.POINT,n.type=h.Point,n.algorithm=t,n.symbol=e.symbol;var i=new f.sfs.Point({spatialReference:r.spatialReference});n.geometry=i,n.callback=e.callback,n.context=e.context,this._constructPlotTool(n).onClick()},plotPolyline:function(e){if((e=e||{}).type==h.FreePolyline){(r={}).symbol=e.symbol,r.callback=e.callback,this.plotFreeDrawPolyline(r)}else{(r={}).map=this.map.getMap(),r.size=e.size;var t=this._getAlgorithm(e.type||h.Polyline,r);if(null==t)throw new Error("参数类型错误！");this._plotEditTool.deactivate();var r,n=this.map.getMap();(r={}).pattern=p.POLYLINE,r.type=e.type||h.Polyline,r.algorithm=t,r.symbol=e.symbol;var i=new f.sfs.Path({spatialReference:n.spatialReference}),o=new f.sfs.Polyline({spatialReference:n.spatialReference});o.addGeometry(i),r.geometry=o,r.callback=e.callback,r.context=e.context,this._constructPlotTool(r).onClick()}},plotPolygon:function(e){if((e=e||{}).type==h.FreePolygon){(r={}).map=this.map.getMap(),r.drawLayer=this._plotLayer,r.pattern=p.POLYGON,r.appevent=u.PLOT_CREATED,r.type=h.Polygon,r.symbol=e.symbol,r.callback=e.callback,r.context=this,this.plotFreeDrawPolygon(r)}else{(r={}).map=this.map.getMap(),r.size=e.size;var t=this._getAlgorithm(e.type||h.Polygon,r);if(null==t)throw new Error("参数类型错误！");this._plotEditTool.deactivate();var r,n=this.map.getMap();(r={}).pattern=p.POLYGON,r.type=e.type||h.Polygon,r.algorithm=t,r.symbol=e.symbol;var i=new f.sfs.Ring({spatialReference:n.spatialReference}),o=new f.sfs.Polygon({spatialReference:n.spatialReference});o.addGeometry(i),r.geometry=o,r.callback=e.callback,r.context=e.context,this._constructPlotTool(r).onClick()}},plotComposite:function(t){t=t||{},(n={}).map=this.map.getMap(),n.size=t.size;var r=this._getAlgorithm(t.type,n);if(null==r)throw new Error("参数类型错误！");this._plotEditTool.deactivate();var n,i=this.map.getMap();(n={}).pattern=p.COMPOSITE,n.type=p.POLYGON,n._type=t.type,n.algorithm=r,e.isArray(t.symbol)?n.symbol=t.symbol:e.isObject(t.symbol)&&(n.symbol=[t.symbol,t.symbol]);var o=new f.sfs.Ring({spatialReference:i.spatialReference}),a=new f.sfs.Polygon({spatialReference:i.spatialReference});a.addGeometry(o);var s=new f.sfs.Path({spatialReference:i.spatialReference}),l=new f.sfs.Polyline({spatialReference:i.spatialReference});l.addGeometry(s),n.geometry=[a,l],n.callback=t.callback,n.context=t.context,this._constructPlotTool(n).onClick()},plotFreeDrawPolyline:function(e){var t=this.map.getMap(),r=this._plotLayer,n=e.callback,i=e.symbol||this.options.symbols.line,o=p.POLYLINE,a=h.Polyline,s=u.PLOT_CREATED,l=e.context,c=new f.sfs.Path({spatialReference:t.spatialReference}),d=new f.sfs.Polyline({spatialReference:t.spatialReference});d.addGeometry(c);var y=new f.sfs.Element({geometry:d,symbol:this._getDefaultSymbol(o,i)});this._freedrawtoolpolyline.onCreate({map:t,spatialRef:t.spatialReference,callBack:n,drawLayer:r,templateElement:y,lineSymbol:i,pattern:o,type:a,appevent:s,context:this,contextx:l}),this._currentTool=this._freedrawtoolpolyline,this._freedrawtoolpolyline.onClick()},plotFreeDrawPolygon:function(e){var t=this.map.getMap(),r=this._plotLayer,n=e.callback,i=e.symbol||this.options.symbols.polygon,o=p.POLYGON,a=h.Polygon,s=u.PLOT_CREATED,l=e.context,c=new f.sfs.Path({spatialReference:t.spatialReference}),d=new f.sfs.Polyline({spatialReference:t.spatialReference});d.addGeometry(c);var y=new f.sfs.Element({geometry:d,symbol:this._getDefaultSymbol(o,i)});this._freedrawtoolpolygon.onCreate({map:t,spatialRef:t.spatialReference,callBack:n,drawLayer:r,templateElement:y,fillSymbol:i,pattern:o,type:a,appevent:s,context:this,contextx:l}),this._currentTool=this._freedrawtoolpolygon,this._freedrawtoolpolygon.onClick()},plot:function(t){var r={};r[p.TEXT]=this.plotText,r[p.TAILEDTEXT]=this.plotTailedText,r[p.POINT]=this.plotMarker,r[p.POLYLINE]=this.plotPolyline,r[p.POLYGON]=this.plotPolygon,r[p.COMPOSITE]=this.plotComposite,t=t||{};var n=this._getAlgorithm(t.type);if(null==n)throw new Error("参数类型错误！");var i=r[n._type];if(e.isFunction(i)){var o=jQuery.extend(!0,{},t);i.call(this,o)}}}),d.include({onPlotClick:function(e,t){this._plotClickObj={callback:e,context:t}},getLayer:function(){if(!this._plotLayer){var e=this.options.layerId,r=this.map.getMap(),n=t.getLayerById(this.map,e);n||(n=new f.carto.ElementLayer({map:r,id:e}),r.addLayer(n)),this._plotLayer=n}return this._plotLayer},getPlotElements:function(){return this._plotLayer.elements},getPlotElementById:function(e){return this._plotLayer.find(e)||null},cancelPlot:function(){this._cancelPlot(),this._fireEvent(u.PLOT_CANCELED)},enableEdit:function(e){!0===e?(this._plotEditTool._enabled_=!0,this._resetToolState()):(this._plotEditTool._enabled_=!1,this._resetToolState())},finishPlot:function(){if(null==this._currentTool||1==this._currentTool.isEndDraw||null==this._lastControlPoint)throw new Error("当前无未完成的标绘！");this._currentTool.endDraw(this._lastControlPoint)},getSelectedElements:function(){return this._plotEditTool.selectionSet.graphiclist},selectPlotElement:function(e){var t=this.getPlotElementById(e);if(t)try{var n=t.elements[0].geometry.asWkt(),i=n.replace(/[^\d^\.^\,^\ ]/g,""),o=this.map.getMap(),a=i.split(",")[0].split(" "),s=parseFloat(a[0]),l=parseFloat(a[1]),c=o.getPixelFromCoordinate([s,l]);this._plotEditTool.onMouseDown(null,null,c[0],c[1])}catch(e){throw new Error(e)}else r.warn("标绘元素不存在！")},updatePlotElement:function(t){t=t||{};var i=[],o=null,a=this._plotLayer.find(t.id);if(a){if("composite"==a.kind){var s=a.elements[1],l=a.elements[0],c=t.symbol,p=t.plotProperty;if(o=new f.sfs.Attribute({name:"data",value:p}),i.push(o),l.attributeSet.attributes=i,e.isObject(c)){var h=n.object2Symbol(c.type,c.options);return l.symbol=h,s.symbol.color=h.borderColor,s.symbol.width=h.borderThickness,this._plotLayer.update(a,!0),this._fireEvent(u.PLOT_UPDATED,{element:a}),!0}return!1}if("tailedtext"==a.kind){var d=a.elements[a.elements.length-1];c=t.symbol;if(o=new f.sfs.Attribute({name:"data",value:p}),i.push(o),d.attributeSet.attributes=i,e.isObject(c)){var y=t.symbol.options;this.options.tailedLabelComponent.update(t.id,y.domHtml,y);var m=this.options.tailedLabelComponent._getTailedLabel(t.id);return a.tailedLabelAttr=m.serialize(),this._fireEvent(u.PLOT_UPDATED,{element:a}),!0}return!1}d=a.elements[a.elements.length-1],c=t.symbol,p=t.plotProperty;if(o=new f.sfs.Attribute({name:"data",value:p}),i.push(o),d.attributeSet.attributes=i,e.isObject(c)){h=n.object2Symbol(c.type,c.options);return d.symbol=h,this._plotLayer.update(a,!0),this._fireEvent(u.PLOT_UPDATED,{element:a}),!0}return!1}r.warn("元素不存在，id="+t.id)},removePlotElement:function(e){var t=this._removePlotElement(e);return this._removeTailedText(e),null!=t&&this._fireEvent(u.PLOT_DELETE,{elements:[t]}),t},removePlotElements:function(e){for(var t=(e=e||"").split(","),r=[],n=0,i=t.length;n<i;n++){var o=t[n],a=this.removePlotElement(o);null!=a&&r.push(a)}return this._fireEvent(u.PLOT_DELETE,{elements:r}),r},clearPlotElements:function(){var e=this._plotLayer.elements;return this._plotLayer.clear(),this.options.tailedLabelComponent&&this.options.tailedLabelComponent.removeAll(),this._fireEvent(u.PLOT_DELETE,{elements:e}),e},getPlotSchema:function(t){for(var r=(t=t||{}).id||e.newUUID32(),n=new s({id:r,name:t.name||"",userId:t.groupId}),i=[],o=0,a=(i=e.isArray(t.elements)?t.elements:this._plotLayer.elements).length;o<a;o++){var l=i[o];if(l){var c=l.copy();if(c.unReset(),!0===t.reserveId&&(c.id=l.id),c._belong_schema=r,"tailedtext"==c.kind){var u=this.options.tailedLabelComponent._getTailedLabel(l.id);u._id=c.id,u.options.id=c.id,c.tailedLabelAttr=u.serialize()}n.addElement(c)}}return JSON.stringify(n)},loadPlotSchema:function(t){var r;if(t=t||{},e.isString(t.schema))try{r=s.fromJson(t.schema)}catch(e){throw new Error("参数类型错误！")}else r=t.schema;for(var n=0;n<r.getCount();++n){var i=r.getElement(n);i.reset(),this._plotLayer.contains(i.id)||(this._plotLayer.add(i),"tailedtext"==i.kind&&this._loadTailedlabel(i),i._schemaId=r.id)}},toggleElement:function(e,t){this.options.tailedLabelComponent._getTailedLabel(e).toggleVisible(t);var r=this.options.tailedLabelComponent.layer,n=r.find(e);r.showElement(n,t)}}),c.extend(d),d}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(2),r(1)],void 0===(i=function(e,t){var r="NoopTool",n=function(e){var r=e||{};r.cursor=r.cursor||"crosshair",t.interact.Tool.call(this,r),this.drawElement=null,this.geoBuilder=new t.draw.GeometryBuilder,this.isEndDraw=!0,this.geoLinePolygon=null};return t.core.ClassUtil.extend2(n,t.interact.Tool),n.prototype.onClick=function(e){n.prototype.uber.onClick.call(this,e),this.pushNum=0},n.prototype.onCreate=function(e){n.prototype.uber.onCreate(e),this.map=e.map,this.srid=e.spatialRef,this.callBack=e.callBack,this.templateElement=e.templateElement,this.drawLayer=e.drawLayer,this.fillSymbol=e.fillSymbol,this.pattern=e.pattern,this.type=e.type,this.appevent=e.appevent,this.context=e.context,this.contextx=e.contextx},n.prototype.onMouseClick=function(e,r,n,i,o,a,s){if(this.templateElement&&this.isEndDraw){this.map.stopDbClick(),this.isEndDraw=!1;var l=new t.sfs.Point({x:o,y:a,spatialReference:this.srid});this.drawElement=this.templateElement.copy();var c=this.drawElement.geometry;this.geoBuilder.build(c,l,1,this.pushNum),this.drawLayer.add(this.drawElement)}},n.prototype.onMouseMove=function(e,r,n,i,o,a,s){if(!this.isEndDraw){var l=new t.sfs.Point({x:o,y:a});this.context._lastControlPoint=l;var c=this.drawElement.geometry;this.geoBuilder.build(c,l,2,this.pushNum),this.drawLayer.update(this.drawElement)}},n.prototype.onDblclick=function(n){if(!this.isEndDraw){this.isEndDraw=!0;var i=this.drawElement.geometry;this.geoBuilder.build(i,null,4,this.pushNum),this.geoLinePolygon=null,this.lintToPolygon(this,i);var o={};o.geometry=this.geoLinePolygon,o.symbol=this.fillSymbol,o.name="freePlot";var a=this.context._constructPlotElement(this.pattern,o);this.drawLayer.remove(this.drawElement),this.drawLayer.add(a),this.pushNum=0,this.map.resumeDbClick(),this.drawElement=null;var s=new t.gdm.CommandManager,l=new t.gdm.CommandNotify({manager:s}),c=new t.interact.NoopTool({id:r,cursor:"pointer"});s.add(c);var u=new t.carto.GraphicSelectionSet;s.onCreate({map:this.map,commandNotify:l,graphicSelectionSet:u,spatialRef:{srid:this.srid}});var f=(new jsts.io.GeoJSONReader).read(this.geoLinePolygon.asGeoJson());e.isFunction(this.callBack)&&(f.isValid()?this.callBack.call(this.contextx,this.geoLinePolygon.asGeoJson()):this.callBack.call(this.contextx,null)),l.activeCommand(r),this.context._fireEvent(this.appevent,{type:this.type,element:a}),this.context._cancelPlot(),this.context._resetToolState()}},n.prototype.endDraw=function(){this.onDblclick()},n.prototype.lintToPolygon=function(e,r){var n="POLYGON((";if(1==r.paths.length){var i=r.paths[0].points;i.push(i[0]);var o=i.length,a=[];if(o>200){var s=o-200;if(o<=400)for(var l=Math.floor(o/s),c=1,u=0;u<o;u++)u==c*l?(c++,0!=u&&1!=u&&u!=o-1&&u!=o-2||a.push(i[u])):a.push(i[u]);else for(l=Math.ceil(o/200),c=1,u=0;u<o;u++)u==c*l?(c++,a.push(i[u])):0!=u&&1!=u&&u!=o-1&&u!=o-2||a.push(i[u]);o=(i=a).length}for(var f=0;f<i.length-1;f++)n=n+i[f].x.toFixed(5)+" "+i[f].y.toFixed(5)+",";n=n+i[o-1].x.toFixed(5)+" "+i[o-1].y.toFixed(5)}n+="))",e.geoLinePolygon=new t.sfs.GeometryFormatter.fromWKT(n,e.srid)},n}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(2),r(1)],void 0===(i=function(e,t){var r="NoopTool",n=function(e){var r=e||{};r.cursor=r.cursor||"crosshair",t.interact.Tool.call(this,r),this.drawElement=null,this.geoBuilder=new t.draw.GeometryBuilder,this.isEndDraw=!0,this.geoLinePolyline=null};return t.core.ClassUtil.extend2(n,t.interact.Tool),n.prototype.onClick=function(e){n.prototype.uber.onClick.call(this,e),this.pushNum=0},n.prototype.onCreate=function(e){n.prototype.uber.onCreate(e),this.map=e.map,this.srid=e.spatialRef,this.callBack=e.callBack,this.templateElement=e.templateElement,this.drawLayer=e.drawLayer,this.lineSymbol=e.lineSymbol,this.pattern=e.pattern,this.type=e.type,this.appevent=e.appevent,this.context=e.context,this.contextx=e.contextx},n.prototype.onMouseClick=function(e,r,n,i,o,a,s){if(this.templateElement&&this.isEndDraw){this.map.stopDbClick(),this.isEndDraw=!1;var l=new t.sfs.Point({x:o,y:a,spatialReference:this.srid});this.drawElement=this.templateElement.copy();var c=this.drawElement.geometry;this.geoBuilder.build(c,l,1,this.pushNum),this.drawLayer.add(this.drawElement)}},n.prototype.onMouseMove=function(e,r,n,i,o,a,s){if(!this.isEndDraw){var l=new t.sfs.Point({x:o,y:a});this.context._lastControlPoint=l;var c=this.drawElement.geometry;this.geoBuilder.build(c,l,2,this.pushNum),this.drawLayer.update(this.drawElement)}},n.prototype.onDblclick=function(n){if(!this.isEndDraw){this.isEndDraw=!0;var i=this.drawElement.geometry;this.geoBuilder.build(i,null,4,this.pushNum),this.geoLinePolyline=null,this.lintToPolyline(this,i);var o={};o.geometry=this.geoLinePolyline,o.symbol=this.lineSymbol,o.name="freePlot";var a=this.context._constructPlotElement(this.pattern,o);this.drawLayer.remove(this.drawElement),this.drawLayer.add(a),this.pushNum=0,this.map.resumeDbClick(),this.drawElement=null;var s=new t.gdm.CommandManager,l=new t.gdm.CommandNotify({manager:s}),c=new t.interact.NoopTool({id:r,cursor:"pointer"});s.add(c);var u=new t.carto.GraphicSelectionSet;s.onCreate({map:this.map,commandNotify:l,graphicSelectionSet:u,spatialRef:{srid:this.srid}});var f=(new jsts.io.GeoJSONReader).read(this.geoLinePolyline.asGeoJson());e.isFunction(this.callBack)&&(f.isValid()?this.callBack.call(this.contextx,this.geoLinePolyline.asGeoJson()):this.callBack.call(this.contextx,null)),l.activeCommand(r),this.context._fireEvent(this.appevent,{type:this.type,element:a}),this.context._cancelPlot(),this.context._resetToolState()}},n.prototype.endDraw=function(){this.onDblclick()},n.prototype.lintToPolyline=function(e,r){var n="linestring(";if(1==r.paths.length){var i=r.paths[0].points,o=i.length,a=[];if(o>200){var s=o-200;if(o<=400)for(var l=Math.floor(o/s),c=1,u=0;u<o;u++)u==c*l?(c++,0!=u&&u!=o-1||a.push(i[u])):a.push(i[u]);else for(l=Math.ceil(o/200),c=1,u=0;u<o;u++)u==c*l?(c++,a.push(i[u])):0!=u&&u!=o-1||a.push(i[u]);o=(i=a).length}for(var f=0;f<i.length-1;f++)n=n+i[f].x.toFixed(5)+" "+i[f].y.toFixed(5)+",";n=n+i[o-1].x.toFixed(5)+" "+i[o-1].y.toFixed(5)}n+=")",e.geoLinePolyline=new t.sfs.GeometryFormatter.fromWKT(n,e.srid)},n}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(2),r(14),r(22),r(16),r(120),r(44),r(165),r(1)],void 0===(i=function(e,t,r,n,i,o,a,s){return{extend:function(l){var c=i.PATTERNS,u=i.TYPES,f=i.TYPES_KEYS;l.include({drawMarker:function(e){if(!(e&&e.geometry instanceof s.sfs.Point))throw new Error("参数错误！");var r=this._constructPlotElement(c.POINT,e),n=t.getLayerById(this.map,e.layerId);(n=n||this._plotLayer).add(r),this._fireEvent(o.PLOT_CREATED,{type:f.Point,element:r}),this._resetToolState()},drawLine:function(e){if(!e)throw new Error("参数错误！");var r=this._constructPlotElement(c.POLYLINE,e),n=t.getLayerById(this.map,e.layerId);(n=n||this._plotLayer).add(r),this._fireEvent(o.PLOT_CREATED,{type:f.Polyline,element:r}),this._resetToolState()},drawPolygon:function(e){if(!e||!(e.geometry instanceof s.sfs.Polygon||e.geometry instanceof s.sfs.MultiPolygon))throw new Error("参数错误！");var r=this._constructPlotElement(c.POLYGON,e),n=t.getLayerById(this.map,e.layerId);(n=n||this._plotLayer).add(r),this._fireEvent(o.PLOT_CREATED,{type:f.Polygon,element:r}),this._resetToolState()},_constructPlotElement:function(t,n){var i=this._getDefaultSymbol(t,n.symbol),o="",a={};a[c.POINT]=f.Point,a[c.POLYLINE]=f.Polyline,a[c.POLYGON]=f.Polygon;var l=this._getAlgorithm(a[t]),u=new s.sfs.AttributeSet,p=e.newUUID();n.hasOwnProperty("name")&&(o=n.name+"_"+p.split("-")[0]);var h=new s.sfs.PlotElement({id:n.id||p,kind:t,name:o,algorithm:l,attributeSet:u}),d=new s.sfs.Element({id:n.id||p,kind:t,geometry:n.geometry,symbol:i,name:o,attributeSet:u});h.add(d),h.reset();try{this._handleControlPoint(h)}catch(e){r.error(e)}return h},_handleControlPoint:function(e){var t=e.elements[0].geometry,r=e.plot,n={point:{regex:/^(.*Point),http\:\/\/www.Gs.com$/,handler:function(e,t){t.controlPoints=[e],t.update([e])}},polyline:{regex:/^(.*Polyline),http\:\/\/www.Gs.com$/,handler:function(e,t){var r=e.paths||[];if(1==r.length){var n=r[0];t.controlPoints=t.controlPoints.concat(n.points),t.update([e])}}},polygon:{regex:/^(.*Polygon),http\:\/\/www.Gs.com$/,handler:function(e,t){var r=e.rings||[];if(1==r.length){var n=r[0];t.controlPoints=t.controlPoints.concat(n.points),t.update([e])}}}};for(var i in n){if(n[i].regex.test(t.$type)){n[i].handler(t,r);break}}}}),l.include({_initTools:function(){var e=this.map.getMap(),t=new s.gdm.CommandManager,r=new s.gdm.CommandNotify({manager:t});this._commandMgr=t,this._commandNotify=r;var n=new s.interact.NoopTool({id:"NoopTool",cursor:this.options.cursor}),i=new s.plot.PlotEditTool({id:"PlotEdit",layer:this._plotLayer});t.add(n),t.add(i),this._plotEditTool=i;var a=this;this._plotEditTool.endEdit=this._plotEditTool.endEdit.before((function(){var e=a.getSelectedElements();e.length>0&&a._fireEvent(o.PLOT_UPDATED,{element:e[0].element})})),this._nooptool=n;var l=new s.carto.GraphicSelectionSet;this._commandHook={map:e,commandNotify:r,graphicSelectionSet:l,spatialRef:{srid:e.spatialReference}},t.onCreate(this._commandHook)},_removePlotElement:function(e){var t=this._plotLayer.find(e);return t?(this._plotLayer.remove(t),t):(r.warn("移除的元素不存在，id="+e),null)},_getAlgorithm:function(t,r){if(e.isString(t)){t=t.replace("Algorithm","");var n=u[t]||null,i=null,o=s.plot[n.algorithm];return n&&e.isFunction(o)&&((i=new o(r?{size:r.size,map:r.map}:{}))._type=n.type),i}return null},_getDefaultSymbol:function(t,r){return e.isObject(r)||(r=this.options.symbols[t]),n.object2Symbol(r.type,r.options)},_constructPlotTool:function(t){if(!t)throw new Error("参数类型错误！");this.map.getMap();var r=this,n=t.algorithm||this._getAlgorithm(t.pattern),i="";t.pattern==c.TEXT?i="text":t.pattern==c.POINT?i="point":t.pattern==c.POLYLINE?i="polyline":t.pattern==c.POLYGON?i="polygon":t.pattern==c.COMPOSITE?i="composite":t.pattern==c.TAILEDTEXT&&(i="tailedtext");var a=t.geometry,l=null,u=[];if(e.isArray(a)){var f=t.symbol||[];l=new s.sfs.Element({geometry:a[1],symbol:this._getDefaultSymbol(c.POLYLINE,f[1])}),u=[new s.sfs.Element({geometry:a[0],symbol:this._getDefaultSymbol(c.POLYGON,f[0])}),l]}else{var p=this._getDefaultSymbol(t.pattern,t.symbol);t.text&&(p.text=t.text),u=[l=new s.sfs.Element({geometry:a,symbol:p})]}var h=new s.plot.PlotTool({id:e.newUUID32(),drawTemplate:l,algorithm:n,elements:u,name:i,plotLayer:this._plotLayer});return h.onCreate(this._commandHook),h.onMouseUp=function(){d.apply(r,arguments)},h.onEndDraw=function(e){y.call(r,e,t)},this._currentTool=h,h;function d(e,t,r,n,i,o,a){this._lastControlPoint=new s.sfs.Point({x:i,y:o})}function y(t,r){this._cancelPlot(),e.isFunction(r.callback)&&r.callback.call(r.context,t,this),this._fireEvent(o.PLOT_CREATED,{type:r.type,element:t})}},_loadTailedlabel:function(e){var t=JSON.parse(e.tailedLabelAttr),r=this,i=this.options.tailedLabelComponent.layer,o={},a={type:"Point",coordinates:[e.elements[0].geometry.x,e.elements[0].geometry.y]};o.geometry=a,o.label=t.domHtml,o.id=e.id,o.symbol=t.symbol,o.domClassName=t.domClassName,o.tailLength=t.tailLength,o.tailAngle=t.tailAngle,o.showArrow=t.showArrow,o.arrowAngle=t.arrowAngle,o.arrowScale=t.arrowScale,o.domStyle=t.domStyle;o.lineColor,o.lineWidth,this.options.tailedLabelComponent.add(o);n.geoinfoToElement(a,e.elements[0].symbol,{id:e.id,layer:i}).labelId=e.id;var s=this.options.tailedLabelComponent._getTailedLabel(e.id);s.on("tailedLabelClick",(function(){var t=e.id;r.fire("openTailedLabelEdit",r.getPlotElementById(t))})),e.tailedLabelAttr=s.serialize()},_cancelPlot:function(){this.map.getMap();try{this._resetToolState(),this._currentTool.deactivate(),this._currentTool=null}catch(e){}this._lastControlPoint=null},_mapClickHandler:function(t){if(!this._currentTool){var r=t.screenX,n=t.screenY,i=this._plotLayer.hitTestList(r,n).graphiclist,a=null;if(i.length>0)a=i[i.length-1].element.parent;if(this._plotClickObj){var s=this._plotClickObj.callback;e.isFunction(s)&&s.call(this._plotLayer.context,a)}this.fire(o.PLOT_CLICKED,{element:a})}},_removeTailedText:function(e){this.options.tailedLabelComponent.layer;this.options.tailedLabelComponent.remove(e)},_resetToolState:function(){this._plotEditTool._enabled_?this._plotEditTool.onClick():(this._plotEditTool.deactivate(),this._nooptool.onClick())},_fireEvent:function(e,t){this.fire(e,t),this.map.fire(e,t)},_addTailedComponent:function(e){var t=new a({map:e,layerId:"tailed-marker-layer",symbol:{type:"SimpleLineSymbol",options:{color:{alpha:250,r:183,g:79,b:79},style:5,width:1}},tailLength:80,tailAlign:"auto",domClassName:"emap-tail-label",domStyle:{background:"#b74f4f",padding:"10px","font-size":"20px",border:"1px solid #a61c00",color:"#ffffff",opacity:1},tailAngle:30,showArrow:!1});this.options.tailedLabelComponent=t;var r=new s.carto.ElementLayer({id:"pointLayer",name:"选点图层",map:e});e.addLayer(r),this.options.tailedLabelComponent.layer=r}})}}}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(412),r(2),r(16),r(57),r(11),r(1)],void 0===(i=function(e,t,r,n,i,o){var a=e.extend({options:{domContainer:"emap-tailedlabel-container",tailLength:100,tailAlign:"auto",tailAngle:45,minHeight:15,minWidth:50,domTag:"span"},initialize:function(t){e.prototype.initialize.call(this,t)},destroy:function(){e.prototype.destroy.call(this)}});return a.include({_getDomAnchorPos:function(){var e=this.options.tailAngle,r={"[0,90)":{xVar:0,yVar:-1},"[90,180)":{xVar:0,yVar:0},"[180,270)":{xVar:-1,yVar:0},"[270,360)":{xVar:-1,yVar:-1}},n={};for(var i in r)if(t.assertWithin(e,i)){n=r[i];break}return"center"===this.options.tailAlign&&(n.xVar=-.5),n}}),a.include({}),a}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(15),r(2),r(413),r(16),r(57),r(11),r(22),r(36),r(1)],void 0===(i=function(e,t,r,n,i,o,a,s,l){var c=e.extend({options:{domContainer:"emap-taileddiv-container",tailLength:100,tailAngle:45,showArrow:!1,arrowAngle:30,arrowScale:.3,arrowLength:NaN,arrowSymbol:!1,arrowShape:"triangle",minHeight:15,minWidth:50,symbol:{type:"SimpleLineSymbol",options:{color:{a:200,r:0,g:0,b:255},style:"5",width:1}},domTag:"div",domMinGap:[5,5,5,5],domHtml:"新建引线文本",mousedownTime:null,mouseUpTime:null},includes:s.prototype,initialize:function(r){e.setOptions(this,r),this._id=r.id||t.newUUID32(),this.options.domId=this.options.domId||this._id,this.options.domHtml=r.label,this._visible=!1,this._tail=null,this._tailArrow=null,this._dom=null,this._domContainer=null,this._tailAnchor=null,this._domAnchor=null,this._domBounds=[],this.options.geometry=o.toJstsGeometry(this.options.geometry);var n={position:"absolute",display:"block","white-space":"nowrap","min-width":this.options.minWidth+"px","min-height":this.options.minHeight+"px","font-family":"SimSun"};this.options.domStyle=jQuery.extend(!0,n,this.options.domStyle||{}),this._domMove=!1,this._domMoveStart={},this._update()},update:function(e){var t=JSON.stringify(this.options.domStyle);if(e&&jQuery.extend(!0,this.options,e),t!=JSON.stringify(this.options.domStyle))for(var r in this.options.domStyle)this._dom.css(r,this.options.domStyle[r]);this._update()},destroy:function(){this._unbindDomEvent(),this._clearTail(),this._clearDom()}});return c.include({getId:function(){return this._id},updateTail:function(){this._clearTail(),this._updateTailAnchor(),this._updateDomAnchor(),this._updateTail(),!0===this.options.showArrow&&this._updateArrow()},updateDom:function(){this._updateTailAnchor(),this._updateDomAnchor(),this._updateDomPosition()},setContent:function(e){this._dom.html(e),this.options.domHtml=e},getBounds:function(){var e=this.options.domMinGap,t=[];return t.push(this._domBounds[0]-e[0]),t.push(this._domBounds[1]-e[1]),t.push(this._domBounds[2]+e[2]),t.push(this._domBounds[3]+e[3]),t},intersects:function(e){var t=e.getBounds(),r=this.getBounds(),n=new jsts.geom.Envelope(t[0],t[2],t[1],t[3]);return new jsts.geom.Envelope(r[0],r[2],r[1],r[3]).intersects(n)},toggleVisible:function(e){e=!!e;var t=this._getDom();e?t.css("display","block"):t.css("display","none");var r=this.options.layer;null!=this._tail&&r.showElement(this._tail,e),null!=this._tailArrow&&r.showElement(this._tailArrow,e),this._visible=e},visible:function(){return this._visible},serialize:function(){var e=jQuery.extend(!0,{},this.options);return delete e.layer,delete e.map,console.log(e),JSON.stringify(e)}}),c.include({_getDomContainer:function(){if(null==this._domContainer){var e=this.options.domContainer;if(0==jQuery("#"+e).length){var t='<div id="'+e+'"';t+='style="top:0px;left:0px;position:absolute;pointer-events:auto;cursor:pointer"',t+="></div>",jQuery("#"+this.options.map.id).find(".ol-overlaycontainer-stopevent").append(t)}this._domContainer=jQuery("#"+e)}return this._domContainer},_getDom:function(){var e=this._getDomContainer(),t=this.options.domId,r=this.options.domTag;if(null==this._dom){var n="<"+r+' id="'+t+'"';if(this.options.domClassName&&(n+=' class="'+this.options.domClassName+'" '),this.options.domStyle){var i="";for(var o in this.options.domStyle)i+=o+":"+this.options.domStyle[o]+";";n+=' style="'+i+'" '}n+="></"+r+">",e.append(n),this._dom=jQuery("#"+t),this._bindDomEvent()}return this._dom},_update:function(){this.updateTail(),this.updateDom()},_updateDomPosition:function(){var e=this._getDom(),t=this._getDomAnchorPos(),r=e.outerWidth(),n=e.outerHeight(),i=this._domAnchor[2]+t.xVar*r,o=this._domAnchor[3]+t.yVar*n;e.css("marginLeft",i+"px"),e.css("marginTop",o+"px"),this._domBounds=[i,o,i+r,o+n]},_drawBounds:function(){this._bounds&&this.options.layer.remove(this._bounds);var e=[],r=this.options.map;function i(e,t,r){var n=r.getCoordinateFromPixel(t);e.push(n)}var o=this.getBounds();i(e,[o[0],o[1]],r),i(e,[o[0],o[3]],r),i(e,[o[2],o[3]],r),i(e,[o[2],o[1]],r),i(e,[o[0],o[1]],r);var a={type:"Polygon",coordinates:[e]};this._bounds=n.geoinfoToElement(a,{type:"SimpleFillSymbol",options:{borderColor:{a:120,r:255,g:0,b:0},fillColor:{a:50,r:200,g:0,b:0},borderThickness:2,opacity:1}},{id:t.newUUID32(),layer:this.options.layer})},_getDomAnchorPos:function(){return{xVar:0,yVar:-1}},_updateTailAnchor:function(){var e=this.options.map,t=this.options.geometry.getCentroid().coordinate,r=[t.x,t.y],n=e.getPixelFromCoordinate(r);this._tailAnchor=r.concat(n)},_updateDomAnchor:function(){var e=this._tailAnchor,t=this.options.tailLength,r=this.options.tailAngle,n=this.options.map,i=(270+r)*Math.PI/180,o=[e[2]+Math.cos(i)*t,e[3]+Math.sin(i)*t],a=n.getCoordinateFromPixel(o);this._domAnchor=a.concat(o)},_updateTail:function(){var e=this._tailAnchor,t=this._domAnchor,r={type:"LineString",coordinates:[[e[0],e[1]],[t[0],t[1]]]};this._tail=n.geoinfoToElement(r,this.options.symbol,{id:this._id,layer:this.options.layer})},_updateArrow:function(){var e={},t=this.options.map;e.startPt=this._domAnchor.slice(2),e.endPt=this._tailAnchor.slice(2),e.arrowScale=this.options.arrowScale,e.arrowAngle=this.options.arrowAngle,e.arrowLength=this.options.arrowLength;for(var i=r.getSimpleArrow(e),o=[],a=0,s=i.length;a<s;a++){var l=i[a],c=t.getCoordinateFromPixel(l);o.push(c)}var u=((t={line:function(e){return{geometry:{type:"LineString",coordinates:e},symbol:this.options.arrowSymbol||this.options.symbol}},triangle:function(e){e.push(e[0]);var t,r={type:"Polygon",coordinates:[e]};if(this.options.arrowSymbol)t=this.options.arrowSymbol;else{t={type:"SimpleFillSymbol",options:{borderColor:{a:1,r:0,g:0,b:0},fillColor:{},opacity:1}};var n=this.options.symbol.options;t.options.fillColor=n.fillColor||n.color}return{geometry:r,symbol:t}}})[this.options.arrowShape]||t.triangle).call(this,o);this._tailArrow=n.geoinfoToElement(u.geometry,u.symbol,{id:this._id+"_arrow",layer:this.options.layer})},_moveDomStart:function(e){this._domMove=!0,e.preventDefault(),e.stopPropagation(),this._domMoveStart.disX=e.pageX-this._dom.offset().left,this._domMoveStart.disY=e.pageY-this._dom.offset().top},_moveDomMove:function(e){if(this._domMove){var t=e.pageX-this._domMoveStart.disX,r=e.pageY-this._domMoveStart.disY;this._dom.css({marginLeft:t,marginTop:r});var n=this._getDom(),i=this._getDomAnchorPos(),o=n.outerWidth(),a=n.outerHeight(),s=t-i.xVar*o,l=r-i.yVar*a,c=[s,l],u=this.options.map.getCoordinateFromPixel(c);this._domAnchor=u.concat(c),this._domBounds=[t,r,t+o,r+a];var f=this._tailAnchor,p=f[3]-l,h=f[2]-s,d=Math.atan(Math.abs(p/h)),y=180/Math.PI*d,m=void 0;p<0&&h<0?m=y+90:p>0&&h<0?m=90-y:p<0&&h>0?m=270-y:p>0&&h>0?m=270+y:0==p&&x<0?m=90:0==p&&x>0?m=270:p<0&&0==x?m=180:p>0&&0==x&&(m=0);var g=Math.sqrt(h*h+p*p);this.options.tailLength=g,this.options.tailAngle=m,this._clearTail(),this._updateTail()}},_moveDomEnd:function(){this._domMove=!1,this.fire("updateTailedLabelAttr")},_domMoveMapMove:function(e,t){if(this._domMove){var r=e-this._domMoveStart.disX,n=t-this._domMoveStart.disY;this._dom.css({marginLeft:r,marginTop:n});var i=this._getDom(),o=this._getDomAnchorPos(),a=i.outerWidth(),s=i.outerHeight(),l=r-o.xVar*a,c=n-o.yVar*s,u=[l,c],f=this.options.map.getCoordinateFromPixel(u);this._domAnchor=f.concat(u),this._domBounds=[r,n,r+a,n+s];var p=this._tailAnchor,h=p[3]-c,d=p[2]-l,y=Math.atan(Math.abs(h/d)),m=180/Math.PI*y,g=void 0;h<0&&d<0?g=m+90:h>0&&d<0?g=90-m:h<0&&d>0?g=270-m:h>0&&d>0?g=270+m:0==h&&x<0?g=90:0==h&&x>0?g=270:h<0&&0==x?g=180:h>0&&0==x&&(g=0);var v=Math.sqrt(d*d+h*h);this.options.tailLength=v,this.options.tailAngle=g,this._clearTail(),this._updateTail()}},_changeDomLabel:function(){},_clearTail:function(){null!=this._tail&&(this.options.layer.remove(this._tail),this._tail=null),null!=this._tailArrow&&(this.options.layer.remove(this._tailArrow),this._tailArrow=null)},_clearDom:function(){null!=this._dom&&this._dom.remove()},_bindDomEvent:function(){var e=this;this._dom.on("mousedown",(function(t){e.mousedownTime=(new Date).getTime(),e._moveDomStart(t),e.options.map.listen("mousemove",(function(t){e._domMoveMapMove(t.screenX,t.screenY)})),e.options.map.listen("mouseup",(function(t){e._moveDomEnd(t)}))})),this._dom.on("mouseup",(function(t){e.mouseUpTime=(new Date).getTime(),e._moveDomEnd(),e.options.map.off("mousemove"),e.options.map.off("mouseup")})),this._dom.on("click",(function(t){e.mouseUpTime-e.mousedownTime<200&&e.fire("tailedLabelClick")}))},_unbindDomEvent:function(){this._dom.off("mousedown"),this._dom.off("mousemove"),this._dom.off("mouseup"),this._dom.off("click")}}),c}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n;void 0===(n=function(){function e(e){return"[object Array]"===Object.prototype.toString.call(e)}var t={angle:function(e,t){var r;return(r=t[0]===e[0]?t[1]>=e[1]?-Math.PI/2:Math.PI/2:Math.atan2(e[1]-t[1],t[0]-e[0]))<0&&(r+=2*Math.PI),180*r/Math.PI},getSimpleArrow:function(r){if(!e((r=r||{}).startPt)||2!=r.startPt.length||!e(r.endPt)||2!=r.endPt.length)throw new Error("参数错误！");var n=r.startPt,i=r.endPt,o=r.arrowLength,a=isNaN(r.arrowScale)?.2:r.arrowScale,s=isNaN(r.arrowAngle)?30:r.arrowAngle,l=!1!==r.forScreen,c=Math.PI,u=t.angle(i,n),f=Math.sqrt(Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2));isNaN(o)&&(o=f*a);var p=l?-1:1,h=(u+s)*c/180,d=(u-s)*c/180,y=i[0]+Math.cos(h)*o,m=i[1]+p*Math.sin(h)*o,g=i[0]+Math.cos(d)*o,v=i[1]+p*Math.sin(d)*o,b=[];return b.push([y,m]),b.push([i[0],i[1]]),b.push([g,v]),b}};return t}.apply(t,[]))||(e.exports=n)},function(e,t,r){"use strict";var n,i;n=[r(415),r(416),r(18)],void 0===(i=function(e,t,r){var n=r.extend({options:{title:"标绘同步接口类"},initialize:function(n){r.prototype.initialize.call(this,n),this._getDifferentData=new e(n),this._analysisDifferentData=new t(n)},destroy:function(){try{this._getDifferentData.destroy()}catch(e){}try{this._analysisDifferentData.destroy()}catch(e){}r.prototype.destroy.call(this)}});return n.include({viewSyncGetData:function(){return this._getDifferentData.getMapView()},plotSyncGetData:function(){return this._getDifferentData.getPlotData()},dataSyncGetData:function(){return this._getDifferentData.getSyncData()}}),n.include({viewSyncShowData:function(e){var t=!1;if(e&&e.data){try{this._analysisDifferentData.analysisMapView(e.data),t=!0}catch(e){e.message,t=!1}}return t}}),n.include({dataSyncShowData:function(e){var t={};if(e)try{t=this._analysisDifferentData.analysisSyncData(e)}catch(e){t.msg=e.message}return t},dataSyncClearData:function(e){var t=!1;try{if(e){var r=e.memberId||e.userId;this._analysisDifferentData.clearSpecifyOrAllData(r)}else this._analysisDifferentData.clearSpecifyOrAllData();t=!0}catch(e){e.message,t=!1}return t},dataSyncSetVisiblity:function(e){var t=!1;try{if(e){var r=e.memberId||e.userId,n=e.visible||!0;this._analysisDifferentData.visibleSpecifyOrAllData(r,n),t=!0}}catch(e){e.message,t=!1}return t},querySyncDataById:function(e){var t=!1;try{e&&(this._analysisDifferentData.querySyncDataById(e),t=!0)}catch(e){t=!1}return t}}),n.include({plotSyncShowData:function(e){var t={};if(e)try{t=this._analysisDifferentData.analysisSyncPlot(e)}catch(e){t.msg=e.message}return t},plotSyncClearData:function(e){var t=!1;try{if(e){var r=e.memberId||e.userId;this._analysisDifferentData.clearSpecifyOrAllPlot(r)}else this._analysisDifferentData.clearSpecifyOrAllPlot();t=!0}catch(e){e.message,t=!1}return t},plotSyncSetVisiblity:function(e){var t=!1;try{if(e){var r=e.memberId||e.userId,n=e.visible||!0;this._analysisDifferentData.visibleSpecifyOrAllPlot(r,n),t=!0}}catch(e){e.message,t=!1}return t},queryPlotDataById:function(e){var t=!1;try{e&&(this._analysisDifferentData.queryPlotDataById(e),t=!0)}catch(e){t=!1}return t}}),n}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(14),r(1),r(86)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{title:"获取不同数据的类"},initialize:function(t){e.prototype.initialize.call(this,t),this.layreIds={dataLayer:[],plotLayer:[]},this._matchingLayer=t.matchingLayer},destroy:function(){e.prototype.destroy.call(this)},_initLayerId:function(e){var t=this.map.getMap().getLayers();if(t.length>0)for(var r=0;r<t.length;r++){for(var n=0;n<e.dataLayer.length;n++)e.dataLayer[n].test(t[r].id)&&this.layreIds.dataLayer.push(t[r].id);for(n=0;n<e.plotLayer.length;n++)e.plotLayer[n].test(t[r].id)&&this.layreIds.plotLayer.push(t[r].id)}}});return i.include({getMapView:function(){var e={};return e.center=this.map._getMapCenter(),e.zoomLevel=this.map.getZoomLevel(),e}}),i.include({getSyncData:function(){return this._initLayerId(this._matchingLayer),this._getAllLayerData()},_getAllLayerData:function(){var e=[];this.layreIds.dataLayer&&(e=this.layreIds.dataLayer);var r={};if(e&&e.length>0)for(var n=0;n<e.length;n++){var i=t.getLayerById(this.map.getMap(),e[n]);if(i){var o=[],a=this._getLayerElements(i);this._serializeElement(a,o),r[e[n]]=o}}return r}}),i.include({getPlotData:function(){return this._initLayerId(this._matchingLayer),this._getPoltData()},_getPoltData:function(){var e={},t=[];if(this.layreIds.plotLayer&&(t=this.layreIds.plotLayer),t&&t.length>0)for(var r=new n({id:(new Date).toString(),name:"标绘数据"}),i=0;i<t.length;i++){var o=this.map.getMap().layers;if(o.length>0)for(var a=0;a<o.length;a++)if(t[i]==o[a].id){var s=this._getLayerElements(o[a]);this._serializeElement(s,r),e[t[i]]=r}}return e}}),i.include({_getLayerElements:function(e){var t=[];if(e instanceof r.carto.GroupLayer)for(var n=e.groupLayers,i=0,o=n.length;i<o;i++){var a=n[i];util._getLayerElements(a,arr)}else e instanceof r.carto.FeatureLayer||(e instanceof r.carto.ElementLayer?t=e.elements:e instanceof r.carto.ClusterLayer&&(t=e.elements));return t},_serializeElement:function(e,t){for(var n=0;n<e.length;n++)if(e[n]instanceof r.sfs.Element){var i={},o=e[n].geometry;i.geom=o.asWkt(),i.srid=o.spatialReference,i.symbol=e[n].symbol,i.$type=e[n].$type,t.push(i)}else if(e[n]instanceof r.sfs.PlotElement){var a=e[n];if(a){var s=a.copy();s.unReset();for(var l=0;l<s.elements.length;l++){var c=s.elements[l];for(var u in c)"parent"==u&&(c[u]={});s.elements[l]=c,console.log(s.elements[l])}s.id=a.id,t.addElement(s)}}return t},_unRest:function(e){console.log(e);for(var t=0;t<e.elements.length;t++)e.elements[t].parent=null,e.elements[t].elements&&this._unRest(e.elements[t]);return e}}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(417),r(18),r(1)],void 0===(i=function(e,t,r){var n=t.extend({options:{title:"解析不同数据的类"},initialize:function(n){t.prototype.initialize.call(this,n),this._dataDisplayOnMap=new e(n),this._deserializer=new r.core.Deserializer,this.layreIds={dataLayer:[],plotLayer:[]},n.matchingLayer&&this._initLayerId(n.matchingLayer)},destroy:function(){this._dataDisplayOnMap.destroy(),t.prototype.destroy.call(this)},_initLayerId:function(e){var t=this.map.getMap().getLayers();if(t.length>0)for(var r=0;r<t.length;r++){for(var n=0;n<e.dataLayer.length;n++)e.dataLayer[n].test(t[r].id)&&this.layreIds.dataLayer.push(t[r].id);for(n=0;n<e.plotLayer.length;n++)e.plotLayer[n].test(t[r].id)&&this.layreIds.plotLayer.push(t[r].id)}}});return n.include({analysisMapView:function(e){var t="";if(e.center&&e.zoomLevel){var n=new r.sfs.Point({x:e.center[0],y:e.center[1],spatialReference:this.map.spatialReference});this.map.getMap().setCenter(n),this.map.getMap().zoomTo(e.zoomLevel),t="视野同步成功!"}else t="视野同步失败!center="+e.center+",zoomLevel="+e.zoomLevel;return t}}),n.include({analysisSyncData:function(e){var t="",r="",n=e.data,i=e.memberId||e.userId,o=[],a={};if(i&&n){var s=[];for(var l in n)for(var c=0;c<n[l].length;c++){var u=this._deserializeElement(n[l][c]);s.push(u)}a={memberId:i,data:o=o.concat(s)};try{r=this._dataDisplayOnMap.showSyncData(a)}catch(e){}t="数据解析成功!"}else t="数据解析失败!成员标识或者数据不全";return{msg:t,dataId:r}},clearSpecifyOrAllData:function(e){return this._dataDisplayOnMap.clearSpecifyOrAllData(e),e?e+"清除数据成功":"全部数据清除成功"},visibleSpecifyOrAllData:function(e,t){return this._dataDisplayOnMap.visibleSpecifyOrAllData(e,t),e?e+"显隐成功":"全部显隐成功"},querySyncDataById:function(e){this._dataDisplayOnMap.querySyncDataById(e)}}),n.include({analysisSyncPlot:function(e){var t="",r="",n=[],i=e.memberId||e.userId,o=e.data,a={};if(i&&o){var s=[];for(var l in o){s=this._deserializePlotElement(o[l]);n=n.concat(s)}a={memberId:i,data:n};try{r=this._dataDisplayOnMap.showSyncPlot(a)}catch(e){}t="标绘数据解析成功!"}else t="标绘数据解析失败!+成员标识或者数据不全";return{msg:t,dataId:r}},clearSpecifyOrAllPlot:function(e){return this._dataDisplayOnMap.clearSpecifyOrAllPlot(e),e?e+"清除标绘成功":"全部标绘清除成功"},visibleSpecifyOrAllPlot:function(e,t){return this._dataDisplayOnMap.visibleSpecifyOrAllPlot(e,t),e?e+"显隐成功":"全部显隐成功"},queryPlotDataById:function(e){this._dataDisplayOnMap.queryPlotDataById(e)}}),n.include({_deserializePlotElement:function(e){var t=[],r=this._deserializer.createJsInstance(e);if(r)for(var n=0;n<r.getCount();n++){var i=r.getElement(n);i.reset(),t.push(i)}return t},_deserializeElement:function(e){var t=null;if(e){var n=e.geom;if(n){var i=r.sfs.GeometryFactory.createGeometryFromWkt(n);i.spatialReference=e.srid;var o=this._deserializeSymbol(e.symbol);t=new r.sfs.Element({geometry:i,symbol:o})}}return t},_deserializeSymbol:function(e){var t=this;if(!e)return null;var n=null;switch(/(.*),.*/.exec(e.$type)[1]){case"PictureMarkerSymbol":a("width,height,opacity,offsetX,offsetY,rotation",e,i={}),s("source",e,i),n=new r.sfs.PictureMarkerSymbol(i);break;case"SimpleMarkerSymbol":l("fillColor,borderColor",e,i={}),a("size,offsetX,offsetY",e,i),s("style",e,i),n=new r.sfs.SimpleMarkerSymbol(i);break;case"TextSymbol":a("fontSize,rotation,borderThickness,offsetX,offsetY",e,i={}),l("foreground,borderColor",e,i),s("text,fontFamilyName,fontWeight,textAlign",e,i),n=new r.sfs.TextSymbol(i);break;case"SimpleLineSymbol":l("color",e,i={}),a("width,style",e,i),n=new r.sfs.SimpleLineSymbol(i);break;case"SimpleFillSymbol":l("fillColor,borderColor",e,i={}),a("borderThickness,opacity",e,i),n=new r.sfs.SimpleFillSymbol(i);break;case"CurrencySymbol":var i={},o={};o.fillSymbol=this.deserializeSymbol(e.fillSymbol),o.textSymbol=this.deserializeSymbol(e.textSymbol),o.markerSymbol=this.deserializeSymbol(e.markerSymbol),s("fillSymbol,textSymbol,markerSymbol",o,i),n=new r.sfs.CurrencySymbol(i)}return n;function a(e,t,r){for(var n=e.split(","),i=0,o=n.length;i<o;i++){var a=n[i];a&&(isNaN(t[a])||(r[a]=parseFloat(t[a])))}}function s(e,t,r){for(var n=e.split(","),i=0,o=n.length;i<o;i++){var a=n[i];a&&t[a]&&(r[a]=t[a])}}function l(e,r,n){for(var i=e.split(","),o=0,a=i.length;o<a;o++){var s=i[o];if(s){var l=t._deserializeColor(r[s]);l&&(n[s]=l)}}}},_deserializeColor:function(e){var t=new r.sfs.Color;return e&&(t.a=e.a,t.r=e.r,t.g=e.g,t.b=e.b),t}}),n}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(2),r(11),r(1)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{title:"把数据展示到地图上"},initialize:function(t){e.prototype.initialize.call(this,t),this._initLayersGroup(),this._plotAndDataObj={plotObj:{},dataObj:{}},this.commandManager=new n.gdm.CommandManager,this.commandNotify=new n.gdm.CommandNotify({manager:this.commandManager})},destroy:function(){this._plotAndDataObj.plotObj={},this._plotAndDataObj.dataObj={},this._syncPlotLayerGroup.clear(),this._syncPlotLayerGroup.removeAllLayers(),this._syncVisualizeLayerGroup.clear(),this._syncVisualizeLayerGroup.removeAllLayers(),this._groupLayer&&(this._groupLayer.clear(),this._groupLayer.removeAllLayers(),this.map.getMap().removeLayer(this._groupLayer)),e.prototype.destroy.call(this)}});return i.include({_initLayersGroup:function(){var e=new n.carto.GroupLayer({id:"syncLayerGroup",name:"同步数据的图层组",layers:[]});this.map.getMap().addLayer(e),this._groupLayer=e,this._layers={};var t=new n.carto.GroupLayer({layers:[]});e.addLayer(t),this._syncPlotLayerGroup=t;var r=new n.carto.GroupLayer({layers:[]});e.addLayer(r),this._syncVisualizeLayerGroup=r},_getPlotSyncLayer:function(e){return e.type="_syncPlotLayerGroup",this._getSyncLayer(e)},_getVisualizeSyncLayer:function(e){return e.type="_syncVisualizeLayerGroup",this._getSyncLayer(e)},_getSyncLayer:function(e){var t=e.type,r=e.memberId||e.userId,i=t.toLowerCase()+"-"+r,o=null;return(o=this._layers[i])||(o=new n.carto.ElementLayer({id:i,map:this.map.getMap()}),this[t].addLayer(o),this._layers[i]=o),o}}),i.include({showSyncData:function(e){var r="",n=e.memberId||e.userId,i=e.data;if(i&&i.length>0){for(var o=this._getVisualizeSyncLayer({memberId:n}),a=0;a<i.length;a++)o.add(i[a]);r=t.newUUID(),this._plotAndDataObj.dataObj[n]||(this._plotAndDataObj.dataObj[n]={}),this._plotAndDataObj.dataObj[n][r]=i}return r},clearSpecifyOrAllData:function(e){if(e){var t=e.split(",");if(t.length>0)for(var r=0;r<t.length;r++){this._getVisualizeSyncLayer({memberId:t[r]}).clear()}}else{for(var n in this._layers)n.indexOf("_syncvisualizelayergroup")>=0&&this._layers[n].clear();this._syncVisualizeLayerGroup.clear()}},visibleSpecifyOrAllData:function(e,t){if(null!=t)if(e){var r=e.split(",");if(r.length>0)for(var n=0;n<r.length;n++){this._getVisualizeSyncLayer({memberId:r[n]}).setVisible(t)}}else this._syncVisualizeLayerGroup.setVisible(t)},querySyncDataById:function(e){var t=e.dataId,r=e.memberId||e.userId;if(t&&r){var n=this._plotAndDataObj.dataObj[r][t];if(n){var i=this._getVisualizeSyncLayer({memberId:r});i.clear(),i.addElements(n)}}}}),i.include({showSyncPlot:function(e){var r,n=e.memberId||e.userId,i=e.data,o=this._getPlotSyncLayer({memberId:n});o.clear();for(var a=0;a<i.length;a++)o.add(i[a]);return this._fitBounds(i[i.length-1]),r=t.newUUID(),this._plotAndDataObj.plotObj[n]||(this._plotAndDataObj.plotObj[n]={}),this._plotAndDataObj.plotObj[n][r]=i,r},_fitBounds:function(e){var t=r.getPlotEnvlop([e],this.map.getMap().spatialReference);if(t)if(t.$type.indexOf("Point")>=0)this.map.getMap().setCenter(t);else{this.map.getMap().pan(t,[100,100,100,100])}},clearSpecifyOrAllPlot:function(e){if(e){var t=e.split(",");if(t.length>0)for(var r=0;r<t.length;r++){this._getPlotSyncLayer({memberId:t[r]}).clear()}}else{for(var n in this._layers)n.indexOf("_syncplotlayergroup")>=0&&this._layers[n].clear();this._syncPlotLayerGroup.clear()}},visibleSpecifyOrAllPlot:function(e,t){if(null!=t)if(e){var r=e.split(",");if(r.length>0)for(var n=0;n<r.length;n++){this._getPlotSyncLayer({memberId:r[n]}).setVisible(t)}}else this._syncPlotLayerGroup.setVisible(t)},queryPlotDataById:function(e){var t=e.dataId,r=e.memberId||e.userId;if(t&&r){var n=this._plotAndDataObj.plotObj[r][t];if(n){var i=this._getPlotSyncLayer({memberId:r});i.clear(),i.addElements(n)}}}}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(44),r(36),r(1),r(86)],void 0===(i=function(e,t,r,n,i){var o=e.extend({options:{title:"协同标绘组件"},includes:r.prototype,initialize:function(t){e.prototype.initialize.call(this,t),this._initLayersGroup(),this._deserializer=new n.core.Deserializer},destroy:function(){e.prototype.destroy.call(this)}});return o.include({_initLayersGroup:function(){var e=new n.carto.GroupLayer({id:"syncLayerGroup",name:"同步数据的图层组",layers:[]});this.map.getMap().addLayer(e),this._groupLayer=e,this._layers={};var t=new n.carto.GroupLayer({layers:[]});e.addLayer(t),this._collaborativePlotLayerGroup=t},_getPlotSyncLayer:function(e){return e.type="_collaborativePlotLayerGroup",this._getSyncLayer(e)},_getSyncLayer:function(e){var t=e.type,r=t.toLowerCase()+"-"+e.memberId,i=null;return(i=this._layers[r])||(i=new n.carto.ElementLayer({id:r,map:this.map.getMap()}),this[t].addLayer(i),this._layers[r]=i),i}}),o.include({startCollaborativePlot:function(){console.log("开始协同标绘");var e=this;this.plotCreatedCallback=function(t){var r=t.element;t.type;e._addPlot(r)},this.plotUpdateCallback=function(t){var r=t.element;e._updatePlot(r)},this.plotDeleteCallback=function(t){var r=t.elements;e._deletePlot(r)},this.map.listen(t.PLOT_CREATED,this.plotCreatedCallback),this.map.listen(t.PLOT_UPDATED,this.plotUpdateCallback),this.map.listen(t.PLOT_DELETE,this.plotDeleteCallback)},endCollaborativePlot:function(){console.log("结束协同标绘");this.map.off(t.PLOT_CREATED,this.plotCreatedCallback),this.map.off(t.PLOT_UPDATED,this.plotUpdateCallback),this.map.off(t.PLOT_DELETE,this.plotDeleteCallback)},analysisSyncPlot:function(e){var t="",r=e.data,n=e.memberId;if(n&&r){var i=this._getPlotSyncLayer({memberId:n}),o=this._deserializePlotElement(r);o&&this["_"+r.name+"OnLayer"](o,i),t="数据解析成功!"}else t="数据解析失败!成员标识或者数据不全";return{msg:t,dataId:""}},clearSpecifyOrAllPlot:function(e){if(e){var t=e.split(",");if(t.length>0)for(var r=0;r<t.length;r++){this._getPlotSyncLayer({memberId:t[r]}).clear()}}else{for(var n in this._layers)n.indexOf("_collaborativePlotLayerGroup")>=0&&this._layers[n].clear();this._syncPlotLayerGroup.clear()}},visibleSpecifyOrAllPlot:function(e,t){if(null!=t)if(e){var r=e.split(",");if(r.length>0)for(var n=0;n<r.length;n++){this._getPlotSyncLayer({memberId:r[n]}).setVisible(t)}}else this._syncPlotLayerGroup.setVisible(t)}}),o.include({_addPlot:function(e){var r=new i({id:(new Date).toString(),name:"addPlot"}),n=e.copy();n.unReset(),n.id=e.id,r.addElement(n),this.fire(t.COLLABORATIVE_PLOT_CREATED,{data:r})},_updatePlot:function(e){var r=new i({id:(new Date).toString(),name:"updatePlot"}),n=e.copy();n.unReset(),n.id=e.id,r.addElement(n),this.fire(t.COLLABORATIVE_PLOT_UPDTAED,{data:r})},_deletePlot:function(e){for(var r=new i({id:(new Date).toString(),name:"deletePlot"}),n=0;n<e.length;n++){var o=e[n].copy();o.unReset(),o.id=e[n].id,r.addElement(o)}this.fire(t.COLLABORATIVE_PLOT_DELETE,{data:r})}}),o.include({_addPlotOnLayer:function(e,t){t&&e[0]&&t.add(e[0])},_updatePlotOnLayer:function(e,t){if(t&&e[0]&&t.contains(e[0].id)){var r=t.find(e[0].id);t.remove(r),t.add(e[0])}},_deletePlotOnLayer:function(e,t){if(e.length>0&&t)for(var r=0;r<e.length;r++)if(t.contains(e[r].id)){var n=t.find(e[r].id);t.remove(n)}},_deserializePlotElement:function(e){var t=[],r=this._deserializer.createJsInstance(e);if(r)for(var n=0;n<r.getCount();n++){var i=r.getElement(n);i.reset(),t.push(i)}return t}}),o}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n={LoggerUtil:r(22),CommonUtil:r(2),CRSTransformUtil:r(121),GeometryUtil:r(11),CoordUtil:r(166),GeoJSONUtil:r(167),LayerUtil:r(14),ResourceUtil:r(68),SpatialOPUtil:r(57),RenderUtil:r(16),SymbolBuilder:r(168),GeometryBuilder:r(169),FeatureBuilder:r(122)};e.exports=n},function(e,t,r){var n,i,o,a,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};a=function(e){"use strict";function t(e){return function(e,t){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(e[0],e[e.length-1])||e.push(e[0]),e}function r(e){for(var t,r=0,n=0,i=e.length,o=e[n];n<i-1;n++)r+=((t=e[n+1])[0]-o[0])*(t[1]+o[1]),o=t;return r>=0}function n(e,t,r,n){var i=(n[0]-r[0])*(e[1]-r[1])-(n[1]-r[1])*(e[0]-r[0]),o=(t[0]-e[0])*(e[1]-r[1])-(t[1]-e[1])*(e[0]-r[0]),a=(n[1]-r[1])*(t[0]-e[0])-(n[0]-r[0])*(t[1]-e[1]);if(0!==a){var s=i/a,l=o/a;if(s>=0&&s<=1&&l>=0&&l<=1)return!0}return!1}function i(e,t){for(var r=0;r<e.length-1;r++)for(var i=0;i<t.length-1;i++)if(n(e[r],e[r+1],t[i],t[i+1]))return!0;return!1}function o(e,t){var r=i(e,t),n=function(e,t){for(var r=!1,n=-1,i=e.length,o=i-1;++n<i;o=n)(e[n][1]<=t[1]&&t[1]<e[o][1]||e[o][1]<=t[1]&&t[1]<e[n][1])&&t[0]<(e[o][0]-e[n][0])*(t[1]-e[n][1])/(e[o][1]-e[n][1])+e[n][0]&&(r=!r);return r}(e,t[0]);return!(r||!n)}function a(e){var n=[],i=e.slice(0),o=t(i.shift().slice(0));if(o.length>=4){r(o)||o.reverse(),n.push(o);for(var a=0;a<i.length;a++){var s=t(i[a].slice(0));s.length>=4&&(r(s)&&s.reverse(),n.push(s))}}return n}function s(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function l(e,n){var a={};if(e.features){a.type="FeatureCollection",a.features=[];for(var c=0;c<e.features.length;c++)a.features.push(l(e.features[c],n))}if("number"==typeof e.x&&"number"==typeof e.y&&(a.type="Point",a.coordinates=[e.x,e.y],"number"==typeof e.z&&a.coordinates.push(e.z)),e.points&&(a.type="MultiPoint",a.coordinates=e.points.slice(0)),e.paths&&(1===e.paths.length?(a.type="LineString",a.coordinates=e.paths[0].slice(0)):(a.type="MultiLineString",a.coordinates=e.paths.slice(0))),e.rings&&(a=function(e){for(var n,a,s=[],l=[],c=0;c<e.length;c++){var u=t(e[c].slice(0));if(!(u.length<4))if(r(u)){var f=[u.slice().reverse()];s.push(f)}else l.push(u.slice().reverse())}for(var p=[];l.length;){a=l.pop();var h=!1;for(n=s.length-1;n>=0;n--)if(o(s[n][0],a)){s[n].push(a),h=!0;break}h||p.push(a)}for(;p.length;){a=p.pop();var d=!1;for(n=s.length-1;n>=0;n--)if(i(s[n][0],a)){s[n].push(a),d=!0;break}d||s.push([a.reverse()])}return 1===s.length?{type:"Polygon",coordinates:s[0]}:{type:"MultiPolygon",coordinates:s}}(e.rings.slice(0))),"number"==typeof e.xmin&&"number"==typeof e.ymin&&"number"==typeof e.xmax&&"number"==typeof e.ymax&&(a.type="Polygon",a.coordinates=[[[e.xmax,e.ymax],[e.xmin,e.ymax],[e.xmin,e.ymin],[e.xmax,e.ymin],[e.xmax,e.ymax]]]),(e.geometry||e.attributes)&&(a.type="Feature",a.geometry=e.geometry?l(e.geometry):null,a.properties=e.attributes?s(e.attributes):null,e.attributes))try{a.id=function(e,t){for(var r=t?[t,"OBJECTID","FID"]:["OBJECTID","FID"],n=0;n<r.length;n++){var i=r[n];if(i in e&&("string"==typeof e[i]||"number"==typeof e[i]))return e[i]}throw Error("No valid id attribute found")}(e.attributes,n)}catch(e){}return JSON.stringify(a.geometry)===JSON.stringify({})&&(a.geometry=null),e.spatialReference&&e.spatialReference.wkid&&4326!==e.spatialReference.wkid&&console.warn("Object converted in non-standard crs - "+JSON.stringify(e.spatialReference)),a}function c(e,t){t=t||"OBJECTID";var r,n={wkid:4326},i={};switch(e.type){case"Point":i.x=e.coordinates[0],i.y=e.coordinates[1],i.spatialReference=n;break;case"MultiPoint":i.points=e.coordinates.slice(0),i.spatialReference=n;break;case"LineString":i.paths=[e.coordinates.slice(0)],i.spatialReference=n;break;case"MultiLineString":i.paths=e.coordinates.slice(0),i.spatialReference=n;break;case"Polygon":i.rings=a(e.coordinates.slice(0)),i.spatialReference=n;break;case"MultiPolygon":i.rings=function(e){for(var t=[],r=0;r<e.length;r++)for(var n=a(e[r]),i=n.length-1;i>=0;i--){var o=n[i].slice(0);t.push(o)}return t}(e.coordinates.slice(0)),i.spatialReference=n;break;case"Feature":e.geometry&&(i.geometry=c(e.geometry,t)),i.attributes=e.properties?s(e.properties):{},e.id&&(i.attributes[t]=e.id);break;case"FeatureCollection":for(i=[],r=0;r<e.features.length;r++)i.push(c(e.features[r],t));break;case"GeometryCollection":for(i=[],r=0;r<e.geometries.length;r++)i.push(c(e.geometries[r],t))}return i}var u={arcgisToGeoJSON:l,geojsonToArcGIS:c};e.arcgisToGeoJSON=l,e.geojsonToArcGIS=c,e.default=u},"object"===s(t)&&void 0!==e?a(t):(i=[t],void 0===(o="function"==typeof(n=a)?n.apply(t,i):n)||(e.exports=o))},function(e,t,r){(function(r){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){"use strict";var e,i=/\s*/g,o=/^\s*|\s*$/g,a=/\s+/;function s(e){if(!e||!e.length)return 0;for(var t=0,r=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t)|0;return r}function l(e,t){return e.getElementsByTagName(t)}function c(e,t){return e.getAttribute(t)}function u(e,t){return parseFloat(c(e,t))}function f(e,t){var r=l(e,t);return r.length?r[0]:null}function p(e){for(var t=0,r=[];t<e.length;t++)r[t]=parseFloat(e[t]);return r}function h(e){var t;return e&&(t=e).normalize&&t.normalize(),e&&e.textContent||""}function d(e,t){var r,n,i={};for(n=0;n<t.length;n++)(r=f(e,t[n]))&&(i[t[n]]=h(r));return i}function y(e,t){for(var r in t)e[r]=t[r]}function m(e){return p(e.replace(i,"").split(","))}function g(e){for(var t=e.replace(o,"").split(a),r=[],n=0;n<t.length;n++)r.push(m(t[n]));return r}function v(e){var t,r=[u(e,"lon"),u(e,"lat")],n=f(e,"ele"),i=f(e,"gpxtpx:hr")||f(e,"hr"),o=f(e,"time");return n&&(t=parseFloat(h(n)),isNaN(t)||r.push(t)),{coordinates:r,time:o?h(o):null,heartRate:i?parseFloat(h(i)):null}}if("undefined"!=typeof XMLSerializer)e=new XMLSerializer;else{var b="object"===(void 0===r?"undefined":n(r))&&!r.browser,_="object"===("undefined"==typeof Titanium?"undefined":n(Titanium));if("object"!==n(t)||!b&&!_)throw new Error("Unable to initialize serializer");e=new XMLSerializer}function w(t){return void 0!==t.xml?t.xml:e.serializeToString(t)}return{kml:function(e){for(var t={type:"FeatureCollection",features:[]},r={},n={},i={},o=["Polygon","LineString","Point","Track","gx:Track"],a=l(e,"Placemark"),u=l(e,"Style"),d=l(e,"StyleMap"),y=0;y<u.length;y++){var v=s(w(u[y])).toString(16);r["#"+c(u[y],"id")]=v,n[v]=u[y]}for(var b=0;b<d.length;b++){r["#"+c(d[b],"id")]=s(w(d[b])).toString(16);for(var _=l(d[b],"Pair"),S={},x=0;x<_.length;x++)S[h(f(_[x],"key"))]=h(f(_[x],"styleUrl"));i["#"+c(d[b],"id")]=S}for(var L=0;L<a.length;L++)t.features=t.features.concat(C(a[L]));function P(e){var t,r;return"#"===(e=e||"").substr(0,1)&&(e=e.substr(1)),6!==e.length&&3!==e.length||(t=e),8===e.length&&(r=parseInt(e.substr(0,2),16)/255,t="#"+e.substr(6,2)+e.substr(4,2)+e.substr(2,2)),[t,isNaN(r)?void 0:r]}function E(e){var t=l(e,"coord"),r=[],n=[];0===t.length&&(t=l(e,"gx:coord"));for(var i=0;i<t.length;i++)r.push(p(h(t[i]).split(" ")));for(var o=l(e,"when"),a=0;a<o.length;a++)n.push(h(o[a]));return{coords:r,times:n}}function C(e){var t,a=function e(t){var r,n,i,a,s,c=[],u=[];if(f(t,"MultiGeometry"))return e(f(t,"MultiGeometry"));if(f(t,"MultiTrack"))return e(f(t,"MultiTrack"));if(f(t,"gx:MultiTrack"))return e(f(t,"gx:MultiTrack"));for(i=0;i<o.length;i++)if(n=l(t,o[i]))for(a=0;a<n.length;a++)if(r=n[a],"Point"===o[i])c.push({type:"Point",coordinates:m(h(f(r,"coordinates")))});else if("LineString"===o[i])c.push({type:"LineString",coordinates:g(h(f(r,"coordinates")))});else if("Polygon"===o[i]){var p=l(r,"LinearRing"),d=[];for(s=0;s<p.length;s++)d.push(g(h(f(p[s],"coordinates"))));c.push({type:"Polygon",coordinates:d})}else if("Track"===o[i]||"gx:Track"===o[i]){var y=E(r);c.push({type:"LineString",coordinates:y.coords}),y.times.length&&u.push(y.times)}return{geoms:c,coordTimes:u}}(e),s={},u=h(f(e,"name")),p=h(f(e,"address")),d=h(f(e,"styleUrl")),y=h(f(e,"description")),v=f(e,"TimeSpan"),b=f(e,"TimeStamp"),_=f(e,"ExtendedData"),w=f(e,"LineStyle"),S=f(e,"PolyStyle"),x=f(e,"visibility");if(!a.geoms.length)return[];if(u&&(s.name=u),p&&(s.address=p),d){"#"!==d[0]&&(d="#"+d),s.styleUrl=d,r[d]&&(s.styleHash=r[d]),i[d]&&(s.styleMapHash=i[d],s.styleHash=r[i[d].normal]);var L=n[s.styleHash];if(L){w||(w=f(L,"LineStyle")),S||(S=f(L,"PolyStyle"));var C=f(L,"IconStyle");if(C){var T=f(C,"Icon");if(T){var A=h(f(T,"href"));A&&(s.icon=A)}}}}if(y&&(s.description=y),v){var R=h(f(v,"begin")),M=h(f(v,"end"));s.timespan={begin:R,end:M}}if(b&&(s.timestamp=h(f(b,"when"))),w){var k=P(h(f(w,"color"))),O=k[0],I=k[1],F=parseFloat(h(f(w,"width")));O&&(s.stroke=O),isNaN(I)||(s["stroke-opacity"]=I),isNaN(F)||(s["stroke-width"]=F)}if(S){var N=P(h(f(S,"color"))),G=N[0],j=N[1],D=h(f(S,"fill")),B=h(f(S,"outline"));G&&(s.fill=G),isNaN(j)||(s["fill-opacity"]=j),D&&(s["fill-opacity"]="1"===D?s["fill-opacity"]||1:0),B&&(s["stroke-opacity"]="1"===B?s["stroke-opacity"]||1:0)}if(_){var U=l(_,"Data"),z=l(_,"SimpleData");for(t=0;t<U.length;t++)s[U[t].getAttribute("name")]=h(f(U[t],"value"));for(t=0;t<z.length;t++)s[z[t].getAttribute("name")]=h(z[t])}x&&(s.visibility=h(x)),a.coordTimes.length&&(s.coordTimes=1===a.coordTimes.length?a.coordTimes[0]:a.coordTimes);var W={type:"Feature",geometry:1===a.geoms.length?a.geoms[0]:{type:"GeometryCollection",geometries:a.geoms},properties:s};return c(e,"id")&&(W.id=c(e,"id")),[W]}return t},gpx:function(e){var t,r,n=l(e,"trk"),i=l(e,"rte"),o=l(e,"wpt"),a={type:"FeatureCollection",features:[]};for(t=0;t<n.length;t++)(r=p(n[t]))&&a.features.push(r);for(t=0;t<i.length;t++)(r=m(i[t]))&&a.features.push(r);for(t=0;t<o.length;t++)a.features.push(g(o[t]));function s(e,t){for(var r=0;r<t;r++)e.push(null);return e}function u(e,t){var r=l(e,t),n=[],i=[],o=[],a=r.length;if(a<2)return{};for(var c=0;c<a;c++){var u=v(r[c]);n.push(u.coordinates),u.time&&i.push(u.time),(u.heartRate||o.length)&&(o.length||s(o,c),o.push(u.heartRate||null))}return{line:n,times:i,heartRates:o}}function p(e){for(var t,r=l(e,"trkseg"),n=[],i=[],o=[],a=0;a<r.length;a++)if((t=u(r[a],"trkpt"))&&(t.line&&n.push(t.line),t.times&&t.times.length&&i.push(t.times),o.length||t.heartRates&&t.heartRates.length)){if(!o.length)for(var c=0;c<a;c++)o.push(s([],n[c].length));t.heartRates&&t.heartRates.length?o.push(t.heartRates):o.push(s([],t.line.length||0))}if(0!==n.length){var p=_(e);return y(p,b(f(e,"extensions"))),i.length&&(p.coordTimes=1===n.length?i[0]:i),o.length&&(p.heartRates=1===n.length?o[0]:o),{type:"Feature",properties:p,geometry:{type:1===n.length?"LineString":"MultiLineString",coordinates:1===n.length?n[0]:n}}}}function m(e){var t=u(e,"rtept");if(t.line){var r=_(e);return y(r,b(f(e,"extensions"))),{type:"Feature",properties:r,geometry:{type:"LineString",coordinates:t.line}}}}function g(e){var t=_(e);return y(t,d(e,["sym"])),{type:"Feature",properties:t,geometry:{type:"Point",coordinates:v(e).coordinates}}}function b(e){var t={};if(e){var r=f(e,"line");if(r){var n=h(f(r,"color")),i=parseFloat(h(f(r,"opacity"))),o=parseFloat(h(f(r,"width")));n&&(t.stroke=n),isNaN(i)||(t["stroke-opacity"]=i),isNaN(o)||(t["stroke-width"]=96*o/25.4)}}return t}function _(e){var t=d(e,["name","cmt","desc","type","time","keywords"]),r=l(e,"link");r.length&&(t.links=[]);for(var n,i=0;i<r.length;i++)y(n={href:c(r[i],"href")},d(r[i],["text","type"])),t.links.push(n);return t}return a}}}();e.exports=i}).call(this,r(422))},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var l,c=[],u=!1,f=-1;function p(){u&&l&&(u=!1,l.length?c=l.concat(c):f=-1,c.length&&h())}function h(){if(!u){var e=s(p);u=!0;for(var t=c.length;t;){for(l=c,c=[];++f<t;)l&&l[f].run();f=-1,t=c.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function y(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||u||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,r){var n=r(40),i=r(170),o={IEMapService:n,IDistrictService:r(171),IResourceCatalogService:r(172),IResourceQueryService:i,IResourceMetaService:r(424),IResourceCurdService:r(425),IResourceDispatchService:r(173),ITyphoonService:r(174),TyphoonServiceImpl:r(426)};e.exports=o},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getTable=function(e){},t}(r(40));e.exports=n},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r(40));e.exports=n},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var i=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getCurrent=function(e){var t,r=this,i=this.opts.crossOrigin;return new Promise((t=n(regeneratorRuntime.mark((function t(n,o){var a,s,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(l in t.prev=0,a=r.opts.currentUrl,s=null,a||n(s),e)a=a.replace("{"+l+"}",e[l]);if(!i){t.next=10;break}r._jsonp({url:a,callback:function(e){n(s=e)}}),t.next=14;break;case 10:return t.next=12,r.opts.httpRequest.get(a);case 12:s=t.sent,n(s);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),o(t.t0);case 19:case"end":return t.stop()}}),t,r,[[0,16]])}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.getTyphoonsByYear=function(e){var t,r=this,i=this.opts.source,o=this.opts.crossOrigin;return new Promise((t=n(regeneratorRuntime.mark((function t(n,a){var s,l,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(l in t.prev=0,s=r.opts.yearUrl,e)s=s.replace("{"+l+"}",e[l]);if(c=null,u=r,!o){t.next=9;break}r._jsonp({url:s,callback:function(e){c=e,i&&"zjwater"==i.toLowerCase()&&(c=u._parseZjwaterTyphoonYearList(c)),n(c)}}),t.next=14;break;case 9:return t.next=11,r.opts.httpRequest.get(s);case 11:c=t.sent,i&&"zjwater"==i.toLowerCase()&&(c=r._parseZjwaterTyphoonYearList(c)),n(c);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),a(t.t0);case 19:case"end":return t.stop()}}),t,r,[[0,16]])}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.getTyphoonInfo=function(e){var t,r=this,i=this.opts.source,o=this.opts.crossOrigin;return new Promise((t=n(regeneratorRuntime.mark((function t(n,a){var s,l,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(l in t.prev=0,s=r.opts.infoUrl,e)s=s.replace("{"+l+"}",e[l]);if(c=null,u=r,!o){t.next=9;break}r._jsonp({url:s,callback:function(e){c=e,i&&"zjwater"==i.toLowerCase()&&(c=u._parseZjwaterTyphoon(c)),n(c)}}),t.next=14;break;case 9:return t.next=11,r.opts.httpRequest.get(s);case 11:c=t.sent,i&&"zjwater"==i.toLowerCase()&&(c=r._parseZjwaterTyphoon(c)),n(c);case 14:t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),a(t.t0);case 19:case"end":return t.stop()}}),t,r,[[0,16]])}))),function(e,r){return t.apply(this,arguments)}))},t.prototype._parseZjwaterTyphoonYearList=function(e){var t=[];return e&&e.forEach((function(e){var r={};r.content=e.name?e.name:null,r.ename=e.enname?e.enname:null,r.start=e.starttime?e.starttime.replace(/\//g,"-").replace(" ","T"):null,r.end=e.endtime?e.endtime.replace(/\//g,"-").replace(" ","T"):null,r.id=e.tfid?parseInt(e.tfid):null,r.is_current=e.isactive?parseInt(e.isactive):null,t.push(r)})),t},t.prototype._parseZjwaterTyphoon=function(e){var t=[],r=this;return e&&e.forEach((function(e){var n={};n.begin_time=e.starttime.replace(/\//g,"-").replace(" ","T"),n.ename=e.enname,n.end_time=e.endtime.replace(/\//g,"-").replace(" ","T"),n.is_current=parseInt(e.isactive),n.land=e.land,n.name=e.name,n.tfbh=e.tfid,n.type="FeatureCollection",n.features=r._parseZjwaterFeature(e.points),t.push(n)})),t},t.prototype._parseRadisuQuad=function(e){var t={ne:0,se:0,nw:0,sw:0};if(e){var r=e.split("|");4==r.length&&(t.ne=r[0],t.se=r[1],t.nw=r[2],t.sw=r[3])}return t},t.prototype._parseForecast=function(e){var t=[],r=this;return e&&e.forEach((function(e){var n={};n.features=r._parseZjwaterFeature(e.forecastpoints),n.region=e.tm,n.type="FeatureCollection",t.push(n)})),t},t.prototype._parseZjwaterFeature=function(e){var t=[],r=this;return e&&e.forEach((function(e){var n={},i={type:"Point",coordinates:[]};i.coordinates.push(parseFloat(e.lng)),i.coordinates.push(parseFloat(e.lat)),n.geometry=i;var o={};o.move_dir=e.movedirection,o.move_speed=parseInt(e.movespeed),o.power=parseInt(e.power),o.pressure=parseInt(e.pressure),o.radius7_quad=r._parseRadisuQuad(e.radius7),o.radius10_quad=r._parseRadisuQuad(e.radius10),o.radius12_quad=r._parseRadisuQuad(e.radius12),o.speed=parseInt(e.speed),o.strong=e.strong,o.time=e.time.replace(/\//g,"-").replace(" ","T"),o.forecast=r._parseForecast(e.forecast),n.properties=o,n.type="Feature",t.push(n)})),t},t.prototype._jsonp=function(e){var t="typhoonCallback"+Math.random().toString().replace(".","");window[t]=function(t){e.callback(t),document.getElementsByTagName("body")[0].removeChild(r)};var r=document.createElement("script");e.url.indexOf("?")>=0?r.src=e.url+"&callback="+t:r.src=e.url+"?callback="+t,document.getElementsByTagName("body")[0].appendChild(r)},t}(r(174));e.exports=i},function(e,t,r){var n={DistrictServiceImpl:r(428),ResourceCatalogServiceImpl:r(430),ResourceQueryServiceImpl:r(432),ResourceAnalysisServiceImpl:r(435),ResourceDispatchServiceImpl:r(438)};e.exports=n},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var i=r(171),o=r(429),a=r(45),s=r(1),l=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getDistrict=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,s,l,c,u,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e.code,s=o[0],l={},"000000"!==s&&(l["tag.adcode"]={$in:o}),c=r._getDistrictLevel(s),u=r._getDistrictTableName(c.level),t.next=7,a.query({url:r.opts.url,httpRequest:r.opts.httpRequest,table:u,data:{query:l,limit:1e4},eId:"siptea",dataParser:r._dataParser});case 7:f=t.sent,n(f);case 9:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype._getDistrictLevel=function(e){var t={parent:null,level:null,child:null};return"000000"==e?(t.level="country",t.child="province",query=""):e.endsWith("0000")?(t.parent="country",t.level="province",t.child="city"):e.endsWith("00")?(t.parent="province",t.level="city",t.child="county"):(t.parent="city",t.level="county"),t},t.prototype._getDistrictTableName=function(e,t,r){var n,i=o.DISTRICTTABLES[e];return i&&(n=r?i.fullName:i.shortName,i.evacuationParams&&i.evacuationParams.length>0&&(t=isNaN(t)?0:t,n+=i.evacuationParams[t])),n},t.prototype._dataParser=function(e){for(var t=e.list,r=[],n=0;n<t.length;n++){var i=t[n],o={};if(o.name=i.name,o.code=i.adcode,i.gov){var a=i.gov.split(",");o.lng=parseFloat(a[0]),o.lat=parseFloat(a[1])}o.geom=i.geom,r.push(o)}return r},t.prototype.getSubDistrict=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var s,l,c,u,f,p,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=e.code,l=r._getDistrictLevel(s),c=l.child,u="",!o.DIRECTCITYS.hasOwnProperty(s)){t.next=9;break}c="county",u="^"+s.substr(0,2)+".*$",t.next=18;break;case 9:t.t0=c,t.next="province"===t.t0?12:"city"===t.t0?14:"county"===t.t0?16:18;break;case 12:return u="^.*$",t.abrupt("break",18);case 14:return u="^"+s.substr(0,2)+".*$",t.abrupt("break",18);case 16:return u="^"+s.substr(0,4)+".*$",t.abrupt("break",18);case 18:return f=r._getDistrictTableName(c),(p={})["tag.adcode"]={$regex:u},t.next=23,a.query({url:r.opts.url,httpRequest:r.opts.httpRequest,table:f,data:{query:p,limit:1e4},eId:"siptea",dataParser:r._dataParser});case 23:h=t.sent,n(h);case 25:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.getDistrictByLngLat=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,l,c,u,f,p,h;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={type:"Point",coordinates:e.point},e.spatialReference&&4326!=e.spatialReference&&(l=new s.sfs.CoordinateTransform,c=new s.sfs.Point({x:e.point[0],y:e.point[1],spatialReference:e.spatialReference}),u=l.transform(c,4326),c=u.asGeoJson()),(f={}).query={geom:{$geoIntersects:{$geometry:o}}},f.searchId="districtbylnglat",f.dataSetId=r._getDistrictTableName("county"),f.queryIndex=0,(p=[]).push({$project:{tag:"$tag",city:{$concat:[{$substr:["$tag.adcode",0,4]},"00"]},province:{$concat:[{$substr:["$tag.adcode",0,2]},"0000"]}}}),p.push({$lookup:{from:r._getDistrictTableName("city",0,!0),localField:"city",foreignField:"tag.adcode",as:"city"}}),p.push({$lookup:{from:r._getDistrictTableName("province",0,!0),localField:"province",foreignField:"tag.adcode",as:"province"}}),p.push({$project:{tag:"$tag",city:"$city.tag",province:"$province.tag"}}),f.aggregate=p,t.next=15,a.aggregateMulti({eId:"siptea",httpRequest:r.opts.httpRequest,url:r.opts.url,aggregateList:[f],dataParser:function(e){var t=null,r=e[f.searchId][f.dataSetId];if(1==r.length){var n=r[0];(t={}).county={name:n.tag.name,code:n.tag.adcode},n.city&&1==n.city.length&&(t.city={name:n.city[0].name,code:n.city[0].adcode}),n.province&&1==n.province.length&&(t.province={name:n.province[0].name,code:n.province[0].adcode})}return t}});case 15:h=t.sent,n(h);case 17:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t}(i);e.exports=l},function(e,t){e.exports={DISTRICTTABLES:{country:{shortName:"country",fullName:"user_siptea_country"},province:{shortName:"province",fullName:"user_siptea_province",evacuationParams:["0.01"]},city:{shortName:"city",fullName:"user_siptea_city",evacuationParams:["0.03"]},county:{shortName:"county",fullName:"user_siptea_county",evacuationParams:["0.12"]}},DIRECTCITYS:{11e4:{},12e4:{},31e4:{},5e5:{}}}},function(e,t,r){var n=r(172),i=r(431),o=(r(45),r(37),function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return n.treeSet={},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.registCustomTree=function(e,t){this.treeSet[e]=t},t.prototype.unregistCustomTree=function(e){this.treeSet[e]=null,delete this.treeSet[e]},t.prototype.stat=function(e){var t,r,n=this;return new Promise((t=regeneratorRuntime.mark((function t(r,o){var a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.statTree({treeId:e.treeId,nodeId:e.nodeId,treeSet:n.treeSet,url:n.opts.url,httpRequest:n.opts.httpRequest});case 2:a=t.sent,r(a);case 4:case"end":return t.stop()}}),t,n)})),r=function(){var e=t.apply(this,arguments);return new Promise((function(t,r){return function n(i,o){try{var a=e[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));t(s)}("next")}))},function(e,t){return r.apply(this,arguments)}))},t}(n));e.exports=o},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var i=r(45),o={statTree:function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,a,s,l,c,u,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={},a={},s=null,e.treeSet.hasOwnProperty(e.treeId)&&(s=e.treeSet[e.treeId]),t.next=6,r._statTableNodes(s,e.url,e.httpRequest);case 6:for(l=t.sent,c=function e(t,r){if(r.children)for(var n=0;n<r.children.length;n++)e(t,r.children[n]);else r.ext&&(a[t.id].dataCount+=l[r.id].total,a[t.id].resourceCount++)},u=function e(t){if(a[t.id]=a[t.id]||{dataCount:0,resourceCount:0},c(t,t),t.children)for(var r=0;r<t.children.length;r++)e(t.children[r])},f=0;f<s.length;f++)u(s[f]);o.statistics=a,n(o);case 12:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},_statTableNodes:function(e,t,r){var o,a=this;return new Promise((o=n(regeneratorRuntime.mark((function n(o,s){var l,c,u,f,p,h,d,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(l={},c=[],u=function e(t){if(t.children)for(var r=0;r<t.children.length;r++)e(t.children[r]);else if(t.ext&&t.ext.table){var n={query:{}};n.searchId=t.id,n.dataSetId=t.ext.table,n.queryIndex=0;var i=[];i.push({$group:{_id:"_id",v:{$sum:1}}}),n.aggregate=i,c.push(n)}else t.ext&&(l[t.id]={total:0})},f=0;f<e.length;f++)u(e[f]);if(!(c.length>0)){n.next=9;break}return n.next=7,i.aggregateMulti({url:t,httpRequest:r,aggregateList:c});case 7:for(h in p=n.sent)d=p[h],y=d[Object.keys(d)[0]],l[h]={total:y[0].v};case 9:o(l);case 10:case"end":return n.stop()}}),n,a)}))),function(e,t){return o.apply(this,arguments)}))}};e.exports=o},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var i=r(170),o=r(87),a=r(45),s=r(37),l=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getPageList=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,l,c,u,f,p,h,d,y,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((o=s(!0,{},e)).pageNo=o.pageNo||1,o.pageSize=o.pageSize||10,l=[o],!r._useAggregate(l)){t.next=29;break}return t.next=8,r._parseAggregateCol(l);case 8:return c=t.sent,t.next=11,a.aggregateMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,aggregateList:c,dataParser:function(e){return r._dataParser(e,l)}});case 11:return u=t.sent,(f=u[0]).pageSize=o.pageSize,f.pageNo=o.pageNo,t.next=17,r._parseQueryCol([o]);case 17:return p=t.sent,(h=p[o.table]).select="_id",h.limit=1,h.page=1,delete h.populate,t.next=25,a.query({url:r.opts.url,httpRequest:r.opts.httpRequest,table:o.table,data:h,dataParser:function(e){return e.total}});case 25:f.total=t.sent,n(f),t.next=37;break;case 29:return t.next=31,r._parseQueryCol(l);case 31:return d=t.sent,y=d[o.table],t.next=35,a.query({url:r.opts.url,httpRequest:r.opts.httpRequest,table:e.table,data:y,dataParser:function(e){return e}});case 35:m=t.sent,n(m);case 37:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.getList=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,s,l,c,u,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=[e],!r._useAggregate(o)){t.next=12;break}return t.next=5,r._parseAggregateCol(o);case 5:return s=t.sent,t.next=8,a.aggregateMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,aggregateList:s,dataParser:function(e){return r._dataParser(e,o)}});case 8:l=t.sent,n(l[0]),t.next=22;break;case 12:return t.next=14,r._parseQueryCol(o);case 14:return c=t.sent,t.next=17,a.queryMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,data:c,dataParser:function(e){return e}});case 17:u=t.sent,(f={}).list=u[e.table],f.table=e.table,n(f);case 22:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype._dataParser=function(e,t){for(var r=[],n=0;n<t.length;n++){var i=t[n],o={},a=e[n][i.table];o.list=a,o.table=i.table,r.push(o);for(var s={},l=0;l<i.relation.length;l++)s[i.relation[l].alias]=i.relation[l];for(var c=0,u=a.length;c<u;c++){var f=a[c];for(var p in f.tag)f[p]=f.tag[p];for(var h in f.id=f._id,delete f._id,delete f.tag,s){var d=f[h];if("many"==s[h].type)for(var y=0,m=d.length;y<m;y++)d[y]=d[y].tag;else f[h]=d.tag}}}return r},t.prototype.getListBatch=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,s,l,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=e.tables,!r._useAggregate(o)){t.next=12;break}return t.next=5,r._parseAggregateCol(o);case 5:return s=t.sent,t.next=8,a.aggregateMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,aggregateList:s,dataParser:function(e){return r._dataParser(e,o)}});case 8:l=t.sent,n(l),t.next=19;break;case 12:return t.next=14,r._parseQueryCol(o);case 14:return c=t.sent,t.next=17,a.queryMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,data:c,dataParser:function(t){for(var r=[],n=0;n<e.tables.length;n++)r.push({table:e.tables[n].table,list:t[e.tables[n].table]});return r}});case 17:u=t.sent,n(u);case 19:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype._useAggregate=function(e){for(var t=!1,r=0;r<e.length;r++){var n=e[r];if(n&&n.relation&&n.relation.length>0){t=!0;break}}return t},t.prototype._parseQueryCol=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var s,l,c,u,f,p,h,d,y,m,g,v,b,_,w,S,x,L,P,E,C,T,A,R,M;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(s={pageNo:"page",pageSize:"limit"},l={},c={},u=0;u<e.length;u++){for(d in(f=e[u]).returnRelation&&(c[f.table]=u),p={},h=[],l[f.table]=p,s)p[s[d]]=f[d];f.select&&(y=o.parseSqlFragment("select",f.select),m=o.translateSelect(y),p.select=m),f.where&&(g=o.parseSqlFragment("where",f.where),v=o.translateWhere(g),h.push(v)),f.geometry&&(b=o.parseGeometryFilter({geometry:f.geometry,inputSr:f.inputSr||4326,dataSr:4326,spatialRel:f.spatialRel||"intersects"}),h.push(b)),f.sort&&(_=o.parseSqlFragment("sort",f.sort),w=o.translateSort(_),p.sort=w),h.length>0&&(p.query={$and:h})}if(!((S=Object.keys(c)).length>0)){t.next=10;break}return t.next=8,a.getMetas({url:r.opts.url,httpRequest:r.opts.httpRequest,tables:S});case 8:for(x=t.sent,L=0;L<S.length;L++){for(P=l[S[L]],E=x[L],C=[],T=[],A=0;A<E.model.length;A++)(R=E.model[A])&&R.fieldRef&&(M="tag."+R.fieldName,C.push([M]),T.push(M));C.length>0&&(P.populate=C,P.select&&(P.select+=" "+T.join(" ")))}case 10:n(l);case 11:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype._parseAggregateCol=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var a,s,l,c,u,f,p,h,d,y,m,g,v,b,_,w,S,x,L,P,E,C;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=[],s=0;s<e.length;s++){for(l=e[s],u=[],(c={}).query={},c.searchId=s,c.dataSetId=l.table,c.queryIndex=0,f=[],l.where&&(p=o.parseSqlFragment("where",l.where),h=o.translateWhere(p),f.push(h)),l.geometry&&(d=o.parseGeometryFilter({geometry:l.geometry,inputSr:l.inputSr||4326,dataSr:4326,spatialRel:l.spatialRel||"intersects"}),f.push(d)),f.length>0&&(c.query={$and:f}),y={},l.relation=l.relation||[],m=0;m<l.relation.length;m++)g=l.relation[m],(v={}).from="user_safety_"+g.table,v.localField="tag."+g.localField,v.foreignField="tag."+g.foreignField,v.as=g.alias,y[v.as]=g,u.push({$lookup:v}),"many"!=g.type&&u.push({$unwind:{path:"$"+g.alias,preserveNullAndEmptyArrays:!0}});if(l.sort&&(b=o.parseSqlFragment("sort",l.sort),_=o.translateSortAggregate(b),u.push({$sort:_})),isNaN(l.pageNo)||(w=l.pageSize||10,u.push({$skip:(l.pageNo-1)*w}),u.push({$limit:w})),S={},l.select)for(x=o.parseSqlFragment("select",l.select),L=o.translateSelect(x),P=L.split(" "),E=0;E<P.length;E++)S[P[E]]="$"+P[E];else S.tag="$tag";for(C in y)S[C]="$"+C;u.push({$project:S}),c.aggregate=u,a.push(c)}n(a);case 3:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t}(i);e.exports=l},function(e,t,r){t.AST=r(434),t.parse=r(175).parse,t.stringify=r(176)},function(e,t,r){var n=r(175).parse,i=r(176);function o(e){this.ast=e}o.prototype={parse:function(e){this.ast=n(e)},stringify:function(){return i(this.ast)},getTables:function(){},getSelectedColumns:function(){}},e.exports=o},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var i=r(436),o=(r(87),r(45)),a=r(437),s=r(37),l=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getResourceCatalog=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.getResourceCatalog(r.opts.httpRequest,r.opts.configUrl,r.opts.url,e.eventType);case 2:o=t.sent,n(o);case 4:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.bufferQuery=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var l,c,u,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(l=s(!0,{},e)).resources=l.resources||[],l.spatialReference=l.spatialReference||4326,"[object Number]"==Object.prototype.toString.call(l.radius)&&(l.radius=[e.radius]),t.next=6,r._ensureResourceTree(e.eventType);case 6:return c=a.makeBufferAggregates(l),t.next=9,o.aggregateMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,aggregateList:c});case 9:u=t.sent,f=a.parseBufferQueryResult(u,l.radius,l.resources),n(f);case 12:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.polygonQuery=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var l,c,u,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(l=s(!0,{},e)).resources=l.resources||[],l.spatialReference=l.spatialReference||4326,t.next=5,r._ensureResourceTree(e.eventType);case 5:return c=a.makeAggregates(l,"polygon"),t.next=8,o.aggregateMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,aggregateList:c});case 8:u=t.sent,f=a.parseQueryResult(u,l.resources),n(f);case 11:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.keywordQuery=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var l,c,u,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(l=s(!0,{},e)).resources=l.resources||[],l.spatialReference=l.spatialReference||4326,t.next=5,r._ensureResourceTree(e.eventType);case 5:return c=a.makeAggregates(l,"keyword"),t.next=8,o.aggregateMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,aggregateList:c});case 8:u=t.sent,f=a.parseQueryResult(u,l.resources),n(f);case 11:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.districtQuery=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var l,c,u,f;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(l=s(!0,{},e)).resources=l.resources||[],l.spatialReference=l.spatialReference||4326,t.next=5,r._ensureResourceTree(e.eventType);case 5:return c=a.makeAggregates(l,"district"),t.next=8,o.aggregateMulti({url:r.opts.url,httpRequest:r.opts.httpRequest,aggregateList:c});case 8:u=t.sent,f=a.parseQueryResult(u,l.resources),n(f);case 11:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype._ensureResourceTree=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==e||null==e){t.next=3;break}return t.next=3,a.getResourceCatalog(r.opts.httpRequest,r.opts.configUrl,r.opts.url,e);case 3:n();case 4:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.bufferStatistics=function(e){console.warn("敬请期待……")},t.prototype.polygonStatistics=function(e){console.warn("敬请期待……")},t.prototype.keywordStatistics=function(e){console.warn("敬请期待……")},t.prototype.districtStatistics=function(e){console.warn("敬请期待……")},t.prototype.getResourceConfig=function(e){return a.getResourceConfigById(e)},t.prototype.destroy=function(){a.clear()},t}(i);e.exports=l},function(e,t,r){var n=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.getResourceCatalog=function(e){},t.prototype.bufferQuery=function(e){},t.prototype.polygonQuery=function(e){},t.prototype.keywordQuery=function(e){},t.prototype.districtQuery=function(e){},t.prototype.bufferStatistics=function(e){},t.prototype.polygonStatistics=function(e){},t.prototype.keywordStatistics=function(e){},t.prototype.districtStatistics=function(e){},t}(r(40));e.exports=n},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var i=r(87),o=r(45),a=r(37),s=r(57),l={},c={},u={};l.clear=function(){c={},u={}};var f=function(e,t,r){var i,a=this;return new Promise((i=n(regeneratorRuntime.mark((function n(i,s){var l,c,u,f,p,h,d,y,m,g,v,b,_,w;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(u in l=e.resources,c={},l)if(!(f=l[u]).table||f.selectField&&Object.keys(f.selectField).length>0||(c[f.table]=c[f.table]||[],c[f.table].push(f)),f.children&&Object.keys(f.children).length>0)for(p in f.children)!(h=f.children[p]).table||h.selectField&&Object.keys(h.selectField).length>0||(c[h.table]=c[h.table]||[],c[h.table].push(h));if(!(Object.keys(c).length>0)){n.next=8;break}return n.next=6,o.getMetas({url:r,httpRequest:t,tables:Object.keys(c)});case 6:for(d=n.sent,y=0;y<d.length;y++){for(m=d[y],g=m.model,v={},b=0;b<g.length;b++)v[g[b].fieldName]=g[b].fieldName;for(_=c[m.dataSetId]||[],w=0;w<_.length;w++)_[w].selectField=v}case 8:i(e);case 9:case"end":return n.stop()}}),n,a)}))),function(e,t){return i.apply(this,arguments)}))};l.getResourceConfig=function(e,t,r,i){var o,a=this;return new Promise((o=n(regeneratorRuntime.mark((function n(o,s){var l,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!c.hasOwnProperty(i)){n.next=4;break}o(c[i]),n.next=13;break;case 4:return t=t.replace(/\{eventType\}/g,i),n.next=7,e.get(t,"json");case 7:return l=n.sent,n.next=10,f(l,e,r);case 10:u=n.sent,c[i]=u,o(l);case 13:case"end":return n.stop()}}),n,a)}))),function(e,t){return o.apply(this,arguments)}))},l.getResourceCatalog=function(e,t,r,i){var o,s=this;return new Promise((o=n(regeneratorRuntime.mark((function n(o,l){var c,f,p,h,d,y,m,g,v,b,_;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c=[],n.next=3,s.getResourceConfig(e,t,r,i);case 3:for(h in f=n.sent,p=f.resources)if(d=p[h],(y={}).id=h,y.name=d.title,y.parentId=null,c.push(y),d.children&&Object.keys(d.children).length>0)for(m in y.isLeaf=!1,d.children){for(_ in g=d.children[m],(v={}).id=[h,m].join("~"),v.name=g.title,v.parentId=h,v.isLeaf=!0,c.push(v),delete(b=a(!0,{},d)).children,g)b[_]=g[_];u[v.id]=b}else u[y.id]=d,y.isLeaf=!0;o(c);case 7:case"end":return n.stop()}}),n,s)}))),function(e,t){return o.apply(this,arguments)}))},l.getResourceConfigById=function(e){return u[e]},l.makeBufferAggregates=function(e){for(var t=[],r=e.radius.length,n=0;n<e.resources.length;n++){var i=e.resources[n],o=u[i],s={type:"buffer"};s.resourceId=i,s.resourceConfig=o,s.keyword=e.keyword||null,s.radius=e.radius[0],s.geometry=e.geometry||null,s.spatialReference=e.spatialReference||4326;for(var l=this.makeAggregate(s),c=0;c<r;c++){var f=a(!0,{},l);f.searchId=f.searchId+"___"+c;var p=f.aggregate[0].$geoNear;p.maxDistance=e.radius[c],c>0&&(p.minDistance=e.radius[c-1]),t.push(f)}}return t},l.makeAggregates=function(e,t){for(var r=[],n=0;n<e.resources.length;n++){var i=e.resources[n],o=l.getResourceConfigById(i);if(o){var a={};a.type=t,a.resourceId=i,a.resourceConfig=o,a.keyword=e.keyword||null,a.districtCode=e.districtCode||null,a.geometry=e.geometry||null,a.geometryFilter=e.geometryFilter||null,a.spatialReference=e.spatialReference||4326;var s=this.makeAggregate(a);r.push(s)}}return r},l.parseBufferQueryResult=function(e,t,r){for(var n=[],i=0;i<t.length;i++){for(var o={total:0,radius:t[i],collection:[]},a=0;a<r.length;a++){var s=r[a],c=l.getResourceConfigById(s);if(c){var u=e[s+"___"+i],f={};f.id=s,f.name=c.title,f.list=u[c.table],o.total+=f.list.length,o.collection.push(f)}}n.push(o)}return n},l.parseQueryResult=function(e,t){for(var r={total:0,collection:[]},n=0;n<t.length;n++){var i=t[n],o=l.getResourceConfigById(i),a=e[i],s={};s.id=i,s.name=o.title,s.list=a[o.table],r.total+=s.list.length,r.collection.push(s)}return r},l.makeAggregate=function(e){var t={},r=[],n=e.resourceConfig.table;t.query={},t.searchId=e.resourceId,t.dataSetId=n,t.queryIndex=0;var i={},o=this.queryBuilders.buildMatch(e,i),c=l.queryBuilders.buildGeoNear(e);if(c)o.inGeoNear.$and.length>0&&(c.$geoNear.query=o.inGeoNear),r.push(c),t.queryIndex=1,o.postGeoNear&&o.postGeoNear.$and.length>0&&(t.query=o.postGeoNear);else{var u=[];o.inGeoNear&&o.inGeoNear.$and.length>0&&(u=u.concat(o.inGeoNear.$and)),o.postGeoNear&&o.postGeoNear.$and.length>0&&(u=u.concat(o.postGeoNear.$and)),u.length>0&&(t.query={$and:u}),e.geometry&&e.radius&&(e.geometryFilter=e.geometryFilter||s.getBuffer({geometry:e.geometry,radius:e.radius,spatialReference:e.spatialReference}))}var f=l.queryBuilders.buildSelect(e,i),p=l.queryBuilders.buildSort(e,i);if(Object.keys(i).length>0){var h=l.queryBuilders.buildRelation(e,i),d=a(!0,{},f.preLookup);a(!0,d,h.project||{}),a(!0,d,o.preLookupSelect||{}),r.push({$project:d}),r=r.concat(h.aggregate),o.postLookup.$and.length>0&&r.push({$match:{$and:o.postLookup.$and}}),Object.keys(f.postLookup).length>0&&r.push({$project:f.postLookup})}else r.push({$project:f.preLookup});return Object.keys(p.preLookup).length>0&&r.push({$sort:p.preLookup}),e.limit&&r.push({$limit:e.limit}),t.aggregate=r,console.debug(t),t},l.queryBuilders={buildGeoNear:function(e){if(!e.geometry||"Point"!=e.geometry.type)return null;var t={limit:1e6};return t.maxDistance=e.radius?parseFloat(e.radius):5e6,t.minDistance=0,t.spherical=!0,t.near=e.geometry,t.includeLocs="geom",t.distanceField="distance",{$geoNear:t}},buildMatch:function(e,t){var r={inGeoNear:{$and:[]},postGeoNear:{$and:[]},postLookup:{$and:[]},preLookupSelect:{}};if(e.resourceConfig.filter){var n=i.parseSqlFragment("where",e.resourceConfig.filter),o=i.translateWhere(n);r.inGeoNear.$and.push(o)}if(e.districtCode&&e.districtCode.length>0){var a={};a["tag."+e.resourceConfig.districtField]={$in:e.districtCode},r.inGeoNear.$and.push(a)}if(e.keyword){var s=e.resourceConfig.keywordFields;if(s&&s.length>0){for(var l={$regex:"^.*"+e.keyword+".*$"},c=[[],[],[]],u=0;u<s.length;u++){var f=s[u],p=f.split(".");if(2==p.length){var h={};h[[p[0],"tag",p[1]].join(".")]=l,c[1].push(h),t[p[0]]=!0}else{var d={};d["tag."+f]=l,c[0].push(d);var y=!1;for(var m in e.resourceConfig.selectField)if(e.resourceConfig.selectField[m]==f){var g={};g[m]=l,c[2].push(g),y=!0;break}y||(r.preLookupSelect[f]="$tag."+f)}}c[1].length>0?r.postLookup.$and.push({$or:c[2].concat(c[1])}):r.inGeoNear.$and.push({$or:c[0]})}}return e.geometryFilter&&r.postGeoNear.$and.push({geom:{$geoIntersects:{$geometry:e.geometryFilter}}}),r},buildSelect:function(e,t){var r={preLookup:{id:"$_id",geometry:"$geom",distance:{$floor:"$distance"},_id:!1},postLookup:{}},n=e.resourceConfig.selectField;for(var i in n)if(0!=i.indexOf("//")){var o=n[i].split(".");2==o.length?(r.postLookup[i]="$"+[o[0],"tag",o[1]].join("."),t[o[0]]=!0):"geom"==n[i]?r.preLookup[i]="$"+n[i]:r.preLookup[i]="$tag."+n[i]}for(var a in r.preLookup)r.postLookup[a]="$"+a;return r},buildSort:function(e,t){for(var r={preLookup:{},postLookup:{}},n=i.parseSqlFragment("sort",e.resourceConfig.sort),o=0;o<n.length;o++){var a=n[o];r.preLookup[a.expr.column]="ASC"==a.type?1:-1}return r},buildRelation:function(e,t){for(var r={aggregate:[],project:{}},n=0;n<e.resourceConfig.relateTables.length;n++){var i=e.resourceConfig.relateTables[n];if(t.hasOwnProperty(i.alias)){var o={};o.from="user_safety_"+i.table,o.localField="tag."+i.localField,o.foreignField="tag."+i.foreignField,o.as=i.alias,r.aggregate.push({$lookup:o}),r.aggregate.push({$unwind:{path:"$"+i.alias,preserveNullAndEmptyArrays:!0}}),r.project[o.localField]="$"+o.localField}}return r}},e.exports=l},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}var i=r(173),o=r(439),a=r(45),s=r(441),l=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));return n.routeService=new o({httpRequest:n.opts.httpRequest,url:n.opts.routServer.url,token:n.opts.routServer.key}),n.config={rescue:{},material:{}},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.setConfig=function(e){this.config=e},t.prototype.rescueDispatch=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={dispatchList:[]},e.tableInfo=r.config.rescue,l=s.makeRescueAggregates(e),t.next=5,a.aggregateMulti({httpRequest:r.opts.httpRequest,url:r.opts.url,aggregateList:l,dataParser:function(t){return s.extractRescueFulfillCol(e,t)}});case 5:if(c=t.sent,!e.routePlan){t.next=9;break}return t.next=9,s.planRoutes({service:r.routeService,destination:e.destination,dispatchCol:c,routeParams:e.routeParams,spatialReference:e.spatialReference});case 9:o.dispatchList=c,n(o);case 11:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t.prototype.materialDispatch=function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={dispatchList:[]},e.tableInfo=r.config.material,l=s.makeMaterialAggregates(e),t.next=5,a.aggregateMulti({httpRequest:r.opts.httpRequest,url:r.opts.url,aggregateList:l,dataParser:function(t){return s.extractMaterialFulfillCol(e,t)}});case 5:if(c=t.sent,!e.routePlan){t.next=9;break}return t.next=9,s.planRoutes({service:r.routeService,destination:e.destination,dispatchCol:c,routeParams:e.routeParams,spatialReference:e.spatialReference});case 9:o.dispatchList=c,n(o);case 11:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},t}(i);e.exports=l},function(e,t,r){var n=r(440),i=(r(37),r(121)),o=r(1),a=function(e){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r));for(var i in n.opts={},r)n.opts[i]=r[i];return n.projectService=new o.sfs.CoordinateTransform,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.driving=function(e){var t,r,n=this;return new Promise((t=regeneratorRuntime.mark((function t(r,o){var a,s,l,c,u,f,p,h,d,y,m,g,v,b,_,w,S,x,L,P,E,C,T,A,R,M,k,O;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n._getUrl(n.opts.url,"driving"),a+="&key="+n.opts.token,e.spatialReference=e.spatialReference||4326,s=n._getTransformedCoordiante(e.origin,e.spatialReference),a+="&origin="+s[0]+","+s[1],l=n._getTransformedCoordiante(e.destination,e.spatialReference),a+="&destination="+l[0]+","+l[1],e.custom)for(c in e.custom)a+="&"+c+"="+e.custom[c];return t.next=10,n.opts.httpRequest.get(a,"json",null,"application/x-www-form-urlencoded",{});case 10:if("OK"==(u=t.sent).info){for(f=u.route.paths[0],p=f.steps,h=[],d=0;d<p.length;d++){if(y=[],(m=p[d]).geometry={type:"LineString",coordinates:y},m.polyline)for(g=m.polyline.split(";"),v=0;v<g.length;v++)b=g[v],_=i.gcj02towgs84(b),w=_.split(","),S=[parseFloat(w[0]),parseFloat(w[1])],y.push(S),h.push(S);if(m.tmcs)for(x=0,L=m.tmcs.length;x<L;x++){for(P=m.tmcs[x],E=P.polyline,C=E.split(";"),T=[],A=0,R=C.length;A<R;A++)M=C[A],k=i.gcj02towgs84(M),O=k.split(","),T.push(O);P.polyline=T.join(";")}}f.geometry={type:"LineString",coordinates:h},r(f)}else o(new Error("路径规划失败："+u.infocode));case 12:case"end":return t.stop()}}),t,n)})),r=function(){var e=t.apply(this,arguments);return new Promise((function(t,r){return function n(i,o){try{var a=e[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));t(s)}("next")}))},function(e,t){return r.apply(this,arguments)}))},t.prototype._getTransformedCoordiante=function(e,t){var r=[];switch(t){case 4326:var n=i.wgs84togcj02([e[1],e[0]].join(","));r[0]=parseFloat(n.split(",")[0]).toFixed(6),r[1]=parseFloat(n.split(",")[1]).toFixed(6);break;case 3857:var a=new o.sfs.Point({x:pint[0],y:e[1],spatialReference:3857}),s=this.projectService.transform(a,4326);r=this._getTransformedCoordiante([s.x,s.y],4326)}return r},t.prototype._getUrl=function(e,t){var r=e;return r.indexOf("/"+t)>=0&&(r=r.replace("/"+t,"")),"/"!==r[r.length-1]&&(r+="/"),r+=t,r+="?"},t}(n);e.exports=a},function(e,t){var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return e.prototype.driving=function(e){},e.prototype.transit=function(e){},e.prototype.walking=function(e){},e.prototype.riding=function(e){},e}();e.exports=r},function(e,t,r){function n(e){return function(){var t=e.apply(this,arguments);return new Promise((function(e,r){return function n(i,o){try{var a=t[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));e(s)}("next")}))}}r(45);var o=r(87),a=(r(121),{makeRescueAggregates:function(e){for(var t=[],r={type:"Point",coordinates:e.destination},n=e.tableInfo.table,i=e.tableInfo.typeField,a=0;a<e.requiredList.length;a++){var s=e.requiredList[a],l={},c=[];l.query={},l.searchId=a,l.dataSetId=n,l.queryIndex=1,l.aggregate=c;var u=[];if(s.filter){var f=o.parseSqlFragment("where",s.filter),p=o.translateWhere(f);u.push(p)}var h={};h["tag."+i]=s.type,u.push(h);var d={limit:1e6,maxDistance:5e6,minDistance:0,spherical:!0};d.near=r,d.includeLocs="geom",d.distanceField="distance",u.length>0&&(d.query={$and:u}),c.push({$geoNear:d}),c.push({$project:{tag:"$tag",id:"$_id",geometry:"$geom",_d:"$distance"}}),t.push(l)}return t},extractRescueFulfillCol:function(e,t){for(var r=[],n=0;n<e.requiredList.length;n++){var i=e.requiredList[n],o=this.extractRescueFulfill(i,t[n][e.tableInfo.table],e.tableInfo);r.push({type:i.type,list:o.list,num:o.num})}return r},extractRescueFulfill:function(e,t,r){var n={},i=[];e.numType=e.numType||1;var o=this.makeRescuePriorityGroup(e.priority,t),a=0,s=r.numField;if(1==e.numType)for(var l=0;l<o.length;l++){var c=o[l];c.length>e.num?(i=c.slice(0,e.num),a+=e.num):(i=i.concat(c),a+=c.length)}else if(2==e.numType)for(var u=0;u<o.length;u++){for(var f=o[u],p=0;p<f.length;p++){var h=f[p];if(a>=e.num)break;var d=parseFloat(h[s]),y=d;a+d>e.num&&(y=e.num-a),a+=y,h.dispatch_num=y,i.push(h)}if(a>=e.num)break}return n.num=a,n.list=i,n},makeRescuePriorityGroup:function(e,t){var r=[];if(e)for(var n=0;n<e.values.length;n++){for(var i=e.values[n],o=[],a=t.length-1;a>=0;a--){var s=t[a];if(s.tag&&s.tag[e.field]==i){var l={id:s.id,geometry:s.geometry,distance:s._d};for(var c in l.geom=s.geometry,s.tag)l[c]=s.tag[c];o.push(l),t.splice(a,1)}}r.push(o)}else r.push(t);return r},planRoutes:function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o,s,l,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.routeParams=e.routeParams||{},o=0;case 2:if(!(o<e.dispatchCol.length)){t.next=17;break}s=e.dispatchCol[o].list,l=0;case 5:if(!(l<s.length)){t.next=14;break}return c=s[l],t.next=9,a.planRouteEach({service:e.service,startPos:[c.geometry.coordinates[0],c.geometry.coordinates[1]],endPos:e.destination,routeParams:e.routeParams,spatialReference:e.spatialReference});case 9:u=t.sent,c.route=u;case 11:l++,t.next=5;break;case 14:o++,t.next=2;break;case 17:n();case 18:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},planRouteEach:function(e){var t,r=this;return new Promise((t=n(regeneratorRuntime.mark((function t(n,i){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.service.driving({origin:e.startPos,destination:e.endPos,spatialReference:e.spatialReference,custom:e.routeParams.custom||{}});case 2:o=t.sent,n(o);case 4:case"end":return t.stop()}}),t,r)}))),function(e,r){return t.apply(this,arguments)}))},makeMaterialAggregates:function(e){var t=[],r={type:"Point",coordinates:e.destination},n=e.tableInfo.reposity,o=e.tableInfo.material,a={},s=[];a.query={},a.searchId=i,a.dataSetId=n.table,a.queryIndex=1,a.aggregate=s;var l={limit:1e6,maxDistance:5e6,minDistance:0,spherical:!0};l.near=r,l.includeLocs="geom",l.distanceField="distance",s.push({$geoNear:l});var c={};return c.from="user_safety_"+o.table,c.localField="_id",c.foreignField="tag."+o.reposityField,c.as="materials",s.push({$lookup:c}),t.push(a),t},extractMaterialFulfillCol:function(e,t){for(var r=[],n=t[0][e.tableInfo.reposity.table],i=e.tableInfo.material.typeField,o=0;o<e.requiredList.length;o++){for(var a=e.requiredList[o],s={},l=a.type.split(","),c=(l.length,0);c<l.length;c++)s[l[c]]=[];for(var u=[],f=0,p=n.length;f<p;f++){var h=n[f],d={};for(var y in d.id=h._id,d.geometry=h.geom,d.geom=h.geom,d.distance=h.distance,d.materials=h.materials,h.tag)d[y]=h.tag[y];for(var m=h.materials||[],g=0,v=0,b=m.length;v<b;v++){var _=m[v];for(var w in _.id=_._id,_.tag)_[w]=_.tag[w];delete _._id,delete _.tag;var S=s[_[i]];S&&(d._index=S.length,S.push(d),g++)}g>0&&u.push(d)}e.limit&&(u.sort((function(e,t){return e._index-t._index})),(u=u.slice(0,e.limit)).sort((function(e,t){return e.distance-t.distance}))),r.push({type:a.type,list:u})}return r}});e.exports=a},function(e,t,r){"use strict";var n,i;n=[r(443)],void 0===(i=function(e){return{AnalysisFile:e}}.apply(t,n))||(e.exports=i)},function(e,t,r){var n,i;n=[r(18),r(444),r(11),r(1)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{},initialize:function(t){e.prototype.initialize.call(this,t)},destroy:function(){e.prototype.destroy.call(this)}});return i.include({analysisDifferenceTypeFile:function(e){if(!e.fileUrl||!e.fileType)throw new Error("参数不完整");var t="_analysis"+e.fileType;"function"==typeof this[t]&&(e.layer=layer,this[t](e))},_analysisCsv:function(e){window.papaparse.parse(e.fileUrl,{download:!0,complete:function(t){if(t){for(var n,i,o,a=t.data,s={type:"FeatureCollection",features:[]},l=0;l<a[0].length;l++)"x"!=a[0][l]&&"X"!=a[0][l]&&"longitude"!=a[0][l]&&"LONGITUDE"!=a[0][l]||(n=l),"y"!=a[0][l]&&"Y"!=a[0][l]&&"latitude"!=a[0][l]&&"LATITUDE"!=a[0][l]||(i=l),"wkt"!=a[0][l]&&"SDE.ST_ASTEXT(SHAPE)"!=a[0][l]||(o=l);for(var c in a)if("0"!=c){var u={type:"Feature",properties:{},geometry:{},symbol:{}},f={};if(null!=n||null!=i){var p={type:"Point",coordinates:[a[c][n],a[c][i]]};f.type="SimpleMarkerSymbol",u.geometry=p,u.symbol=f,s.features.push(u)}if(null!=o){if(!a[c][o])break;"LineString"==(p=r.getGeoJSONWriter().write(r.getWktReader().read(a[c][o]))).type?f.type="SimpleLineSymbol":f.type="SimpleFillSymbol",u.geometry=p,u.symbol=f,s.features.push(u)}}}e.callback&&e.context&&e.callback.call(e.context,s)}})},_analysisShape:function(e){window.shp.load(e.fileUrl,(function(t){var r=[],n={type:"FeatureCollection",features:[]};if(t.records.length>0&&(r=t.records),1==t.shapeType||2==t.shapeType)for(var i=0;i<r.length;i++){var o={type:"Feature",properties:{},geometry:{},symbol:{}},a={},s={type:"Point",coordinates:[r[i].shape.content.x,r[i].shape.content.y]};a.type="SimpleMarkerSymbol",o.geometry=s,o.symbol=a,n.features.push(o)}else if(3==t.shapeType||4==t.shapeType)for(i=0;i<r.length;i++){o={type:"Feature",properties:{},geometry:{},symbol:{}},a={},s={type:"LineString",coordinates:[]};if((c=r[i].shape.content.points).length>0)for(var l=0;l<c.length/2;l++)s.coordinates.push([c[2*l],c[2*l+1]]);a.type="SimpleLineSymbol",o.geometry=s,o.symbol=a,n.features.push(o)}else if(5==t.shapeType||6==t.shapeType)for(i=0;i<r.length;i++){var c;o={type:"Feature",properties:{},geometry:{},symbol:{}},a={},s={type:"Polygon",coordinates:[[]]};if((c=r[i].shape.content.points).length>0)for(l=0;l<c.length/2;l++)s.coordinates[0].push([c[2*l],c[2*l+1]]);a.type="SimpleFillSymbol",o.geometry=s,o.symbol=a,n.features.push(o)}e.callback&&e.context&&e.callback.call(e.context,n)}),(function(e){throw new Error(e)}))},_analysisGml:function(e){$.ajax({type:"get",url:e.fileUrl,dataType:"XML",async:!0,success:function(t){var r=$(t).find("featureMember"),n={type:"FeatureCollection",features:[]};r.each((function(){var e={type:"Feature",properties:{},geometry:{},symbol:{}},t={};if($(this).find("Point").length>0){var r=$(this).find("Point").find("pos").text().split(" "),i={type:"Point",coordinates:[r[1],r[0]]};t.type="SimpleMarkerSymbol",e.geometry=i,e.symbol=t,n.features.push(e)}if($(this).find("LineString").length>0){for(var o=$(this).find("LineString").find("posList").text().split(" "),a=(i={type:"LineString",coordinates:[]},0);a<o.length/2;a++)i.coordinates.push([o[2*a+1],o[2*a]]);t.type="SimpleLineSymbol",e.geometry=i,e.symbol=t,n.features.push(e)}if($(this).find("LinearRing").length>0){for(var s=$(this).find("LinearRing").find("posList").text().split(" "),l=(i={type:"Polygon",coordinates:[[]]},0);l<s.length/2;l++)i.coordinates[0].push([s[2*l+1],s[2*l]]);t.type="SimpleFillSymbol",e.geometry=i,e.symbol=t,n.features.push(e)}})),e.callback&&e.context&&e.callback.call(e.context,n)},error:function(e){throw new Error(e.message)}})},_analysisKml:function(e){var t=this;$.ajax({type:"get",url:e.fileUrl,dataType:"XML",async:!0,success:function(r){var n=$(r).find("Placemark"),i=$(r).find("Style"),o=($(r).find("featureMember"),{type:"FeatureCollection",features:[]});n.each((function(){var e={type:"Feature",properties:{},geometry:{},symbol:{}},r={};if($(this).find("Point").length>0){$(this).find("styleUrl").length>0&&(r=t._getSymbolObj(i,$(this).find("styleUrl").text(),"IconStyle"));var n={type:"Point",coordinates:[(l=$(this).find("Point").find("coordinates").text().split(","))[0],l[1]]};e.geometry=n,e.symbol=r,o.features.push(e)}if($(this).find("LineString").length>0){$(this).find("styleUrl").length>0&&(r=t._getSymbolObj(i,$(this).find("styleUrl").text(),"LineStyle"));for(var a=$(this).find("LineString").find("coordinates").text().split(" "),s=(n={type:"LineString",coordinates:[]},0);s<a.length;s++){var l=a[s].split(",");n.coordinates.push([l[0],l[1]])}e.geometry=n,e.symbol=r,o.features.push(e)}if($(this).find("LinearRing").length>0){$(this).find("styleUrl").length>0&&(r=t._getSymbolObj(i,$(this).find("styleUrl").text(),"PolyStyle"));var c=$(this).find("LinearRing").find("coordinates").text().split(" ");for(n={type:"LineString",coordinates:[[]]},s=0;s<c.length;s++){var u=c[s].split(",");n.coordinates[0].push([u[0],u[1]])}e.geometry=n,e.symbol=r,o.features.push(e)}})),e.callback&&e.context&&e.callback.call(e.context,o)},error:function(e){throw new Error(e.message)}})},analysisWfsData:function(e){if(!e.wfsData)throw new Error("传入参数错误！");return t.wfsXmlToJsonDataArray(e.wfsData)}}),i.include({_getSymbolObj:function(e,t,r){var i={};return e.length>0&&e.each((function(){if("#"+$(this)[0].id==t){if("IconStyle"==r){var e=$(this).find("scale").text()||.2,o=$(this).find("href").text()||void 0,a=$(this).find("rotation").text()||0,s=$(this).find("width").text()||void 0,l=$(this).find("height").text()||void 0;i={type:"PictureMarkerSymbol",scale:e,sourceKey:o,width:s,height:l,rotation:a}}if("LineStyle"==r){var c=$(this).find("style").text()||5,u=$(this).find("width").text()||2,f=$(this).find("color").text()||"#ff0000",p=n.sfs.Color.fromHex(f);i={type:"SimpleLineSymbol",color:p,style:c,width:u}}if("PolyStyle"==r){f=$(this).find("color").text()||"#ff0000";var h=$(this).find("borderThickness").text()||0,d=$(this).find("opacity").text()||1;p=n.sfs.Color.fromHex(f);i={type:"SimpleFillSymbol",borderColor:p,fillColor:p,borderThickness:h,opacity:d}}}})),i}}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){var n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};void 0===(n=function(){var e={};function t(e){var t={};for(var r in e)0==r.indexOf("esri:")&&(t[r.substr(5)]=e[r]);var n=e["gml:envelope"].split(","),i=parseFloat(n[0]),o=parseFloat(n[1]),a=parseFloat(n[2]),s=parseFloat(n[3]);t.longitude=(i+a)/2,t.latitude=(o+s)/2;var l=e["gml:multiPointProperty"],c=e["gml:multiLineStringProperty"],u=e["gml:multiPolygonProperty"];if(l){var f=l["gml:MultiPoint"]["gml:pointMember"],p="";if(f.length){p="MULTIPOINT(",t.wkttype="MULTIPOINT";for(var h=0;h<f.length;h++){var d=f[h]["gml:Point"]["gml:coordinates"];h==f.length-1?p+=d:p+=d+","}p+=")"}else p+="POINT(",t.wkttype="POINT",p+=f["gml:Point"]["gml:coordinates"],p+=")";t.wktdata=p}if(c){var y=c["gml:MultiLineString"]["gml:lineStringMember"],m="";if(y.length){t.wkttype="MULTILINESTRING",m+="MULTILINESTRING(";for(h=0;h<y.length;h++){var g=y[h]["gml:LineString"]["gml:coordinates"];h==y.length-1?m+="("+g.replace(new RegExp(";","gm"),",")+")":m+="("+g.replace(new RegExp(";","gm"),",")+"),"}m+=")"}else{t.wkttype="LINESTRING",m+="LINESTRING(",m+=(g=y["gml:LineString"]["gml:coordinates"]).replace(new RegExp(";","gm"),","),m+=")"}t.wktdata=m}if(u){var v=u["gml:MultiPolygon"]["gml:polygonMember"],b="";if(v.length){t.wkttype="MULTIPOLYGON",b+="MULTIPOLYGON(";for(h=0;h<v.length;h++){var _=v[h]["gml:Polygon"]["gml:outerBoundaryIs"]["gml:LinearRing"]["gml:coordinates"];h==v.length-1?b+="(("+_.replace(new RegExp(";","gm"),",")+"))":b+="(("+_.replace(new RegExp(";","gm"),",")+")),"}b+=")"}else{t.wkttype="POLYGON",b+="POLYGON(",b+="("+(_=v["gml:Polygon"]["gml:outerBoundaryIs"]["gml:LinearRing"]["gml:coordinates"]).replace(new RegExp(";","gm"),",")+")",b+=")"}t.wktdata=b}return l||u||c||(t.wkttype="未知类型"),t}return e.xml2json=function(e,t){var r={toObj:function(e){var t={};if(1==e.nodeType){if(e.attributes.length)for(var n=0;n<e.attributes.length;n++)t["@"+e.attributes[n].nodeName]=(e.attributes[n].nodeValue||"").toString();if(e.firstChild){for(var i=0,o=0,a=!1,s=e.firstChild;s;s=s.nextSibling)1==s.nodeType?a=!0:3==s.nodeType&&s.nodeValue.match(/[^ \f\n\r\t\v]/)?i++:4==s.nodeType&&o++;if(a)if(i<2&&o<2){r.removeWhite(e);for(s=e.firstChild;s;s=s.nextSibling)3==s.nodeType?t["#text"]=r.escape(s.nodeValue):4==s.nodeType?t["#cdata"]=r.escape(s.nodeValue):t[s.nodeName]?t[s.nodeName]instanceof Array?t[s.nodeName][t[s.nodeName].length]=r.toObj(s):t[s.nodeName]=[t[s.nodeName],r.toObj(s)]:t[s.nodeName]=r.toObj(s)}else e.attributes.length?t["#text"]=r.escape(r.innerXml(e)):t=r.escape(r.innerXml(e));else if(i)e.attributes.length?t["#text"]=r.escape(r.innerXml(e)):t=r.escape(r.innerXml(e));else if(o)if(o>1)t=r.escape(r.innerXml(e));else for(s=e.firstChild;s;s=s.nextSibling)t["#cdata"]=r.escape(s.nodeValue)}e.attributes.length||e.firstChild||(t=null)}else 9==e.nodeType?t=r.toObj(e.documentElement):alert("unhandled node type: "+e.nodeType);return t},toJson:function(e,t,n){var o=t?'"'+t+'"':"";if(e instanceof Array){for(var a=0,s=e.length;a<s;a++)e[a]=r.toJson(e[a],"",n+"\t");o+=(t?":[":"[")+(e.length>1?"\n"+n+"\t"+e.join(",\n"+n+"\t")+"\n"+n:e.join(""))+"]"}else if(null==e)o+=(t&&":")+"null";else if("object"==(void 0===e?"undefined":i(e))){var l=[];for(var c in e)l[l.length]=r.toJson(e[c],c,n+"\t");o+=(t?":{":"{")+(l.length>1?"\n"+n+"\t"+l.join(",\n"+n+"\t")+"\n"+n:l.join(""))+"}"}else o+="string"==typeof e?(t&&":")+'"'+e.toString()+'"':(t&&":")+e.toString();return o},innerXml:function(e){var t="";if("innerHTML"in e)t=e.innerHTML;else for(var r=function e(t){var r="";if(1==t.nodeType){r+="<"+t.nodeName;for(var n=0;n<t.attributes.length;n++)r+=" "+t.attributes[n].nodeName+'="'+(t.attributes[n].nodeValue||"").toString()+'"';if(t.firstChild){r+=">";for(var i=t.firstChild;i;i=i.nextSibling)r+=e(i);r+="</"+t.nodeName+">"}else r+="/>"}else 3==t.nodeType?r+=t.nodeValue:4==t.nodeType&&(r+="<![CDATA["+t.nodeValue+"]]>");return r},n=e.firstChild;n;n=n.nextSibling)t+=r(n);return t},escape:function(e){return e.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(e){e.normalize();for(var t=e.firstChild;t;)if(3==t.nodeType)if(t.nodeValue.match(/[^ \f\n\r\t\v]/))t=t.nextSibling;else{var n=t.nextSibling;e.removeChild(t),t=n}else 1==t.nodeType?(r.removeWhite(t),t=t.nextSibling):t=t.nextSibling;return e}};9==e.nodeType&&(e=e.documentElement);var n=r.toJson(r.toObj(r.removeWhite(e)),e.nodeName,"\t");return"{\n"+t+(t?n.replace(/\t/g,t):n.replace(/\t|\n/g,""))+"\n}"},e.json2xml=function(e,t){var r=function e(t,r,n){var o="";if(t instanceof Array)for(var a=0,s=t.length;a<s;a++)o+=n+e(t[a],r,n+"\t")+"\n";else if("object"==(void 0===t?"undefined":i(t))){var l=!1;for(var c in o+=n+"<"+r,t)"@"==c.charAt(0)?o+=" "+c.substr(1)+'="'+t[c].toString()+'"':l=!0;if(o+=l?">":"/>",l){for(var c in t)"#text"==c?o+=t[c]:"#cdata"==c?o+="<![CDATA["+t[c]+"]]>":"@"!=c.charAt(0)&&(o+=e(t[c],c,n+"\t"));o+=("\n"==o.charAt(o.length-1)?n:"")+"</"+r+">"}}else o+=n+"<"+r+">"+t.toString()+"</"+r+">";return o},n="";for(var o in e)n+=r(e[o],o,"");return t?n.replace(/\t/g,t):n.replace(/\t|\n/g,"")},e.wfsXmlToJsonDataArray=function(e,r){return function(e,r){var n,i=JSON.parse(e),o=[];if(!i||!i["wfs:FeatureCollection"])return;n=i["wfs:FeatureCollection"]["gml:featureMember"];if(!n)return;if(n&&null==n.length){for(var a in n)break;o.push(t(n[a]))}else for(var s=0;s<n.length;s++){for(var a in n[s])break;var l=t(n[s][a]);o.push(l)}return o}(this.xml2json(e,""))},e}.apply(t,[]))||(e.exports=n)},function(e,t,r){"use strict";var n,i;n=[r(36),r(44),r(446),r(447)],void 0===(i=function(e,t,r,n){return{AppEvent:e,AppEvents:t,Draggable:n}}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";!function(e){function t(e){return"[object Function]"==Object.prototype.toString.call(e)}function r(e){return e instanceof Promise}e.prototype.before=function(e){var r=this;return function(){return(!t(e)||!1!==e.apply(this,arguments))&&r.apply(this,arguments)}},e.prototype.after=function(e){var n=this;return function(){var i=n.apply(this,arguments);if(!1===i)return!1;if(t(e))if(r(i)){var o=this,a=arguments;i.then((function(){var t=[];for(var r in arguments)t.push(arguments[r]);t.push(a),e.apply(o,t)}))}else e.apply(this,arguments);return i}},e.prototype.around=function(e,n){var i=this;return function(){if(t(e)&&!1===e.apply(this,arguments))return!1;var o=i.apply(this,arguments);if(!1===o)return!1;if(t(n))if(r(o)){var a=this,s=arguments;o.then((function(){var e=[];for(var t in arguments)e.push(arguments[t]);e.push(s),n.apply(a,e)}))}else n.apply(this,arguments);return o}}}(Function)},function(e,t,r){"use strict";var n,i;n=[r(15),r(2)],void 0===(i=function(e,t){var r={TRANSFORM:function(){return this.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"])},testProp:function(e){for(var t=document.documentElement.style,r=0;r<e.length;r++)if(e[r]in t)return e[r];return!1},setPosition:function(e,r){e._pos=r,t.Browser().any3d?this.setTransform(e,r):(e.style.left=r[0]+"px",e.style.top=r[1]+"px")},getPosition:function(e){return e._pos||[0,0]},setTransform:function(e,r,n){var i=r||new Point(0,0);e.style[this.TRANSFORM()]=(t.Browser().ie3d?"translate("+i[0]+"px,"+i[1]+"px)":"translate3d("+i[0]+"px,"+i[1]+"px,0)")+(n?" scale("+n+")":"")}},n={extend:function(e){var t,r,n,i;for(r=1,n=arguments.length;r<n;r++)for(t in i=arguments[r])e[t]=i[t];return e},create:Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}()};!function(){function e(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var t=0;function r(e){var r=+new Date,n=Math.max(0,16-(r-t));return t=r+n,window.setTimeout(e,n)}var i=window.requestAnimationFrame||e("RequestAnimationFrame")||r,o=window.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};n.requestAnimFrame=function(e,t,n){if(!n||i!==r)return i.call(window,function(e,t){var r=Array.prototype.slice;if(e.bind)return e.bind.apply(e,r.call(arguments,1));var n=r.call(arguments,2);return function(){return e.apply(t,n.length?n.concat(r.call(arguments)):arguments)}}(e,t));e.call(t)},n.cancelAnimFrame=function(e){e&&o.call(window,e)}}();var i=e.extend({option:{clickTolerance:3},draggableStyle:{dragging:{cursor:"move"},defaults:{cursor:"default"}},initialize:function(r,n,i,o){e.setOptions(this,o),this._element=r,this._dragStartTarget=n||r,this.START=t.Browser().touch?"touchstart mousedown":"mousedown",this.END={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},this.MOVE={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},enable:function(){this._enabled||($(this._dragStartTarget).bind(this.START,{self:this},this._onDown),this._enabled=!0)},disable:function(){this._enabled&&(i._dragging===this&&this.finishDrag(),$(this._dragStartTarget).unbind(this.START,this._onDown),this._enabled=!1,this._moved=!1)},_onDown:function(e){var t=e.originalEvent,r=e.data.self;if(!t._simulated&&r._enabled&&(r._moved=!1,!(i._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(i._dragging=r,r._moving)))){var n=t.touches?t.touches[0]:t;r._startPoint=[n.clientX,n.clientY],$(document).bind(r.MOVE[t.type],{self:r},r._onMove),$(document).bind(r.END[t.type],{self:r},r._onUp),r._dragStartTarget&&r._dragStartTarget.style&&(r._dragStartTarget.style.cursor=r.draggableStyle.dragging.cursor)}},_onMove:function(e){var t=e.originalEvent,i=e.data.self;if(!t._simulated&&i._enabled)if(t.touches&&t.touches.length>1)i._moved=!0;else{var o=t.touches&&1===t.touches.length?t.touches[0]:t,a=[o.clientX,o.clientY],s=i._startPoint,l=[a[0]-s[0],a[1]-s[1]];if((l[0]||l[1])&&!(Math.abs(l[0])+Math.abs(l[1])<i.options.clickTolerance)){if(t.preventDefault&&t.preventDefault(),!i._moved){i._moved=!0;var c=r.getPosition(i._element);i._startPos=[c[0]-l[0],c[1]-l[1]],i._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&i._lastTarget instanceof SVGElementInstance&&(i._lastTarget=i._lastTarget.correspondingUseElement)}i._newPos=[i._startPos[0]+l[0],i._startPos[1]+l[1]],i._moving=!0,n.cancelAnimFrame(i._animRequest),i._lastEvent=t,i._updatePosition()}}},_onUp:function(e){var t=e.originalEvent,r=e.data.self;console.log("up"),!t._simulated&&r._enabled&&(r.finishDrag(),r._dragStartTarget.style.cursor=r.draggableStyle.defaults.cursor)},_updatePosition:function(){r.setPosition(this._element,this._newPos)},setDragTarget:function(e){e&&(this._dragStartTarget=e)},getDragTarget:function(){return this._dragStartTarget},finishDrag:function(){for(var e in console.log("finishDrag"),this._lastTarget&&(this._lastTarget=null),this.MOVE)$(document).unbind(this.MOVE[e],this._onMove),$(document).unbind(this.END[e],this._onUp);this._moved&&this._moving&&n.cancelAnimFrame(this._animRequest),this._moving=!1,i._dragging=!1}});return i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(449),r(450),r(451),r(452),r(453),r(165),r(455)],void 0===(i=function(e,t,r,n,i,o,a){var s={};return s.ScreenShotComponent=e,s.SelectionComponent=n,s.AnimateComponent=r,s.MeasureComponent=i,s.TailedLabelComponent=o,s.BufferDrawComponent=a,s}.apply(t,n))||(e.exports=i)},function(e,t,r){var n,i;n=[r(18),r(2)],void 0===(i=function(e,t){return e.extend({initialize:function(t){e.prototype.initialize.call(this,t)},shotMap:function(e){var r=document.getElementById(this.map.id);html2canvas(r,{onrendered:function(r){t.isFunction(e)&&e(r.toDataURL())},useCORS:!0})},screen:function(e){html2canvas.download(document.getElementById(this.map.options.targetId))},destroy:function(){e.prototype.destroy.call(this)}})}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(85),r(1)],void 0===(i=function(e,t,r){var n={PointNaturalDistribution:"PointNaturalDistribution",PointClusterDistribution:"PointClusterDistribution",PointClusterDistributionReduplicative:"PointClusterDistributionReduplicative",Statistics_Ratio_Ring:"Statistics_Ratio_Ring",Statistics_Total_Circle:"Statistics_Total_Circle",PointQuantityNaturalDistribution:"PointQuantityNaturalDistribution"},i=e.extend({options:{},initialize:function(t){e.prototype.initialize.call(this,t),this.changeVisualStyle(t)},addDispalyElements:function(e){this._layer.addElements(e)},updateData:function(e){this._layer.clear(),this._layer.addElements(e)},updateStatistics:function(e){n.Statistics_Ratio_Ring!=this.options.displayMode&&n.Statistics_Total_Circle!=this.options.displayMode||this._layer.updateStatistics(e)},setVisible:function(e){this._layer.setVisible(e)},getVisible:function(){return this._layer.getVisible()},changeVisualStyle:function(e){null!=this._layer&&(this.map.getMap().removeLayer(this._layer),this._layer.destroy()),this.options.displayMode=e.displayMode;var r=this,n={PointNaturalDistribution:function(e){var n=(new t.LayerFactory).createLayer(t.TYPES.ELEMENT_POINT_LAYER,{layerId:e.id,layerName:e.layerName,layerGroups:e.layerGroups,map:r.map.getMap(),idKey:e.fieldsParam.idKey,xField:e.fieldsParam.xField,yField:e.fieldsParam.yField,symbolConfig:jQuery.extend(!0,{},e.symbolConfig)});r.map.getMap().addLayer(n),r._layer=n},PointClusterDistribution:function(e){var n=(new t.LayerFactory).createLayer(t.TYPES.ELEMENT_POINT_PIXEL_CLUSTER,{layerId:e.id,layerName:e.layerName,layerGroups:e.layerGroups,map:r.map.getMap(),idKey:e.fieldsParam.idKey,xField:e.fieldsParam.xField,yField:e.fieldsParam.yField,symbolConfig:jQuery.extend(!0,{},e.symbolConfig)});r.map.getMap().addLayer(n),r._layer=n},PointClusterDistributionReduplicative:function(e){var n=new t.LayerFactory,i=jQuery.extend(!0,{},e.reduplicativeParam),o=n.createLayer(t.TYPES.ELEMENT_POINT_DUPLICATE,{layerId:e.id,layerName:e.layerName,layerGroups:e.layerGroups,map:r.map.getMap(),idKey:e.fieldsParam.idKey,xField:e.fieldsParam.xField,yField:e.fieldsParam.yField,symbolConfig:jQuery.extend(!0,{},e.symbolConfig),spiderfyDistance:i.spiderfyDistance,spiderfyLevel:i.spiderfyLevel,coincidenceClusterHoverThreshold:i.coincidenceClusterHoverThreshold,coincidenceClusterWeight:i.coincidenceClusterWeight,coincidenceClusterMarkerSym:i.coincidenceClusterMarkerSym,coincidenceClusterTextSym:i.coincidenceClusterTextSym,showSpiderLeg:i.showSpiderLeg,spiderfyThreshold:i.spiderfyThreshold,circleRadius:i.circleRadius,spiderfyLegSym:i.spiderfyLegSym});r.map.getMap().addLayer(o),r._layer=o},Statistics_Ratio_Ring:function(e){var n=(new t.LayerFactory).createLayer(t.TYPES.RING_STATISTICS_LAYER,{layerId:e.id,layerName:e.layerName,layerGroups:e.layerGroups,map:r.map.getMap(),xField:e.fieldsParam.xField,yField:e.fieldsParam.yField,showZero:e.showZero});r.map.getMap().addLayer(n),r._layer=n},Statistics_Total_Circle:function(e){var n=(new t.LayerFactory).createLayer(t.TYPES.PIE_STATISTICS_LAYER,{layerId:e.id,layerName:e.layerName,layerGroups:e.layerGroups,map:r.map.getMap(),xField:e.fieldsParam.xField,yField:e.fieldsParam.yField,showZero:e.showZero});r.map.getMap().addLayer(n),r._layer=n},PointQuantityNaturalDistribution:function(e){var n=(new t.LayerFactory).createLayer(t.TYPES.FEATURE_POINT_LAYER,{layerId:e.id,layerName:e.layerName,layerGroups:e.layerGroups,map:r.map.getMap(),idKey:e.fieldsParam.idKey,xField:e.fieldsParam.xField,yField:e.fieldsParam.yField,symbolConfig:jQuery.extend(!0,{},e.symbolConfig)});r.map.getMap().addLayer(n),r._layer=n}};null!=n[e.displayMode]?n[e.displayMode](e):console.error(e.displayMode+"没有对应的处理方法！")},getLayer:function(){return this._layer},clear:function(){this._layer.clear()},hitTest:function(e,t){return this._layer.hitTest(e,t)},adjustExtent:function(){var e=this._layer.getLayerExtent(),t=new r.sfs.Envelope({minx:e[0],miny:e[1],maxx:e[2],maxy:e[3],spatialReference:this.map.spatialReference});this.map.getMap().pan(t,[5,5,5,5])},fullExtent:function(){this.adjustExtent()},destroy:function(){this._layer.clear(),this._layer.destroy(),e.prototype.destroy.call(this)}});return i.DisplayMode=n,i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(2),r(14),r(16),r(57),r(11),r(1)],void 0===(i=function(e,t,r,n,i,o,a){var s={timers:{},timerMethod:{},getTimer:function(e){var t=this;return this.timers[e]||(this.timerMethod[e]={},this.timers[e]=setInterval((function(){t.play(e)}),e)),this.timers.addTimerMothed=function(e,r,n,i,o){if(!t.timerMethod[e])throw new Error("指定的定时器方法不存在！");t.timerMethod[e][r]={fn:n,ctx:o,param:i}},this.timers.deleteTimerMethod=function(e,r){var n=!1;if(!t.timerMethod[e])throw new Error("指定的定时器方法不存在！");return t.timerMethod[e][r]&&(delete t.timerMethod[e][r],n=!0),n},this.timers.timerMethodsIsEmpty=function(e){return!!t.timerMethod&&(!!t.timerMethod[e]&&0==Object.keys(t.timerMethod[e]).length)},this.timers},clearTimer:function(e,t){if(!e[t])throw new Error("指定的定时器不存在！");window.clearInterval(e[t]),delete e[t]},play:function(e){if(Object.keys(this.timerMethod[e]).length>0){var t=this.timerMethod[e];for(var r in t)t[r].fn.call(t[r].ctx,t[r].param,t[r].fn)}}},l=e.extend({options:{},initialize:function(n){e.prototype.initialize.call(this,n);var i=this.map.getMap();this.options.layerId=this.options.layerId||t.newUUID32();var o=r.getLayerById(this.map,this.options.layerId);o||(o=new a.carto.ElementLayer({id:this.options.layerId,map:i}),i.addLayer(o)),this._layer=o,this._timerMap={},this._toolTipWare=new a.widget.TooltipWare({map:i}),this._differenceTimer={}},destroy:function(){for(var t in this._timerMap)this.clear(t);var r=this.map.getMap();this._layer.clear(),r.removeLayer(this._layer),e.prototype.destroy.call(this)}});return l.include({blinkIconMaker:function(e){if(e=e||{},!t.isArray(e.point)||2!=e.point.length)throw new Error("point参数错误！");if(e.process.length<1)throw new Error("process参数错误！");for(var r=this.map.getMap(),n=new a.sfs.Point({x:e.point[0],y:e.point[1],spatialReference:r.spatialReference}),i=e.process,o=isNaN(e.interval)?200:parseFloat(e.interval),s=isNaN(e.cost)?3e3:parseFloat(e.cost),l=[],c=0,u=i.length;c<u;c++){var f=i[c],p=new a.sfs.PictureMarkerSymbol({source:f.source,width:f.width,height:f.height,offsetX:f.width/2,offsetY:f.height/2,opacity:1});l.push(p)}var h=0,d=t.newUUID(),y=new a.sfs.Element({id:d,geometry:n,symbol:l[h]});if(this._layer.add(y),e.tooltip){var m=jQuery.extend(!0,{},e.tooltip),g=m.html||"<div>test</div>";m.id=d,m.offset=m.offset||[10,-10],m.className=m.className||"g2-tooltip",m.layerId=this._layer.getLayerId();var v=new a.widget.Tooltip({id:m.id,anchor:n,content:g,layerId:m.layerId,offset:m.offset,className:m.className});this._toolTipWare.add(v)}var b=this,_=0,w=setInterval((function(){++h>=l.length&&(h%=l.length),y.symbol=l[h],b._layer.update(y,!0),(_+=o)>=s&&b.clear(d)}),o);return this._timerMap[d]=w,d},blinkVectorMarker:function(e){if(e=e||{},!t.isArray(e.point)||2!=e.point.length)throw new Error("参数错误！");var r=this.map.getMap(),i=new a.sfs.Point({x:e.point[0],y:e.point[1],spatialReference:r.spatialReference}),o=e.style||"circle",s=isNaN(e.startSize)?3:parseFloat(e.startSize),l=isNaN(e.endSize)?20:parseFloat(e.endSize),c=isNaN(e.interval)?80:parseFloat(e.interval),u=isNaN(e.cost)?3e3:parseFloat(e.cost),f=l>s?1:-1,p=e.borderColor||{a:100,r:0,g:0,b:250},h=isNaN(e.borderWidth)?1:parseFloat(e.borderWidth),d=e.fillColor||{a:200,r:0,g:0,b:250},y=n.object2Color(p),m=n.object2Color(d),g=new a.sfs.SimpleMarkerSymbol({style:o,fillColor:m,borderColor:y,size:s,borderThickness:h}),v=t.newUUID(),b=new a.sfs.Element({id:v,geometry:i,symbol:g});if(this._layer.add(b),e.tooltip){var _=jQuery.extend(!0,{},e.tooltip),w=_.html||"<div>test</div>";_.id=v,_.offset=_.offset||[10,-10],_.className=_.className||"g2-tooltip",_.layerId=this._layer.getLayerId();var S=new a.widget.Tooltip({id:_.id,anchor:i,content:w,layerId:_.layerId,offset:_.offset,className:_.className});this._toolTipWare.add(S)}var x=this,L=0,P=setInterval((function(){b.symbol;var e=b.symbol.size;e+=f,b.symbol.size=e,x._layer.update(b,!0),(e-s)*(e-l)>=0&&(f*=-1),(L+=c)>=u&&x.clear(v)}),c);return this._timerMap[v]=P,v},rotationIconMaker:function(e){if(e){if(!t.isArray(e.point)||2!=e.point.length||!e.source)throw new Error("参数错误！");isNaN(e.width)||parseFloat(e.width),isNaN(e.height)||parseFloat(e.height);var r=isNaN(e.speed)?200:parseFloat(e.speed),n=360,i=this.map.getMap(),o=new a.sfs.Point({x:e.point[0],y:e.point[1],spatialReference:i.spatialReference}),s=new a.sfs.PictureMarkerSymbol({source:e.source,rotation:n,width:e.width,height:e.height,opacity:1,offsetX:e.width/2,offsetY:e.height/2}),l=t.newUUID(),c=new a.sfs.Element({id:l,geometry:o,symbol:s});if(this._layer.add(c),e.tooltip){var u=jQuery.extend(!0,{},e.tooltip),f=u.html||"<div>test</div>";u.id=l,u.offset=u.offset||[10,-10],u.className=u.className||"g2-tooltip",u.layerId=this._layer.getLayerId();var p=new a.widget.Tooltip({id:u.id,anchor:o,content:f,layerId:u.layerId,offset:u.offset,className:u.className});this._toolTipWare.add(p)}var h=this,d=setInterval((function(){var e=h._layer.find(l);n-=20,e.symbol.rotation=n,h._layer.update(e,!0),0==n&&(n=360)}),r);return this._timerMap[l]=d,l}},iconMoveOnLine:function(e,r,n){if(!(e.pathGeojson&&e.source&&e.width&&e.height))throw new Error("参数错误！");var l=isNaN(e.speed)?2:parseFloat(e.speed),c=isNaN(e.lineStyle)?5:parseFloat(e.lineStyle),u=isNaN(e.lineWidth)?3:parseFloat(e.lineWidth),f=e.lineColor||{a:153,r:0,g:0,b:255},p=isNaN(e.interval)?80:parseFloat(e.interval),h=e.isRotate||!1,d=e.textIsRotate||!1,y=e.isShowLine,m={},g=e.tooltip||!1;null==y&&(y=!0),m="string"==typeof e.pathGeojson?o.getWktReader().read(e.pathGeojson):o.getGeoJSONReader().read(e.pathGeojson);for(var v=o.getGeoJSONWriter().write(m),b=new a.sfs.SimpleLineSymbol({style:c,width:u,color:new a.sfs.Color(f)}),_=new a.sfs.Polyline({spatialReference:this.map.getMap().spatialReference}),w=new a.sfs.Path({spatialReference:this.map.getMap().spatialReference}),S=0;S<v.coordinates.length;S++){var x=new a.sfs.Point({x:v.coordinates[S][0],y:v.coordinates[S][1],spatialReference:this.map.getMap().spatialReference});w.addPoint(x)}if(_.addGeometry(w),0==o.measureLength(_))throw new Error("线起点终点不能重合！");var L=t.newUUID(),P=new a.sfs.Element({id:L,geometry:_,symbol:b});y&&this._layer.add(P);var E=i.getPointOnPath({pathGeometry:v,pathSrid:this.map.getMap().spatialReference,distance:0}),C=t.newUUID(),T=new a.sfs.Point({x:E.point[0],y:E.point[1],spatialReference:this.map.getMap().spatialReference}),A=new a.sfs.PictureMarkerSymbol({source:e.source,width:e.width,height:e.height,offsetX:e.width/2,offsetY:e.height/2,opacity:1}),R=new a.sfs.TextSymbol({text:e.text||"",fontSize:e.size||15,offsetX:e.offsetX||0,offsetY:e.offsetY||-21,foreground:new a.sfs.Color(e.foreground)||new a.sfs.Color({a:255,r:255,g:0,b:0}),borderColor:new a.sfs.Color(e.borderColor)||new a.sfs.Color({a:255,r:255,g:0,b:0}),borderThickness:e.borderThickness||.1,fontFamilyName:e.fontFamilyName,fontWeight:e.fontWeight||1,textAlign:e.textAlign}),M=new a.sfs.CurrencySymbol({markerSymbol:A,textSymbol:R}),k=new a.sfs.Element({id:C,geometry:T,symbol:M});if(h&&(M.markerSymbol.rotation=E.point[2]),d&&(M.textSymbol.rotation=E.point[2]),this._layer.add(k),g){var O=(g=jQuery.extend(!0,{},g)).html||"<div>test</div>";g.id=C,g.offset=g.offset||[10,-10],g.className=g.className||"g2-tooltip",g.layerId=this._layer.getLayerId();var I=new a.widget.Tooltip({id:g.id,anchor:T,content:O,layerId:g.layerId,offset:g.offset,className:g.className});this._toolTipWare.add(I);var F=jQuery("[animateId="+C+"]").eq(0).parent().parent().parent();g.container=F,g.startPoint=T}var N=this,G={geomtry:v,pointId:C,lineId:L,interval:p,step:1,speed:l,rotation:0,tooltip:g,callback:r,context:n},j=s.getTimer(p);return this[L+"draw"]=function(e){var r=i.getPointOnPath({pathGeometry:e.geomtry,pathSrid:N.map.getMap().spatialReference,distance:e.interval*e.step/1e3*e.speed});function n(n){var i,o=N._layer.find(e.pointId);if(t.isEmptyObject(o)){console.log("地图点已被清除");var l=s.getTimer(e.interval);l.deleteTimerMethod(e.interval,e.lineId+"draw");l.timerMethodsIsEmpty(e.interval)&&s.clearTimer(l,p)}else{if(n)i=new a.sfs.Point({x:r.point[0],y:r.point[1],spatialReference:N.map.getMap().spatialReference});else{var c=e.geomtry.coordinates;i=new a.sfs.Point({x:c[c.length-1][0],y:c[c.length-1][1],spatialReference:N.map.getMap().spatialReference})}if(o.geometry=i,r.point&&(e.rotation=r.point[2]),h&&(o.symbol.markerSymbol.rotation=e.rotation),d&&(o.symbol.textSymbol.rotation=e.rotation),N._layer.remove(o),N._layer.add(o),e.tooltip)if(t.isFunction(N._toolTipWare.update)){var u={};u.id=e.tooltip.id,u.anchor=i,N._toolTipWare.update(u)}else{var f=N._toolTipWare.IdContainer[e.tooltip.id];f&&f.setPosition([i.x,i.y])}e.step+=1}}r.arrival?(n(!1),t.isFunction(e.callback)&&e.callback.call(e.context,e.lineId+","+e.pointId,p)):n(!0)},j.addTimerMothed(p,L+"draw",this[L+"draw"],G),L+","+C},lineGradient:function(e){if(!e.pathGeojson)throw new Error("参数错误！");var r=isNaN(e.lineStyle)?5:parseFloat(e.lineStyle),n=isNaN(e.lineWidth)?3:parseFloat(e.lineWidth),l=e.lineColor||{a:153,r:0,g:0,b:255},c=isNaN(e.interval)?50:parseFloat(e.interval),u=isNaN(e.coverPointNum)?4:e.coverPointNum,f={};f="string"==typeof e.pathGeojson?o.getWktReader().read(e.pathGeojson):o.getGeoJSONReader().read(e.pathGeojson);for(var p=o.getGeoJSONWriter().write(f),h=new a.sfs.SimpleLineSymbol({style:r,width:n,color:new a.sfs.Color(l)}),d=new a.sfs.Polyline({spatialReference:this.map.getMap().spatialReference}),y=new a.sfs.Path({spatialReference:this.map.getMap().spatialReference}),m=0;m<p.coordinates.length;m++){var g=new a.sfs.Point({x:p.coordinates[m][0],y:p.coordinates[m][1],spatialReference:this.map.getMap().spatialReference});y.addPoint(g)}d.addGeometry(y);var v=t.newUUID(),b=new a.sfs.Element({id:v,geometry:d,symbol:h});this._layer.add(b);var _=this,w=new a.carto.ElementLayer({id:v,map:this.map.getMap()});this.map.getMap().addLayer(w);var S=s.getTimer(c),x={lineArr:[],step:1,layer:w,geomtry:p,interval:c,coverPointNum:u,speed:1e5,lineId:v,polylineElement:b,_layer:this._layer,lineStyle:r,lineWidth:n};function L(){return"#ff"+Math.floor(180*Math.random()+10)+Math.floor(100*Math.random()+10)}return this[v+"draw"]=function(e){if(e.lineArr.length>0){for(var r=0;r<e.lineArr.length;r++)w.remove(e.lineArr[r]);e.lineArr.length=0}var n=e.interval/1e3*e.step;e.step=e.step+1;for(var o=[],s=!1,l=e.geomtry.coordinates,c=1;c<e.coverPointNum;c++){if(n-(f=e.interval*c/1e3)>=0){var u=i.getPointOnPath({pathGeometry:e.geomtry,pathSrid:_.map.getMap().spatialReference,distance:n*e.speed-f*e.speed});if(u.arrival&&!s){e._layer.find(e.lineId)&&e._layer.remove(e.polylineElement),u.point=[l[l.length-1][0],l[l.length-1][1],0],u.color=a.sfs.Color.fromHex(L()),u.point&&o.push(u),s=!0;continue}u.color=a.sfs.Color.fromHex(L()),u.point&&o.push(u)}}for(var f=o.length-1;f>0;f--)if(o[f-1]){var p=new a.sfs.Polyline({spatialReference:_.map.getMap().spatialReference}),h=new a.sfs.Path({spatialReference:_.map.getMap().spatialReference}),d=new a.sfs.SimpleLineSymbol({style:e.lineStyle,width:e.lineWidth,color:o[f].color}),y=new a.sfs.Point({x:o[f].point[0],y:o[f].point[1],spatialReference:_.map.getMap().spatialReference});if(!o[f-1].point)break;var m=new a.sfs.Point({x:o[f-1].point[0],y:o[f-1].point[1],spatialReference:_.map.getMap().spatialReference});h.addPoint(y),h.addPoint(m),p.addGeometry(h);var g=new a.sfs.Element({id:t.newUUID(),geometry:p,symbol:d});e.lineArr.push(g),e.layer.add(g)}try{o[o.length-1].point[0]==l[l.length-1][0]&&o[o.length-1].point[1]==l[l.length-1][1]&&(e.step=0)}catch(e){}},S.addTimerMothed(c,v+"draw",this[v+"draw"],x),v},loadGifPicture:function(e){if(!e.source||!e.point)throw new Error("参数错误！");var r=t.newUUID(),n=e.offset||[-32,-32],i='<img id="'+r+'" src="'+e.source+'"/>',o=new a.sfs.Point({x:e.point[0],y:e.point[1],spatialReference:this.map.getMap().spatialReference}),s=new a.widget.Tooltip({id:r,anchor:o,content:i,layerId:this._layer.id,offset:n});return this._toolTipWare.add(s),r},updateGifPicture:function(e){if(!e.id||!e.source)throw new Error("参数错误！");$("#"+e.id).attr("src",e.source)},clear:function(e,t){if((e=e.split(",")||[]).length<1)throw new Error("参数错误！");for(var n=0;n<e.length;n++){var i=r.getLayerById(this.map,e[n]);if(i&&this.map.removeLayer(i),t){var o=s.getTimer(t);o.deleteTimerMethod(t,e[n]+"draw");o.timerMethodsIsEmpty(t)&&s.clearTimer(o,t)}try{clearInterval(this._timerMap[e[n]])&&delete this._timerMap[e[n]]}catch(e){}var a=this._layer.find(e[n]);a&&(this._layer.remove(a),this._toolTipWare.remove(e[n]))}}}),l.include({pointFlowOnLine:function(e){if(!e.data)throw new Error("传入参数错误");this.allCanvas||(this.allCanvas={});var t=this._initParam(e,this.map.getMap()),r=this._createBaseCanvas()+","+this._createAnimationCanvas();return this.allCanvas[r]=t,this._drawCanvas(r),this._initMapEvents(r),r},_initParam:function(e,t){var r={};return r.markerRadius=isNaN(e.markerRadius)?2:parseFloat(e.markerRadius),r.markerColor=e.markerColor,r.lineType=e.lineType||"solid",r.lineWidth=isNaN(e.lineWidth)?2:parseFloat(e.lineWidth),r.colors=e.colors||["red","popup","#EDCC72","#E2F194","#94E08A","#4ECDA5","#F8AB60","green"],r.moveRadius=isNaN(e.moveRadius)?3:parseFloat(e.moveRadius),r.fillColor=e.fillColor||["red"],r.shadowBlur=isNaN(e.shadowBlur)?10:parseFloat(e.shadowBlur),r.data=e.data,r.deltaAngle=isNaN(e.deltaAngle)?0:parseFloat(e.deltaAngle),r.interval=isNaN(e.interval)?50:parseFloat(e.interval),this.canvasMap=t,this.mapViewWidth=t.getViewSize()[0],this.mapViewHeight=t.getViewSize()[1],r},_createBaseCanvas:function(){var e=document.createElement("canvas");e.id="canvas-"+t.newUUID(),this[e.id]=e,$(".ol-overlaycontainer-stopevent").prepend(e);var r=e.getContext("2d");return e.style.cssText="pointer-events:none;position:absolute;left:0;top:0;z-index:0;",e.width=this.mapViewWidth,e.height=this.mapViewHeight,e.style.width=e.width+"px",e.style.height=e.height+"px",this._adjustRatio(r),e.id},_createAnimationCanvas:function(){var e=document.createElement("canvas");e.id="canvas-"+t.newUUID(),this[e.id]=e,$(".ol-overlaycontainer-stopevent").prepend(e);var r=e.getContext("2d");return e.style.cssText="pointer-events:none;position:absolute;left:0;top:0;z-index:1;",e.width=this.mapViewWidth,e.height=this.mapViewHeight,e.style.width=e.width+"px",e.style.height=e.height+"px",this._adjustRatio(r),e.id},_adjustRatio:function(e){var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,r=(window.devicePixelRatio||1)/t,n=e.canvas.width,i=e.canvas.height;e.canvas.width=n*r,e.canvas.height=i*r,e.canvas.style.width=n+"px",e.canvas.style.height=i+"px",e.scale(r,r)},_drawCanvas:function(e){var t=this;this._clearCanvasContent(e),setTimeout((function(){t._drawBaseLine(e)}),1),this.allCanvas[e].canvasInterval=setInterval((function(){t._drawAnimationLine(e)}),t.allCanvas[e].interval)},_drawAnimationLine:function(e){var t=this[e.split(",")[1]].getContext("2d");if(t){t.fillStyle="rgba(0,0,0,0.9)";var r=t.globalCompositeOperation;t.globalCompositeOperation="destination-in",t.fillRect(0,0,this.mapViewWidth,this.mapViewHeight),t.globalCompositeOperation=r;for(var n=0;n<this.allCanvas[e].markLines.length;n++){this.allCanvas[e].markLines[n].drawMoveCircle(t,e,n)}}},_drawBaseLine:function(e){var t=this[e.split(",")[0]].getContext("2d");t&&(this._addMarkLine(e),t.clearRect(0,0,this.mapViewWidth,this.mapViewHeight),this.allCanvas[e].markLines.forEach((function(r){r.drawMarker(t,e),r.drawLinePath(t,e)})))},_initMapEvents:function(e){var t=this,r=function(r,n,i,o,a,s,l){t.allCanvas[e].canvasInterval&&t._drawCanvas(e)};t.map.listen("mousedown",(function(e,n,i,o,a,s,l){t.map.listen("mousemove",r)}));t.map.listen("mouseup",(function(e,n,i,o,a,s,l){t.map.off("mousemove",r)}));t.map.listen("resolutionchanged",(function(r,n,i){t.allCanvas[e].canvasInterval&&t._drawCanvas(e)}));t.map.listen("extentchanged",(function(r,n,i,o){t.allCanvas[e].canvasInterval&&t._drawCanvas(e)}))},_addMarkLine:function(e){var t=this;function r(e){this.city=e.city,this.location=e.location,this.color=e.color}function n(e){this.from=e.from,this.to=e.to,this.id=e.id}this.allCanvas[e].markLines=[],this.allCanvas[e].data.forEach((function(i,o){t.allCanvas[e].markLines.push(new n({id:o,from:new r({city:i.from.city,location:new a.sfs.Point({x:i.from.lnglat[0],y:i.from.lnglat[1],spatialReference:t.map.getMap().spatialReference}),color:t.allCanvas[e].colors[o]}),to:new r({city:i.to.city,location:new a.sfs.Point({x:i.to.lnglat[0],y:i.to.lnglat[1],spatialReference:t.map.getMap().spatialReference}),color:t.allCanvas[e].colors[o]})}))})),r.prototype.draw=function(e,r){var n=t.canvasMap.getPixelFromCoordinate([this.location.x,this.location.y]);n&&(e.save(),e.beginPath(),e.fillStyle=this.color||"red",e.arc(n[0],n[1],t.allCanvas[r].markerRadius,0,2*Math.PI,!0),e.closePath(),e.fill(),e.textAlign="center",e.textBaseline="middle",e.font="12px Microsoft YaHei",e.fillStyle=this.color||"red",e.fillText(this.city,n[0],n[1]-10),e.restore())},n.prototype.getPointList=function(e,t,r){var n=[[e[0],e[1]],[t[0],t[1]]],i=n[1][0],o=n[1][1];return n[3]=[i,o],n[1]=this.getOffsetPoint(n[0],n[3],r),n[2]=this.getOffsetPoint(n[3],n[0],r),(n=this.smoothSpline(n,!1))[n.length-1]=[i,o],n},n.prototype.getOffsetPoint=function(e,r,n){var i,o,a,s=this.getDistance(e,r)/3,l=[e[0],e[1]],c=t.allCanvas[n].deltaAngle;if(e[0]!=r[0]&&e[1]!=r[1]){var u=(r[1]-e[1])/(r[0]-e[0]);i=Math.atan(u)}else i=e[0]==r[0]?(e[1]<=r[1]?1:-1)*Math.PI/2:0;return e[0]<=r[0]?(i-=c,o=Math.round(Math.cos(i)*s),a=Math.round(Math.sin(i)*s),l[0]+=o,l[1]+=a):(i+=c,o=Math.round(Math.cos(i)*s),a=Math.round(Math.sin(i)*s),l[0]-=o,l[1]-=a),l},n.prototype.smoothSpline=function(e,t){for(var r=e.length,n=[],i=0,o=1;o<r;o++)i+=this.getDistance(e[o-1],e[o]);var a=i/2;a=a<r?r:a;for(o=0;o<a;o++){var s,l,c,u=o/(a-1)*(t?r:r-1),f=Math.floor(u),p=u-f,h=e[f%r];t?(s=e[(f-1+r)%r],l=e[(f+1)%r],c=e[(f+2)%r]):(s=e[0===f?f:f-1],l=e[f>r-2?r-1:f+1],c=e[f>r-3?r-1:f+2]);var d=p*p,y=p*d;n.push([this.interpolate(s[0],h[0],l[0],c[0],p,d,y),this.interpolate(s[1],h[1],l[1],c[1],p,d,y)])}return n},n.prototype.interpolate=function(e,t,r,n,i,o,a){var s=.5*(r-e),l=.5*(n-t);return(2*(t-r)+s+l)*a+(-3*(t-r)-2*s-l)*o+s*i+t},n.prototype.getDistance=function(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))},n.prototype.drawMarker=function(e,t){this.from.draw(e,t),this.to.draw(e,t)},n.prototype.drawLinePath=function(e,r){var n=t.canvasMap.getPixelFromCoordinate([this.from.location.x,this.from.location.y]),i=t.canvasMap.getPixelFromCoordinate([this.to.location.x,this.to.location.y]);if(n&&i){var o=this.path=this.getPointList(n,i,r),a=o.length;if(e.save(),e.beginPath(),e.lineWidth=t.allCanvas[r].lineWidth,e.strokeStyle=t.allCanvas[r].markerColor||t.allCanvas[r].colors[this.id],e.shadowBlur=t.allCanvas[r].shadowBlur,t.allCanvas[r].lineType&&"solid"!=t.allCanvas[r].lineType){if("dashed"==t.allCanvas[r].lineType||"dotted"==t.allCanvas[r].lineType)for(s=1;s<a;s+=2)e.moveTo(o[s-1][0],o[s-1][1]),e.lineTo(o[s][0],o[s][1])}else{e.moveTo(o[0][0],o[0][1]);for(var s=0;s<a;s++)e.lineTo(o[s][0],o[s][1])}e.stroke(),e.restore(),this.step=0}},n.prototype.drawMoveCircle=function(e,r,n){var i=t.canvasMap.getPixelFromCoordinate([this.from.location.x,this.from.location.y]),o=t.canvasMap.getPixelFromCoordinate([this.to.location.x,this.to.location.y]);if(i&&o){var a=this.path||this.getPointList(i,o,r);e.save(),e.fillStyle=t.allCanvas[r].fillColor[n]||"red",e.shadowColor=t.allCanvas[r].fillColor[n]||"red",e.shadowBlur=t.allCanvas[r].shadowBlur,e.beginPath(),this.step+=1,a[this.step]||(this.step=0),e.arc(a[this.step][0],a[this.step][1],t.allCanvas[r].moveRadius,0,2*Math.PI,!0),e.fill(),e.closePath(),e.restore(),this.step+=1}}},_clearCanvasContent:function(e){clearInterval(this.allCanvas[e].canvasInterval),this.allCanvas[e].canvasInterval=null;var t=e.split(",");this[t[0]].getContext("2d").clearRect(0,0,this.mapViewWidth,this.mapViewHeight),this[t[1]].getContext("2d").clearRect(0,0,this.mapViewWidth,this.mapViewHeight)},clearFlowAnimation:function(e){var r=this;if(e)i(e);else if(!t.isEmptyObject(this.allCanvas))for(var n in this.allCanvas)i(n);function i(e){clearInterval(r.allCanvas[e].canvasInterval),r.allCanvas[e].canvasInterval=null;var t=e.split(",");r[t[0]].remove(),r[t[1]].remove(),delete r.allCanvas[e]}}}),l}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(14),r(2),r(1)],void 0===(i=function(e,t,r,n){var i=e.extend({options:{},initialize:function(i){e.prototype.initialize.call(this,i);var o=this.map.getMap();this.options.selectionLayer=this.options.selectionLayer||r.newUUID32();var a=t.getLayerById(this.map,this.options.selectionLayer);a||(a=new n.carto.ElementLayer({id:this.options.selectionLayer,map:o}),o.addLayer(a)),this._layer=a,this._matchingLayer=this.options.matchingLayer},destroy:function(){this.map.getMap().removeLayer(this._layer),e.prototype.destroy.call(this)}});return i.include({pointMatchingElement:function(){var e=this,t=this._matchingLayer;t.length>0&&this.map.listen("click",(function(r){for(var n=0;n<t.length;n++){var i=t[n].hitTest(r.screenX,r.screenY);if(i){i.layer=t[n];var o=i.element;e.fire("pointMatchingElement",o)}}}))},squareMatchingElement:function(e){var r,n,i,o,a,s=this;this.map.getMap().stopDragPan(),this.map.getMap().stopMouseWheelZoom(),this._mapMousemove=function(e){i=e.mapX,o=e.mapY;e={startX:r,startY:n,endX:i,endY:o};a=s._drawSquare(e)},this._mapMousedown=function(e){r=e.mapX,n=e.mapY,s.map.listen("mousemove",s._mapMousemove)},this._mapMouseup=function(r){s.map.off("mousedown",s._mapMousedown),s.map.off("mousemove",s._mapMousemove),s.map.off("mouseup",s._mapMouseup),s.map.resumeDragPan(),s.map.resumeMouseWheelZoom();var n=t.selectElementOnMap(a.geometry,s._matchingLayer,e);s.fire("squareMatchingElement",n)},this.map.listen("mouseup",this._mapMouseup),this.map.listen("mousedown",this._mapMousedown)},cancelSelection:function(){this.map.off("mousedown",self._mapMousedown),this.map.off("mousemove",self._mapMousemove),this.map.off("mouseup",self._mapMouseup),this.map.resumeDragpan(),this.map.resumeMouseWheelZoom()},clearSelection:function(){this._layer.clear()}}),i.include({_drawSquare:function(e){var t,r=new n.sfs.Point({x:e.startX,y:e.startY,spatialReference:this.map.spatialReference}),i=new n.sfs.Point({x:e.endX,y:e.startY,spatialReference:this.map.spatialReference}),o=new n.sfs.Point({x:e.endX,y:e.endY,spatialReference:this.map.spatialReference}),a=new n.sfs.Point({x:e.startX,y:e.endY,spatialReference:this.map.spatialReference}),s=new n.sfs.SimpleFillSymbol({fillColor:n.sfs.Color.fromHex("#44ffffff"),borderColor:n.sfs.Color.fromHex("#000"),borderThickness:1,style:5}),l=new n.sfs.Ring({spatialReference:this.map.spatialReference}),c=new n.sfs.Polygon({spatialReference:this.map.spatialReference});return l.addPoint(r),l.addPoint(i),l.addPoint(o),l.addPoint(a),l.addPoint(r),c.addGeometry(l),this._layer.find("selectSquare")?((t=this._layer.find("selectSquare")).geometry=c,this._layer.remove(t),this._layer.add(t)):(t=new n.sfs.Element({id:"selectSquare",geometry:c,symbol:s}),this._layer.add(t)),t}}),i}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(9),r(454),r(2),r(16),r(11),r(1)],void 0===(i=function(e,t,r,n,i,o){var a=e.extend({options:{layerId:"measure-layer",showTipLink:!0,symbols:{line:{type:"SimpleFillSymbol",options:{borderColor:{a:120,r:255,g:0,b:0},borderThickness:2,opacity:1}},polygon:{type:"SimpleFillSymbol",options:{borderColor:{a:120,r:255,g:0,b:0},fillColor:{a:50,r:200,g:0,b:0},borderThickness:2,opacity:1}},node:{type:"SimpleMarkerSymbol",options:{style:"circle",borderColor:{a:200,r:200,g:0,b:0},fillColor:{a:250,r:255,g:255,b:255},borderThickness:2,size:4}},delete:{type:"PictureMarkerSymbol",options:{source:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAb0lEQVR42mNYfuABHB28sxOIjtzds+bwQ2RxCGKAUP8ZGPAghFIQHz8Aq0ZSCjEDVQVcCptSuGpkLrpSZGkMbdjciqmOYqXEOoAEbxEMLGBMEhMFQGUMkHjHH7EQNQxfP38AojMPjx6+uxsihAsBAMBJhSJg1b4KAAAAAElFTkSuQmCC",width:14,height:14,opacity:1}}},styleName:["emap-measure-node-tooltip","emap-measure-tooltip"],lengthTipFn:function(e,t){isNaN(t)||(t=(t/1e3).toFixed(2));var r={start:function(){return"起点"},node:function(e){return e+"公里"},end:function(e){return"总长:"+e+"公里"}},n=r[e];if("[object Function]"==Object.prototype.toString.call(n))return r[e](t)},areaTipFn:function(e,t){return"周长:"+(e=(e/1e3).toFixed(2))+"公里 <br/>面积:"+(t=(t/1e6).toFixed(2))+"平方公里"}},initialize:function(t){e.prototype.initialize.call(this,t),this._measuringTool=null,this._measuringObj=null,this._measures={},this._initialize(),this.map.listen("click",this._clickHandler,this)},destroy:function(){this.clear(),this.map.removeLayer(this._drawLayer),this.map.removeLayer(this._measureLayer),this.map.off("click",this._clickHandler),e.prototype.destroy.call(this)}});return a.include({_initialize:function(){var e=this.map.getLayerById(this.options.layerId+"-draw");e||(e=new o.carto.ElementLayer({id:this.options.layerId+"-draw"}),this.map.addLayer(e));var t=this.map.getLayerById(this.options.layerId);t||(t=new o.carto.ElementLayer({id:this.options.layerId}),this.map.addLayer(t)),this._drawLayer=e,this._measureLayer=t,this._toolTipWare=new o.widget.TooltipWare({map:this.map}),this._nodeSymbol=n.object2Symbol(this.options.symbols.node.type,this.options.symbols.node.options),this._deleteSymbol=n.object2Symbol(this.options.symbols.delete.type,this.options.symbols.delete.options),this._createTools()},_clickHandler:function(e){var t=e.screenX,r=e.screenY,n=this._measureLayer.hitTest(t,r);if(n&&"_measure_id"in n.element){var i=this._measures[n.element._measure_id];this._clearMeasure(i)}},_clearMeasuring:function(){this._drawLayer.clear(),this._measuringTool&&delete this._measuringTool._measure_id,this._measuringTool=null,this._measuringObj&&this._clearMeasure(this._measuringObj),this._measuringObj=null,this._ellipseElement=null,delete this._ellipseElement},_clearMeasure:function(e){if(r.isObject(e)){var t=e.element,n=e.nodes,i=e.tooltips,o=e.deleteEle,a=e.linkEle;t&&this._measureLayer.remove(t),o&&this._measureLayer.remove(o),a&&this._measureLayer.remove(a);for(var s=0,l=n.length;s<l;s++)n[s]&&this._measureLayer.remove(n[s]);for(s=0,l=i.length;s<l;s++)this._toolTipWare.remove(i[s].id)}}}),a.include({measureLength:function(){this.cancel(),this._measuringTool=this._lineTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},measureArea:function(){this.cancel(),this._measuringTool=this._polygonTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},measureCircle:function(){this.cancel(),this._measuringTool=this._circleTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},measureEllipse:function(){this.cancel(),this._measuringTool=this._ellipseTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},finish:function(){if(!this._measuringTool)throw new Error("当前无测量！");try{this._measuringTool.onEndDraw()}catch(e){throw new Error("结束异常！error="+e.message)}},cancel:function(){this._noopTool.onClick(),this._clearMeasuring()},clear:function(){this._drawLayer.clear(),this._measureLayer.clear(),this._toolTipWare.clear()}}),t.extend(a,"_measure_id"),a}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(2),r(16),r(11),r(1)],void 0===(i=function(e,t,r,n,i){return{extend:function(e,o){var a="NoopTool";e.include({_createTools:function(){var e=this.options.symbols,t=r.object2Symbol(e.line.type,e.line.options),n=r.object2Symbol(e.polygon.type,e.polygon.options),o={map:this.map,spatialRef:{srid:this.map.spatialReference},tooltipWare:this._toolTipWare},s=new i.sfs.Path({spatialReference:this.map.spatialReference}),l=new i.sfs.Polyline({spatialReference:this.map.spatialReference});l.addGeometry(s),this._polylineTemplate=new i.sfs.Element({geometry:l,symbol:t}),this._lineTool=new i.draw.DrawTool({id:"measureLineTool",cursor:"crosshair",templateElement:this._polylineTemplate.copy(),drawLayer:this._drawLayer}),this._extendLineTool(this._lineTool),this._lineTool.onCreate(o);var c=new i.sfs.Ring({spatialReference:this.map.spatialReference}),u=new i.sfs.Polygon({spatialReference:this.map.spatialReference});u.addGeometry(c),this._polygonTemplate=new i.sfs.Element({geometry:u,symbol:n}),this._polygonTool=new i.draw.DrawTool({id:"measurePolygonTool",cursor:"crosshair",templateElement:this._polygonTemplate.copy(),drawLayer:this._drawLayer}),this._extendPolygonTool(this._polygonTool),this._polygonTool.onCreate(o),this._circleTool=new i.draw.DrawTool({id:"measureCircleTool",cursor:"crosshair",templateElement:this._polygonTemplate.copy(),drawLayer:this._drawLayer}),this._extendCircleTool(this._circleTool),this._circleTool.onCreate(o),this._ellipseTool=new i.draw.DrawTool({id:"measureEllipseTool",cursor:"crosshair",templateElement:this._polygonTemplate.copy(),drawLayer:this._drawLayer}),this._extendEllipseTool(this._ellipseTool),this._ellipseTool.onCreate(o),this._noopTool=new i.interact.NoopTool({id:a,cursor:"pointer"}),this._noopTool.onCreate(o)},_extendLineTool:function(e){var r=this;function n(e,r,n,a,s,l,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:s,y:l,spatialReference:this.map.spatialReference}),h=this._lineTool.drawElement.geometry.paths[0].points.slice(f.points.length);"ontouchend"in document?0===f.points.length?h=h.slice(0,1).concat(h.slice(2)):1===f.points.length&&(h=h.slice(1)):h=h.slice(0,h.length-1);for(var d=0,y=h.length;d<y;d++){p=h[d];var m=this._addNodeEle(u,p,this._nodeSymbol);f.nodes.push(m),f.points.push(p);var g,v,b=this._getStyleName(0),_=this._measureLayer.id;1==f.points.length?g=this.options.lengthTipFn("start"):(v=this._measurePolyline(f.points),g=this.options.lengthTipFn("node",v));var w=new i.widget.Tooltip({id:t.newUUID32(),anchor:p,content:g,layerId:_,offset:[10,0],className:b});f.tooltips.push(w),this._toolTipWare.add(w)}}function a(e){e=e||this._drawLayer.elements[0];var r=this._measuringTool[o],n=this._getMeasuring(r);if(n.points.length<2)throw new Error("距离测量至少两个点！");e.geometry=this._constructGeometry("polyline",n.points);var a=n.tooltips.splice(n.tooltips.length-1,1)[0];this._toolTipWare.remove(a.id);var l=this._measureLayer.id,c=this._getStyleName(1),u=this._measurePolyline(n.points),f=this.options.lengthTipFn("end",u),p=s.call(this,n),h=new i.widget.Tooltip({id:t.newUUID32(),anchor:a.anchor,content:f,layerId:l,offset:[10,p[1]],className:c});n.tooltips.push(h),this._toolTipWare.add(h),this._deleteSymbol.offsetX=p[0],this._deleteSymbol.offsetY=p[1];var d=new i.sfs.Element({geometry:a.anchor,symbol:this._deleteSymbol});d[o]=r,this._measureLayer.add(d),n.deleteEle=d,this._measureLayer.add(e),n.element=e,this._measures[r]=n,this._measuringObj=null,this.cancel()}function s(e){var t=this.options.symbols.delete.options,r=t.width,n=t.height,i=t.offsetX,o=t.offsetY,a=e.points;if(isNaN(i)&&a.length>1){var s=a[a.length-1],l=a[a.length-2];i=s.x>=l.x?-5:r+5}return isNaN(o)&&(o=n/2),[i,o]}e.onMouseUp=function(){n.apply(r,arguments)},e.onEndDraw=function(){a.apply(r,arguments)}},_extendPolygonTool:function(e){var r=this;function n(e,t,r,n,a,s,l){var c=this._measuringTool[o],u=this._getMeasuring(c),f=new i.sfs.Point({x:a,y:s,spatialReference:this.map.spatialReference}),p=this._polygonTool.drawElement.geometry.shell.points;p.length>2&&(f=p[p.length-3]);var h=this._addNodeEle(c,f,this._nodeSymbol);u.nodes.push(h),u.points.push(f)}function a(e){e=e||this._drawLayer.elements[0];var r=this._measuringTool[o],n=this._getMeasuring(r);if(n.points.length<3)throw new Error("多边形测量至少三个点！");e.geometry=this._constructGeometry("polygon",n.points);var a=this._measurePolygon(n.points),s=this._getStyleName(1),l=this._measureLayer.id,c=[0,0],u=this.options.areaTipFn.apply(window,a),f=e.geometry.getBaryCenter(),p=new i.sfs.Point(f),h=new i.widget.Tooltip({id:t.newUUID32(),anchor:p,content:u,layerId:l,offset:c,className:s});n.tooltips.push(h),this._toolTipWare.add(h);c=this._caculateDeleteMarkerOffset(n);this._deleteSymbol.offsetX=c[0],this._deleteSymbol.offsetY=c[1];var d=n.points[n.points.length-1],y=new i.sfs.Element({geometry:d,symbol:this._deleteSymbol});y[o]=r,this._measureLayer.add(y),n.deleteEle=y,this._addLinkEle(n,p,d),this._measureLayer.add(e),n.element=e,this._measures[r]=n,this._measuringObj=null,this.cancel()}e.onMouseUp=function(){n.apply(r,arguments)},e.onEndDraw=function(){a.apply(r,arguments)}},_extendCircleTool:function(e){var t=this;function r(e,t,r,n,a,l,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:a,y:l,spatialReference:this.map.spatialReference});0==f.points.length?f.points.push(p):(s.call(this,f,p),this._onCircleEllipseEndDraw.call(this))}function a(e,t,r,n,a,l,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:a,y:l,spatialReference:this.map.spatialReference});s.call(this,f,p)}function s(e,t){if(e.points.length>0){e.points=e.points.splice(0,1),e.points.push(t);var r=e.points,o=r[0],a=r[1],s=this.map.getPixelFromCoordinate([o.x,o.y]),l=this.map.getPixelFromCoordinate([a.x,a.y]),c=Math.sqrt(Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2));if(0==parseFloat(c).toFixed(6))return;for(var u=n.getCirclePonits({center:s,radius:c,count:128,spatialReference:3857}),f=new i.sfs.Ring,p=0,h=u.length;p<h;p++){var d=u[p],y=this.map.getCoordinateFromPixel(d);f.addPoint(new i.sfs.Point({x:y[0],y:y[1]}))}var m=this._drawLayer.elements[0],g=m.geometry;g.removeAllGeometry(),g.addGeometry(f),this._drawLayer.update(m)}}e.onMouseUp=function(){r.apply(t,arguments)},e.onMouseMove=function(){a.apply(t,arguments)},e.onEndDraw=function(){t._onCircleEllipseEndDraw.apply(t,arguments)}},_extendEllipseTool:function(e){var r=this;function n(e,t,r,n,a,c,u){var f=this._measuringTool[o],p=this._getMeasuring(f),h=new i.sfs.Point({x:a,y:c,spatialReference:this.map.spatialReference});0==p.points.length?(p.points.push(h),this._ellipseElement=s.call(this,{}),this._ellipseElement.plot.addControlPoint(h)):(l.call(this,p,h),this._onCircleEllipseEndDraw.call(this))}function a(e,t,r,n,a,s,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:a,y:s,spatialReference:this.map.spatialReference});l.call(this,f,p)}function s(e){var r=new i.plot.EllipseAlgorithm({}),n=new i.sfs.AttributeSet,o=new i.sfs.PlotElement({id:t.newUUID32(),kind:"ellipseTemplate",algorithm:r,attributeSet:n}),a=new i.sfs.Element({geometry:new i.sfs.Polygon,attributeSet:n});return o.add(a),o.reset(),o}function l(e,t){if(e.points.length>0){e.points=e.points.splice(0,1),e.points.push(t);var r=this._ellipseElement.plot,n=this._ellipseElement.algorithm.createGeometries(r,t)[0],i=this._drawLayer.elements[0];i.geometry=n,this._drawLayer.update(i)}}e.onMouseUp=function(){n.apply(r,arguments)},e.onMouseMove=function(){a.apply(r,arguments)},e.onEndDraw=function(){r._onCircleEllipseEndDraw.apply(r,arguments)}},_constructGeometry:function(e,t){return{polyline:function(e){for(var t=new i.sfs.Path,r=0;r<e.length;r++)t.addPoint(e[r]);var n=new i.sfs.Polyline;return n.addGeometry(t),n},polygon:function(e){for(var t=new i.sfs.Ring,r=0;r<e.length;r++)t.addPoint(e[r]);var n=new i.sfs.Polygon;return n.addGeometry(t),n}}[e](t)},_onCircleEllipseEndDraw:function(e){e=e||this._drawLayer.elements[0];var r=this._measuringTool[o],n=this._getMeasuring(r),a=e.geometry.shell,s=this._measurePolygon(a.points),l=this._getStyleName(1),c=this._measureLayer.id,u=[0,0],f=this.options.areaTipFn.apply(window,s),p=e.geometry.getBaryCenter(),h=new i.sfs.Point(p),d=new i.widget.Tooltip({id:t.newUUID32(),anchor:h,content:f,layerId:c,offset:u,className:l});n.tooltips.push(d),this._toolTipWare.add(d);u=this._caculateDeleteMarkerOffset(n,!0);this._deleteSymbol.offsetX=u[0],this._deleteSymbol.offsetY=u[1];var y=a.points[parseInt(7*(a.points.length-1)/8)],m=new i.sfs.Element({geometry:y,symbol:this._deleteSymbol});m[o]=r,this._measureLayer.add(m),n.deleteEle=m,this._addLinkEle(n,h,y),this._measureLayer.add(e),n.element=e,this._measures[r]=n,this._measuringObj=null,this.cancel()},_caculateDeleteMarkerOffset:function(e,t){var r=this.options.symbols.delete.options,n=r.width,i=r.height,o=r.offsetX,a=r.offsetY,s=e.points;if(isNaN(o)&&s.length>1){var l=s[s.length-1],c=s[s.length-2];o=!0===t||l.x>=c.x?-5:n+5}return isNaN(a)&&(a=i/2),[o,a]},_addNodeEle:function(e,t,r){var n=new i.sfs.Element({geometry:t,symbol:r});return this._measureLayer.add(n),n},_addLinkEle:function(e,t,n){if(!0===this.options.showTipLink){var o=this.options.symbols,a=new i.sfs.Path;a.addPoint(t),a.addPoint(n);var s=new i.sfs.Polyline;s.addGeometry(a);var l=jQuery.extend(!0,{},o.line);if("SimpleFillSymbol"==l.type)l={type:"SimpleLineSymbol",options:{color:l.options.borderColor}};l.options.style=3,l.options.width=2,l.options.color.a=.7*(l.options.color.a||l.options.color.alpha||0);var c=r.geoinfoToElement(s,l);this._measureLayer.add(c),e.linkEle=c}},_getStyleName:function(e){return t.isArray(this.options.styleName)?this.options.styleName[e]:this.options.styleName},_getMeasuring:function(e){return this._measuringObj||(this._measuringObj={element:null,points:[],tooltips:[],nodes:[],deleteEle:null,linkEle:null}),this._measuringObj.id=e,this._measuringObj},_measurePolyline:function(e){for(var t=new i.sfs.Path({spatialReference:this.map.spatialReference}),r=0,o=e.length;r<o;r++)t.addPoint(e[r]);var a=new i.sfs.Polyline({spatialReference:this.map.spatialReference});return a.addGeometry(t),n.measureLength(a)},_measurePolygon:function(e){for(var t=new i.sfs.Ring({spatialReference:this.map.spatialReference}),r=0,o=e.length;r<o;r++)t.addPoint(e[r]);t.addPoint(e[0]);var a=new i.sfs.Polygon({spatialReference:this.map.spatialReference});return a.addGeometry(t),[o=n.measureLength(a),n.measureArea(a)]}})}}}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(18),r(14),r(2),r(11),r(1)],void 0===(i=function(e,t,r,n,i){var o={NoopTool:"NoopTool"},a=i.interact.Tool.extend({initialize:function(e){var t=e||{};i.interact.Tool.call(this,t),this.parent=t.parent,this.onMove=-1,this.currentElement=null,this.center=t.center,this.map=t.map,this.drawLayer=t.drawLayer,this.circleEle=t.circleEle,this.lineEle=t.lineEle,this.picEle=t.picEle,this.textEle=t.textEle,this.geoSearch=t.geoSearch,this.callback=t.callBack,this.query=t.query,this.context=t.context,this.markerSymbol=t.markerSymbol,this.fillSymbol=t.fillSymbol},onMouseUp:function(e,t,r,n,i,o,a){if(this.map.resumeDragPan(),0==this.onMove)this.onMove=-1;else if(this.onMove>0){var s={x:this.center.x,y:this.center.y,radius:this.radius,count:128},l=this.parent._getCircleGeoJson(s);this.callback.call(this.context,l,this.textlength),this.onMove=-1,this.currentElement=null,this.drawLayer.update(this.picEle,!0)}},onMouseDown:function(e,t,r,n,i,o,a){if(this.onMove<0){var s=this.drawLayer.hitTest(r,n);s&&(this.map.stopDragPan(),s&&this.picEle.id==s.element.id&&(this.currentElement=s.element,this.onMove++,this.drawLayer.update(this.picEle,!0)))}},onMouseMove:function(e,t,r,n,o,a,s){if(this.onMove>=0&&this.currentElement){this.currentElement.geometry.x=o,this.currentElement.geometry.y=this.center.y,this.drawLayer.update(this.currentElement);var l=new i.sfs.Polyline({spatialReference:this.map.spatialReference}),c=new i.sfs.Path({spatialReference:this.map.spatialReference}),u=this.center,f=new i.sfs.Point({x:o,y:this.center.y,spatialReference:this.map.spatialReference});c.addPoint(u),c.addPoint(f),l.addGeometry(c),this.lineEle.geometry=l,this.drawLayer.update(this.lineEle),this.radius=Math.abs(u.x-f.x);var p=new i.sfs.CoordinateTransform,h=new i.sfs.MeasureService({projectService:p});this.textlength=h.length(this.lineEle.geometry),this.textEle.symbol.text=Math.round(this.textlength)/1e3+"km",this.drawLayer.update(this.textEle,!0),this.drawLayer.remove(this.circleEle);this.center.x,this.center.y,this.textlength;var d=new i.sfs.Point({x:this.center.x,y:this.center.y,spatialReference:this.map.spatialReference}),y=this.parent._getBufferGeoJson(d,this.textlength),m=i.sfs.GeometryFactory.createGeometryFromGeoJson(y,this.map.spatialReference),g=new i.sfs.Ring({spatialReference:this.map.spatialReference});m.addGeometry(g);var v=this.fillSymbol,b=new i.sfs.Element({geometry:m,symbol:v});this.circleEle=b,this.drawLayer.add(this.circleEle),this.onMove++}},onMouseClick:function(e,t,r,n,i,o,a){}}),s=i.interact.Tool.extend({initialize:function(e){var t=e||{};i.interact.Tool.call(this,t),this.onMove=-1,this.currentElement=null,this.geometry=t.geometry,this.map=t.map,this.drawLayer=t.drawLayer,this.lineEle=t.lineEle,this.picEle=t.picEle,this.bufferEle=t.bufferEle,this.maxPoint=t.maxPoint,this.bufferMaxPoint=t.bufferMaxPoint,this.callback=t.callBack,this.context=t.context,this.parent=t.parent,this.textEle=t.textEle,this.fillSymbol=t.fillsymbol},onMouseUp:function(e,t,r,n,i,o,a){if(this.map.resumeDragPan(),0==this.onMove)this.onMove=-1;else if(this.onMove>0){this.callback.call(this.context,this.bufferGeoJSON,this.textlength),this.onMove=-1,this.currentElement=null,this.drawLayer.update(this.picEle,!0)}},onMouseDown:function(e,t,r,n,i,o,a){if(this.onMove<0){var s=this.drawLayer.hitTest(r,n);s&&(this.map.stopDragPan(),s&&this.picEle.id==s.element.id&&(this.currentElement=s.element,this.onMove++))}},onMouseMove:function(e,t,r,n,o,a,s){if(this.onMove>=0&&this.currentElement){var l=this.maxPoint,c=new i.sfs.Point({x:o,y:a,spatialReference:this.map.spatialReference}),u=new i.sfs.Polyline({spatialReference:this.map.spatialReference}),f=new i.sfs.Path({spatialReference:this.map.spatialReference});f.addPoint(l),f.addPoint(c),u.addGeometry(f),this.lineEle.geometry=u,this.radius=Math.abs(l.x-c.x);var p=new i.sfs.CoordinateTransform,h=new i.sfs.MeasureService({projectService:p});this.textlength=h.length(this.lineEle.geometry),this.drawLayer.remove(this.bufferEle);var d=(new jsts.io.GeoJSONReader).read(this.geometry);d=d.buffer(this.textlength*(360/(2*Math.PI*6378137))),this.bufferGeoJSON=(new jsts.io.GeoJSONWriter).write(d);var y=this.bufferGeoJSON,m=i.sfs.GeometryFactory.createGeometryFromGeoJson(y,this.map.spatialReference),g=new i.sfs.Ring({spatialReference:this.map.spatialReference});m.addGeometry(g);var v=this.fillSymbol;this.bufferEle=new i.sfs.Element({geometry:m,symbol:v}),this.drawLayer.add(this.bufferEle);var b=y.coordinates,_=this.parent._sortFunction(b,y.type),w=new i.sfs.Point({x:_[0][0],y:_[0][1],spatialReference:this.map.spatialReference});this.currentElement.geometry=w,this.drawLayer.update(this.currentElement);var S=new i.sfs.Polyline({spatialReference:this.map.spatialReference}),x=new i.sfs.Path({spatialReference:this.map.spatialReference});x.addPoint(l),x.addPoint(w),S.addGeometry(x),this.lineEle.geometry=S,this.drawLayer.update(this.lineEle);p=new i.sfs.CoordinateTransform,h=new i.sfs.MeasureService({projectService:p});this.textlength=h.length(this.lineEle.geometry),this.drawLayer.remove(this.textEle);var L=Math.round(this.textlength)/1e3+"km",P=new i.sfs.TextSymbol({text:L,foreground:new i.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0});this.textEle=new i.sfs.Element({geometry:S,symbol:P}),this.drawLayer.add(this.textEle),this.onMove++}},onMouseClick:function(e,t,r,n,i,o,a){}}),l=e.extend({options:{name:"缓冲区查询 ",buffer_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAUCAYAAADskT9PAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzdCRTQ5OTYzRkFFMTFFNDk1NTE5ODREMUQwMDhDMzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzdCRTQ5OTczRkFFMTFFNDk1NTE5ODREMUQwMDhDMzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDN0JFNDk5NDNGQUUxMUU0OTU1MTk4NEQxRDAwOEMzMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDN0JFNDk5NTNGQUUxMUU0OTU1MTk4NEQxRDAwOEMzMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpA7b9wAAAPDSURBVHjarFZbTxNREJ7d7ba7lbaAgqBUMETEW9OggCYiYIyKJhp+gA/6B4wPhGhMjET9CaivXggxXogkaqLxQXxofCCKFRSjQohRgZa2WLbXXWfWs02tB2ONk3xJe2Z25pvvzDm7Ql9fH3BMQEigaeWQTu8Cw9iB/0sQ1fA3ZhgGCMIs/gojXiGeg8czzwu1cQrbIJWqhETiOOj6YX9LS+X6hga3Q1Gk0rIyB/ylLcZiqaV4PPN5evr7i5GROYhEhpDUFSQS/qVgngJUXIFkcgsWP9dx4IC/pa2t2m63S8bPrqBoEwQzKT5pvHj27Mvj4eGXuHYKSUwWKkBxKmQyjVj8Uld397amnTurdF2HbDYL/8GE5ra2NStcLnloYKAfotFjSOJLPgHZ3F9NO7m3q2uzv7W1KpPJwH81bGaTz1eRTCS2PLx79yKunKBlkaEU9313jdfb3NrevjaLxal7Hvb1BE0U6yNkUE2cqaqtTU17UIUOi4AdUYkE9qCznDon2XkJ9veO5zX0u98yiuOSwLyU37d9+0qcqSMWAdUkoOt1NXV1nmw6bQYW4uDpt7kCDy5s4MbQumUUz4shdau9XjeGNFsEFEQZMnKqTqecpcErwKGz73OJh/vqgRdjgfyW0XOFftoGUZJErFWC2+CysQFUkIAoCoJAAcYfjpxe5KngxRtIRLbbRS2RUMTcMRTFBF4caYPtVT7unfXmHj56foorrQXyW0bPFfpZfiMWiWjgdoeIAFFMIoHw/Oxs3MDLgyft7TNrc4m7L8xwY2jdMornxZC2USouCNMkhmgWx5sTZHn6XTC4INtswFOBcKu36hdpC2EZxfH8lNeG+SffvAkhgadEgGZgCTEHDsfE2Oior76hwbOmtnYVXhjcWRjsqcwdw2J8OF5gk2UIzc1FR548mQRFGbJOASnwDfEVVDVwb2DgYyQcjuKQmHItd6kUA2qEiqeSyaWbV6++B0m6jA2HiIDU2dlJdTLmIEqSDanqrwMBtaa21rGyosJpsARFg3UtoeSKqkIkFIpc6+9/h1t9HUpK7rDGc++CBGLGvBUd+MYVxfjQ4GB8q9+/rtHnK3N7PKq7tFQ1ONIu+/YRRdDi8eRiNKqNjo8vjAYCnzD3DVT5Ptt2I5+Abg4iwAdEClnGaCiDExMbg2Nj61FHD8L9D6/jRWwmhJM3Bi7XI/xN+SPs5P32QUKLMUZiAbEaGU8h3Oy2lIq5f5iq1FTInK+fX0dLzLfsF5HOgpLsASfCweKEIghYc5VCaAzcK/SHAAMA4XIlf6DGCVoAAAAASUVORK5CYII="},initialize:function(n){e.prototype.initialize.call(this,n);var o=this.map.getMap();this.options.layerId=this.options.layerId||r.newUUID32();var a=t.getLayerById(this.map,this.options.layerId);a||(a=new i.carto.ElementLayer({id:this.options.layerId,map:o}),o.addLayer(a)),this._layer=a},destroy:function(){var t=this.map.getMap();this._layer.clear(),t.removeLayer(this._layer),e.prototype.destroy.call(this)}});return l.include({drawBuffer:function(e){if(this.clearBufferLayer(),r.isEmptyObject(e))throw new Error("传入参数错误！");this.param=e;var t=e.type;this._noopTool(),this.map.off("click",this._getMapPolt()),this.map.off("click",this._getMapClickPoint()),"point"==t&&this.map.listen("click",this._getMapClickPoint()),"polyline"==t&&this._drawPolyline(e),"getGeo"==t&&this.map.listen("click",this._getMapPolt())},circleBuffer:function(e){this.clearBufferLayer();var t,r,n=e.mapX,o=e.mapY,s=e.radius,l=e.context,c=e.callback,u=this._layer;t=0!=e.showDrag||e.showDrag,r=0!=e.showLine||e.showLine;var f=this.map,p=e.symbol||new i.sfs.SimpleFillSymbol,h=new i.sfs.Point({x:n,y:o,spatialReference:f.spatialReference}),d={x:n,y:o,radius:s,angle:90,srs:f.spatialReference},y=this._getCirclePointByAngle(d);if(t){var m=this.options.buffer_img,g=new i.sfs.PictureMarkerSymbol({source:m,width:32,height:20,rotation:"0",opacity:"1",offsetX:"2",offsetY:"5"});this.picEle=new i.sfs.Element({id:"moveMarker",geometry:y,symbol:g}),u.add(this.picEle)}var v=new i.sfs.SimpleLineSymbol({color:new i.sfs.Color({a:153,r:255,g:0,b:0})}),b=new i.sfs.Polyline({spatialReference:f.spatialReference}),_=new i.sfs.Path({spatialReference:f.spatialReference}),w=h,S=y;_.addPoint(w),_.addPoint(S),b.addGeometry(_),this.polylineElement=new i.sfs.Element({geometry:b,symbol:v});var x=new i.sfs.CoordinateTransform,L=new i.sfs.MeasureService({projectService:x}).length(this.polylineElement.geometry),P=Math.round(L)/1e3+"km",E=new i.sfs.TextSymbol({text:P,foreground:new i.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0});this.textEle=new i.sfs.Element({geometry:h,symbol:E}),r&&(u.add(this.polylineElement),u.add(this.textEle));f.spatialReference;var C=new i.sfs.Point({x:n,y:o,spatialReference:f.spatialReference}),T=this._getBufferGeoJson(C,s),A=i.sfs.GeometryFactory.createGeometryFromGeoJson(T,f.spatialReference),R=new i.sfs.Polygon({spatialReference:f.spatialReference});if(A.addGeometry(R),this.circleEle=new i.sfs.Element({geometry:A,symbol:p}),u.add(this.circleEle),t){var M=new a({center:h,parent:this,callBack:c,map:f,drawLayer:u,circleEle:this.circleEle,lineEle:this.polylineElement,picEle:this.picEle,textEle:this.textEle,markerSymbol:g,context:l,fillSymbol:p});M.onCreate({map:f}),M.onClick()}c.call(l,T,s)},geojsonBuffer:function(e){this.clearBufferLayer();var t,r,n=e.geojson,o=new jsts.io.GeoJSONReader,a=e.radius,l=e.callback,c=e.symbol,u=this._layer,f=this.map,p=e.context;t=0!=e.showDrag||e.showDrag,r=0!=e.showLine||e.showLine,"LineString"==n.type&&n.coordinates.length<2&&(n.coordinates=n.coordinates[0]);var h=$.extend(!0,{},n),d=o.read(n),y=this._sortFunction(n.coordinates,n.type),m=new i.sfs.Point({x:y[0][0],y:y[0][1],spatialReference:f.spatialReference});d=d.buffer(a*(360/(2*Math.PI*6378137)));var g=(new jsts.io.GeoJSONWriter).write(d),v=g.coordinates,b=this._sortFunction(v,g.type),_=new i.sfs.Point({x:b[0][0],y:b[0][1],spatialReference:f.spatialReference}),w=new i.sfs.SimpleLineSymbol({color:new i.sfs.Color({a:153,r:255,g:0,b:0})}),S=new i.sfs.Polyline({spatialReference:f.spatialReference}),x=new i.sfs.Path({spatialReference:f.spatialReference});x.addPoint(m),x.addPoint(_),S.addGeometry(x),this.polylineElement=new i.sfs.Element({geometry:S,symbol:w}),r&&u.add(this.polylineElement);var L=Math.round(a)/1e3+"km",P=new i.sfs.TextSymbol({text:L,foreground:new i.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0});this.textEle=new i.sfs.Element({geometry:this.polylineElement.geometry,symbol:P}),u.add(this.textEle);var E=this.options.buffer_img,C=new i.sfs.PictureMarkerSymbol({source:E,width:32,height:20,rotation:"0",opacity:"1",offsetX:"2",offsetY:"5"}),T=new i.sfs.Element({id:"moveMarker",geometry:_,symbol:C});t&&u.add(T);var A=i.sfs.GeometryFactory.createGeometryFromGeoJson(g,f.spatialReference),R=c||new i.sfs.SimpleFillSymbol,M=new i.sfs.Ring({spatialReference:f.spatialReference});A.addGeometry(M);var k=new i.sfs.Element({geometry:A,symbol:R});if(u.add(k),t){var O=new s({maxPoint:m,bufferMaxPoint:_,geometry:h,bufferEle:k,parent:this,callBack:l,map:f,drawLayer:u,lineEle:this.polylineElement,picEle:T,textEle:this.textEle,fillsymbol:c,context:p});O.onCreate({map:f}),O.onClick()}l.call(p,g,a)},clearBufferLayer:function(){this._layer&&this._layer.clear()}}),l.include({_noopTool:function(){var e=new i.gdm.CommandManager,t=new i.gmd.CommandNotify({manager:e}),r=new i.gdm.NoopTool({id:o.NoopTooll,cursor:"pointer"});e.add(r);var n=new i.carto.GraphicSelectionSet;e.onCreate({map:this.map,commandNotify:t,graphicSelectionSet:n,spatialRef:{srid:this.map.spatialReference}}),t.activeCommand(o.NoopTool,null)},_drawPolyline:function(e){var t=this._layer,r=e.callback,n=e.context,o=e.symbol||new i.sfs.SimpleLineSymbol,a=new i.sfs.Path({spatialReference:this.map.spatialReference}),s=new i.sfs.Polyline({spatialReference:this.map.spatialReference});s.addGeometry(a);var l=new i.sfs.Element({geometry:s,symbol:o});this.ploylinePlot=new i.draw.DrawTool({id:"ploylinePlot",templateElement:l,layer:t,drawLayer:t});var c=new i.sfs.CoordinateTransform,u=new i.sfs.MeasureService({projectService:c});this.ploylinePlot.onCreate({map:this.map,spatialRef:this.map.spatialReference,measureService:u}),this.ploylinePlot.onEndDraw=function(e){t.add(e),this.map.currentTool(null);var o=u.length(e.geometry),a=e.geometry.asGeoJson(),s=Math.round(o)/1e3+"km",l=new i.sfs.TextSymbol({text:s,foreground:new i.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0}),c=new i.sfs.Element({geometry:e.geometry,symbol:l});t.add(c),r.call(n,a,o)},this.ploylinePlot.onClick()},_getBufferGeoJson:function(e,t){if(!e||isNaN(t))return null;var r=null,o=e.spatialReference;if(4326==o){var a={center:[e.x,e.y],radius:t,count:128,spatialReference:o};return(s=n.getCirclePonits(a)).push(s[0]),(r={}).coordinates=[s],r.type="Polygon",r}if(3857==o){var s,l=new i.sfs.CoordinateTransform,c=new i.sfs.Point({x:e.x,y:e.y,spatialReference:o}),u=l.transform(c,4326),f=(a={center:[u.x,u.y],radius:t,count:128,spatialReference:4326},{type:"Polygon",coordinates:[s=n.getCirclePonits(a)]}),p=i.sfs.GeometryFactory.createGeometryFromGeoJson(f);p.spatialReference=4326,r=l.transform(p,o).asGeoJson()}return r},_getCirclePointByAngle:function(e){var t=e.x,r=e.y,o=e.radius,a=e.angle,s=e.srs;if("3857"==s){var l=new i.sfs.CoordinateTransform,c=new i.sfs.Point({x:e.x,y:e.y,spatialReference:s}),u=l.transform(c,4326),f={center:[u.x,u.y],radius:o,count:360,spatialReference:4326},p=n.getCirclePonits(f),h={type:"Point",coordinates:[p[a][0],p[a][1]]},d=i.sfs.GeometryFactory.createGeometryFromGeoJson(h);d.spatialReference=4326;var y=l.transform(d,s).asGeoJson();return h=new i.sfs.Point({x:y.coordinates[0],y:y.coordinates[1],spatialReference:s})}o/=6378137,a=a*Math.PI/180;var m=r*Math.PI/180,g=t*Math.PI/180,v=Math.asin(Math.sin(m)*Math.cos(o)+Math.cos(m)*Math.sin(o)*Math.cos(a)),b=g+Math.atan2(Math.sin(a)*Math.sin(o)*Math.cos(m),Math.cos(o)-Math.sin(m)*Math.sin(v));if(!isNaN(v)||!isNaN(b)){var _=180*b/Math.PI,w=180*v/Math.PI;return h=new i.sfs.Point({x:_,y:w,spatialReference:s})}},_getCircleGeoJson:function(e){var t=e.x,r=e.y,n=e.radius,i=e.count,o=[],a={};if("3857"==e.srs){var s={type:"Point"};s.coordinates=[t,r],a=this._getGeoBuffer(s,n)}else{for(var l=0;l<i;l++){var c=360/i;o.push(c*l)}a.type="Polygon";var u=[];n/=6378137;for(var f=0;f<o.length;f++){var p=o[f];p=p*Math.PI/180;var h=r*Math.PI/180,d=t*Math.PI/180,y=Math.asin(Math.sin(h)*Math.cos(n)+Math.cos(h)*Math.sin(n)*Math.cos(p)),m=d+Math.atan2(Math.sin(p)*Math.sin(n)*Math.cos(h),Math.cos(n)-Math.sin(h)*Math.sin(y));if(!isNaN(y)||!isNaN(m)){var g=[],v=180*m/Math.PI,b=180*y/Math.PI;g.push(v),g.push(b),u.unshift(g),f==o.length-1&&u.push(u[0])}}a.coordinates=[u]}return a},_getMapPolt:function(){if(!this._getMapPoltListener){var e=this;this._getMapPoltListener=function(t){for(var r,n=e.param.callback,i=e.options.layerId,o=e.param.map.getLayers(),a=0;a<o.length;a++)o[a].id==i&&(r=o[a]);var s=r.hitTest(t.screenX,t.screenY);s&&(n(s.element.geometry.asGeoJson()),e.map.off("click",e._getMapPolt()))}}return this._getMapPoltListener},_getMapClickPoint:function(){if(!this._mapClickListener){var e=this;this._mapClickListener=function(t){var r=e.param.callback,n=e.param.symbol,o=e._layer,a=new i.sfs.Point({x:t.mapX,y:t.mapY,spatialReference:e.map.spatialReference}),s=n||new i.sfs.MarkerSymbol,l=new i.sfs.Element({geometry:a,symbol:s});o.add(l),e.map.off("click",e._getMapClickPoint()),r(a)}}return this._mapClickListener},_sortFunction:function(e,t){var r=[];if("LineString"==t)(r=e).sort((function(e,t){return e[0]<t[0]?1:-1}));else if("Point"==t)r.push(e);else{for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<i.length;o++)r.push(i[o]);r.sort((function(e,t){return e[0]<t[0]?1:-1}))}return r}}),l}.apply(t,n))||(e.exports=i)},function(e,t,r){var n={SwitchBaseLayer:r(457),BaseLayerProviders:r(177),FeatureHighlight:r(458),FeatureLocate:r(459),PopupManager:r(460),Measure:r(462),FullScreen:r(464),ScreenShot:r(465),MousePosition:r(466),ThematicMap:r(467),LayerManager:r(469)};e.exports=n},function(e,t,r){var n=r(9),i=(r(177),r(2),r(14)),o=r(37),a=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.list=e.layers||[],this.layers=[]},load:function(){for(var e=0;e<this.list.length;e++){var t=this._createBaseLayer(this.list[e]);t.setVisible(!!this.list[e].visible),this.map.addLayer(t),this.layers.push(t)}},destroy:function(){n.prototype.destroy.call(this)},unload:function(){this.clear()},showLayer:function(e,t){if(t)for(var r=0;r<this.layers.length;r++)this.layers[r].setVisible(this.layers[r].id===e);else for(var n=0;n<this.layers.length;n++)if(this.layers[n].id===e){this.layers[n].setVisible(!0);break}},hideLayer:function(e){for(var t=0;t<this.layers.length;t++)if(this.layers[t].id===e){this.layers[t].setVisible(!1);break}},hideAll:function(){for(var e=0;e<this.layers.length;e++)this.layers[e].setVisible(!1)},getLayerById:function(e){},getCurrentLayers:function(){},getLayers:function(){return this.layers},addLayer:function(e){if(this._checkLayerOpts(e)){this.list.push(e);var t=this._createBaseLayer(e);this.map.addLayer(t),this.layers.push(t),this._updateOnChange()}},removeLayer:function(e){var t=this._removeLayerById(e);return null!=t&&this._updateOnChange(),t},clear:function(){for(var e=0;e<this.layers.length;e++)this.map.removeLayer(this.layers[e]);this.layers=[],this.list=[]},_createBaseLayer:function(e){var t=null;if(e=o(!0,{},e),this._handleToken(e),e.layers.length>1){var r=o(!0,{},e);r.type="group",t=i.createBaseLayer(r)}else{var n=o(!0,{},e.layers[0]);n.id=e.id,n.name=e.name,t=i.createBaseLayer(n)}return t},_removeLayerById:function(e){for(var t=null,r=this.list.length-1;r>=0;r--)if(this.list[r].id===e){t=this.list[r],this.list.splice(r,1);var n=this.layers[r];this.map.removeLayer(n),this.layers.splice(r,1);break}return t},_checkLayerOpts:function(e){return!0},_handleToken:function(e){for(var t=0;t<e.layers.length;t++){var r=e.layers[t];r.token&&(r.url=r.url.replace("{token}",r.token))}},_updateOnChange:function(){}});e.exports=a},function(e,t,r){var n=r(9),i=r(16),o=r(2),a=r(1),s=n.extend({options:{},initialize:function(e){if(n.prototype.initialize.call(this,e),e.layer)this.layer=e.layer;else{var t=new a.carto.ElementLayer({id:e.id||"highlightLayer",name:e.name||"highlightLayer",map:e.map,zIndex:e.zIndex||100});this.layer=t}e.blink&&e.blink.interval&&e.blink.duration?(this.interval=e.blink.interval,this.duration=e.blink.duration):(this.interval=200,this.duration=1600)},load:function(){this.map.addLayer(this.layer),this._toolTipWare=new a.widget.TooltipWare({map:this.map})},addHighlight:function(e,t){var r=this;this.removeHighlight(e),o.isArray(t)||(t=[t]),t.forEach((function(t){t&&t.style&&"GifMarkerSymbol"==t.style.type?r._toolstipConstructor(e,t):r._elementConstructor(e,t).forEach((function(n){if(r.layer.add(n),t.blink&&t.blink.interval&&t.blink.interval+""!="0")r._setElementInterval(e,t.blink,n);else{var i={interval:r.interval,duration:r.duration};r._setElementInterval(e,i,n)}}))}))},removeHighlight:function(e){if(this.layer.elements)for(var t=this.layer.elements.length-1;t>-1;t--){var r=this.layer.elements[t];r.id==e&&this.layer.remove(r)}if(this._intervalObj[e])for(var n=0;n<this._intervalObj[e].length;n++)clearInterval(this._intervalObj[e][n]);this._toolTipWare.remove(e),delete this._intervalObj[e]},clearHighlight:function(){this.layer.clear(),this._toolTipWare.clear();var e=this._intervalObj;for(var t in e)if(e.hasOwnProperty(t))for(var r=e[t],n=0;n<r.length;n++){var i=r[n];clearInterval(i)}this._intervalObj={}},unload:function(){this.clearHighlight(),this.map.removeLayer(this.layer)},destroy:function(){n.prototype.destroy.call(this)},_toolstipConstructor:function(e,t){var r=t.style;if(r.options){var n=t.data,i=[-10,-10];r.options.offsetx&&(i[0]=r.options.offsetx),r.options.offsety&&(i[1]=r.options.offsety);var o='<img id="'+e+'" src="'+r.options.source+'"/>',s=new a.widget.Tooltip({id:e,anchor:this._geometryConstructor(n),content:o,layerId:this.layer.getLayerId(),offset:i});this._toolTipWare.add(s)}},_setElementInterval:function(e,t,r){var n=null;t.duration&&(n=parseInt(parseFloat(t.duration)/parseFloat(t.interval)));var i=this.layer;this._intervalObj[e]||(this._intervalObj[e]=[]),this._intervalObj[e].push(this._getIntervalFunc(t.interval,n,r,i))},_getIntervalFunc:function(e,t,r,n){var i=0,o=setInterval((function(){null!=t?i<=t?n.showElement(r,i%2==0):(n.remove(r),clearInterval(o)):n.showElement(r,i%2==0),i++}),e);return o},_intervalObj:{},_elementConstructor:function(e,t){var r=this,n=[];if(t.data)return o.isArray(t.data)||(t.data=[t.data]),t.data.forEach((function(i){var o=new a.sfs.Element({id:e,geometry:r._geometryConstructor(i),symbol:r._symbolConstructor(t.style)});n.push(o)})),n},_geometryConstructor:function(e){var t=new a.sfs.Geometry;return"wkt"==e.type.toLowerCase()?t=a.sfs.GeometryFactory.createGeometryFromWkt(e.geom,this.map.getSrid()):"geojson"==e.type.toLowerCase()&&(t=a.sfs.GeometryFactory.createGeometryFromGeoJson(e.geom,this.map.getSrid())),t},_symbolConstructor:function(e){return i.object2Symbol(e)}});e.exports=s},function(e,t,r){var n=r(9),i=r(2),o=r(1),a=n.extend({options:{padding:[10,10,10,10],minResolution:0,maxZoom:null,duration:{}},initialize:function(e){n.prototype.initialize.call(this,e),this.moveDuration=this.options.duration.move?this.options.duration.move:0,this.zoomDuration=this.options.duration.zoom?this.options.duration.zoom:0},fit:function(e,t){var r=this,n=new o.sfs.Envelope;if(i.isArray(e)){new o.sfs.GeometryCollection;e.forEach((function(e){var t=r._geometryConstructor(e);n.union(t.envelope())}))}else if(i.isObject(e)){var a=this._geometryConstructor(e);n=a.envelope()}var s=this.options.minResolution,l=this.moveDuration,c=this.zoomDuration,u=this.options.maxZoom,f=this.options.padding;if(t&&(u=t.maxZoom?t.maxZoom:this.options.maxZoom,s=t.minResolution?t.minResolution:this.options.minResolution,t.duration&&(l=t.duration.move?t.duration.move:this.moveDuration,c=t.duration.zoom?t.duration.zoom:this.zoomDuration,f=t.padding?t.padding:this.options.padding)),this._isEnvelopePoint(n)){var p=new o.sfs.Point({x:n.minx,y:n.miny});u?this.map.map.getView().animate({center:[p.x,p.y],duration:l},{zoom:u,duration:c}):s&&this.map.map.getView().animate({center:[p.x,p.y],duration:l},{resolution:s,duration:c})}else{var h=[(n.minx+n.maxx)/2,(n.miny+n.maxy)/2],d=[n.minx,n.miny,n.maxx,n.maxy],y=this.map.map.getSize(),m=this.map.map.getView().getResolutionForExtent(d,y);d[0]=d[0]-m*f[0],d[1]=d[1]-m*f[1],d[2]=d[2]+m*f[2],d[3]=d[3]+m*f[3],m=this.map.map.getView().getResolutionForExtent(d,y);this.map.map.getView().animate({center:h,duration:l},{resolution:m,duration:c})}},_isEnvelopePoint:function(e){return e.maxx==e.minx&&e.maxy==e.miny},_geometryConstructor:function(e){var t=new o.sfs.Geometry;return"wkt"==e.type.toLowerCase()?t=o.sfs.GeometryFactory.createGeometryFromWkt(e.geom,this.map.getSrid()):"geojson"==e.type.toLowerCase()&&(t=o.sfs.GeometryFactory.createGeometryFromGeoJson(e.geom,this.map.getSrid())),t},destroy:function(){n.prototype.destroy.call(this)}});e.exports=a},function(e,t,r){r(1);var n=r(9),i=r(2),o=r(461),a=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},destroy:function(){n.prototype.destroy.call(this)},load:function(){n.prototype.load.call(this),this.tooltipWare=new o({map:this.map})},unload:function(){this.clear(),this.tooltipWare=null,n.prototype.unload.call(this)},addSimple:function(e){return e.id=e.id||i.newUUID32(),e.type="simple",this.tooltipWare.addPopup(e)},addLinePopup:function(e){},remove:function(e){this.tooltipWare&&this.tooltipWare.removePopup(e)},clear:function(){this.tooltipWare&&this.tooltipWare.clearPopup()}});e.exports=a},function(e,t,r){var n=r(1),i=function(e){function t(r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,e.call(this,r))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t.prototype.addPopup=function(e){return this["_addPopup_"+e.type].call(this,e)},t.prototype.removePopup=function(e){this.remove(e)},t.prototype.clearPopup=function(){this.clear()},t.prototype._addPopup_simple=function(e){var t=this;return new Promise((function(r,i){var o='<div id="'+e.id+'"></div>',a=new n.widget.Tooltip({id:e.id,anchor:new n.sfs.Point({x:e.anchor[0],y:e.anchor[1]}),content:o,layerId:e.layerId,offset:e.offset||[0,0],className:e.className,autoPan:e.autoPan||!1});t.add(a),r({id:e.id,containerId:e.id})}))},t}(n.widget.TooltipWare);e.exports=i},function(e,t,r){"use strict";var n,i;n=[r(9),r(463),r(2),r(16),r(11),r(1)],void 0===(i=function(e,t,r,n,i,o){var a=e.extend({options:{layerId:"measure-layer",showTipLink:!0,symbols:{line:{type:"SimpleFillSymbol",options:{borderColor:{a:120,r:255,g:0,b:0},borderThickness:2,opacity:1}},polygon:{type:"SimpleFillSymbol",options:{borderColor:{a:120,r:255,g:0,b:0},fillColor:{a:50,r:200,g:0,b:0},borderThickness:2,opacity:1}},node:{type:"SimpleMarkerSymbol",options:{style:"circle",borderColor:{a:200,r:200,g:0,b:0},fillColor:{a:250,r:255,g:255,b:255},borderThickness:2,size:4}},delete:{type:"PictureMarkerSymbol",options:{source:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAIAAACQKrqGAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAb0lEQVR42mNYfuABHB28sxOIjtzds+bwQ2RxCGKAUP8ZGPAghFIQHz8Aq0ZSCjEDVQVcCptSuGpkLrpSZGkMbdjciqmOYqXEOoAEbxEMLGBMEhMFQGUMkHjHH7EQNQxfP38AojMPjx6+uxsihAsBAMBJhSJg1b4KAAAAAElFTkSuQmCC",width:14,height:14,opacity:1}}},styleName:["emap-measure-node-tooltip","emap-measure-tooltip"],lengthTipFn:function(e,t){isNaN(t)||(t=(t/1e3).toFixed(2));var r={start:function(){return"起点"},node:function(e){return e+"公里"},end:function(e){return"总长:"+e+"公里"}},n=r[e];if("[object Function]"==Object.prototype.toString.call(n))return r[e](t)},areaTipFn:function(e,t){return"周长:"+(e=(e/1e3).toFixed(2))+"公里 <br/>面积:"+(t=(t/1e6).toFixed(2))+"平方公里"}},initialize:function(t){e.prototype.initialize.call(this,t),this._measuringTool=null,this._measuringObj=null,this._measures={},this._initialize(),this.map.listen("click",this._clickHandler,this),this.map.listen(G.misc.AppEvents.CLEAR_MAP,this.clear,this)},destroy:function(){this.clear(),this.map.removeLayer(this._drawLayer),this.map.removeLayer(this._measureLayer),this.map.off("click",this._clickHandler),this.map.off(G.misc.AppEvents.CLEAR_MAP,this.clear),e.prototype.destroy.call(this)}});return a.include({_initialize:function(){var e=this.map.getLayerById(this.options.layerId+"-draw");e||(e=new o.carto.ElementLayer({id:this.options.layerId+"-draw"}),this.map.addLayer(e));var t=this.map.getLayerById(this.options.layerId);t||(t=new o.carto.ElementLayer({id:this.options.layerId}),this.map.addLayer(t)),this._drawLayer=e,this._measureLayer=t,this._toolTipWare=new o.widget.TooltipWare({map:this.map}),this._nodeSymbol=n.object2Symbol(this.options.symbols.node.type,this.options.symbols.node.options),this._deleteSymbol=n.object2Symbol(this.options.symbols.delete.type,this.options.symbols.delete.options),this._createTools()},_clickHandler:function(e){var t=e.screenX,r=e.screenY,n=this._measureLayer.hitTest(t,r);if(n&&"_measure_id"in n.element){var i=this._measures[n.element._measure_id];this._clearMeasure(i)}},_clearMeasuring:function(){this._drawLayer.clear(),this._measuringTool&&delete this._measuringTool._measure_id,this._measuringTool=null,this._measuringObj&&this._clearMeasure(this._measuringObj),this._measuringObj=null,this._ellipseElement=null,delete this._ellipseElement},_clearMeasure:function(e){if(r.isObject(e)){var t=e.element,n=e.nodes,i=e.tooltips,o=e.deleteEle,a=e.linkEle;t&&this._measureLayer.remove(t),o&&this._measureLayer.remove(o),a&&this._measureLayer.remove(a);for(var s=0,l=n.length;s<l;s++)n[s]&&this._measureLayer.remove(n[s]);for(s=0,l=i.length;s<l;s++)this._toolTipWare.remove(i[s].id)}}}),a.include({measureLength:function(){this.cancel(),this._measuringTool=this._lineTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},measureArea:function(){this.cancel(),this._measuringTool=this._polygonTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},measureCircle:function(){this.cancel(),this._measuringTool=this._circleTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},measureEllipse:function(){this.cancel(),this._measuringTool=this._ellipseTool,this._measuringTool.onClick(),this._measuringTool._measure_id=r.newUUID32()},finish:function(){if(!this._measuringTool)throw new Error("当前无测量！");try{this._measuringTool.onEndDraw()}catch(e){throw new Error("结束异常！error="+e.message)}},cancel:function(){this._noopTool.onClick(),this._clearMeasuring()},clear:function(){this._drawLayer.clear(),this._measureLayer.clear(),this._toolTipWare.clear()}}),t.extend(a,"_measure_id"),a}.apply(t,n))||(e.exports=i)},function(e,t,r){"use strict";var n,i;n=[r(9),r(2),r(16),r(11),r(1)],void 0===(i=function(e,t,r,n,i){return{extend:function(e,o){var a="NoopTool";e.include({_createTools:function(){var e=this.options.symbols,t=r.object2Symbol(e.line.type,e.line.options),n=r.object2Symbol(e.polygon.type,e.polygon.options),o={map:this.map,spatialRef:{srid:this.map.spatialReference},tooltipWare:this._toolTipWare},s=new i.sfs.Path({spatialReference:this.map.spatialReference}),l=new i.sfs.Polyline({spatialReference:this.map.spatialReference});l.addGeometry(s),this._polylineTemplate=new i.sfs.Element({geometry:l,symbol:t}),this._lineTool=new i.draw.DrawTool({id:"measureLineTool",cursor:"crosshair",templateElement:this._polylineTemplate.copy(),drawLayer:this._drawLayer}),this._extendLineTool(this._lineTool),this._lineTool.onCreate(o);var c=new i.sfs.Ring({spatialReference:this.map.spatialReference}),u=new i.sfs.Polygon({spatialReference:this.map.spatialReference});u.addGeometry(c),this._polygonTemplate=new i.sfs.Element({geometry:u,symbol:n}),this._polygonTool=new i.draw.DrawTool({id:"measurePolygonTool",cursor:"crosshair",templateElement:this._polygonTemplate.copy(),drawLayer:this._drawLayer}),this._extendPolygonTool(this._polygonTool),this._polygonTool.onCreate(o),this._circleTool=new i.draw.DrawTool({id:"measureCircleTool",cursor:"crosshair",templateElement:this._polygonTemplate.copy(),drawLayer:this._drawLayer}),this._extendCircleTool(this._circleTool),this._circleTool.onCreate(o),this._ellipseTool=new i.draw.DrawTool({id:"measureEllipseTool",cursor:"crosshair",templateElement:this._polygonTemplate.copy(),drawLayer:this._drawLayer}),this._extendEllipseTool(this._ellipseTool),this._ellipseTool.onCreate(o),this._noopTool=new i.interact.NoopTool({id:a,cursor:"pointer"}),this._noopTool.onCreate(o)},_extendLineTool:function(e){var r=this;function n(e,r,n,a,s,l,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:s,y:l,spatialReference:this.map.spatialReference}),h=this._lineTool.drawElement.geometry.paths[0].points.slice(f.points.length);"ontouchend"in document?0===f.points.length?h=h.slice(0,1).concat(h.slice(2)):1===f.points.length&&(h=h.slice(1)):h=h.slice(0,h.length-1);for(var d=0,y=h.length;d<y;d++){p=h[d];var m=this._addNodeEle(u,p,this._nodeSymbol);f.nodes.push(m),f.points.push(p);var g,v,b=this._getStyleName(0),_=this._measureLayer.id;1==f.points.length?g=this.options.lengthTipFn("start"):(v=this._measurePolyline(f.points),g=this.options.lengthTipFn("node",v));var w=new i.widget.Tooltip({id:t.newUUID32(),anchor:p,content:g,layerId:_,offset:[10,0],className:b});f.tooltips.push(w),this._toolTipWare.add(w)}}function a(e){e=e||this._drawLayer.elements[0];var r=this._measuringTool[o],n=this._getMeasuring(r);if(n.points.length<2)throw new Error("距离测量至少两个点！");e.geometry=this._constructGeometry("polyline",n.points);var a=n.tooltips.splice(n.tooltips.length-1,1)[0];this._toolTipWare.remove(a.id);var l=this._measureLayer.id,c=this._getStyleName(1),u=this._measurePolyline(n.points),f=this.options.lengthTipFn("end",u),p=s.call(this,n),h=new i.widget.Tooltip({id:t.newUUID32(),anchor:a.anchor,content:f,layerId:l,offset:[10,p[1]],className:c});n.tooltips.push(h),this._toolTipWare.add(h),this._deleteSymbol.offsetX=p[0],this._deleteSymbol.offsetY=p[1];var d=new i.sfs.Element({geometry:a.anchor,symbol:this._deleteSymbol});d[o]=r,this._measureLayer.add(d),n.deleteEle=d,this._measureLayer.add(e),n.element=e,this._measures[r]=n,this._measuringObj=null,this.cancel()}function s(e){var t=this.options.symbols.delete.options,r=t.width,n=t.height,i=t.offsetX,o=t.offsetY,a=e.points;if(isNaN(i)&&a.length>1){var s=a[a.length-1],l=a[a.length-2];i=s.x>=l.x?-5:r+5}return isNaN(o)&&(o=n/2),[i,o]}e.onMouseUp=function(){n.apply(r,arguments)},e.onEndDraw=function(){a.apply(r,arguments)}},_extendPolygonTool:function(e){var r=this;function n(e,t,r,n,a,s,l){var c=this._measuringTool[o],u=this._getMeasuring(c),f=new i.sfs.Point({x:a,y:s,spatialReference:this.map.spatialReference}),p=this._polygonTool.drawElement.geometry.shell.points;p.length>2&&(f=p[p.length-3]);var h=this._addNodeEle(c,f,this._nodeSymbol);u.nodes.push(h),u.points.push(f)}function a(e){e=e||this._drawLayer.elements[0];var r=this._measuringTool[o],n=this._getMeasuring(r);if(n.points.length<3)throw new Error("多边形测量至少三个点！");e.geometry=this._constructGeometry("polygon",n.points);var a=this._measurePolygon(n.points),s=this._getStyleName(1),l=this._measureLayer.id,c=[0,0],u=this.options.areaTipFn.apply(window,a),f=e.geometry.getBaryCenter(),p=new i.sfs.Point(f),h=new i.widget.Tooltip({id:t.newUUID32(),anchor:p,content:u,layerId:l,offset:c,className:s});n.tooltips.push(h),this._toolTipWare.add(h);c=this._caculateDeleteMarkerOffset(n);this._deleteSymbol.offsetX=c[0],this._deleteSymbol.offsetY=c[1];var d=n.points[n.points.length-1],y=new i.sfs.Element({geometry:d,symbol:this._deleteSymbol});y[o]=r,this._measureLayer.add(y),n.deleteEle=y,this._addLinkEle(n,p,d),this._measureLayer.add(e),n.element=e,this._measures[r]=n,this._measuringObj=null,this.cancel()}e.onMouseUp=function(){n.apply(r,arguments)},e.onEndDraw=function(){a.apply(r,arguments)}},_extendCircleTool:function(e){var t=this;function r(e,t,r,n,a,l,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:a,y:l,spatialReference:this.map.spatialReference});0==f.points.length?f.points.push(p):(s.call(this,f,p),this._onCircleEllipseEndDraw.call(this))}function a(e,t,r,n,a,l,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:a,y:l,spatialReference:this.map.spatialReference});s.call(this,f,p)}function s(e,t){if(e.points.length>0){e.points=e.points.splice(0,1),e.points.push(t);var r=e.points,o=r[0],a=r[1],s=this.map.getPixelFromCoordinate([o.x,o.y]),l=this.map.getPixelFromCoordinate([a.x,a.y]),c=Math.sqrt(Math.pow(s[0]-l[0],2)+Math.pow(s[1]-l[1],2));if(0==parseFloat(c).toFixed(6))return;for(var u=n.getCirclePonits({center:s,radius:c,count:128,spatialReference:3857}),f=new i.sfs.Ring,p=0,h=u.length;p<h;p++){var d=u[p],y=this.map.getCoordinateFromPixel(d);f.addPoint(new i.sfs.Point({x:y[0],y:y[1]}))}var m=this._drawLayer.elements[0],g=m.geometry;g.removeAllGeometry(),g.addGeometry(f),this._drawLayer.update(m)}}e.onMouseUp=function(){r.apply(t,arguments)},e.onMouseMove=function(){a.apply(t,arguments)},e.onEndDraw=function(){t._onCircleEllipseEndDraw.apply(t,arguments)}},_extendEllipseTool:function(e){var r=this;function n(e,t,r,n,a,c,u){var f=this._measuringTool[o],p=this._getMeasuring(f),h=new i.sfs.Point({x:a,y:c,spatialReference:this.map.spatialReference});0==p.points.length?(p.points.push(h),this._ellipseElement=s.call(this,{}),this._ellipseElement.plot.addControlPoint(h)):(l.call(this,p,h),this._onCircleEllipseEndDraw.call(this))}function a(e,t,r,n,a,s,c){var u=this._measuringTool[o],f=this._getMeasuring(u),p=new i.sfs.Point({x:a,y:s,spatialReference:this.map.spatialReference});l.call(this,f,p)}function s(e){var r=new i.plot.EllipseAlgorithm({}),n=new i.sfs.AttributeSet,o=new i.sfs.PlotElement({id:t.newUUID32(),kind:"ellipseTemplate",algorithm:r,attributeSet:n}),a=new i.sfs.Element({geometry:new i.sfs.Polygon,attributeSet:n});return o.add(a),o.reset(),o}function l(e,t){if(e.points.length>0){e.points=e.points.splice(0,1),e.points.push(t);var r=this._ellipseElement.plot,n=this._ellipseElement.algorithm.createGeometries(r,t)[0],i=this._drawLayer.elements[0];i.geometry=n,this._drawLayer.update(i)}}e.onMouseUp=function(){n.apply(r,arguments)},e.onMouseMove=function(){a.apply(r,arguments)},e.onEndDraw=function(){r._onCircleEllipseEndDraw.apply(r,arguments)}},_constructGeometry:function(e,t){return{polyline:function(e){for(var t=new i.sfs.Path,r=0;r<e.length;r++)t.addPoint(e[r]);var n=new i.sfs.Polyline;return n.addGeometry(t),n},polygon:function(e){for(var t=new i.sfs.Ring,r=0;r<e.length;r++)t.addPoint(e[r]);var n=new i.sfs.Polygon;return n.addGeometry(t),n}}[e](t)},_onCircleEllipseEndDraw:function(e){e=e||this._drawLayer.elements[0];var r=this._measuringTool[o],n=this._getMeasuring(r),a=e.geometry.shell,s=this._measurePolygon(a.points),l=this._getStyleName(1),c=this._measureLayer.id,u=[0,0],f=this.options.areaTipFn.apply(window,s),p=e.geometry.getBaryCenter(),h=new i.sfs.Point(p),d=new i.widget.Tooltip({id:t.newUUID32(),anchor:h,content:f,layerId:c,offset:u,className:l});n.tooltips.push(d),this._toolTipWare.add(d);u=this._caculateDeleteMarkerOffset(n,!0);this._deleteSymbol.offsetX=u[0],this._deleteSymbol.offsetY=u[1];var y=a.points[parseInt(7*(a.points.length-1)/8)],m=new i.sfs.Element({geometry:y,symbol:this._deleteSymbol});m[o]=r,this._measureLayer.add(m),n.deleteEle=m,this._addLinkEle(n,h,y),this._measureLayer.add(e),n.element=e,this._measures[r]=n,this._measuringObj=null,this.cancel()},_caculateDeleteMarkerOffset:function(e,t){var r=this.options.symbols.delete.options,n=r.width,i=r.height,o=r.offsetX,a=r.offsetY,s=e.points;if(isNaN(o)&&s.length>1){var l=s[s.length-1],c=s[s.length-2];o=!0===t||l.x>=c.x?-5:n+5}return isNaN(a)&&(a=i/2),[o,a]},_addNodeEle:function(e,t,r){var n=new i.sfs.Element({geometry:t,symbol:r});return this._measureLayer.add(n),n},_addLinkEle:function(e,t,n){if(!0===this.options.showTipLink){var o=this.options.symbols,a=new i.sfs.Path;a.addPoint(t),a.addPoint(n);var s=new i.sfs.Polyline;s.addGeometry(a);var l=jQuery.extend(!0,{},o.line);if("SimpleFillSymbol"==l.type)l={type:"SimpleLineSymbol",options:{color:l.options.borderColor}};l.options.style=3,l.options.width=2,l.options.color.a=.7*(l.options.color.a||l.options.color.alpha||0);var c=r.geoinfoToElement(s,l);this._measureLayer.add(c),e.linkEle=c}},_getStyleName:function(e){return t.isArray(this.options.styleName)?this.options.styleName[e]:this.options.styleName},_getMeasuring:function(e){return this._measuringObj||(this._measuringObj={element:null,points:[],tooltips:[],nodes:[],deleteEle:null,linkEle:null}),this._measuringObj.id=e,this._measuringObj},_measurePolyline:function(e){for(var t=new i.sfs.Path({spatialReference:this.map.spatialReference}),r=0,o=e.length;r<o;r++)t.addPoint(e[r]);var a=new i.sfs.Polyline({spatialReference:this.map.spatialReference});return a.addGeometry(t),n.measureLength(a)},_measurePolygon:function(e){for(var t=new i.sfs.Ring({spatialReference:this.map.spatialReference}),r=0,o=e.length;r<o;r++)t.addPoint(e[r]);t.addPoint(e[0]);var a=new i.sfs.Polygon({spatialReference:this.map.spatialReference});return a.addGeometry(t),[o=n.measureLength(a),n.measureArea(a)]}})}}}.apply(t,n))||(e.exports=i)},function(e,t,r){var n=r(9),i=(r(2),n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this._addFullScreenStyle()},load:function(){n.prototype.load.call(this)},unload:function(){n.prototype.unload.call(this)},fullScreen:function(){this._handleFullScreen()},exit:function(){this._handleExit()},destroy:function(){n.prototype.destroy.call(this)},_handleFullScreen:function(){if(this._isFullScreenSupported()){var e,t=this.map;if(t)if(!this._isFullScreen())e=this.options.source?"string"==typeof this.options.source?document.getElementById(this.options.source):this.options.source:document.getElementById(t.options.targetId),this.keys_?this._requestFullScreenWithKeys(e):this._requestFullScreen(e)}},_handleExit:function(){this._isFullScreenSupported()&&(this.map&&this._isFullScreen()&&this._exitFullScreen())},_requestFullScreen:function(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()},_exitFullScreen:function(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()},_isFullScreen:function(){return!!(document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||document.fullscreenElement)},_isFullScreenSupported:function(){var e=document.body;return!!(e.webkitRequestFullscreen||e.mozRequestFullScreen&&document.mozFullScreenEnabled||e.msRequestFullscreen&&document.msFullscreenEnabled||e.requestFullscreen&&document.fullscreenEnabled)},_addFullScreenStyle:function(){var e;e=this.options.source?"string"==typeof this.options.source?this.options.source:this.options.source.id:this.map.options.targetId;var t=document.getElementById("fullscreen_style");t||((t=document.createElement("style")).type="text/css",t.id="fullscreen_style",document.getElementsByTagName("head")[0].appendChild(t));var r="#"+e+":-moz-full-screen {height: 100%;width: 100%;}",n="#"+e+":-webkit-full-screen {height: 100%;width: 100%;}",i="#"+e+":-ms-fullscreen {height: 100%;width: 100%;}",o="#"+e+":fullscreen {height: 100%;width: 100%;}";t.appendChild(document.createTextNode(r)),t.appendChild(document.createTextNode(n)),t.appendChild(document.createTextNode(i)),t.appendChild(document.createTextNode(o))}}));e.exports=i},function(e,t,r){var n=r(9),i=(r(2),n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},getImage:function(e){var t=this;return new Promise((function(r,n){var i=document.getElementById(e||t.map.options.targetId);html2canvas(i,{onrendered:function(e){r(e.toDataURL())},useCORS:!0})}))},downloadImage:function(e,t){var r,n,i=this;return new Promise((r=regeneratorRuntime.mark((function r(n,o){var a,s,l,c,u;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.getImage(e);case 2:a=r.sent,s=(t=t||"screenshot")+".png",window.ActiveXObject||"ActiveXObject"in window?(l=function(e){for(var t=atob(e.split(",")[1]),r=[],n=0;n<t.length;n++)r.push(t.charCodeAt(n));return new Blob([new Uint8Array(r)],{type:"image/png"})}(a),window.navigator.msSaveOrOpenBlob(l,s)):((c=document.createElementNS("http://www.w3.org/1999/xhtml","a")).href=a,c.download=s,(u=document.createEvent("MouseEvents")).initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),c.dispatchEvent(u)),n();case 7:case"end":return r.stop()}}),r,i)})),n=function(){var e=r.apply(this,arguments);return new Promise((function(t,r){return function n(i,o){try{var a=e[i](o),s=a.value}catch(e){return void r(e)}if(!a.done)return Promise.resolve(s).then((function(e){n("next",e)}),(function(e){n("throw",e)}));t(s)}("next")}))},function(e,t){return n.apply(this,arguments)}))},destroy:function(){n.prototype.destroy.call(this)}}));e.exports=i},function(e,t,r){var n=r(9),i=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.options.format=this.options.format?this.options.format:"{x} | {y}",this.options.precision=this.options.precision?this.options.precision:6,this.options.lnglatFormat=this.options.lnglatFormat?this.options.lnglatFormat:"DD",this.dom=document.getElementById(this.options.targetId),this.srid=this.map.spatialReference},load:function(){n.prototype.load.call(this),this.map.listen("mousemove",this._mapListener,this)},unload:function(){this.map.off("mousemove",this._mapListener,this),n.prototype.unload.call(this)},destroy:function(){this.unload(),n.prototype.destroy.call(this)},_mapListener:function(e){var t=this._updateView(e.screenX,e.screenY,e.mapX,e.mapY);this.fire(this.options.eventName,t)},_updateView:function(e,t,r,n){var i=parseFloat(r),o=parseFloat(n),a=0,s=0,l={},c=this;({DD:function(e){var t=c._transform([i,o],c.srid,4326);i=t[0],o=t[1],a=i.toFixed(e.precision),s=o.toFixed(e.precision),l.x=parseFloat(a),l.y=parseFloat(s)},DMS:function(e){var t=c._transform([i,o],c.srid,4326);i=t[0],o=t[1],a=i.toFixed(e.precision),s=o.toFixed(e.precision),l.x=i,l.y=o;var r=parseInt(i),n=60*(i-r),u=parseInt(n).toString(),f=parseInt(60*(n-u)).toString();a=r+"°"+(u.length>1?u:0+u)+"′"+(f.length>1?f:0+f)+"″";var p=parseInt(o),h=60*(o-p),d=parseInt(h).toString(),y=parseInt(60*(h-d)).toString();s=p+"°"+(d.length>1?d:0+d)+"′"+(y.length>1?y:0+y)+"″"},MM:function(e){a=i.toFixed(e.precision),s=o.toFixed(e.precision),l.x=parseFloat(a),l.y=parseFloat(s)}})[this.options.lnglatFormat](this.options),l.xText=a,l.yText=s,"1"==this.options.formatType?i>0&i<180&o>0&o<=90?(a="E "+a,s="N "+s):i>0&i<180&o>=-90&o<0?(a="E "+a,s="S "+s.replace(/-/g,"")):i>-180&i<0&o>-90&o<0?(a="W "+a.replace(/-/g,""),s="S "+s.replace(/-/g,"")):i>-180&i<0&o>0&o<=90&&(a="W "+a.replace(/-/g,""),s="N "+s):"2"==this.options.formatType&&(i>0&i<180&o>0&o<=90?(a+=" E",s+=" N"):i>0&i<180&o>=-90&o<0?(a+=" E",s=s.replace(/-/g,"")+" S"):i>-180&i<0&o>-90&o<0?(a=a.replace(/-/g,"")+" W",s=s.replace(/-/g,"")+" S"):i>-180&i<0&o>0&o<=90&&(a=a.replace(/-/g,"")+" W",s+=" N"));var u=this.options.format;return u=(u=u.replace("{x}",a)).replace("{y}",s),l.text=u,l},_transform:function(e,t,r){var n=new g2.sfs.CoordinateTransform,i=new g2.sfs.Point({x:e[0],y:e[1]});i.setSpatialReference(t);var o=n.transform(i,r);return[o.x,o.y]}});e.exports=i},function(e,t,r){var n=r(9),i=r(468),o=n.extend({options:{scaleMaxWidth:100},initialize:function(e){n.prototype.initialize.call(this,e)},addListeners:function(){this.map.listen("resolutionchanged",this._resolutionchanged,this)},removeListeners:function(){this.map.off("resolutionchanged",this._resolutionchanged)},getMapDom:function(){var e=this.map.options.targetId;return document.getElementById(e)},getScale:function(){return i.getScale(this.map,{scaleMaxWidth:this.options.scaleMaxWidth})},export:function(e){return new Promise((function(e,t){e({})}))},download:function(e){var t=new G.common.ScreenShot({map:this.map});t.downloadImage(e.domId,e.name),t.destroy},updateMapViewSize:function(e,t){var r=this.getMapDom();isNaN(e)||(r.style.width=e+"px"),isNaN(t)||(r.style.height=t+"px"),this.map.updateViewSize()},_resolutionchanged:function(){this._updateScale()},_updateScale:function(){var e=i.getScale(this.map,{scaleMaxWidth:this.options.scaleMaxWidth});e&&this.fire("update-scale",e)},destroy:function(){n.prototype.destroy.call(this)}});e.exports=o},function(e,t){var r={getScale:function(e,t){var r=e.getExtent(),n=r.center().y,i=6378137*Math.PI*Math.cos(n*Math.PI/180)*(r.maxx-r.minx)/180,o=e.getViewSize(),a=t.scaleMaxWidth,s=0;o[0]>0&&(s=i*(a/o[0]));var l=this.getRoundNum(s);return{width:this.getScaleWidth(t.scaleMaxWidth,l/s),scale:l,scaleText:l<1e3?l+" m":l/1e3+" km"}},getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),r=e/t;return t*(r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:1)},getScaleWidth:function(e,t){return Math.round(e*t)-10}};e.exports=r},function(e,t,r){var n=r(9),i=r(14),o=r(44),a=(r(1),n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},load:function(){n.prototype.load.call(this)},addListeners:function(){this.map.listen(o.LAYER_CHANGED,this._onLayerChanged,this)},removeListeners:function(){this.map.off(o.LAYER_CHANGED,this._onLayerChanged)},_onLayerChanged:function(e){var t=this._getList(this._listOptions);this.fire("layer_changed",{list:t})},getLayerList:function(e){var t=this;return this._listOptions=e,new Promise((function(r,n){t._checkLoaded();r(t._getList(e))}))},_getList:function(e){(e=e||{}).filter=e.filter||function(e){return e.name&&e.id};for(var t=[],r=i.defaultGroupLayers,n={},o=0;o<r.length;o++)n[r[o].id]=r[o];for(var a=this.map.getLayers(),s=0;s<a.length;s++){var l=a[s];if(e.filter(l))if(n.hasOwnProperty(l.id))for(var c=l.groupLayers,u=0;u<c.length;u++){var f=c[u];if(e.filter(f)){var p=this._buildLayerInfo(f);t.push(p)}}else{var h=this._buildLayerInfo(l);t.push(h)}}return t},_buildLayerInfo:function(e){var t={};return t.id=e.id,t.name=e.name,t.isBase=i.isBaseLayer(e),t.visible=e.visible,t},setLayerVisible:function(e){this._checkLoaded();var t=i.getLayerById(this.map,e.id);return t?(t.setVisible(!!e.visible),t):null},getLayerInfo:function(e){this._checkLoaded();var t=i.getLayerById(this.map,e);return t?this._buildLayerInfo(t):null},unload:function(){n.prototype.load.call(this)},destroy:function(){n.prototype.destroy.call(this)}}));e.exports=a},function(e,t,r){var n={Buffer:r(471)};e.exports=n},function(e,t,r){var n=r(9),i=(r(14),r(11)),o=r(2),a=r(16),s=r(1),l={NoopTool:"NoopTool"},c=s.interact.Tool.extend({initialize:function(e){var t=e||{};s.interact.Tool.call(this,t),this.onMove=-1,this.currentElement=null,this.geometry=t.geometry,this.map=t.map,this.drawLayer=t.drawLayer,this.lineEle=t.lineEle,this.picEle=t.picEle,this.bufferEle=t.bufferEle,this.maxPoint=t.maxPoint,this.bufferMaxPoint=t.bufferMaxPoint,this.callback=t.callBack,this.context=t.context,this.parent=t.parent,this.textEle=t.textEle,this.fillSymbol=t.fillsymbol,this.textPosition=t.textPosition},onMouseUp:function(e,t,r,n,i,o,a){if(this.map.resumeDragPan(),0==this.onMove)this.onMove=-1;else if(this.onMove>0){this.callback&&this.callback.call(this.context,this.bufferGeoJSON,this.textlength),this.onMove=-1,this.currentElement=null,this.drawLayer.update(this.picEle,!0)}},onMouseDown:function(e,t,r,n,i,o,a){if(this.onMove<0){var s=this.drawLayer.hitTest(r,n);if(s){var l=s.element.geometry;if(!l.x||!l.y)return;this.map.stopDragPan(),s&&this.picEle.id==s.element.id&&(this.currentElement=s.element,this.onMove++)}}},onMouseMove:function(e,t,r,n,o,a,l){if(this.onMove>=0&&this.currentElement){var c=this.maxPoint,u=new s.sfs.Point({x:o,y:a,spatialReference:this.map.spatialReference}),f=new s.sfs.Polyline({spatialReference:this.map.spatialReference}),p=new s.sfs.Path({spatialReference:this.map.spatialReference});p.addPoint(c),p.addPoint(u),f.addGeometry(p),this.lineEle.geometry=f,this.radius=Math.abs(c.x-u.x);var h=(new s.sfs.CoordinateTransform).transform(this.lineEle.geometry,3857),d=i.toJstsGeometry(h);this.textlength=d.getLength(),this.drawLayer.remove(this.bufferEle);var y=function(e,t,r){var n=s.sfs.GeometryFactory.createGeometryFromGeoJson(e,r),i=new s.sfs.CoordinateTransform,o=i.transform(n,3857).asGeoJson(),a=(new jsts.io.GeoJSONReader).read(o);a=a.buffer(t);var l=(new jsts.io.GeoJSONWriter).write(a),c=s.sfs.GeometryFactory.createGeometryFromGeoJson(l,3857);return i.transform(c,r).asGeoJson()}(this.geometry,this.textlength,this.map.spatialReference);this.bufferGeoJSON=y;var m=s.sfs.GeometryFactory.createGeometryFromGeoJson(y,this.map.spatialReference),g=new s.sfs.Ring({spatialReference:this.map.spatialReference});m.addGeometry(g);var v=this.fillSymbol;this.bufferEle=new s.sfs.Element({geometry:m,symbol:v}),this.drawLayer.add(this.bufferEle);var b=y.coordinates,_=this.parent._sortFunction(b,y.type),w=new s.sfs.Point({x:_[0][0],y:_[0][1],spatialReference:this.map.spatialReference});this.currentElement.geometry=w,this.drawLayer.update(this.currentElement);var S=new s.sfs.Polyline({spatialReference:this.map.spatialReference}),x=new s.sfs.Path({spatialReference:this.map.spatialReference});x.addPoint(c),x.addPoint(w),S.addGeometry(x),this.lineEle.geometry=S,this.drawLayer.update(this.lineEle),this.textlength=d.getLength();var L=this.textEle.symbol;L||(L=new s.sfs.TextSymbol({text:P,foreground:new s.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0})),this.drawLayer.remove(this.textEle);var P=Math.round(this.textlength)/1e3+"km";L.text=P;var E=S;if("middle"==this.textPosition)E=S;else if("left"==this.textPosition)E=c;else if("right"==this.textPosition)E=w;this.textEle=new s.sfs.Element({geometry:E,symbol:L}),this.drawLayer.add(this.textEle),this.onMove++}},onMouseClick:function(e,t,r,n,i,o,a){}}),u=s.interact.Tool.extend({initialize:function(e){var t=e||{};s.interact.Tool.call(this,t),this.parent=t.parent,this.onMove=-1,this.currentElement=null,this.center=t.center,this.map=t.map,this.drawLayer=t.drawLayer,this.circleEle=t.circleEle,this.lineEle=t.lineEle,this.picEle=t.picEle,this.textEle=t.textEle,this.geoSearch=t.geoSearch,this.callback=t.callBack,this.query=t.query,this.context=t.context,this.markerSymbol=t.markerSymbol,this.fillSymbol=t.fillSymbol},onMouseUp:function(e,t,r,n,i,o,a){if(this.map.resumeDragPan(),0==this.onMove)this.onMove=-1;else if(this.onMove>0){var s={x:this.center.x,y:this.center.y,radius:this.radius,count:128},l=this.parent._getCircleGeoJson(s);this.callback.call(this.context,l,this.textlength),this.onMove=-1,this.currentElement=null,this.drawLayer.update(this.picEle,!0)}},onMouseDown:function(e,t,r,n,i,o,a){if(this.onMove<0){var s=this.drawLayer.hitTest(r,n);s&&(this.map.stopDragPan(),s&&this.picEle.id==s.element.id&&(this.currentElement=s.element,this.onMove++,this.drawLayer.update(this.picEle,!0)))}},onMouseMove:function(e,t,r,n,i,o,a){if(this.onMove>=0&&this.currentElement){this.currentElement.geometry.x=i,this.currentElement.geometry.y=this.center.y,this.drawLayer.update(this.currentElement);var l=new s.sfs.Polyline({spatialReference:this.map.spatialReference}),c=new s.sfs.Path({spatialReference:this.map.spatialReference}),u=this.center,f=new s.sfs.Point({x:i,y:this.center.y,spatialReference:this.map.spatialReference});c.addPoint(u),c.addPoint(f),l.addGeometry(c),this.lineEle.geometry=l,this.drawLayer.update(this.lineEle),this.radius=Math.abs(u.x-f.x);var p=new s.sfs.CoordinateTransform,h=new s.sfs.MeasureService({projectService:p});this.textlength=h.length(this.lineEle.geometry),this.textEle.symbol.text=Math.round(this.textlength)/1e3+"km",this.drawLayer.update(this.textEle,!0),this.drawLayer.remove(this.circleEle);this.center.x,this.center.y,this.textlength;var d=new s.sfs.Point({x:this.center.x,y:this.center.y,spatialReference:this.map.spatialReference}),y=this.parent._getBufferGeoJson(d,this.textlength),m=s.sfs.GeometryFactory.createGeometryFromGeoJson(y,this.map.spatialReference),g=new s.sfs.Ring({spatialReference:this.map.spatialReference});m.addGeometry(g);var v=this.fillSymbol,b=new s.sfs.Element({geometry:m,symbol:v});this.circleEle=b,this.drawLayer.add(this.circleEle),this.onMove++}},onMouseClick:function(e,t,r,n,i,o,a){}}),f=s.interact.Tool.extend({initialize:function(e){var t=e||{};s.interact.Tool.call(this,t),this.onMove=-1,this.currentElement=null,this.geometry=t.geometry,this.map=t.map,this.drawLayer=t.drawLayer,this.lineEle=t.lineEle,this.picEle=t.picEle,this.bufferEle=t.bufferEle,this.maxPoint=t.maxPoint,this.bufferMaxPoint=t.bufferMaxPoint,this.callback=t.callBack,this.context=t.context,this.parent=t.parent,this.textEle=t.textEle,this.fillSymbol=t.fillsymbol,this.textPosition=t.textPosition},onMouseUp:function(e,t,r,n,i,o,a){if(this.map.resumeDragPan(),0==this.onMove)this.onMove=-1;else if(this.onMove>0){this.callback&&this.callback.call(this.context,this.bufferGeoJSON,this.textlength),this.onMove=-1,this.currentElement=null,this.drawLayer.update(this.picEle,!0)}},onMouseDown:function(e,t,r,n,i,o,a){if(this.onMove<0){var s=this.drawLayer.hitTest(r,n);if(s){var l=s.element.geometry;if(!l.x||!l.y)return;this.map.stopDragPan(),s&&this.picEle.id==s.element.id&&(this.currentElement=s.element,this.onMove++)}}},onMouseMove:function(e,t,r,n,i,o,a){if(this.onMove>=0&&this.currentElement){var l=this.maxPoint,c=new s.sfs.Point({x:i,y:o,spatialReference:this.map.spatialReference}),u=new s.sfs.Polyline({spatialReference:this.map.spatialReference}),f=new s.sfs.Path({spatialReference:this.map.spatialReference});f.addPoint(l),f.addPoint(c),u.addGeometry(f),this.lineEle.geometry=u,this.radius=Math.abs(l.x-c.x);var p=new s.sfs.CoordinateTransform,h=new s.sfs.MeasureService({projectService:p});this.textlength=h.length(this.lineEle.geometry),this.drawLayer.remove(this.bufferEle);var d=(new jsts.io.GeoJSONReader).read(this.geometry);d=d.buffer(this.textlength*(360/(2*Math.PI*6378137))),this.bufferGeoJSON=(new jsts.io.GeoJSONWriter).write(d);var y=this.bufferGeoJSON,m=s.sfs.GeometryFactory.createGeometryFromGeoJson(y,this.map.spatialReference),g=new s.sfs.Ring({spatialReference:this.map.spatialReference});m.addGeometry(g);var v=this.fillSymbol;this.bufferEle=new s.sfs.Element({geometry:m,symbol:v}),this.drawLayer.add(this.bufferEle);var b=y.coordinates,_=this.parent._sortFunction(b,y.type),w=new s.sfs.Point({x:_[0][0],y:_[0][1],spatialReference:this.map.spatialReference});this.currentElement.geometry=w,this.drawLayer.update(this.currentElement);var S=new s.sfs.Polyline({spatialReference:this.map.spatialReference}),x=new s.sfs.Path({spatialReference:this.map.spatialReference});x.addPoint(l),x.addPoint(w),S.addGeometry(x),this.lineEle.geometry=S,this.drawLayer.update(this.lineEle);p=new s.sfs.CoordinateTransform,h=new s.sfs.MeasureService({projectService:p});this.textlength=h.length(this.lineEle.geometry);var L=this.textEle.symbol;L||(L=new s.sfs.TextSymbol({text:P,foreground:new s.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0})),this.drawLayer.remove(this.textEle);var P=Math.round(this.textlength)/1e3+"km";L.text=P;var E=S;if("middle"==this.textPosition)E=S;else if("left"==this.textPosition)E=l;else if("right"==this.textPosition)E=w;this.textEle=new s.sfs.Element({geometry:E,symbol:L}),this.drawLayer.add(this.textEle),this.onMove++}},onMouseClick:function(e,t,r,n,i,o,a){}}),p=n.extend({options:{name:"缓冲区查询 ",buffer_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAUCAYAAADskT9PAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzdCRTQ5OTYzRkFFMTFFNDk1NTE5ODREMUQwMDhDMzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzdCRTQ5OTczRkFFMTFFNDk1NTE5ODREMUQwMDhDMzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDN0JFNDk5NDNGQUUxMUU0OTU1MTk4NEQxRDAwOEMzMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDN0JFNDk5NTNGQUUxMUU0OTU1MTk4NEQxRDAwOEMzMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpA7b9wAAAPDSURBVHjarFZbTxNREJ7d7ba7lbaAgqBUMETEW9OggCYiYIyKJhp+gA/6B4wPhGhMjET9CaivXggxXogkaqLxQXxofCCKFRSjQohRgZa2WLbXXWfWs02tB2ONk3xJe2Z25pvvzDm7Ql9fH3BMQEigaeWQTu8Cw9iB/0sQ1fA3ZhgGCMIs/gojXiGeg8czzwu1cQrbIJWqhETiOOj6YX9LS+X6hga3Q1Gk0rIyB/ylLcZiqaV4PPN5evr7i5GROYhEhpDUFSQS/qVgngJUXIFkcgsWP9dx4IC/pa2t2m63S8bPrqBoEwQzKT5pvHj27Mvj4eGXuHYKSUwWKkBxKmQyjVj8Uld397amnTurdF2HbDYL/8GE5ra2NStcLnloYKAfotFjSOJLPgHZ3F9NO7m3q2uzv7W1KpPJwH81bGaTz1eRTCS2PLx79yKunKBlkaEU9313jdfb3NrevjaLxal7Hvb1BE0U6yNkUE2cqaqtTU17UIUOi4AdUYkE9qCznDon2XkJ9veO5zX0u98yiuOSwLyU37d9+0qcqSMWAdUkoOt1NXV1nmw6bQYW4uDpt7kCDy5s4MbQumUUz4shdau9XjeGNFsEFEQZMnKqTqecpcErwKGz73OJh/vqgRdjgfyW0XOFftoGUZJErFWC2+CysQFUkIAoCoJAAcYfjpxe5KngxRtIRLbbRS2RUMTcMRTFBF4caYPtVT7unfXmHj56foorrQXyW0bPFfpZfiMWiWjgdoeIAFFMIoHw/Oxs3MDLgyft7TNrc4m7L8xwY2jdMornxZC2USouCNMkhmgWx5sTZHn6XTC4INtswFOBcKu36hdpC2EZxfH8lNeG+SffvAkhgadEgGZgCTEHDsfE2Oior76hwbOmtnYVXhjcWRjsqcwdw2J8OF5gk2UIzc1FR548mQRFGbJOASnwDfEVVDVwb2DgYyQcjuKQmHItd6kUA2qEiqeSyaWbV6++B0m6jA2HiIDU2dlJdTLmIEqSDanqrwMBtaa21rGyosJpsARFg3UtoeSKqkIkFIpc6+9/h1t9HUpK7rDGc++CBGLGvBUd+MYVxfjQ4GB8q9+/rtHnK3N7PKq7tFQ1ONIu+/YRRdDi8eRiNKqNjo8vjAYCnzD3DVT5Ptt2I5+Abg4iwAdEClnGaCiDExMbg2Nj61FHD8L9D6/jRWwmhJM3Bi7XI/xN+SPs5P32QUKLMUZiAbEaGU8h3Oy2lIq5f5iq1FTInK+fX0dLzLfsF5HOgpLsASfCweKEIghYc5VCaAzcK/SHAAMA4XIlf6DGCVoAAAAASUVORK5CYII="},initialize:function(e){n.prototype.initialize.call(this,e);var t=this.map.getMap(),r=e.layer;r||(r=new s.carto.ElementLayer({id:e.id||o.newUUID32(),name:e.name,map:t,zIndex:e.zIndex||100})),this._layer=r},load:function(){n.prototype.load.call(this),this.map.addLayer(this._layer)},unload:function(){n.prototype.unload.call(this),this.map.removeLayer(this._layer)},buffer:function(e){this.clearBuffer(),this.bufferconf=e,this._buffer(e)},_buffer:function(e){var t,r,n=this._geometryConstructor2(e.data),i=this._getBufferGeom(n,e.buffer.radius);t=this._getOutmostPoint(n),r=this._getOutmostPoint(i);var o=new s.sfs.Path({spatialReference:this.map.getSrid()});o.addPoint(t),o.addPoint(r);var a=new s.sfs.Polyline({spatialReference:this.map.spatialReference});a.addGeometry(o);var l=this._elementConstructor(a,e.buffer.axis?e.buffer.axis.style:null);l.id=e.buffer.id;var u=this._elementConstructor(i,e.buffer.fill?e.buffer.fill.style:null);u.id=e.buffer.id;var f=this._elementConstructor(r,e.buffer.drag?e.buffer.drag.style:null);f.id=e.buffer.id;var p=a;if(e.buffer.label)if("middle"==e.buffer.label.position)p=a;else if("left"==e.buffer.label.position)p=t;else if("right"==e.buffer.label.position)p=r;var h=this._elementConstructor(p,e.buffer.label?e.buffer.label.style:null);h.id=e.buffer.id;var d=this._getLength(a);if(h.symbol&&(h.symbol.text=Math.round(d)/1e3+"km"),e.buffer.fill&&e.buffer.fill.visible&&this._layer.add(u),e.buffer.axis&&e.buffer.axis.visible&&this._layer.add(l),e.buffer.label&&e.buffer.label.visible&&(h.symbol.source||(h.symbol.source=this.options.buffer_img),this._layer.add(h)),e.buffer.drag&&e.buffer.drag.visible){this._layer.add(f);var y=new c({maxPoint:t,bufferMaxPoint:r,geometry:Object.assign({},n.asGeoJson()),bufferEle:u,parent:this,callBack:e.buffer.callback,map:this.map,drawLayer:this._layer,lineEle:l,picEle:f,textEle:h,textPosition:e.buffer.label?e.buffer.label.position:null,fillsymbol:u.symbol,context:this});y.onCreate({map:this.map}),y.onClick()}e.buffer.callback&&e.buffer.callback.call(this,i.asGeoJson(),e.buffer.radius)},setRadius:function(e){this.bufferconf.buffer.radius=e,this.clearBuffer(),this._buffer(this.bufferconf)},clearBuffer:function(){this._layer&&this._layer.clear()},getBufferGeometry:function(){if(this._layer&&this._layer.elements&&this._layer.elements.length>0)for(var e=this._layer.elements,t=0;t<e.length;t++)if(e[t].geometry.$type.indexOf("Polygon")>-1)return e[t].geometry},destroy:function(){var e=this.map.getMap();this._layer.clear(),e.removeLayer(this._layer),n.prototype.destroy.call(this)},_getLength:function(e){var t=(new s.sfs.CoordinateTransform).transform(e,3857);return i.toJstsGeometry(t).getLength()},_getOutmostPoint:function(e){var t=e.asGeoJson(),r=t.coordinates,n=this._sortFunction(r,t.type);return new s.sfs.Point({x:n[0][0],y:n[0][1],spatialReference:this.map.getSrid()})},_getBufferGeom:function(e,t){var r=new s.sfs.CoordinateTransform,n=r.transform(e,3857).asGeoJson(),i=(new jsts.io.GeoJSONReader).read(n);i=i.buffer(t);var o=(new jsts.io.GeoJSONWriter).write(i),a=s.sfs.GeometryFactory.createGeometryFromGeoJson(o,3857);return r.transform(a,this.map.getSrid())},_elementConstructor:function(e,t){var r=new s.sfs.Element({geometry:e});return t&&(r.symbol=this._symbolConstructor(t)),r},_geojsonConstructor:function(e){var t,r=new jsts.io.GeoJSONReader,n=new jsts.io.WKTReader;return"wkt"==e.type.toLowerCase()?t=n.read(geo):"geojson"==e.type.toLowerCase()&&(t=r.read(geo)),(new jsts.io.GeoJSONWriter).write(t)},_geometryConstructor:function(e){var t=new s.sfs.Geometry;return"wkt"==e.type.toLowerCase()?t=s.sfs.GeometryFactory.createGeometryFromWkt(e.geom,this.map.getSrid()):"geojson"==e.type.toLowerCase()&&(t=s.sfs.GeometryFactory.createGeometryFromGeoJson(e.geom,this.map.getSrid())),t},_geometryConstructor2:function(e){var t;"wkt"==e.type.toLowerCase()?t=i.getWktReader().read(e.geom):"geojson"==e.type.toLowerCase()&&(t=i.getGeoJSONReader().read(e.geom)),t=t.buffer(1e-5);var r=(new jsts.io.GeoJSONWriter).write(t);return s.sfs.GeometryFactory.createGeometryFromGeoJson(r,this.map.getSrid())},_symbolConstructor:function(e){return a.object2Symbol(e)}});p.include({drawBuffer:function(e){if(this.clearBufferLayer(),o.isEmptyObject(e))throw new Error("传入参数错误！");this.param=e;var t=e.type;this._noopTool(),this.map.off("click",this._getMapPolt()),this.map.off("click",this._getMapClickPoint()),"point"==t&&this.map.listen("click",this._getMapClickPoint()),"polyline"==t&&this._drawPolyline(e),"getGeo"==t&&this.map.listen("click",this._getMapPolt())},circleBuffer:function(e){this.clearBufferLayer();var t,r,n=e.mapX,i=e.mapY,o=e.radius,a=e.context,l=e.callback,c=this._layer;t=0!=e.showDrag||e.showDrag,r=0!=e.showLine||e.showLine;var f=this.map,p=e.symbol||new s.sfs.SimpleFillSymbol,h=new s.sfs.Point({x:n,y:i,spatialReference:f.spatialReference}),d={x:n,y:i,radius:o,angle:90,srs:f.spatialReference},y=this._getCirclePointByAngle(d);if(t){var m=this.options.buffer_img,g=new s.sfs.PictureMarkerSymbol({source:m,width:32,height:20,rotation:"0",opacity:"1",offsetX:"2",offsetY:"10"});this.picEle=new s.sfs.Element({id:"moveMarker",geometry:y,symbol:g}),c.add(this.picEle)}var v=new s.sfs.SimpleLineSymbol({color:new s.sfs.Color({a:153,r:255,g:0,b:0})}),b=new s.sfs.Polyline({spatialReference:f.spatialReference}),_=new s.sfs.Path({spatialReference:f.spatialReference}),w=h,S=y;_.addPoint(w),_.addPoint(S),b.addGeometry(_),this.polylineElement=new s.sfs.Element({geometry:b,symbol:v});var x=new s.sfs.CoordinateTransform,L=new s.sfs.MeasureService({projectService:x}).length(this.polylineElement.geometry),P=Math.round(L)/1e3+"km",E=new s.sfs.TextSymbol({text:P,foreground:new s.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0});this.textEle=new s.sfs.Element({geometry:h,symbol:E}),r&&(c.add(this.polylineElement),c.add(this.textEle));f.spatialReference;var C=new s.sfs.Point({x:n,y:i,spatialReference:f.spatialReference}),T=this._getBufferGeoJson(C,o),A=s.sfs.GeometryFactory.createGeometryFromGeoJson(T,f.spatialReference),R=new s.sfs.Polygon({spatialReference:f.spatialReference});if(A.addGeometry(R),this.circleEle=new s.sfs.Element({geometry:A,symbol:p}),c.add(this.circleEle),t){var M=new u({center:h,parent:this,callBack:l,map:f,drawLayer:c,circleEle:this.circleEle,lineEle:this.polylineElement,picEle:this.picEle,textEle:this.textEle,markerSymbol:g,context:a,fillSymbol:p});M.onCreate({map:f}),M.onClick()}l&&l.call(a,T,o)},geojsonBuffer:function(e){this.clearBufferLayer();var t,r,n=e.geojson,i=new jsts.io.GeoJSONReader,o=e.radius,a=e.callback,l=e.symbol,c=this._layer,u=this.map,p=e.context;t=0!=e.showDrag||e.showDrag,r=0!=e.showLine||e.showLine,"LineString"==n.type&&n.coordinates.length<2&&(n.coordinates=n.coordinates[0]);var h=$.extend(!0,{},n),d=i.read(n),y=this._sortFunction(n.coordinates,n.type),m=new s.sfs.Point({x:y[0][0],y:y[0][1],spatialReference:u.spatialReference});d=d.buffer(o*(360/(2*Math.PI*6378137)));var g=(new jsts.io.GeoJSONWriter).write(d),v=g.coordinates,b=this._sortFunction(v,g.type),_=new s.sfs.Point({x:b[0][0],y:b[0][1],spatialReference:u.spatialReference}),w=new s.sfs.SimpleLineSymbol({color:new s.sfs.Color({a:153,r:255,g:0,b:0})}),S=new s.sfs.Polyline({spatialReference:u.spatialReference}),x=new s.sfs.Path({spatialReference:u.spatialReference});x.addPoint(m),x.addPoint(_),S.addGeometry(x),this.polylineElement=new s.sfs.Element({geometry:S,symbol:w}),r&&c.add(this.polylineElement);var L=Math.round(o)/1e3+"km",P=new s.sfs.TextSymbol({text:L,foreground:new s.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0});this.textEle=new s.sfs.Element({geometry:this.polylineElement.geometry,symbol:P}),c.add(this.textEle);var E=this.options.buffer_img,C=new s.sfs.PictureMarkerSymbol({source:E,width:32,height:20,rotation:"0",opacity:"1",offsetX:"2",offsetY:"5"}),T=new s.sfs.Element({id:"moveMarker",geometry:_,symbol:C});t&&c.add(T);var A=s.sfs.GeometryFactory.createGeometryFromGeoJson(g,u.spatialReference),R=l||new s.sfs.SimpleFillSymbol,M=new s.sfs.Ring({spatialReference:u.spatialReference});A.addGeometry(M);var k=new s.sfs.Element({geometry:A,symbol:R});if(c.add(k),t){var O=new f({maxPoint:m,bufferMaxPoint:_,geometry:h,bufferEle:k,parent:this,callBack:a,map:u,drawLayer:c,lineEle:this.polylineElement,picEle:T,textEle:this.textEle,fillsymbol:l,context:p});O.onCreate({map:u}),O.onClick()}a&&a.call(p,g,o)},clearBufferLayer:function(){this._layer&&this._layer.clear()}}),p.include({_noopTool:function(){var e=new s.gdm.CommandManager,t=new s.gmd.CommandNotify({manager:e}),r=new s.gdm.NoopTool({id:l.NoopTooll,cursor:"pointer"});e.add(r);var n=new s.carto.GraphicSelectionSet;e.onCreate({map:this.map,commandNotify:t,graphicSelectionSet:n,spatialRef:{srid:this.map.spatialReference}}),t.activeCommand(l.NoopTool,null)},_drawPolyline:function(e){var t=this._layer,r=e.callback,n=e.context,i=e.symbol||new s.sfs.SimpleLineSymbol,o=new s.sfs.Path({spatialReference:this.map.spatialReference}),a=new s.sfs.Polyline({spatialReference:this.map.spatialReference});a.addGeometry(o);var l=new s.sfs.Element({geometry:a,symbol:i});this.ploylinePlot=new s.draw.DrawTool({id:"ploylinePlot",templateElement:l,layer:t,drawLayer:t});var c=new s.sfs.CoordinateTransform,u=new s.sfs.MeasureService({projectService:c});this.ploylinePlot.onCreate({map:this.map,spatialRef:this.map.spatialReference,measureService:u}),this.ploylinePlot.onEndDraw=function(e){t.add(e),this.map.currentTool(null);var i=u.length(e.geometry),o=e.geometry.asGeoJson(),a=Math.round(i)/1e3+"km",l=new s.sfs.TextSymbol({text:a,foreground:new s.sfs.Color({r:255,g:0,b:0,a:255}),offsetX:10,offsetY:-13,rotation:0}),c=new s.sfs.Element({geometry:e.geometry,symbol:l});t.add(c),r&&r.call(n,o,i)},this.ploylinePlot.onClick()},_getBufferGeoJson:function(e,t){if(!e||isNaN(t))return null;var r=null,n=e.spatialReference;if(4326==n){var o={center:[e.x,e.y],radius:t,count:128,spatialReference:n};return(a=i.getCirclePonits(o)).push(a[0]),(r={}).coordinates=[a],r.type="Polygon",r}if(3857==n){var a,l=new s.sfs.CoordinateTransform,c=new s.sfs.Point({x:e.x,y:e.y,spatialReference:n}),u=l.transform(c,4326),f=(o={center:[u.x,u.y],radius:t,count:128,spatialReference:4326},{type:"Polygon",coordinates:[a=i.getCirclePonits(o)]}),p=s.sfs.GeometryFactory.createGeometryFromGeoJson(f);p.spatialReference=4326,r=l.transform(p,n).asGeoJson()}return r},_getCirclePointByAngle:function(e){var t=e.x,r=e.y,n=e.radius,o=e.angle,a=e.srs;if("3857"==a){var l=new s.sfs.CoordinateTransform,c=new s.sfs.Point({x:e.x,y:e.y,spatialReference:a}),u=l.transform(c,4326),f={center:[u.x,u.y],radius:n,count:360,spatialReference:4326},p=i.getCirclePonits(f),h={type:"Point",coordinates:[p[o][0],p[o][1]]},d=s.sfs.GeometryFactory.createGeometryFromGeoJson(h);d.spatialReference=4326;var y=l.transform(d,a).asGeoJson();return h=new s.sfs.Point({x:y.coordinates[0],y:y.coordinates[1],spatialReference:a})}n/=6378137,o=o*Math.PI/180;var m=r*Math.PI/180,g=t*Math.PI/180,v=Math.asin(Math.sin(m)*Math.cos(n)+Math.cos(m)*Math.sin(n)*Math.cos(o)),b=g+Math.atan2(Math.sin(o)*Math.sin(n)*Math.cos(m),Math.cos(n)-Math.sin(m)*Math.sin(v));if(!isNaN(v)||!isNaN(b)){var _=180*b/Math.PI,w=180*v/Math.PI;return h=new s.sfs.Point({x:_,y:w,spatialReference:a})}},_getCircleGeoJson:function(e){var t=e.x,r=e.y,n=e.radius,i=e.count,o=[],a={};if("3857"==e.srs){var s={type:"Point"};s.coordinates=[t,r],a=this._getGeoBuffer(s,n)}else{for(var l=0;l<i;l++){var c=360/i;o.push(c*l)}a.type="Polygon";var u=[];n/=6378137;for(var f=0;f<o.length;f++){var p=o[f];p=p*Math.PI/180;var h=r*Math.PI/180,d=t*Math.PI/180,y=Math.asin(Math.sin(h)*Math.cos(n)+Math.cos(h)*Math.sin(n)*Math.cos(p)),m=d+Math.atan2(Math.sin(p)*Math.sin(n)*Math.cos(h),Math.cos(n)-Math.sin(h)*Math.sin(y));if(!isNaN(y)||!isNaN(m)){var g=[],v=180*m/Math.PI,b=180*y/Math.PI;g.push(v),g.push(b),u.unshift(g),f==o.length-1&&u.push(u[0])}}a.coordinates=[u]}return a},_getMapPolt:function(){if(!this._getMapPoltListener){var e=this;this._getMapPoltListener=function(t){for(var r,n=e.param.callback,i=e.options.layerId,o=e.param.map.getLayers(),a=0;a<o.length;a++)o[a].id==i&&(r=o[a]);var s=r.hitTest(t.screenX,t.screenY);s&&(n(s.element.geometry.asGeoJson()),e.map.off("click",e._getMapPolt()))}}return this._getMapPoltListener},_getMapClickPoint:function(){if(!this._mapClickListener){var e=this;this._mapClickListener=function(t){var r=e.param.callback,n=e.param.symbol,i=e._layer,o=new s.sfs.Point({x:t.mapX,y:t.mapY,spatialReference:e.map.spatialReference}),a=n||new s.sfs.MarkerSymbol,l=new s.sfs.Element({geometry:o,symbol:a});i.add(l),e.map.off("click",e._getMapClickPoint()),r(o)}}return this._mapClickListener},_sortFunction:function(e,t){var r=[];if("LineString"==t)(r=e).sort((function(e,t){return e[0]<t[0]?1:-1}));else if("Point"==t)r.push(e);else{for(var n=0;n<e.length;n++)for(var i=e[n],o=0;o<i.length;o++)r.push(i[o]);r.sort((function(e,t){return e[0]<t[0]?1:-1}))}return r}}),e.exports=p},function(e,t,r){var n={RenderMgr:r(123),SimpleRenderMgr:r(473),StatisticsRenderMgr:r(478)};e.exports=n},function(e,t,r){var n=r(123),i=(r(36),r(474)),o=r(475),a=r(476),s=r(477),l=r(169),c=r(168),u=r(122),f=r(1),p=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this._last_mouse_over=null},addListeners:function(){this.map.listen("click",this._clickHandler,this),this.map.listen("mousemove",this._mouseMoveHandler,this)},removeListeners:function(){this.map.off("click",this._clickHandler,this),this.map.off("mousemove",this._mouseMoveHandler,this)},add:function(e){this._checkLoaded(),this.remove(e.featureType);var t=this._getFeatureType(e.featureType)||{},r=this._getRendererClazz(e.type),n=e.geometryBuilder||new l({}),i=e.symbolBuilder||new c({}),o=new u({idField:e.idField,geometryBuilder:n,symbolBuilder:i}),a=t.renderer||new r({id:e.featureType,name:e.featureName,map:this.map,idField:e.idField,geometryType:n.getGeometryType(),featureBuilder:o,layer:e.layer||null,eventDispatcher:this.eventDispatcher});a.add(e.list),t.featureType=e.featureType,t.featureName=e.featureName,t.idField=e.idField,t.geometryBuilder=e.geometryBuilder,t.symbolBuilder=e.symbolBuilder,t.renderer=a,t.listeners=e.listeners||{},this.featureTypeList.push(t)},_getRendererClazz:function(e){return{0:i,1:o,2:a,3:s}[e=e||0]||null},update:function(e){this._checkLoaded();var t=this._getFeatureType(e.featureType);t&&t.renderer.update(e.list)},getLayer:function(e){var t=this._getFeatureType(e);if(t)return t.renderer.getLayer()},getExtent:function(e){var t=this._getFeatureType(e);if(t)return t.renderer.getExtent()},_clickHandler:function(e){if(this.listens("click")||this.listens("noclick")){var t=this._hitTest(e.screenX,e.screenY);t.length>0?(this._invokeFeatureListeners("click",t),this.fire("click",{list:t})):(this._invokeFeatureListeners("noclick"),this.fire("noclick"))}},_mouseMoveHandler:function(e){if(this.listens("mouseover")||this.listens("mouseout")){var t=this._hitTest(e.screenX,e.screenY);if(t.length>0){var r=this._getHitTargetKey(t);null!=this._last_mouse_over&&this._last_mouse_over.key==r||(this._invokeFeatureListeners("mouseover",t),this.fire("mouseover",{list:t}),this._last_mouse_over={key:r,type:r.split("~")[1]})}else if(this._last_mouse_over){var n=this._getFeatureType(this._last_mouse_over.type);n&&n.listeners.mouseout&&n.listeners.mouseout(),this.fire("mouseout",{}),this._last_mouse_over=null}}},_invokeFeatureListeners:function(e,t){var r={};if(t){for(var n=0;n<t.length;n++){var i=t[n];r[i.featureType]=r[i.featureType]||[],r[i.featureType].push(i)}for(var o in r){var a=this._getFeatureType(o);a&&a.listeners[e]&&a.listeners[e](r[o])}}else for(var s=0;s<this.featureTypeList.length;s++){var l=this.featureTypeList[s];l&&l.listeners[e]&&l.listeners[e]()}},_getHitTargetKey:function(e){var t=null;if(e.length>0){var r=e[0];t=[r.elementId,r.featureType].join("~")}return t},_hitTest:function(e,t){for(var r=[],n=0;n<this.featureTypeList.length;n++){var i=this.featureTypeList[n];this._hitTestFeatureType(i,i.renderer.getLayer(),r,e,t)}return r},_hitTestFeatureType:function(e,t,r,n,i,o){var a,s,l=t;if(l&&(l instanceof f.carto.ElementLayer||l instanceof f.carto.FeatureLayer||l instanceof f.carto.ClusterLayer||l instanceof f.carto.GroupLayer)&&l.visible)if(l.map=l.map||this.map,o=o||l.getLayerId(),l instanceof f.carto.GroupLayer)for(var c=l.groupLayers,u=c.length-1;u>=0;u--){var p=c[u];this._hitTestFeatureType(e,p,r,n,i,l.getLayerId())}else{var h=l.hitTestList(n,i);if(h.graphiclist.length>0)for(var d=0;d<h.graphiclist.length;d++){var y=h.graphiclist[d];if(y&&(y.element||y.feature)){var m={};m.element=y.element||y.feature,m.elementId=(a=m.element,s=void 0,s=void 0,a instanceof f.sfs.Element?s=a.id:a instanceof f.sfs.Feature&&(s=a.objectId),s),m.layerId=l.getLayerId()||o,m.featureType=e.featureType,r.push(m)}}}}});e.exports=p},function(e,t,r){var n=r(69),i=r(14),o=(r(2),r(1)),a=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.options.geometryType=this.options.geometryType||"point",this.options.map.initialGroupLayers(),this.layer=new o.carto.ElementLayer({id:e.id,name:e.name}),i.addLayer2Group(this.options.map,this.layer,this.options.geometryType)},destroy:function(){this.clear(),i.removeLayerFromGroup(this.options.map,this.layer,this.options.geometryType),n.prototype.destroy.call(this)},getLayer:function(){return this.layer},getExtent:function(){return i.getLayerExtent(this.layer)},add:function(e){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n];try{var o=this.options.featureBuilder.buildElement(i);o&&r.push(o)}catch(e){console.warn(e)}}this.layer.addElements(r)},update:function(e){for(var t=[].concat(this.layer.elements),r=e.length,n=0;n<r;n++){var i=e[n],o=void 0;try{o=this.options.featureBuilder.buildElement(i)}catch(e){console.warn(e)}for(var a=i[this.options.idField],s=0;len1=t.length;s++)if(t[s].id==a){t.splice(s,1);break}o&&t.push(o)}this.layer.clear(),this.layer.addElements(t)},remove:function(e){var t=this.layer.find(e);return t&&this.layer.remove(t),t},clear:function(){this.layer.clear()},setVisible:function(e){this.layer.setVisible(!!e)},getVisible:function(){return this.layer.visible}});e.exports=a},function(e,t,r){var n=r(69),i=r(14),o=r(2),a=r(1),s=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.options.geometryType=this.options.geometryType||"point",this.options.map.initialGroupLayers(),this.featureLayerList=[],this.layer=new a.carto.GroupLayer({id:e.id,name:e.name,layers:[]}),i.addLayer2Group(this.options.map,this.layer,this.options.geometryType)},destroy:function(){this.clear(),this.layer.removeAllLayers(),this.featureLayerList=null,i.removeLayerFromGroup(this.options.map,this.layer,this.options.geometryType),n.prototype.destroy.call(this)},getLayer:function(){return this.layer},getExtent:function(){return i.getLayerExtent(this.layer)},add:function(e){for(var t=(new Date).getTime(),r=e.length,n=0;n<r;n++){var i=e[n],o=this.options.featureBuilder.buildFeature(i,!0);this._getFeatureLayerObj(i).featureSet.add(o)}this._render(),console.debug(e.length+" features takes "+((new Date).getTime()-t)+"ms")},update:function(e){var t=e.length;this.clearLayerOnly();for(var r=0;r<t;r++){var n=e[r],i=this.options.featureBuilder.buildFeature(n,!0),o=this._getFeatureById(i.objectId);o.index>=0&&o.featureLayerObj.featureSet.features.splice(o.index,1),this._getFeatureLayerObj(n).featureSet.add(i)}this._render()},remove:function(e){var t=this._getFeatureById(feature.objectId);t.index>=0&&t.featureLayerObj.featureSet.features.splice(t.index,1),t.featureLayerObj.layer.clear();var r=new a.render.SimpleRenderer({symbol:featureLayerObj.symbol});featureLayerObj.layer.addFeatures(featureLayerObj.featureSet),featureLayerObj.layer.render(r)},_render:function(){for(var e=0,t=this.featureLayerList.length;e<t;e++){var r=this.featureLayerList[e],n=new a.render.SimpleRenderer({symbol:r.symbol});r.layer.addFeatures(r.featureSet),r.layer.setVisible(!0),r.layer.render(n)}},_getFeatureLayerObj:function(e){var t=this.options.featureBuilder.buildSymbol(e),r=this._getFeatureObjBySymbol(t);if(null==r){r={};var n=new a.carto.FeatureLayer({id:"featureLayer-"+o.newUUID32(),opacity:1,visible:!1});r.symbol=t,r.layer=n,r.featureSet=new a.sfs.FeatureSet,this.layer.addLayer(n),this.featureLayerList.push(r)}return r},_getFeatureObjBySymbol:function(e){for(var t=null,r=0,n=this.featureLayerList.length;r<n;r++){var i=this.featureLayerList[r].symbol;if(i===e){t=this.featureLayerList[r];break}var o=!0;for(var a in i)i[a]==e[a]||(o=!1);if(o){t=this.featureLayerList[r];break}}return t},_getFeatureById:function(e){for(var t={index:-1},r=0,n=this.featureLayerList.length;r<n;r++){for(var i=this.featureLayerList[r],o=0;o<i.featureSet.getCount();o++)if(e==i.featureSet.getFeature(o).objectId){t.featureLayerObj=i,t.index=o,t.feature=i.featureSet.getFeature(o);break}if(t.index>=0)break}return t},clearLayerOnly:function(){for(var e=0;e<this.layer.groupLayers.length;e++)this.layer.groupLayers[e].clear();this.layer.clear()},clear:function(){this.clearLayerOnly();for(var e=0,t=this.featureLayerList.length;e<t;e++){this.featureLayerList[e].featureSet.features=[]}},setVisible:function(e){this.layer.setVisible(!!e)},getVisible:function(){return this.layer.visible}});e.exports=s},function(e,t,r){var n=r(69),i=(r(14),r(2),r(1)),o=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.gvInstance=null,this.featureCol={type:"FeatureCollection",features:[]},this.initListeners()},destroy:function(){this.featureCol.features=[],this.featureCol=null,this.destroyGvInstance(),n.prototype.destroy.call(this)},getLayer:function(){return this.getGvInstance()},add:function(e){(new Date).getTime();for(var t=e.length,r=this.options.featureBuilder.options.geometryBuilder,n=this.options.idField,i=this.featureCol.features,o=0;o<t;o++){var a=e[o];a.id=a.id||a[n];var s=r.build(a),l={id:a.id,geometry:s.asGeoJson(),properties:a};i.push(l)}this.render()},update:function(e){(new Date).getTime();for(var t=e.length,r=this.options.featureBuilder.options.geometryBuilder,n=this.options.idField,i=[],o=0;o<t;o++){var a=e[o];a.id=a.id||a[n];var s=r.build(a),l={id:a.id,geometry:s.asGeoJson(),properties:a},c=this._getFeatureById(l.id);c.index>=0?this.featureCol.features[c.index]=l:i.push(l)}this.featureCol.features=this.featureCol.features.concat(i),this.render()},remove:function(e){var t=this._getFeatureById(e);return t.index>=0?(this.featureCol.features.splice(t.index,1),this.render(),t.feature):null},_getFeatureById:function(e){for(var t={feature:null,index:-1},r=0,n=this.featureCol.features.length;r<n;r++){var i=this.featureCol.features[r];if(e==i.id){t.feature=i,t.index=r;break}}return t},render:function(){var e=new gv.source.GeoJsonSource(this.featureCol),t=this.getGvInstance();0==t.source.featureCollection.features.length&&0==e.featureCollection.features.length||(t.setDataSource(e),t.render())},clear:function(){this.featureCol.features=[],this.render()},setVisible:function(e){var t=this.getGvInstance();return!!t&&(t.setVisible(!!e),!0)},getVisible:function(){var e=this.getGvInstance();if(e)return e.getVisible()},addListeners:function(){this.gvInstance&&(this.gvInstance.on("click",this.onClick),this.gvInstance.on("mouseover",this.onMouseOver),this.gvInstance.on("mouseout",this.onMouseOut))},removeListeners:function(){this.gvInstance&&(this.gvInstance.un("click",this.onClick),this.gvInstance.un("mouseover",this.onMouseOver),this.gvInstance.un("mouseout",this.onMouseOut))},initListeners:function(){var e=this;this.onClick=function(t){e.fireEvent("click",t)},this.onMouseOver=function(t){e.fireEvent("mouseover",t)},this.onMouseOut=function(t){e.fireEvent("mouseout",t)}},fireEvent:function(e,t){if(t&&this.options.eventDispatcher.listens(e)){var r={},n={};for(var o in t)"geometry"!=o&&(n[o]=t[o]);var a=new i.sfs.Element({id:n[this.options.idField],geometry:i.sfs.GeometryFactory.createGeometryFromGeoJson(t.geometry)});a.attributeSet=this.options.featureBuilder.buildAttributeSet(n),r.featureType=this.options.id,r.featureName=this.options.name,r.element=a,r.elementId=a.id,this.options.eventDispatcher.fire(e,r);var s=this.options.eventDispatcher.listener(this.options.id,e);s&&s(t)}},getGvInstance:function(){var e=this;if(null==this.gvInstance){var t=new gv.source.GeoJsonSource(this.featureCol);this.gvInstance=new gv.chart.PointClusterChart(t,this.getGvOptions()),this.gvInstance.bind(this.options.map,gv.chart.MapType.TSMap),this.addListeners(),this.gvInstance.renderComplete((function(){e.gvInstance.setVisible(e.gvInstance.getVisible())}))}return this.gvInstance},getGvOptions:function(){return this.options.featureBuilder.options.symbolBuilder.build()},destroyGvInstance:function(){this.gvInstance&&(this.gvInstance.unbind(this.options.map),this.removeListeners(),this.gvInstance=null)}});e.exports=o},function(e,t,r){var n=r(69),i=r(14),o=(r(2),r(1)),a=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.options.geometryType=this.options.geometryType||"point",this.options.map.initialGroupLayers();var t=this.options.featureBuilder.options.symbolBuilder.buildClusterStyle();t.id=e.id,t.name=e.name,this.layer=new o.carto.ClusterLayer(t),i.addLayer2Group(this.options.map,this.layer,this.options.geometryType)},destroy:function(){this.clear(),i.removeLayerFromGroup(this.options.map,this.layer,this.options.geometryType),n.prototype.destroy.call(this)},getLayer:function(){return this.layer},getExtent:function(){return i.getLayerExtent(this.layer)},add:function(e){for(var t=e.length,r=[],n=0;n<t;n++){var i=e[n],o=void 0;try{(o=this.options.featureBuilder.buildElement(i))&&r.push(o)}catch(e){console.warn(e)}}this.layer.addElements(r)},update:function(e){for(var t=[].concat(this.layer.elements),r=e.length,n=0;n<r;n++){var i=e[n],o=void 0;try{o=this.options.featureBuilder.buildElement(i)}catch(e){console.warn(e)}for(var a=i[this.options.idField],s=0;len1=t.length;s++)if(t[s].id==a){t.splice(s,1);break}o&&t.push(o)}this.layer.clear(),this.layer.addElements(t)},remove:function(e){var t=this.layer.find(e);return t&&this.layer.remove(t),t},clear:function(){this.layer.clear()},setVisible:function(e){this.layer.setVisible(!!e)},getVisible:function(){return this.layer.visible}});e.exports=a},function(e,t,r){var n=r(123),i=r(479),o=r(480),a=r(481),s=r(122),l=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},addListeners:function(){this.map.listen("resolutionchanged",this._onResolutionChanged,this),this.map.listen("click",this._onClick,this)},removeListeners:function(){this.map.off("resolutionchanged",this._onResolutionChanged,this),this.map.off("click",this._onClick,this)},_onResolutionChanged:function(e){for(var t=this.featureTypeList.length-1;t>=0;t--){this.featureTypeList[t].renderer.onResolutionChanged(e)}},_onClick:function(e){for(var t=this.featureTypeList.length-1;t>=0;t--){this.featureTypeList[t].renderer.onClick(e)}},add:function(e){this._checkLoaded(),this.remove(e.featureType);var t=this._getFeatureType(e.featureType)||null,r=t||{},n=this._getRenderer(e.type||1),i=new s({idField:e.idField,geometryBuilder:e.geometryBuilder}),o=new n({id:e.featureType,name:e.featureName,map:this.map,idField:e.idField,featureBuilder:i,renderOption:e.renderOption,eventDispatcher:this.eventDispatcher});o.add(e.list),r.featureType=e.featureType,r.featureName=e.featureName,r.idField=e.idField,r.geometryBuilder=e.geometryBuilder,r.renderer=o,null==t&&this.featureTypeList.push(r)},update:function(e){this._checkLoaded();var t=this._getFeatureType(e.featureType);t&&t.renderer.update(e.list)},_getRenderer:function(e){return{1:i,2:o,3:a}[e]||null},getLayer:function(e){var t=this._getFeatureType(e);return t?t.renderer.getLayer():null},destroy:function(){n.prototype.destroy.call(this)}});e.exports=l},function(e,t,r){var n=r(178),i=r(70),o=(r(14),r(2),r(1),n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},getGvInstance:function(e){if(null==this.gvInstance){var t=new gv.source.GeoJsonSource(i.emptyFeatureCol());this.gvInstance=new gv.chart.PieStatisticsChart(e||t,this.getGvOptions()),this.gvInstance.bind(this.options.map,gv.chart.MapType.TSMap),this.addListeners()}return this.gvInstance}}));e.exports=o},function(e,t,r){var n=r(178),i=r(70),o=(r(14),r(2),r(57),r(37),r(1),n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},getGvInstance:function(e){if(null==this.gvInstance){var t=new gv.source.GeoJsonSource(i.emptyFeatureCol());this.gvInstance=new gv.chart.BarStatisticsChart(e||t,this.getGvOptions()),this.gvInstance.bind(this.options.map,gv.chart.MapType.TSMap),this.addListeners()}return this.gvInstance}}));e.exports=o},function(e,t,r){var n=r(179),i=(r(70),r(14),r(2),r(1)),o=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),this.featureSet=new i.sfs.FeatureSet,this.layer=new i.carto.FeatureLayer({}),this.overlayWare=new i.widget.OverlayWare({map:this.options.map}),this.initListeners(),this.visible=!0},destroy:function(){this.clear(),n.prototype.destroy.call(this)},getLayer:function(){return this.layer},render:function(){var e=this,t=this.featureSet,r=this.options.renderOption.style,n=r.htmlFn;n||(n=function(t){var r=document.createElement("div");r.setAttribute("id",[e.options.id,t[e.options.idField]].join("-"));return r.innerHTML="-",r});for(var o=0;o<t.getCount();o++){var a=t.getFeature(o),s=new i.widget.OverLay({element:n(a._original_data),offset:r.offset||[10,10],position:a.geometry,positioning:r.offset||"top-left",stopEvent:!0});this.overlayWare.add(s),a._overlay=s}},clear:function(){this.layer.clear(),this.featureSet.features=[],this.overlayWare.clear()},setVisible:function(e){for(var t=e?"block":"none",r=this.featureSet,n=0;n<r.getCount();n++){r.getFeature(n)._overlay.element.style.display=t}this.visible=!!e},getVisible:function(){return this.visible},addListeners:function(){},removeListeners:function(){}});e.exports=o},function(e,t,r){var n={EarthquakeIntensity:r(483),ChemicalLeak:r(484),ChemicalExplode:r(485),ChemicalFire:r(486)};e.exports=n},function(e,t,r){var n=r(9),i=(r(2),n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},load:function(){n.prototype.load.call(this)},unload:function(){n.prototype.unload.call(this)},showIntensityRange:function(e){},clearIntensityRange:function(){}}));e.exports=i},function(e,t){},function(e,t){},function(e,t){},function(e,t,r){var n={TyphoonTrack:r(488),TyphoonWarningLine:r(489),TyphoonForecast:r(490),BufferQuery:r(492)};e.exports=n},function(e,t,r){var n=r(9),i=r(2),o=r(11),a=r(1),s=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),1!=this.enable&&(this.map=e.map,this.options={},this.options.picSymbol=this._initPicSymbolOptions(e),this.options.dataSpatialReference=4326,this.options.dataSpatialReference=this._mergeOptions(this.options.dataSpatialReference,e.dataSpatialReference),this.options.spatialReference=this.map.spatialReference,this.options.spatialReference=this._mergeOptions(this.options.spatialReference,e.spatialReference),this.options.projection=1,this.options.projection=this._mergeOptions(this.options.projection,e.projection),this.service=e.service,this.options.typhoon={},this.options.typhoon=this._initTyphoonOptions(e),this.options.forecast=this._initForecast(e),this.options.popup=this._initPopup(e),this.options.popupForecast=this._initPopupForecast(e),this.options.toolTipWare=new a.widget.TooltipWare({map:this.map}),this.options.layerOrder=this._initLayerOrder(e),this.options.tfbh=e.tfbh,this.enable=!0,this._initInterfaceMsg(e))},load:function(){this.isLoaded()||(this.tyhoonPlayFlag=0,null!=this.options.tfbh&&this.loadOneTyphoon(this.options.tfbh),this.tf={},this.tf.paths={},this.tf.realLine={},this.tf.realPoints={},this.tf.realLabels={},this.tf.forecastLines={},this.tf.forecastPoints={},this._initLayers()),n.prototype.load.call(this)},addListeners:function(){null!=this.options.mapType?this._addListeners_tsmap():this._addListeners()},getIsLoaded:function(){return this.isLoaded},removeListeners:function(){this.map.off("click",this._getMapClickListener,this),this.map.off("mousemove",this._getMapMouseMoveListener,this)},service:null,setService:function(e){this.service=e},clearAll:function(){this.tf.Layer_point.clear(),this.tf.Layer_line.clear(),this.tf.selectPoint.clear(),this._forecastsClear(),this._clearCircle(),this.tf.typhoonIconLayer.clear(),this.tf.Layer_label.clear(),this._clearIntervals(this.tf.typhoonInterval),this._clearIntervals(this.tf._ds),this.tyhoonPlayFlag=0},removeAll:function(){this.clearAll(),this.tf.paths=null},clearOneTyphoon:function(e){if(null!=this.tf.realLine[e]){for(var t=0;t<this.tf.realLine[e].length;t++)this.tf.Layer_line.remove(this.tf.realLine[e][t]);for(var r=0;r<this.tf.realPoints[e].length;r++)this.tf.Layer_point.remove(this.tf.realPoints[e][r]);this.tf.Layer_label.remove(this.tf.realLabels[e]),this._forecastsClear(),this._clearCircleByTfbh(e),this.tf.typhoonIconLayer.clear(),window.clearInterval(this.tf.typhoonInterval[e]),window.clearInterval(this.tf._ds[e]),this.tyhoonPlayFlag=0}},removeOneTyphoon:function(e){this.clearOneTyphoon(e),delete this.tf.paths[e]},loadOneTyphoon:function(e,t){this._showTyphoonTrack(e,t)},loadOneTyphoonData:function(e,t){this._showTyphoonTrackData(e,t)},playOneTyphoon:function(e,t,r,n){var i=500;if(t&&(i=t),this.tf.paths[e])if(null!=this.tf.realLine[e])if(1!=this.tyhoonPlayFlag){this.tyhoonPlayFlag=1,this.clearOneTyphoon(e),this._createTyphoonLabel(e);var o=this;this.tf.typhoonIconLayer.clear(),window.clearInterval(this.tf.typhoonInterval[e]),window.clearInterval(this.tf._ds[e]);var a=0,s=this.tf.realPoints[e].length,l=this.tf.realPoints[e];if(!l||l.length<1)this.tyhoonPlayFlag=0;else{var c=setInterval((function(){o.tf.typhoonIconLayer.clear();var t=o.tf.realPoints[e][a+1];o._addTyphoonIconById(e,t,i);var u=l[a+1],f=u._tfbh,p=u._data.properties.time.replace("T"," ");if(r&&0==r.show||o.showTyphoonCircle(f,p),n&&0==n.show||o.showTyphoonForecast(f,p),o.tf.Layer_line.add(o.tf.realLine[e][a]),o.tf.Layer_point.add(l[a]),++a>=s-1){o.tf.Layer_point.add(l[a]),o.tf.typhoonIconLayer.clear(),window.clearInterval(o.tf.typhoonInterval[e]);t=o.tf.realPoints[e][a];o._addTyphoonIconById(e,t,i),window.clearInterval(c),c=null}}),i);this.tf._ds[e]=c}}else console.log("有正在播放。",e,"请等待...");else console.debug("no data ",e," ...")},showForecasts:function(e,t){for(var r in this.options.forecast.org[e].display=t,this.tf.Layer_forecast)if(this.tf.forecastLines[r]&&this.tf.Layer_forecast[r].showElement(this.tf.forecastLines[r][e],t),this.tf.forecastPoints[r]&&this.tf.forecastPoints[r][e])for(var n=0;n<this.tf.forecastPoints[r][e].length;n++){var i=this.tf.forecastPoints[r][e][n];this.tf.Layer_forecast.showElement(i,t)}},selectTyphoonTrackPoint:function(e,t){if(null!=this.tf.realPoints[e])for(var r=this.tf.realPoints[e],n=0;n<r.length;n++){if(r[n]._data.properties.time.replace("T"," ")==t)return void this._showRoutePointPopup(r[n])}},getTyphoonCircleInfo:function(e,t){if(null!=this.tf.realPoints[e]){for(var r={},n=this.tf.realPoints[e],i=0;i<n.length;i++){if(n[i]._data.properties.time.replace("T"," ")==t){r=this._getTyphoonCircleInfo(n[i]);break}}return r}},showTyphoonCircle:function(e,t){if(null!=this.tf.realPoints[e])for(var r=this.tf.realPoints[e],n=0;n<r.length;n++){for(var i=!0,o=n;o<r.length;o++){var a=r[o],s=a._data.properties.radius7?a._data.properties.radius7:0,l=a._data.properties.radius7_quad,c=0;for(var u in l){var f=l[u];f&&(c+=f)}if(c+s>0){i=!1;break}}if(r[n]._data.properties.time.replace("T"," ")==t&&0==i)return void this._showTyphoonCircle(r[n])}},showTyphoonForecast:function(e,t){if(null!=this.tf.realPoints[e])for(var r=this.tf.realPoints[e],n=0;n<r.length;n++){if(r[n]._data.properties.time.replace("T"," ")==t)return void this._showTyphoonForecast(r[n])}},openInterfaceMsg:function(e,t){for(var r=0;r<this.options.interfaceMsg[e].length;r++)this.options.interfaceMsg[e][r].enable=t;this._updateEventsArray(this.options.interfaceMsg.trackPoint,this.options.interfaceMsg.forecastPoint)},openTrackPopup:function(e){this.options.popup.display=e},openForecastPopup:function(e){this.options.popupForecast.display=e},getLoadedTyphoons:function(){var e={status:-1,data:"typhoon web component no init,no typhoon data..."};if(null==this.tf)return e;if(e={status:-1,data:"typhoon web component init,no typhoon data..."},null==this.tf.paths)return e;e={status:1,data:this.tf.paths};var t=[];for(var r in this.tf.paths)if(this.tf.paths.hasOwnProperty(r)){var n=this.tf.paths[r];t.push(n)}return e.data=t,e},unload:function(){if(0!=this.enable){for(var e=this.trackClickEvent.concat(this.trackMousemoveEvent).concat(this.forecastClickEvent).concat(this.forecastMousemoveEvent),t=0;t<e.length;t++){var r=e[t];this.off(r)}for(var i in this.clearAll(),this.map.removeLayer(this.tf.typhoonIconLayer),this.map.removeLayer(this.tf.Layer_line),this.map.removeLayer(this.tf.Layer_point),this.map.removeLayer(this.tf.selectPoint),this.map.removeLayer(this.tf.Layer_label),this.tf.Layer_Circle)this.map.removeLayer(this.tf.Layer_Circle[i]);for(var i in this.tf.Layer_forecast)this.map.removeLayer(this.tf.Layer_forecast[i]);this.tf.paths={},this.tf.realLine={},this.tf.realPoints={},this.tf.realLabels={},this.tf.forecastLines={},this.tf.forecastPoints={},this.tf=void 0,n.prototype.unload.call(this)}},destroy:function(){this.unload(),this.options=void 0,this.enable=!1,n.prototype.destroy.call(this)},_clearIntervals:function(e){for(var t in e)window.clearInterval(e[t])},_mergeOptions:function(e){for(var t,r,n=1,i=arguments.length;n<i;n++)for(t in r=arguments[n])e[t]=r[t];return e},_mergeStr:function(e,t){return null!=t&&(e=t),e},_initPicSymbolOptions:function(e){return this.options.picSymbol={typhoonIcon:"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAC0AAAAtCAYAAAA6GuKaAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAggSURBVGhDvZl7bFRVEMZREJAiogI+ACuIihhEQCIkCooGSEQSjMFIML7ABGs0xqhgokWDgMQYDBogqNWIEqr4DwLiIzw1IWKssWDaNLSlLX3Sd7t9wK6/7zqnuWy33bt06U1O9t7zmPlmzsycmbN9+iT5iUQifYuLi69JMtmLQ66kpGTZ6dOni/ldUVlZecXF4ZIkqmVlZQsAmo9214bD4QFJIttzMmz5JdFUSktLUwD7He2fY8eODfKPM/8ytJ6KIJOLiooeY+5zCLeM99n0T+V3VHZ2dv+eI+uCAgxHwHCsf7igoGAMYM9Ju/7+/Pz8ofRvAdg5WsTf6A/7GzQ1foQ2M6ngAXwTjNrLy8sHO8IwmVZVVRUB8DN+Zszby/w2AxPRnJqamlb6M1g/59SpU+NYO5z+IdoJtczMzL7Ru9RjAWCSA9PPHSHe5wJEgF/zCTELxws5sIxLo9udBvfv399PJsL3GtZtZWw9QsxFiMt7DDCaAMQXQzzi+tn625uamrSl2c7G0ezsuro6zww0F1BlFRUVt2oN6+fwfaKxsTGCUOeZinYhFApFAP4rNB5ImgND7CBM//BptAggZ913YWHh2IaGhg4wjP2sMcDfTAtF27S+ZdP8nhUdmZ39hiVUtLklvAto4Orm5uYIW75EixHgGxGGybc+U8l3wOjPUT/fnzkz8YPWbgDqbQS9Qf7BTvXTIcTuDYTXSOa+UF9fH4JOFd+zEgZsW7tZW6h3EQd0M0QFepj6IPyR23JpS87F79FoMzDgIfkAbbm0SXtIESkWMGislDkxvjph4CzKg8BBE2CltMd3tgmhGFzv02Q17//G0rCbI3tXw94jZ86cicispBTGv4fuQv+xL4Hor2b+1ljnQ0xhNBFCjbR3bcvbjfkGM5W07gDGsuV4fRIGfl+lp6df6vOhk6zbFUjjmMEwaQPpF9nBou2SVp43IdrigQgybjQ7HNkU0Ur/0w4ofdkI82Vc4DBcYmFsGrY7UcS1tfQ/iiC3JVHLTdDMEH1HE4CeCcFnjYDKbJjThAPf1y1wiGyS0zE5FWIzpDUjNJ/vxUG0GHQOdl0jRQD2Y3i0CLQv5j9r5jhGDt5t5sjCAwIt0+D9XhExR1woGwsKKIF5YU7MO8lnrmdNi1snZ0XDd5jG19HvaT/mw+BfAg3QawF+jyOCqSxNAMh5J2CQdWaKIyyquPWHHEiwFHRZXDD4Z21trSclzCY4h0Hru6urqxMGEwSwzWlUPgKw0ZjCWfUpz2EXbjFtj6ZvXYemAfaF+wDcHklL38MuejgTCQpA5gTzI6zfx3t50HXM225nw4vyI9GBxm5fGHylAzSTc/Py8rxTSvHZvPkt+/akDtpgEmKnrnLEdWSztjDIeu0wkeo645tna8qg4cVvpRf0TfVo87IWsC/pHcDTLdh7yRJjG4OGOVv3TrSzwLS/Yn8Q4Mz52wCmmX23K731KaGv9y67QUNZetepxMI2i9UTVI0EZOYdzXLeWB4ODcXlIMDbVCCYwtqkCGfXnegq3ADUK/15P2kO6Hkvu1AchKEOIdZtjiaOMCODatrs+HXRgNY2fdOWxlKEgH1C22uaf1MBXVKyUFFkeVQo6lJjzFd5NkmllPIYs0N/ghVE2yFT3lPCAP8NMUFjBpM1wQ0ysda025KbmzuA96Ig2tYcS/arlR/TWoOss1RBSZIXNZRnYxaTFPZcVIkJHC0dIVT9ZCax1G0p/QL8alBtBwEZPUc+BNiNrh/A07OyslKsOuo4ZDoBVx5g2zHBgP9gmlMoKpGDXgigIGtUf6oAdpEKLGnCoNOZ98Mxtew60eoBOaW+Ke+V8JcGYdrTOSrvoJHqc9htZtfNmNjObkErJrJY1YhXqOpwUA0Ynf/2FKTP9j3HhH6z+Lnqnj5nphWMeQVJtw/bdL9qNRdNzFRW2RVCEO+PO0eOpwTfp9nfnTmYQB9Y2GvCZIMVuwB/w+zpkDuWCYPjsa+DMAonQfMNCqc+535PIN21BGPzzTxC/hOxk7aRaLK/E4nXyDGsEl9J+BlqhIYrsVIteSFmYs42T0mZhTrtzEyyyCstiijkjTNNt7jcI6Z5oMUZADmvmFTp7yuHVOTqOK5hni5vXNEb1xyihPvNTO5D9Sti0VQEzNShJkGUTihnoe+XeOaso3MFTVmZF/b0AHoiJlHSxb1GTMACgtZqEewJaHXsCP11LrfwJWJZJsQWO8Y9UxFfl/XFBY5207VNMFyl49gtgPly+o7rlHLHvOUGnrbUz6+ugA8jeJpdR2TL/q1orVKObgBX25ngmQJzB6rIYLxFodbmeJdDgR8VtTCvs1vQObrCcos51oco+CPE+4DRxfpO2mq+/891efi+ES1VWDjTbtQ5rVnm2CZhaMfNdveY5r1Q26MHQgtp7aatTfFuOAE7hZbrbNiK4l3utoixQT4HbpPtEkFGmda9RCkpj7RsTrq7tbVVWqukHaXvR3530A7rAKLVuRBm5pVDlT3FgdA1sNZKAWi9nvnjZRZybLukXJQUwNFEdP+A9uRcGbQcHTgqkyxUnVMxQdNfGHf71wLwZUUF7FZ/beiSJkXjvH9qWl5/UQDHIqptVwXtQPjnYEopjD2IkC1WIJzg14u/ehRODfCOXgPcFSPZNYD2+ZxQRWqq/xZUqaeduF/3GmD+UhusaAG4x2lrZdc0XbSHZTICjVaf1C5EgwL8IDQcZmxBrwF2jDCJMSpkYf4I2tU93zxzrk7/O/rW6B+zTBevex10ogxVtqH9uxJdFz3/P/gcX4PsbnO8AAAAAElFTkSuQmCC"},this.options.picSymbol=this._mergeOptions(this.options.picSymbol,e.picSymbol),this.options.picSymbol},_createLayer:function(e,t){var r;return r=new a.carto.ElementLayer({id:e.id,name:e.name,zIndex:e.zIndex,map:t}),t.addLayer(r),r},_initTyphoonOptions:function(e){return this.options.typhoon.lineColor={a:153,r:255,g:255,b:255},this.options.typhoon.lineSingleColorFlag=0,this.options.typhoon.lineColor=this._mergeOptions(this.options.typhoon.lineColor,e.typhoon.lineColor),this.options.typhoon.lineSingleColorFlag=this._mergeOptions(this.options.typhoon.lineSingleColorFlag,e.typhoon.lineSingleColorFlag),this.options.typhoon.nameTextSymbol={text:"台风名称文本样式",fontSize:14,fontWeight:"normal",fontFamilyName:"宋体",foreground:{a:255,r:0,g:0,b:0},borderColor:{a:255,r:0,g:0,b:0},offsetY:20,borderThickness:1},this.options.typhoon.nameTextSymbol=this._mergeOptions(this.options.typhoon.nameTextSymbol,e.typhoon.nameTextSymbol),this.options.typhoon.focusPointSymbol={fillColor:"#FFFFFF",borderColor:"#80808C",weight:.5,opacity:153,fillOpacity:150,radius:12},this.options.typhoon.focusPointSymbol=this._mergeOptions(this.options.typhoon.focusPointSymbol,e.typhoon.focusPointSymbol),this.options.typhoon.typhoonSpeeds=[[.1,10.7],[10.8,17.1],[17.2,24.4],[24.5,32.6],[32.7,41.4],[41.5,50.9],[51,120]],this.options.typhoon.typhoonLevel=["常态气压","热带低压","热带风暴","强热带风暴","台风","强台风","超强台风"],this.options.typhoon.typhoonPointColor=["#000000","#02FF02","#39C7CF","#FBF9CC","#FFDE75","#FF8515","#FF5252"],this.options.typhoon.typhoonSpeeds=this._mergeOptions(this.options.typhoon.typhoonSpeeds,e.typhoon.typhoonSpeeds),this.options.typhoon.typhoonLevel=this._mergeOptions(this.options.typhoon.typhoonLevel,e.typhoon.typhoonLevel),this.options.typhoon.typhoonPointColor=this._mergeOptions(this.options.typhoon.typhoonPointColor,e.typhoon.typhoonPointColor),this.options.typhoon},_initForecast:function(e){return this.options.forecast={lineStyle:{width:2,style:2},org:{"中国":{rgb:"#FF0000",display:1},CN:{rgb:"#FF0000",display:1},"中国香港":{rgb:"#FFA500",display:1},HK:{rgb:"#FFA500",display:1},"中国台湾":{rgb:"#FFFF00",display:1},TW:{rgb:"#FFFF00",display:1},"日本":{rgb:"#00FF00",display:1},JP:{rgb:"#00FF00",display:1},"美国":{rgb:"#0000FF",display:1},US:{rgb:"#0000FF",display:1},"韩国":{rgb:"#B97A57",display:1},KR:{rgb:"#B97A57",display:1},"南海":{rgb:"#800080",display:1},NH:{rgb:"#800080",display:1},"浙江":{rgb:"#FFC0CB",display:1},ZJ:{rgb:"#FFC0CB",display:1},"菲律宾":{rgb:"#22B14C",display:1},"广东":{rgb:"#4B0082",display:1},"欧洲":{rgb:"#B5E61D",display:1},null:{rgb:"#000000",display:1}}},this.options.forecast.lineStyle=this._mergeOptions(this.options.forecast.lineStyle,e.forecast.lineStyle),this.options.forecast.org=this._mergeOptions(this.options.forecast.org,e.forecast.org),this.options.forecast},_initPopup:function(e){return this.options.popup={display:1,offset:[-200,100],divStyle:"font-size:12px;color:#000 ;background: transparent; margin-top: 8px;margin-left: 10px; margin-right: 0px;",liStyle:"height:20px;margin:2px;",pointEPSG:4326,pointPrecision:3,typhoonName:{display:1,label:"台风编号：",unit:""},passTime:{display:1,label:"过去时间：",unit:""},centerPoint:{display:1,label:"中心位置：",x:"#lon#",y:"#lat#",format:"#lon#E,#lat#N",unit:""},centerPressure:{display:1,label:"中心气压：",unit:"百帕"},power:{display:1,label:"最大风力：",unit:"级"},speed:{display:1,label:"最大风速：",unit:"米/秒"},moveSpeed:{display:1,label:"移动速度：",unit:"公里/小时"},moveDir:{display:1,label:"移动方向：",unit:""},sevenRingRadius:{display:1,label:"七级风圈半径:",unit:"公里"},tenRingRadius:{display:1,label:"十级风圈半径:",unit:"公里"},twelveRingRadius:{display:1,label:"十二级风圈半径:",unit:"公里"}},this.options.popup=this._mergeOptions(this.options.popup,e.popup),this.options.popup},_initPopupForecast:function(e){return this.options.popupForecast={display:1,offset:[-200,100],divStyle:"font-size:12px;color:#000 ;background: transparent; margin-top: 8px;margin-left: 10px; margin-right: 0px;",liStyle:"height:20px;margin:2px;",pointEPSG:4326,org:{display:1,label:"预报机构：",unit:""},arrivalTime:{display:1,label:"到达时间：",unit:""},centerPoint:{display:1,label:"中心位置：",x:"#lon#",y:"#lat#",format:"#lon#,#lat#",unit:""},power:{display:1,label:"最大风力：",unit:"级"},speed:{display:1,label:"最大风速：",unit:"米/秒"},moveSpeed:{display:1,label:"移动速度：",unit:"公里/小时"},moveDir:{display:1,label:"移动方向：",unit:""},centralPressure:{display:1,label:"中心气压：",unit:"百帕"},pointPrecision:3},this.options.popupForecast=this._mergeOptions(this.options.popupForecast,e.popupForecast),this.options.popupForecast},_initLayerOrder:function(e){return this.options.layerOrder={trackLine:{id:"typhoon_line",name:"台风路径线图层",zIndex:101},trackPoint:{id:"typhoon_point",name:"台风路径点图层",zIndex:102},focusPoint:{id:"typhoon_focus_point",name:"台风路径点焦点图层",zIndex:101},trackLabel:{id:"typhoon_label",name:"台风路径文本",zIndex:100},typhoonRing:{id:"typhoon_ring",name:"台风路径风圈",zIndex:100},typhoonForecast:{id:"typhoon_forecast",name:"预报图层",zIndex:101},typhoonIcon:{id:"typhoon_icon_Layer",name:"台风风眼图标",zIndex:100}},this.options.layerOrder=this._mergeOptions(this.options.layerOrder,e.layerOrder),this.options.layerOrder},_initLayers:function(){this.tf.typhoonIconLayer=null,this.tf.typhoonIconLayer=this._createLayer(this.options.layerOrder.typhoonIcon,this.map),this.tf.typhoonInterval={},this.tf._ds={},this.tf.Layer_line=null,this.tf.Layer_line=this._createLayer(this.options.layerOrder.trackLine,this.map),this.tf.Layer_point=null,this.tf.Layer_point=this._createLayer(this.options.layerOrder.trackPoint,this.map),this.tf.selectPoint=null,this.tf.selectPoint=this._createLayer(this.options.layerOrder.focusPoint,this.map),this.tf.Layer_label=null,this.tf.Layer_label=this._createLayer(this.options.layerOrder.trackLabel,this.map),this.tf.Layer_Circle={},this.tf.Layer_forecast={}},_initInterfaceMsg:function(e){var t=e.interfaceMsg.trackPoint,r=e.interfaceMsg.forecastPoint;i.isObject(t)&&(e.interfaceMsg.trackPoint=[t]),i.isObject(r)&&(e.interfaceMsg.forecastPoint=[r]),this.options.interfaceMsg={forecastPoint:[{name:"mousemoveForecastPoint",enable:1}],trackPoint:[{name:"mouseoverTrackPoint",enable:1}]},this.options.interfaceMsg.forecastPoint=this._mergeOptions(this.options.interfaceMsg.forecastPoint,e.interfaceMsg.forecastPoint),this.options.interfaceMsg.trackPoint=this._mergeOptions(this.options.interfaceMsg.trackPoint,e.interfaceMsg.trackPoint)},_transformMap:function(e){return this.options.dataSpatialReference==this.map.spatialReference?e:(new a.sfs.CoordinateTransform).transform(e,this.options.map.spatialReference)},_transformData:function(e){return this.options.dataSpatialReference==this.map.spatialReference?e:(new a.sfs.CoordinateTransform).transform(e,this.options.dataSpatialReference)},_transformObj:function(e,t){return t==this.map.spatialReference?e:(new a.sfs.CoordinateTransform).transform(e,t)},_showTyphoonTrack:function(e,t){var r=this,n={status:-1,data:""};this.service.getTyphoonInfo({typhoonid:e}).then((function(e){var i=e;if(i){if(n.status=1,n.data=i[0],null==i[0])return;r._drawOneTyphoon(i[0],t)}else n.status=-1,n.data="no data ! Please check data....."}))},_showTyphoonTrackData:function(e,t){var r={status:-1,data:""};e?(r.status=1,r.data=e,this._drawOneTyphoon(e,t)):(r.status=-1,r.data="no data ! Please check data.....")},_drawOneTyphoon:function(e,t){var r=e.tfbh;this.clearOneTyphoon(r),this.tf.paths[r]=e,this._createlineById(r,t),this._createPointById(r,t),this._createTyphoonLabel(r,t)},_createlineById:function(e,t){this.tf.realLine[e]=[];for(var r,n=!0,i=0;i<this.tf.paths[e].features.length;i++){var o=this.tf.paths[e].features[i];if(!n){var s=new a.sfs.Polyline({spatialReference:this.options.dataSpatialReference}),l=new a.sfs.Path({spatialReference:this.options.dataSpatialReference}),c=new a.sfs.Point({x:r.geometry.coordinates[0],y:r.geometry.coordinates[1],spatialReference:this.options.dataSpatialReference}),u=new a.sfs.Point({x:o.geometry.coordinates[0],y:o.geometry.coordinates[1],spatialReference:this.options.dataSpatialReference});l.addPoint(c),l.addPoint(u),s.addGeometry(l);var f,p={a:153,r:0,g:0,b:0};if(null!=this.options.typhoon.lineColor&&(p=this.options.typhoon.lineColor),this.options.typhoon.lineSingleColorFlag>0)f=new a.sfs.SimpleLineSymbol({color:new a.sfs.Color(p)});else{var h=this._getTyphoonGrade(o.properties.speed);f=new a.sfs.SimpleLineSymbol({color:new a.sfs.Color.fromHex(h.color)})}s=this._transformMap(s),(y=new a.sfs.Element({geometry:s,symbol:f}))._tfbh=e,this.tf.realLine[e].push(y)}r=o,n=!1}if(this.tf.realLine[e]&&0!=t)for(var d=0;d<this.tf.realLine[e].length;d++){var y=this.tf.realLine[e][d];this.tf.Layer_line.add(y)}},_createPointById:function(e,t){this.tf.realPoints[e]=[];for(var r=this.tf.paths[e].features.length,n=0;n<r;n++){var i=this.tf.paths[e].features[n].properties.speed,o=this._getTyphoonPointStyle(i),s=a.sfs.GeometryFactory.createGeometryFromGeoJson(this.tf.paths[e].features[n].geometry,this.options.dataSpatialReference),l=new a.sfs.SimpleMarkerSymbol({fillColor:a.sfs.Color.fromHex(o.fillColor),borderColor:a.sfs.Color.fromHex(o.borderColor),size:o.radius});l.fillColor.a=o.fillOpacity,l.borderColor.a=o.opacity,s=this._transformMap(s);var c=new a.sfs.Element({geometry:s,symbol:l});c._data=this.tf.paths[e].features[n],c._tfbh=e,c.islast=n==r-1,0!=t&&this.tf.Layer_point.add(c),this.tf.realPoints[e].push(c)}var u=this._getBoundRect(this.tf.paths[e].features);this.map.pan(u,[0,0,0,0])},_getBoundRect:function(e){var t=180,r=90,n=-180,i=-90,o=2;o=2;0==this.options.projection&&(o=1e4,null!=this.options.rect&&(null!=this.options.rect.maxx&&(t=this.options.rect.maxx),null!=this.options.rect.maxy&&(r=this.options.rect.maxy),null!=this.options.rect.minx&&(n=this.options.rect.minx),null!=this.options.rect.miny&&(i=this.options.rect.miny),null!=this.options.rect.noMinx&&(t=this.options.rect.minx),null!=this.options.rect.noMaxy&&(i=this.options.rect.maxy)));for(var s=0;s<e.length;s++){var l=a.sfs.GeometryFactory.createGeometryFromGeoJson(e[s].geometry,this.options.dataSpatialReference);t>l.x&&(t=l.x),r>l.y&&(r=l.y),n<l.x&&(n=l.x),i<l.y&&(i=l.y)}1==e.length&&(t-=o,r-=o,n+=o,i+=o);var c=new a.sfs.Point({x:t,y:r,spatialReference:this.options.dataSpatialReference});c=this._transformMap(c);var u=new a.sfs.Point({x:n,y:i,spatialReference:this.options.dataSpatialReference});return u=this._transformMap(u),new a.sfs.Envelope({minx:c.x,maxx:u.x,miny:c.y,maxy:u.y,spatialReference:this.options.spatialReference})},_createTyphoonLabel:function(e,t){var r=this.tf.realPoints[e][0],n=this.tf.paths[e].name;"-"==this.tf.paths[e].name&&(n=this.tf.paths[e].ename);var i=e+"\n"+n,o=this.options.typhoon.nameTextSymbol,s=new a.sfs.TextSymbol({text:i,fontSize:o.fontSize,fontWeight:o.fontWeight,fontFamilyName:o.fontFamilyName,foreground:new a.sfs.Color(o.foreground),borderColor:new a.sfs.Color(o.borderColor),offsetY:o.offsetY,borderThickness:o.borderThickness}),l=r.geometry,c=new a.sfs.Element({geometry:l,symbol:s});0!=t&&this.tf.Layer_label.add(c),this.tf.realLabels[e]=c},_createFocusPoint:function(e){if(null!=e._data){this.tf.selectPoint.clear();var t=this.options.typhoon.focusPointSymbol,r=a.sfs.GeometryFactory.createGeometryFromGeoJson(e._data.geometry,this.options.dataSpatialReference),n=new a.sfs.SimpleMarkerSymbol({fillColor:a.sfs.Color.fromHex(t.fillColor),borderColor:a.sfs.Color.fromHex(t.borderColor),size:t.radius});n.fillColor.a=t.fillOpacity,n.borderColor.a=t.opacity,r=this._transformMap(r);var i=new a.sfs.Element({geometry:r,symbol:n});i._data=e._data,i._tfbh=e._tfbh,this.tf.selectPoint.add(i)}},_addTyphoonIconById:function(e,t,r){null==t&&(t=this.tf.realPoints[e][this.tf.realPoints[e].length-1],this.tyhoonPlayFlag=0);var n=360,i=this;window.clearInterval(this.tf.typhoonInterval[e]),this.tf.typhoonIconLayer.clear(),this.tf.typhoonInterval[e]=window.setInterval((function(){i.tf.typhoonIconLayer.clear();var e=new a.sfs.PictureMarkerSymbol({source:i.options.picSymbol.typhoonIcon,width:"50",height:"50",rotation:n+"",opacity:"1",offsetX:"23",offsetY:"23"}),r=new a.sfs.Element({geometry:t.geometry,symbol:e});i.tf.typhoonIconLayer.add(r),0==(n-=20)&&(n=360)}),r/5)},_getTyphoonPointStyle:function(e){return e=e||0,{fillColor:this._getTyphoonGrade(e).color,borderColor:"#80808C",weight:.5,opacity:153,fillOpacity:255,fill:!0,radius:5}},_getTyphoonGrade:function(e){var t=this.options.typhoon.typhoonSpeeds,r=this.options.typhoon.typhoonPointColor,n=this.options.typhoon.typhoonLevel,i=-1;if(null!=e&&null!=e||(e=0),(e=e.toFixed(1))<t[0][0]&&(i=0),e>t[t.length-1][1]&&(i=t.length-1),-1==i)for(var o=0;o<t.length;o++){var a=t[o],s=a[0],l=a[1];if((e==s||e>s)&&(e==l||e<l)){i=o;break}}return{color:r[i],level:n[i]}},_getRegineColor:function(e){var t=null;null==(t=this.options.forecast.org[e.trim()].rgb)&&(t=this.options.forecast.org.null),t=new a.sfs.Color.fromHex(t);var r=new a.sfs.SimpleLineSymbol({color:t,width:this.options.forecast.lineStyle.width,style:this.options.forecast.lineStyle.style});return r.color.a=this.options.forecast.lineStyle.opacity,r},_forecastsClear:function(){if(this.tf.Layer_forecast){for(var e in this.tf.Layer_forecast)this.tf.Layer_forecast[e].clear();this.tf.forecastPoints={},this.tf.forecastLines={}}},_forecastsClearByTfbh:function(e){this.tf.Layer_forecast&&(this.tf.Layer_forecast[e].clear(),this.tf.forecastPoints[e]={},this.tf.forecastLines[e]={})},_drawForecasts:function(e){this.tf.forecastPoints[e._tfbh]||(this.tf.forecastPoints[e._tfbh]={}),this.tf.forecastLines[e._tfbh]||(this.tf.forecastLines[e._tfbh]={}),this.tf.Layer_forecast[e._tfbh]?this._forecastsClearByTfbh(e._tfbh):this.tf.Layer_forecast[e._tfbh]=this._createLayer(this.options.layerOrder.typhoonForecast,this.map);for(var t=0;t<e._data.properties.forecast.length;t++){var r=e._data.properties.forecast[t],n=new a.sfs.Path({spatialReference:this.options.spatialReference});n.addPoint(new a.sfs.Point({x:parseFloat(e.geometry.x),y:parseFloat(e.geometry.y),spatialReference:this.options.spatialReference}));for(var i=0;i<r.features.length;i++){var o=r.features[i],s=new a.sfs.Point({x:o.geometry.coordinates[0],y:o.geometry.coordinates[1],spatialReference:this.options.spatialReference}),l=this._getTyphoonPointStyle(o.properties.speed),c=new a.sfs.SimpleMarkerSymbol({fillColor:new a.sfs.Color.fromHex(l.fillColor),borderColor:new a.sfs.Color.fromHex(l.borderColor),size:l.radius-1}),u=new a.sfs.Element({geometry:s,symbol:c});o.region_ab=r.region_ab,o.region=r.region,u.data_user=o,u._forecast=1,null==this.tf.forecastPoints[e._tfbh][o.region]&&(this.tf.forecastPoints[e._tfbh][o.region]=[]),this.tf.forecastPoints[e._tfbh][o.region].push(u),this.tf.Layer_forecast[e._tfbh].add(u),this.tf.Layer_forecast[e._tfbh].showElement(u,this.options.forecast.org[o.region].display),n.addPoint(s)}var f=new a.sfs.Polyline({spatialReference:this.options.spatialReference});f.addGeometry(n);var p=this._getRegineColor(r.region),h=new a.sfs.Element({geometry:f,symbol:p});this.tf.Layer_forecast[e._tfbh].add(h),this.tf.Layer_forecast[e._tfbh].showElement(h,this.options.forecast.org[o.region].display),this.tf.forecastLines[e._tfbh][r.region]=h}},_clearCircle:function(){if(this.tf.Layer_Circle){for(var e in this.tf.Layer_Circle)this.tf.Layer_Circle[e].clear();this.tf.selectPoint.clear()}},_clearCircleByTfbh:function(e){this.tf.Layer_Circle[e]&&(this.tf.Layer_Circle[e].clear(),this.tf.selectPoint.clear())},_showRoutePointPopup:function(e){var t;null!=(t=e)._data&&null!=t._data.properties&&(this._drawCircle(t),this._drawForecasts(t))},_getTyphoonCircleInfo:function(e){var t;if(null!=(t=e)._data&&null!=t._data.properties){var r=this._getCircle(t);return r=this._typhoonCircle2Ring(r,"ne"),r=this._typhoonCircle2Ring(r,"nw"),r=this._typhoonCircle2Ring(r,"se"),(r=this._typhoonCircle2Ring(r,"sw")).grade_7&&(r=this._getUnionedGeom(r,"grade_7")),r.grade_10&&(r=this._getUnionedGeom(r,"grade_10")),r.grade_12&&(r=this._getUnionedGeom(r,"grade_12")),r}},_getUnionedGeom:function(e,t){var r=new jsts.io.GeoJSONReader,n=r.read(e[t].ne.geom),i=r.read(e[t].nw.geom),o=r.read(e[t].se.geom),a=r.read(e[t].sw.geom),s=n.union(i).union(o).union(a),l=new jsts.io.GeoJSONWriter;return e[t].geom=l.write(s),e},_typhoonCircle2Ring:function(e,t){var r,n,i,o=new jsts.io.GeoJSONWriter;return e.grade_12&&e.grade_12[t]&&e.grade_12[t].geom?(r=e.grade_12[t].geom,n=e.grade_10[t].geom.difference(e.grade_12[t].geom),i=e.grade_7[t].geom.difference(e.grade_10[t].geom)):e.grade_10&&e.grade_10[t]&&e.grade_10[t].geom?(n=e.grade_10[t].geom,i=e.grade_7[t].geom.difference(e.grade_10[t].geom)):e.grade_7&&e.grade_7[t]&&e.grade_7[t].geom&&(i=e.grade_7[t].geom),e.grade_7[t].geom=i?o.write(i):null,e.grade_10[t].geom=n?o.write(n):null,e.grade_12[t].geom=r?o.write(r):null,e},_showTyphoonCircle:function(e){var t;null!=(t=e)._data&&null!=t._data.properties&&this._drawCircle(t)},_showTyphoonForecast:function(e){var t;null!=(t=e)._data&&null!=t._data.properties&&this._drawForecasts(t)},_showPopupForecast:function(e,t){if(e.data_user){this.options.toolTipWare.clear();var r=this._getForecastPopupContent(e,t),n=new a.widget.Tooltip({anchor:e.geometry,content:r,offset:[0,-10]});this.options.toolTipWare.add(n)}},_getForecastPopupContent:function(e,t){var r="font-size:12px;color:#000 ;background: #fff; margin-top: 8px;margin-left: 10px; margin-right: 0px;";return null!=this.options.popupForecast.divStyle&&(r=this.options.popupForecast.divStyle),'<div id="'+t+'" style="'+r+'">'+JSON.stringify(this._parseForecastData(e))},_getCircle:function(e){var t={},r=e._data,n=r.properties.radius7_quad,i=r.properties.radius10_quad,o=r.properties.radius12_quad,s=new a.sfs.Point({x:r.geometry.coordinates[0],y:r.geometry.coordinates[1],spatialReference:this.options.dataSpatialReference}),l=[(s=this._transformMap(s)).x,s.y];if(null==n&&null==i&&null==o){var c=r.properties.radius7,u=r.properties.radius10,f=r.properties.radius12;if(null!=c){var p={center:l,radius:0,direction:"ne",radiusQuad:{ne:c,se:c,sw:c,nw:c}};t.grade_7=this._getRing(p)}if(null!=u){p={center:l,radius:u,direction:"ne",radiusQuad:{ne:u,se:u,sw:u,nw:u}};t.grade_10=this._getRing(p)}if(null!=f){p={center:l,radius:f,direction:"ne",radiusQuad:{ne:f,se:f,sw:f,nw:f}};t.grade_12=this._getRing(p)}}else{if(n.ne>0){p={center:l,radius:0,direction:"ne",radiusQuad:r.properties.radius7_quad};t.grade_7=this._getRing(p)}if(i.ne>0){p={center:l,radius:u,direction:"ne",radiusQuad:r.properties.radius10_quad};t.grade_10=this._getRing(p)}if(o.ne>0){p={center:l,radius:f,direction:"ne",radiusQuad:r.properties.radius12_quad};t.grade_12=this._getRing(p)}}return t},_getRing:function(e){var t={};return e.direction="ne",e.radius=e.radiusQuad.ne,t[e.direction]={},t[e.direction].geom=o.toJstsGeometry(this._getRingArcGeom(e)),e.direction="nw",e.radius=e.radiusQuad.nw,t[e.direction]={},t[e.direction].geom=o.toJstsGeometry(this._getRingArcGeom(e)),e.direction="sw",e.radius=e.radiusQuad.sw,t[e.direction]={},t[e.direction].geom=o.toJstsGeometry(this._getRingArcGeom(e)),e.direction="se",e.radius=e.radiusQuad.se,t[e.direction]={},t[e.direction].geom=o.toJstsGeometry(this._getRingArcGeom(e)),t},_drawCircle:function(e){var t=e._data;this.tf.Layer_Circle[e._tfbh]?this._clearCircleByTfbh(e._tfbh):this.tf.Layer_Circle[e._tfbh]=this._createLayer(this.options.layerOrder.typhoonRing,this.map);var r=t.properties.radius7_quad,n=t.properties.radius10_quad,i=t.properties.radius12_quad,o=new a.sfs.Point({x:t.geometry.coordinates[0],y:t.geometry.coordinates[1],spatialReference:this.options.dataSpatialReference}),s=[(o=this._transformMap(o)).x,o.y],l={color:"#42A53C",fillColor:"#42A53C",opacity:153,fillOpacity:153,weight:0},c={color:"#FFAA00",fillColor:"#FFAA00",opacity:153,fillOpacity:153,weight:0},u={color:"#F2360E",fillColor:"#F2360E",opacity:153,fillOpacity:153,weight:0};if(null==r&&null==n&&null==i){var f=t.properties.radius7,p=t.properties.radius10,h=t.properties.radius12;if(null!=f){var d={ne:f,se:f,sw:f,nw:f},y={layer:this.tf.Layer_Circle[e._tfbh],center:s,radius:0,style:l,direction:"ne",radiusQuad:d};this._drawRing(y)}if(null!=p){var m={ne:p,se:p,sw:p,nw:p};y={layer:this.tf.Layer_Circle[e._tfbh],center:s,radius:p,style:c,direction:"ne",radiusQuad:m};this._drawRing(y)}if(null!=h){var g={ne:h,se:h,sw:h,nw:h};y={layer:this.tf.Layer_Circle[e._tfbh],center:s,radius:h,style:u,direction:"ne",radiusQuad:g};this._drawRing(y)}}else{if(r.ne>0){y={layer:this.tf.Layer_Circle[e._tfbh],center:s,radius:0,style:l,direction:"ne",radiusQuad:t.properties.radius7_quad};this._drawRing(y)}if(n.ne>0){y={layer:this.tf.Layer_Circle[e._tfbh],center:s,radius:p,style:c,direction:"ne",radiusQuad:t.properties.radius10_quad};this._drawRing(y)}if(i.ne>0){y={layer:this.tf.Layer_Circle[e._tfbh],center:s,radius:h,style:u,direction:"ne",radiusQuad:t.properties.radius12_quad};this._drawRing(y)}}},_drawRing:function(e){e.direction="ne",e.radius=e.radiusQuad.ne,this._drawRingArc(e),e.direction="nw",e.radius=e.radiusQuad.nw,this._drawRingArc(e),e.direction="sw",e.radius=e.radiusQuad.sw,this._drawRingArc(e),e.direction="se",e.radius=e.radiusQuad.se,this._drawRingArc(e)},_drawRingArc:function(e){var t=new a.sfs.SimpleFillSymbol({borderThickness:.01,fillColor:new a.sfs.Color.fromHex(e.style.fillColor),borderColor:new a.sfs.Color.fromHex(e.style.color)});t.fillColor.a=e.style.fillOpacity,t.borderColor.a=e.style.opacity;var r=this._getRingArcGeom(e),n=new a.sfs.Element({geometry:r,symbol:t});e.layer.add(n)},_getRingArcGeom:function(e){var t=this._arcPointsConstructor[e.direction](e.center,e.radius,this.options.projection),r=t.startP,n=t.endP,i=new a.sfs.Plot,o=[],s=new a.sfs.Point({x:e.center[0],y:e.center[1],spatialReference:this.options.spatialReference}),l=new a.sfs.Point({x:r[0],y:r[1],spatialReference:this.options.spatialReference}),c=new a.sfs.Point({x:n[0],y:n[1],spatialReference:this.options.spatialReference});return o.push(s),o.push(l),o.push(c),i.controlPoints=o,(new a.plot.SectorAlgorithm).createGeometries(i,null)[0]},_arcPointsConstructor:{ne:function(e,t,r){var n=new Array(2),i=new Array(2);return n[0]=0==r?e[0]+1e3*t:e[0]+t/111,n[1]=e[1],i[0]=e[0],i[1]=0==r?e[1]+1e3*t:e[1]+t/111,{startP:n,endP:i}},nw:function(e,t,r){var n=new Array(2),i=new Array(2);return n[0]=e[0],n[1]=0==r?e[1]+1e3*t:e[1]+t/111,i[0]=0==r?e[0]-1e3*t:e[0]-t/111,i[1]=e[1],{startP:n,endP:i}},sw:function(e,t,r){var n=new Array(2),i=new Array(2);return n[0]=0==r?e[0]-1e3*t:e[0]-t/111,n[1]=e[1],i[0]=e[0],i[1]=0==r?e[1]-1e3*t:e[1]-t/111,{startP:n,endP:i}},se:function(e,t,r){var n=new Array(2),i=new Array(2);return n[0]=e[0],n[1]=0==r?e[1]-1e3*t:e[1]-t/111,i[0]=0==r?e[0]+1e3*t:e[0]+t/111,i[1]=e[1],{startP:n,endP:i}}},_showPopup:function(e,t,r){if(null!=e._data){this.options.toolTipWare.clear();var n=this._getTrackPopupContent(e,r),i=this.options.popup.offset,o=new a.widget.Tooltip({anchor:e.geometry,content:n,layerId:t.getLayerId(),offset:i});this.options.toolTipWare.add(o)}},_getTrackPopupContent:function(e,t){var r="font-size:12px;color:#000 ;background: #fff; margin-top: 8px;margin-left: 10px; margin-right: 0px;";return null!=this.options.popup.divStyle&&(r=this.options.popup.divStyle),"<div id='"+t+"' style='"+r+"'>"+JSON.stringify(this._parseTrackData(e))+"</div>"},_updateEventsArray:function(e,t){this.trackClickEvent=[],this.trackMousemoveEvent=[],this.forecastClickEvent=[],this.forecastMousemoveEvent=[];for(var r=0;r<e.length;r++){var n=e[r];0!=n.enable&&"click"==n.event?this.trackClickEvent.push(n.name):0!=n.enable&&"mousemove"==n.event&&this.trackMousemoveEvent.push(n.name)}for(var i=0;i<t.length;i++){var o=t[i];0!=o.enable&&"click"==o.event?this.forecastClickEvent.push(o.name):0!=o.enable&&"mousemove"==o.event&&this.forecastMousemoveEvent.push(o.name)}},_addListeners:function(){var e=this,t=e.options.interfaceMsg.trackPoint,r=e.options.interfaceMsg.forecastPoint;this._updateEventsArray(t,r),this._getMapClickListener=function(t){var r=t.screenX,n=t.screenY,o=e.tf.Layer_point.hitTest(r,n);if(o){var a=o.element;if(null==a._tfbh)return;e.options.interfaceMsg.trackPoint.enable,e._showRoutePointPopup(a)}var s=null,l=[];for(var c in e.tf.Layer_forecast){var u=e.tf.Layer_forecast[c].hitTest(r,n);u&&l.push(u)}if(l.length>0&&(s=l[0]),s){var f=s.element;if(null==f._forecast)return;var p=i.newUUID32();if(e.forecastClickEvent.length>0)for(var h=0;h<e.forecastClickEvent.length;h++){1==e.options.popupForecast.display&&e._showPopupForecast(f,p);var d=e.forecastClickEvent[h];e.fire(d,{id:p,data:e._parseForecastData(f)})}}},this.map.listen("click",this._getMapClickListener,this);var n=this;this._getMapMouseMoveListener=function(t){var r=t.screenX,o=t.screenY;n.options.toolTipWare.clear(),n.tf.selectPoint.clear();var a=n.tf.Layer_point.hitTest(r,o);if(a){var s=i.newUUID32(),l=a.element;if(n._createFocusPoint(l),n.trackMousemoveEvent.length>0)for(var c=0;c<n.trackMousemoveEvent.length;c++){1==n.options.popup.display&&n._showPopup(l,n.tf.Layer_point,s);var u=n.trackMousemoveEvent[c];n.fire(u,{id:s,data:n._parseTrackData(l)})}}var f=null,p=[];for(var h in e.tf.Layer_forecast){var d=e.tf.Layer_forecast[h].hitTest(r,o);d&&p.push(d)}if(p.length>0&&(f=p[0]),f){var y=f.element;if(null==y._forecast)return;s=i.newUUID32();if(n.forecastMousemoveEvent.length>0)for(var m=0;m<n.forecastMousemoveEvent.length;m++){1==n.options.popupForecast.display&&n._showPopupForecast(y,s);var g=n.forecastMousemoveEvent[m];n.fire(g,{id:s,data:n._parseForecastData(y)})}}},this.map.listen("mousemove",this._getMapMouseMoveListener,this)},_parseTrackData:function(e){var t=this._transformObj(e.geometry,this.options.popup.pointEPSG);if(null!=this.options.popup.pointPrecision){var r=parseFloat(t.x),n=parseFloat(t.y);r=r.toFixed(this.options.popup.pointPrecision),n=n.toFixed(this.options.popup.pointPrecision),t.x=r,t.y=n}var i,o=e._data.properties.move_speed,a=e._data.properties.move_dir,s=e._data.properties.radius7_quad,l=e._data.properties.radius10_quad,c=e._data.properties.radius12_quad,u=e._tfbh;i="-"==this.tf.paths[u].name||""==this.tf.paths[u].name?this.tf.paths[u].ename:this.tf.paths[u].name;var f=e._data.properties.time;f=f.replace("T"," ");var p=e._data.properties.pressure,h=e._data.properties.power,d=e._data.properties.speed;return{typhoonBh:{label:this.options.popup.typhoonBh.label,data:e._tfbh},typhoonName:{label:this.options.popup.typhoonName.label,data:i},passTime:{label:this.options.popup.passTime.label,data:f},centerPoint:{label:this.options.popup.centerPoint.label,unit:this.options.popup.centerPoint.unit,data:[t.x,t.y]},centerPressure:{label:this.options.popup.centerPressure.label,unit:this.options.popup.centerPressure.unit,data:p},power:{label:this.options.popup.power.label,unit:this.options.popup.power.unit,data:h},speed:{label:this.options.popup.speed.label,unit:this.options.popup.speed.unit,data:d},moveSpeed:{label:this.options.popup.moveSpeed.label,unit:this.options.popup.moveSpeed.unit,data:o},moveDir:{label:this.options.popup.moveDir.label,unit:this.options.popup.moveDir.unit,data:a},radius7:{label:this.options.popup.sevenRingRadius.label,unit:this.options.popup.sevenRingRadius.unit,data:s},radius10:{label:this.options.popup.tenRingRadius.label,unit:this.options.popup.tenRingRadius.unit,data:l},radius12:{label:this.options.popup.tenRingRadius.label,unit:this.options.popup.tenRingRadius.unit,data:c},islast:{label:"是否为最新轨迹点位",data:e.islast}}},_parseForecastData:function(e){var t=e.data_user,r=new a.sfs.Point({x:t.geometry.coordinates[0],y:t.geometry.coordinates[1],spatialReference:this.options.dataSpatialReference}),n=this._transformObj(r,this.options.popupForecast.pointEPSG),i=t.properties.time.replace("T"," "),o=t.region,s=t.properties.power,l=t.properties.speed,c=t.properties.pressure,u=t.properties.move_speed,f=t.properties.move_dir;return{forecastOrg:{label:this.options.popupForecast.org.label,data:o},arrivalTime:{label:this.options.popupForecast.arrivalTime.label,data:i},centerPoint:{label:this.options.popupForecast.centerPoint.label,unit:this.options.popupForecast.centerPoint.unit,data:[n.x,n.y]},power:{label:this.options.popupForecast.power.label,unit:this.options.popupForecast.power.unit,data:s},speed:{label:this.options.popupForecast.speed.label,unit:this.options.popupForecast.speed.unit,data:l},centralPressure:{label:this.options.popupForecast.centralPressure.label,unit:this.options.popupForecast.centralPressure.unit,data:c},moveSpeed:{label:this.options.popupForecast.moveSpeed.label,unit:this.options.popupForecast.moveSpeed.unit,data:u},moveDir:{label:this.options.popupForecast.moveDir.label,unit:this.options.popupForecast.moveDir.unit,data:f}}},_getString:function(e,t){return null!=e&&(context=t.label+e+t.unit),0==t.display&&(context=""),context},_addListeners_tsmap:function(){var e=this;this._getMapClickListener_ts=function(t,r,n,i,o,a,s){var l=e.tf.Layer_point.hitTest(n,i);if(l){var c=l.element;if(null==c._tfbh)return;e._showRoutePointPopup(c)}},this.map.listen("click",this._getMapClickListener_ts,this);var t=this;this._getMapMouseMoveListener_ts=function(r,n,i,o,a,s,l){t.options.toolTipWare.clear(),t.tf.selectPoint.clear();var c=t.tf.Layer_point.hitTest(i,o);if(c){var u=c.element;t._createFocusPoint(u),1==t.options.popup.display&&t._showPopup(u,t.tf.Layer_point)}var f=e.tf.Layer_forecast.hitTest(i,o);if(f){var p=f.element;if(null==p._forecast)return;1==t.options.popupForecast.display&&t._showPopupForecast(p,uuid)}},this.map.listen("mousemove",this._getMapMouseMoveListener_ts,this)}});e.exports=s},function(e,t,r){var n=r(9),i=r(1),o=n.extend({options:{map:null,warningLineParm:null},initialize:function(e){if(n.prototype.initialize.call(this,e),1!=this.enable){this.dataSpatialReference=4326,this.dataSpatialReference=this._mergeOptions(this.dataSpatialReference,e.dataSpatialReference),this.map=e.map;this.warning_line_parm={id:"typhoon_alertline",name:"台风警戒线",zIndex:100,pic24_xy:[127,30],pic48_xy:[132,30],lineStyle48h:3,lineStyle24h:5,points_24h:[[126.993568,34.005024],[126.993568,21.971252],[118.995521,17.96586],[118.995521,10.97105],[113.018959,4.48627],[104.998939,-.035506]],points_48h:[[131.981361,33.959474],[131.981361,14.96886],[119.962318,-.035506],[104.998939,-.035506]],color_24h:"#FFFF00",color_48h:"#160DFF",pic_base24:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAByCAYAAABA87G+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAACPElEQVRoge2aQW7EIAxFIaqUG4y67KrqEXr/4/QCo9kMXcxEIdQ23zaJwpS/adJkeBgMNpCYUgpHajqUNoCnBaY0pZQmyPveagXl9zHeo6diIQgWLrAY73EBUVagllWBiLQwEZhbJsG0zQxZaC3cBKRgngpEaS6VCub6r1YJFljCEDhiMdSkkjfmzxCvFZt0D/U5lw5gP0BN3GsCbKEBZPvN2p9mC6W0wwysRQELFEqipAK0UBLYMqUoRealWpDm/fMNi+6B4tpikXfCzjVymn8OtESMcwwLqtat5lVyWOSTt6bJkEpBA58rzBJVzuWlZXPunpeWTWXNY2DgHoKdZpF3eKj6sIVUfdhC1SSqNVTdhyH4mnpE/BcHPubO97Ref6XtM73zVDf3VIV5NvfWH1+y68/Nc8t4dVmYZwQoUFgffj/vLs+/y/0M7aFyEqe2R4E/TIVWCzVgcWqj9rnL/6sXr1LWphUCP3wuVZ09cdI06+tbCAVgrkCLc401/gCq1SRNPGx9aFlNmSykoPD7XUQLz44xkCZOqbz2yD0stBWBNoa257wfLivhY3Vps6jffRpOZdam6UfTyYz27D6X6DRU/sl9wYAKHvhcIsxV0A1spT68tCsglAjTTjKHEG6Bei7pPBGfm0c5qBtY100cm5zgFONvlJhDjFd1xK9uX1JWeCK/yUupykjvbd5BPzOjACikCqx9JLeMwxiv6o0hV5pYVgTR4RG/Og5rXto04kug3SO+pBHxB3AAXfoFW1EPwh6Vf8EAAAAASUVORK5CYII=",pic_base48:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAByCAYAAABA87G+AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJ9SURBVHja7FrbboMwDI1DmKj60h/c1+0HeZkqjYL3sGXK0oTYjkEFJU+lrXI4vsQ+BkBEs+eyZufVANWXS377+f7vEhHQGGMAEIo7Xj8EgIQ1Td1TePf9DDKGCXYpsBBgmjqcpg57Y0DswxTYZkGz5jfPzDNNMd4sSlO+ZPuwFJXqPvRAiIChHzV8mo3SkB0rDzXTAhEQAKHvZ/AmVM/DHCvK5q1aNMD9AefZ4jxbbCY9FuCyAC7L86Et9aeYYdct4IHVAD0za9PnqQTUSsGkoLYGTK0ecoE8y5aHLyRmEkm+KyAnKJoPjwWYaoaPkRZSOV2dFl5DlHQgR5CShwqpzThArxmlsRnH8YrjeN2uL41Ndbt9ggc+V7VIsdzFh5sHjVayF00aAmmDiqaJNaYWAdawbgV4X8BQA8Z6UKoPHaUXzX2OryntpKX0oqmNum6B0n9YgGusarpxK2ntYxFaLddic+VuKASmMnZUTZELDq7ucBKT5n6ngLut1RLLpNSqwDnMndZGKoD3+xuJ4eXypcOwtCH1htiAko1FgBxTtQJ8nFY/dSDspg/jR7ObMaw5jchDBS3TOsldS7Q9Wa6FUwwN+abyWL06aOINwutaljbnw5xGjJ/dH3tOQ8m93CN2NuCauWp86qhg8TEmOdZYiR9unDKp+lm6Fonni9LzVHzfHsbd2zkqfsgux1St4qfWMEyGmptswLC1958BEObZ4hJIR0nFd6UWPwT/0f4bThPXfKfaROXAYpOqBU3Kh8MwPZk0PLirgoYq03ZrMWoqfjEP/UzGWvx7qU694seDHz+3QQR8PKz4WGMPhn7fS3wyLwcU2qvzDbABxut7ABMu/tuAIt6cAAAAAElFTkSuQmCC"},this.warning_line_parm=this._mergeOptions(this.warning_line_parm,e.warningLineParm),this.warnLinelayer=new i.carto.ElementLayer({id:this.warning_line_parm.id,name:this.warning_line_parm.name,zIndex:this.warning_line_parm.zIndex,map:this.map}),this.warnLinelayer._typeLayer="typhoon",this.enable=!0}},load:function(){n.prototype.load.call(this),this.map.addLayer(this.warnLinelayer),this.warnLine()},destroy:function(){this.unload(),this.warning_line_parm=void 0,this.enable=!1,n.prototype.destroy.call(this)},getValidDataValue:function(e,t){return null!=t&&(e=t),e},warnLine:function(){this.warnLineObj=new Array;var e=this,t=[[126.993568,34.005024],[126.993568,21.971252],[118.995521,17.96586],[118.995521,10.97105],[113.018959,4.48627],[104.998939,-.035506]],r="#FFFF00",n=[[131.981361,33.959474],[131.981361,14.96886],[119.962318,-.035506],[104.998939,-.035506]],o="#160DFF",a=void 0,s=void 0;t=this.getValidDataValue(t,e.warning_line_parm.points_24h),r=this.getValidDataValue(r,e.warning_line_parm.color_24h),o=this.getValidDataValue(o,e.warning_line_parm.color_48h),n=this.getValidDataValue(n,e.warning_line_parm.points_48h),a=this.getValidDataValue(a,e.warning_line_parm.lineStyle24h),s=this.getValidDataValue(s,e.warning_line_parm.lineStyle48h),this.addLine(this.warnLinelayer,t,r,a),this.addLine(this.warnLinelayer,n,o,s);var l,c,u=function(t,r,n){var o=new i.sfs.PictureMarkerSymbol({source:n,width:"28",height:"144",rotation:"0",opacity:"1",offsetX:"13",offsetY:"31"});r=new i.sfs.Point({x:r[0],y:r[1],spatialReference:e.dataSpatialReference});r=e._transformMap(r);var a=new i.sfs.Element({geometry:r,symbol:o});t.add(a)};l=e.warning_line_parm.pic24_xy,c=e.warning_line_parm.pic48_xy,u(this.warnLinelayer,l,e.warning_line_parm.pic_base24),u(this.warnLinelayer,c,e.warning_line_parm.pic_base48)},addLine:function(e,t,r,n){var o=new i.sfs.Color.fromHex(r);o.a=153;var a=new i.sfs.SimpleLineSymbol({color:o});null!=n&&(a.style=n);for(var s=new i.sfs.Polyline({spatialReference:this.map.spatialReference}),l=new i.sfs.Path({spatialReference:this.map.spatialReference}),c=0;c<t.length;c++){var u=new i.sfs.Point({x:t[c][0],y:t[c][1],spatialReference:this.dataSpatialReference});l.addPoint(u)}s.addGeometry(l),s=this._transformMap(s);var f=new i.sfs.Element({geometry:s,symbol:a});e.add(f)},unload:function(){n.prototype.unload.call(this),0!=this.enable&&this._removeLayer(this.warning_line_parm.id)},_removeLayer:function(e){var t=this.map.findLayer(e);do{this.map.removeLayer(t),t=this.map.findLayer(e)}while(null!=t)},_mergeOptions:function(e){for(var t,r,n=1,i=arguments.length;n<i;n++)for(t in r=arguments[n])e[t]=r[t];return e},_transformMap:function(e){return this.dataSpatialReference==this.map.spatialReference?e:(new i.sfs.CoordinateTransform).transform(e,this.map.spatialReference)}});e.exports=o},function(e,t,r){var n=r(9),i=r(2),o=r(1),a=r(491),s=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e),e.typhoon=e.typhoon||{},e.typhoon.layer?this.typhoonLayer=e.layer:this.typhoonLayer=new o.carto.ElementLayer({id:e.typhoon.id||i.newUUID32(),name:e.typhoon.name,map:e.map,zIndex:e.typhoon.zIndex||100}),e.probability=e.probability||{},e.probability.layer?this.probabilityLayer=e.layer:this.probabilityLayer=new o.carto.ElementLayer({id:e.probability.id||i.newUUID32(),name:e.probability.name,map:e.map,zIndex:e.zIndex||100})},load:function(){n.prototype.load.call(this),this.toolTipWareTyphoon=new o.widget.TooltipWare({map:this.map}),this.toolTipWareProbability=new o.widget.TooltipWare({map:this.map}),this.map.addLayer(this.typhoonLayer),this.map.addLayer(this.probabilityLayer)},unload:function(){this.map.removeLayer(this.typhoonLayer),this.map.removeLayer(this.probabilityLayer),this.toolTipWareProbability.clear(),this.toolTipWareProbability.clear(),this.typhoonTooltipHash=null,this.probabilityTooltipHash=null,n.prototype.unload.call(this)},destroy:function(){this.unload(),n.prototype.destroy.call(this)},showTyphoon:function(e){e.id&&this.removeTyphoon(e.id);var t=this._getGeojson(e);this._drawTyphoon(t,e)},showProbability:function(e){e.id&&this.removeProbability(e.id);var t=this._getGeojson(e);this._drawProbability(t,e)},removeTyphoon:function(e){for(var t=this.typhoonLayer.elements.length-1;t>=0;t--){var r=this.typhoonLayer.elements[t];r.id===e&&this.typhoonLayer.remove(r)}for(var n in this.typhoonTooltipHash)if(this.typhoonTooltipHash.hasOwnProperty(n))for(var i=this.typhoonTooltipHash[n],o=0;o<i.length;o++){var a=i[o];this.toolTipWareTyphoon.remove(a)}},removeProbability:function(e){for(var t=this.probabilityLayer.elements.length-1;t>=0;t--){var r=this.probabilityLayer.elements[t];r.id===e&&this.probabilityLayer.remove(r)}for(var n in this.probabilityTooltipHash)if(this.probabilityTooltipHash.hasOwnProperty(n))for(var i=this.probabilityTooltipHash[n],o=0;o<i.length;o++){var a=i[o];this.toolTipWareProbability.remove(a)}},clearTyphoon:function(){this.typhoonLayer.clear(),this.toolTipWareTyphoon.clear()},clearProbability:function(){this.probabilityLayer.clear(),this.toolTipWareProbability.clear()},clear:function(){this.clearTyphoon(),this.clearProbability()},typhoonTooltipHash:{},probabilityTooltipHash:{},_getGeojson:function(e){var t=null;if(e.format&&"geojson"==e.format.toLowerCase())t=e.data,i.isString(t)&&(t=JSON.parse(t));else{var r=e.data;if(i.isString(r))r=(new DOMParser).parseFromString(r,"text/xml");t=G.utils.GeoJSONUtil.fromKml(r)}return t},_drawTyphoon:function(e,t){var r=this;t.id&&(this.typhoonTooltipHash[t.id]=[]);for(var n=0;n<e.features.length;n++){var i=e.features[n];if("Point"==i.geometry.type){this._getForcastRangeTooltips(i).forEach((function(e){r.toolTipWareTyphoon.add(e),t.id&&r.typhoonTooltipHash[t.id].push(e.id)}))}else{var o=this._parseElement(i,t);this.typhoonLayer.add(o)}}},_drawProbability:function(e,t){var r=t.label||{};t.id&&(this.probabilityTooltipHash[t.id]=[]);for(var n=0;n<e.features.length;n++){var i=e.features[n],o=this._parseElement(i,t);if(this.probabilityLayer.add(o),0!=r.display){var a=this._parseTooltipFromPolygon(i,t);this.toolTipWareProbability.add(a),t.id&&this.probabilityTooltipHash[t.id].push(a.id)}}},_parseElement:function(e,t){var r=this._getSymbol;t.style&&(r=t.style);var n=new(G.utils.SymbolBuilder.extend({build:function(e){return r(e)}})),i=new G.utils.GeometryBuilder({geometryField:["geometry"]}),o=new G.utils.FeatureBuilder({geometryBuilder:i,symbolBuilder:n}).buildElement(e);return o.id=t.id,o},_getSymbol:function(e){var t=1;e.properties["fill-opacity"]?t=e.properties["fill-opacity"]:e.properties["stroke-opacity"]&&(t=e.properties["stroke-opacity"]);var r=255*t,n={r:100,g:100,b:100,a:255};e.properties.fill?n=o.sfs.Color.fromHex(e.properties.fill):e.properties.stroke&&(n=o.sfs.Color.fromHex(e.properties.stroke)),n.a=r;var i=e.geometry.type,a={};return"Polygon"==i?a={type:"SimpleFillSymbol",options:{borderColor:n,fillColor:n,borderThickness:3}}:"LineString"==i&&(a={type:"SimpleLineSymbol",options:{color:n,width:3}}),G.utils.RenderUtil.object2Symbol(a)},_getForcastRangeTooltips:function(e){var t=[],r={x:e.geometry.coordinates[0],y:e.geometry.coordinates[1]},n='<div style = ""><img height="16" width = "16" src="data/'+e.properties.icon+'"/></div>',s=new o.widget.Tooltip({id:i.newUUID32(),anchor:r,content:n,offset:[-8,-8]});t.push(s);var l=e.properties.name,c='<div style = "font-size:6px"><span>'+(l=a.t2s(l))+"</span></div>",u=new o.widget.Tooltip({id:i.newUUID32(),anchor:r,content:c,offset:[5,0]});return t.push(u),t},_parseTooltipFromPolygon:function(e,t){var r=new G.utils.GeometryBuilder({geometryField:["geometry"]}),n=e.properties.name,s="<div style='width:20px'><span>"+(n=a.t2s(n))+"</span><div>",l=r.build(e),c=this._getLabelAnchor(l,t);return new o.widget.Tooltip({id:i.newUUID32(),anchor:c,content:s,offset:[-10,-5]})},_getLabelAnchor:function(e,t){var r=(t.label||{}).position||"left",n=e.shell.points,i=function(e,t){return e.x<t.x};switch(r){case"left":i=function(e,t){return e.x-t.x};break;case"right":i=function(e,t){return t.x-e.x};break;case"bottom":i=function(e,t){return e.y-t.y};break;case"top":i=function(e,t){return t.y-e.y}}var o=n.sort(i);return{x:o[0].x,y:o[0].y}},_mergeOptions:function(e){for(var t,r,n=1,i=arguments.length;n<i;n++)for(t in r=arguments[n])e[t]=r[t];return e}});e.exports=s},function(e,t,r){"use strict";var n="万与丑专业丛东丝丢两严丧个丬丰临为丽举么义乌乐乔习乡书买乱争于亏云亘亚产亩亲亵亸亿仅从仑仓仪们价众优伙会伛伞伟传伤伥伦伧伪伫体余佣佥侠侣侥侦侧侨侩侪侬俣俦俨俩俪俭债倾偬偻偾偿傥傧储傩儿兑兖党兰关兴兹养兽冁内冈册写军农冢冯冲决况冻净凄凉凌减凑凛几凤凫凭凯击凼凿刍划刘则刚创删别刬刭刽刿剀剂剐剑剥剧劝办务劢动励劲劳势勋勐勚匀匦匮区医华协单卖卢卤卧卫却卺厂厅历厉压厌厍厕厢厣厦厨厩厮县参叆叇双发变叙叠叶号叹叽吁后吓吕吗吣吨听启吴呒呓呕呖呗员呙呛呜咏咔咙咛咝咤咴咸哌响哑哒哓哔哕哗哙哜哝哟唛唝唠唡唢唣唤唿啧啬啭啮啰啴啸喷喽喾嗫呵嗳嘘嘤嘱噜噼嚣嚯团园囱围囵国图圆圣圹场坂坏块坚坛坜坝坞坟坠垄垅垆垒垦垧垩垫垭垯垱垲垴埘埙埚埝埯堑堕塆墙壮声壳壶壸处备复够头夸夹夺奁奂奋奖奥妆妇妈妩妪妫姗姜娄娅娆娇娈娱娲娴婳婴婵婶媪嫒嫔嫱嬷孙学孪宁宝实宠审宪宫宽宾寝对寻导寿将尔尘尧尴尸尽层屃屉届属屡屦屿岁岂岖岗岘岙岚岛岭岳岽岿峃峄峡峣峤峥峦崂崃崄崭嵘嵚嵛嵝嵴巅巩巯币帅师帏帐帘帜带帧帮帱帻帼幂幞干并广庄庆庐庑库应庙庞废庼廪开异弃张弥弪弯弹强归当录彟彦彻径徕御忆忏忧忾怀态怂怃怄怅怆怜总怼怿恋恳恶恸恹恺恻恼恽悦悫悬悭悯惊惧惨惩惫惬惭惮惯愍愠愤愦愿慑慭憷懑懒懔戆戋戏戗战戬户扎扑扦执扩扪扫扬扰抚抛抟抠抡抢护报担拟拢拣拥拦拧拨择挂挚挛挜挝挞挟挠挡挢挣挤挥挦捞损捡换捣据捻掳掴掷掸掺掼揸揽揿搀搁搂搅携摄摅摆摇摈摊撄撑撵撷撸撺擞攒敌敛数斋斓斗斩断无旧时旷旸昙昼昽显晋晒晓晔晕晖暂暧札术朴机杀杂权条来杨杩杰极构枞枢枣枥枧枨枪枫枭柜柠柽栀栅标栈栉栊栋栌栎栏树栖样栾桊桠桡桢档桤桥桦桧桨桩梦梼梾检棂椁椟椠椤椭楼榄榇榈榉槚槛槟槠横樯樱橥橱橹橼檐檩欢欤欧歼殁殇残殒殓殚殡殴毁毂毕毙毡毵氇气氢氩氲汇汉污汤汹沓沟没沣沤沥沦沧沨沩沪沵泞泪泶泷泸泺泻泼泽泾洁洒洼浃浅浆浇浈浉浊测浍济浏浐浑浒浓浔浕涂涌涛涝涞涟涠涡涢涣涤润涧涨涩淀渊渌渍渎渐渑渔渖渗温游湾湿溃溅溆溇滗滚滞滟滠满滢滤滥滦滨滩滪漤潆潇潋潍潜潴澜濑濒灏灭灯灵灾灿炀炉炖炜炝点炼炽烁烂烃烛烟烦烧烨烩烫烬热焕焖焘煅煳熘爱爷牍牦牵牺犊犟状犷犸犹狈狍狝狞独狭狮狯狰狱狲猃猎猕猡猪猫猬献獭玑玙玚玛玮环现玱玺珉珏珐珑珰珲琎琏琐琼瑶瑷璇璎瓒瓮瓯电画畅畲畴疖疗疟疠疡疬疮疯疱疴痈痉痒痖痨痪痫痴瘅瘆瘗瘘瘪瘫瘾瘿癞癣癫癯皑皱皲盏盐监盖盗盘眍眦眬着睁睐睑瞒瞩矫矶矾矿砀码砖砗砚砜砺砻砾础硁硅硕硖硗硙硚确硷碍碛碜碱碹磙礼祎祢祯祷祸禀禄禅离秃秆种积称秽秾稆税稣稳穑穷窃窍窑窜窝窥窦窭竖竞笃笋笔笕笺笼笾筑筚筛筜筝筹签简箓箦箧箨箩箪箫篑篓篮篱簖籁籴类籼粜粝粤粪粮糁糇紧絷纟纠纡红纣纤纥约级纨纩纪纫纬纭纮纯纰纱纲纳纴纵纶纷纸纹纺纻纼纽纾线绀绁绂练组绅细织终绉绊绋绌绍绎经绐绑绒结绔绕绖绗绘给绚绛络绝绞统绠绡绢绣绤绥绦继绨绩绪绫绬续绮绯绰绱绲绳维绵绶绷绸绹绺绻综绽绾绿缀缁缂缃缄缅缆缇缈缉缊缋缌缍缎缏缐缑缒缓缔缕编缗缘缙缚缛缜缝缞缟缠缡缢缣缤缥缦缧缨缩缪缫缬缭缮缯缰缱缲缳缴缵罂网罗罚罢罴羁羟羡翘翙翚耢耧耸耻聂聋职聍联聩聪肃肠肤肷肾肿胀胁胆胜胧胨胪胫胶脉脍脏脐脑脓脔脚脱脶脸腊腌腘腭腻腼腽腾膑臜舆舣舰舱舻艰艳艹艺节芈芗芜芦苁苇苈苋苌苍苎苏苘苹茎茏茑茔茕茧荆荐荙荚荛荜荞荟荠荡荣荤荥荦荧荨荩荪荫荬荭荮药莅莜莱莲莳莴莶获莸莹莺莼萚萝萤营萦萧萨葱蒇蒉蒋蒌蓝蓟蓠蓣蓥蓦蔷蔹蔺蔼蕲蕴薮藁藓虏虑虚虫虬虮虽虾虿蚀蚁蚂蚕蚝蚬蛊蛎蛏蛮蛰蛱蛲蛳蛴蜕蜗蜡蝇蝈蝉蝎蝼蝾螀螨蟏衅衔补衬衮袄袅袆袜袭袯装裆裈裢裣裤裥褛褴襁襕见观觃规觅视觇览觉觊觋觌觍觎觏觐觑觞触觯詟誉誊讠计订讣认讥讦讧讨让讪讫训议讯记讱讲讳讴讵讶讷许讹论讻讼讽设访诀证诂诃评诅识诇诈诉诊诋诌词诎诏诐译诒诓诔试诖诗诘诙诚诛诜话诞诟诠诡询诣诤该详诧诨诩诪诫诬语诮误诰诱诲诳说诵诶请诸诹诺读诼诽课诿谀谁谂调谄谅谆谇谈谊谋谌谍谎谏谐谑谒谓谔谕谖谗谘谙谚谛谜谝谞谟谠谡谢谣谤谥谦谧谨谩谪谫谬谭谮谯谰谱谲谳谴谵谶谷豮贝贞负贠贡财责贤败账货质贩贪贫贬购贮贯贰贱贲贳贴贵贶贷贸费贺贻贼贽贾贿赀赁赂赃资赅赆赇赈赉赊赋赌赍赎赏赐赑赒赓赔赕赖赗赘赙赚赛赜赝赞赟赠赡赢赣赪赵赶趋趱趸跃跄跖跞践跶跷跸跹跻踊踌踪踬踯蹑蹒蹰蹿躏躜躯车轧轨轩轪轫转轭轮软轰轱轲轳轴轵轶轷轸轹轺轻轼载轾轿辀辁辂较辄辅辆辇辈辉辊辋辌辍辎辏辐辑辒输辔辕辖辗辘辙辚辞辩辫边辽达迁过迈运还这进远违连迟迩迳迹适选逊递逦逻遗遥邓邝邬邮邹邺邻郁郄郏郐郑郓郦郧郸酝酦酱酽酾酿释里鉅鉴銮錾钆钇针钉钊钋钌钍钎钏钐钑钒钓钔钕钖钗钘钙钚钛钝钞钟钠钡钢钣钤钥钦钧钨钩钪钫钬钭钮钯钰钱钲钳钴钵钶钷钸钹钺钻钼钽钾钿铀铁铂铃铄铅铆铈铉铊铋铍铎铏铐铑铒铕铗铘铙铚铛铜铝铞铟铠铡铢铣铤铥铦铧铨铪铫铬铭铮铯铰铱铲铳铴铵银铷铸铹铺铻铼铽链铿销锁锂锃锄锅锆锇锈锉锊锋锌锍锎锏锐锑锒锓锔锕锖锗错锚锜锞锟锠锡锢锣锤锥锦锨锩锫锬锭键锯锰锱锲锳锴锵锶锷锸锹锺锻锼锽锾锿镀镁镂镃镆镇镈镉镊镌镍镎镏镐镑镒镕镖镗镙镚镛镜镝镞镟镠镡镢镣镤镥镦镧镨镩镪镫镬镭镮镯镰镱镲镳镴镶长门闩闪闫闬闭问闯闰闱闲闳间闵闶闷闸闹闺闻闼闽闾闿阀阁阂阃阄阅阆阇阈阉阊阋阌阍阎阏阐阑阒阓阔阕阖阗阘阙阚阛队阳阴阵阶际陆陇陈陉陕陧陨险随隐隶隽难雏雠雳雾霁霉霭靓静靥鞑鞒鞯鞴韦韧韨韩韪韫韬韵页顶顷顸项顺须顼顽顾顿颀颁颂颃预颅领颇颈颉颊颋颌颍颎颏颐频颒颓颔颕颖颗题颙颚颛颜额颞颟颠颡颢颣颤颥颦颧风飏飐飑飒飓飔飕飖飗飘飙飚飞飨餍饤饥饦饧饨饩饪饫饬饭饮饯饰饱饲饳饴饵饶饷饸饹饺饻饼饽饾饿馀馁馂馃馄馅馆馇馈馉馊馋馌馍馎馏馐馑馒馓馔馕马驭驮驯驰驱驲驳驴驵驶驷驸驹驺驻驼驽驾驿骀骁骂骃骄骅骆骇骈骉骊骋验骍骎骏骐骑骒骓骔骕骖骗骘骙骚骛骜骝骞骟骠骡骢骣骤骥骦骧髅髋髌鬓魇魉鱼鱽鱾鱿鲀鲁鲂鲄鲅鲆鲇鲈鲉鲊鲋鲌鲍鲎鲏鲐鲑鲒鲓鲔鲕鲖鲗鲘鲙鲚鲛鲜鲝鲞鲟鲠鲡鲢鲣鲤鲥鲦鲧鲨鲩鲪鲫鲬鲭鲮鲯鲰鲱鲲鲳鲴鲵鲶鲷鲸鲹鲺鲻鲼鲽鲾鲿鳀鳁鳂鳃鳄鳅鳆鳇鳈鳉鳊鳋鳌鳍鳎鳏鳐鳑鳒鳓鳔鳕鳖鳗鳘鳙鳛鳜鳝鳞鳟鳠鳡鳢鳣鸟鸠鸡鸢鸣鸤鸥鸦鸧鸨鸩鸪鸫鸬鸭鸮鸯鸰鸱鸲鸳鸴鸵鸶鸷鸸鸹鸺鸻鸼鸽鸾鸿鹀鹁鹂鹃鹄鹅鹆鹇鹈鹉鹊鹋鹌鹍鹎鹏鹐鹑鹒鹓鹔鹕鹖鹗鹘鹚鹛鹜鹝鹞鹟鹠鹡鹢鹣鹤鹥鹦鹧鹨鹩鹪鹫鹬鹭鹯鹰鹱鹲鹳鹴鹾麦麸黄黉黡黩黪黾鼋鼌鼍鼗鼹齄齐齑齿龀龁龂龃龄龅龆龇龈龉龊龋龌龙龚龛龟志制咨只里系范松没尝尝闹面准钟别闲乾尽脏拼",i="萬與醜專業叢東絲丟兩嚴喪個丬豐臨爲麗舉麼義烏樂喬習鄉書買亂爭於虧雲亙亞產畝親褻嚲億僅從侖倉儀們價衆優夥會傴傘偉傳傷倀倫傖僞佇體餘傭僉俠侶僥偵側僑儈儕儂俁儔儼倆儷儉債傾傯僂僨償儻儐儲儺兒兌兗黨蘭關興茲養獸囅內岡冊寫軍農冢馮沖決況凍淨淒涼凌減湊凜幾鳳鳧憑凱擊凼鑿芻劃劉則剛創刪別剗剄劊劌剴劑剮劍剝劇勸辦務勱動勵勁勞勢勳勐勩勻匭匱區醫華協單賣盧滷臥衛卻巹廠廳歷厲壓厭厙廁廂厴廈廚廄廝縣參靉靆雙發變敘疊葉號嘆嘰籲後嚇呂嗎唚噸聽啓吳嘸囈嘔嚦唄員咼嗆嗚詠咔嚨嚀噝吒咴鹹哌響啞噠嘵嗶噦譁噲嚌噥喲嘜嗊嘮啢嗩唣喚唿嘖嗇囀齧囉嘽嘯噴嘍嚳囁呵噯噓嚶囑嚕噼囂嚯團園囪圍圇國圖圓聖壙場阪壞塊堅壇壢壩塢墳墜壟壠壚壘墾垧堊墊埡墶壋塏堖塒壎堝埝垵塹墮壪牆壯聲殼壺壼處備復夠頭誇夾奪奩奐奮獎奧妝婦媽嫵嫗嬀姍姜婁婭嬈嬌孌娛媧嫺嫿嬰嬋嬸媼嬡嬪嬙嬤孫學孿寧寶實寵審憲宮寬賓寢對尋導壽將爾塵堯尷屍盡層屓屜屆屬屢屨嶼歲豈嶇崗峴嶴嵐島嶺嶽崬巋嶨嶧峽嶢嶠崢巒嶗崍嶮嶄嶸嶔嵛嶁嵴巔鞏巰幣帥師幃帳簾幟帶幀幫幬幘幗冪襆幹並廣莊慶廬廡庫應廟龐廢廎廩開異棄張彌弳彎彈強歸當錄彠彥徹徑徠御憶懺憂愾懷態慫憮慪悵愴憐總懟懌戀懇惡慟懨愷惻惱惲悅愨懸慳憫驚懼慘懲憊愜慚憚慣愍慍憤憒願懾憖憷懣懶懍戇戔戲戧戰戩戶扎撲扦執擴捫掃揚擾撫拋摶摳掄搶護報擔擬攏揀擁攔擰撥擇掛摯攣掗撾撻挾撓擋撟掙擠揮撏撈損撿換搗據捻擄摑擲撣摻摜揸攬撳攙擱摟攪攜攝攄擺搖擯攤攖撐攆擷擼攛擻攢敵斂數齋斕鬥斬斷無舊時曠暘曇晝曨顯晉曬曉曄暈暉暫曖札術樸機殺雜權條來楊榪傑極構樅樞棗櫪梘棖槍楓梟櫃檸檉梔柵標棧櫛櫳棟櫨櫟欄樹棲樣欒桊椏橈楨檔榿橋樺檜槳樁夢檮棶檢櫺槨櫝槧欏橢樓欖櫬櫚櫸檟檻檳櫧橫檣櫻櫫櫥櫓櫞檐檁歡歟歐殲歿殤殘殞殮殫殯毆毀轂畢斃氈毿氌氣氫氬氳匯漢污湯洶沓溝沒灃漚瀝淪滄渢潙滬沵濘淚澩瀧瀘濼瀉潑澤涇潔灑窪浹淺漿澆湞溮濁測澮濟瀏滻渾滸濃潯濜塗涌濤澇淶漣潿渦溳渙滌潤澗漲澀澱淵淥漬瀆漸澠漁瀋滲溫遊灣溼潰濺漵漊潷滾滯灩灄滿瀅濾濫灤濱灘澦漤瀠瀟瀲濰潛瀦瀾瀨瀕灝滅燈靈災燦煬爐燉煒熗點煉熾爍爛烴燭煙煩燒燁燴燙燼熱煥燜燾煅煳熘愛爺牘犛牽犧犢犟狀獷獁猶狽狍獮獰獨狹獅獪猙獄猻獫獵獼玀豬貓蝟獻獺璣璵瑒瑪瑋環現瑲璽珉珏琺瓏璫琿璡璉瑣瓊瑤璦璇瓔瓚甕甌電畫暢畲疇癤療瘧癘瘍癧瘡瘋皰痾癰痙癢瘂癆瘓癇癡癉瘮瘞瘻癟癱癮癭癩癬癲癯皚皺皸盞鹽監蓋盜盤瞘眥矓着睜睞瞼瞞矚矯磯礬礦碭碼磚硨硯碸礪礱礫礎硜硅碩硤磽磑礄確礆礙磧磣鹼碹磙禮禕禰禎禱禍稟祿禪離禿稈種積稱穢穠穭稅穌穩穡窮竊竅窯竄窩窺竇窶豎競篤筍筆筧箋籠籩築篳篩簹箏籌籤簡籙簀篋籜籮簞簫簣簍籃籬籪籟糴類秈糶糲粵糞糧糝餱緊縶糹糾紆紅紂纖紇約級紈纊紀紉緯紜紘純紕紗綱納紝縱綸紛紙紋紡紵紖紐紓線紺紲紱練組紳細織終縐絆紼絀紹繹經紿綁絨結絝繞絰絎繪給絢絳絡絕絞統綆綃絹繡綌綏絛繼綈績緒綾緓續綺緋綽鞝緄繩維綿綬繃綢綯綹綣綜綻綰綠綴緇緙緗緘緬纜緹緲緝縕繢緦綞緞緶線緱縋緩締縷編緡緣縉縛縟縝縫縗縞纏縭縊縑繽縹縵縲纓縮繆繅纈繚繕繒繮繾繰繯繳纘罌網羅罰罷羆羈羥羨翹翽翬耮耬聳恥聶聾職聹聯聵聰肅腸膚肷腎腫脹脅膽勝朧腖臚脛膠脈膾髒臍腦膿臠腳脫腡臉臘醃膕齶膩靦膃騰臏臢輿艤艦艙艫艱豔艹藝節羋薌蕪蘆蓯葦藶莧萇蒼苧蘇檾蘋莖蘢蔦塋煢繭荊薦薘莢蕘蓽蕎薈薺蕩榮葷滎犖熒蕁藎蓀蔭蕒葒葤藥蒞莜萊蓮蒔萵薟獲蕕瑩鶯蓴蘀蘿螢營縈蕭薩蔥蕆蕢蔣蔞藍薊蘺蕷鎣驀薔蘞藺藹蘄蘊藪藁蘚虜慮虛蟲虯蟣雖蝦蠆蝕蟻螞蠶蠔蜆蠱蠣蟶蠻蟄蛺蟯螄蠐蛻蝸蠟蠅蟈蟬蠍螻蠑螿蟎蠨釁銜補襯袞襖嫋褘襪襲襏裝襠褌褳襝褲襉褸襤襁襴見觀覎規覓視覘覽覺覬覡覿覥覦覯覲覷觴觸觶讋譽謄訁計訂訃認譏訐訌討讓訕訖訓議訊記訒講諱謳詎訝訥許訛論訩訟諷設訪訣證詁訶評詛識詗詐訴診詆謅詞詘詔詖譯詒誆誄試詿詩詰詼誠誅詵話誕詬詮詭詢詣諍該詳詫諢詡譸誡誣語誚誤誥誘誨誑說誦誒請諸諏諾讀諑誹課諉諛誰諗調諂諒諄誶談誼謀諶諜謊諫諧謔謁謂諤諭諼讒諮諳諺諦謎諞諝謨讜謖謝謠謗諡謙謐謹謾謫譾謬譚譖譙讕譜譎讞譴譫讖谷豶貝貞負貟貢財責賢敗賬貨質販貪貧貶購貯貫貳賤賁貰貼貴貺貸貿費賀貽賊贄賈賄貲賃賂贓資賅贐賕賑賚賒賦賭齎贖賞賜贔賙賡賠賧賴賵贅賻賺賽賾贗贊贇贈贍贏贛赬趙趕趨趲躉躍蹌跖躒踐躂蹺蹕躚躋踊躊蹤躓躑躡蹣躕躥躪躦軀車軋軌軒軑軔轉軛輪軟轟軲軻轤軸軹軼軤軫轢軺輕軾載輊轎輈輇輅較輒輔輛輦輩輝輥輞輬輟輜輳輻輯轀輸轡轅轄輾轆轍轔辭辯辮邊遼達遷過邁運還這進遠違連遲邇逕跡適選遜遞邐邏遺遙鄧鄺鄔郵鄒鄴鄰鬱郄郟鄶鄭鄆酈鄖鄲醞醱醬釅釃釀釋裏鉅鑑鑾鏨釓釔針釘釗釙釕釷釺釧釤鈒釩釣鍆釹鍚釵鈃鈣鈈鈦鈍鈔鍾鈉鋇鋼鈑鈐鑰欽鈞鎢鉤鈧鈁鈥鈄鈕鈀鈺錢鉦鉗鈷鉢鈳鉕鈽鈸鉞鑽鉬鉭鉀鈿鈾鐵鉑鈴鑠鉛鉚鈰鉉鉈鉍鈹鐸鉶銬銠鉺銪鋏鋣鐃銍鐺銅鋁銱銦鎧鍘銖銑鋌銩銛鏵銓鉿銚鉻銘錚銫鉸銥鏟銃鐋銨銀銣鑄鐒鋪鋙錸鋱鏈鏗銷鎖鋰鋥鋤鍋鋯鋨鏽銼鋝鋒鋅鋶鐦鐗銳銻鋃鋟鋦錒錆鍺錯錨錡錁錕錩錫錮鑼錘錐錦杴錈錇錟錠鍵鋸錳錙鍥鍈鍇鏘鍶鍔鍤鍬鍾鍛鎪鍠鍰鎄鍍鎂鏤鎡鏌鎮鎛鎘鑷鐫鎳鎿鎦鎬鎊鎰鎔鏢鏜鏍鏰鏞鏡鏑鏃鏇鏐鐔钁鐐鏷鑥鐓鑭鐠鑹鏹鐙鑊鐳鐶鐲鐮鐿鑔鑣鑞鑲長門閂閃閆閈閉問闖閏闈閒閎間閔閌悶閘鬧閨聞闥閩閭闓閥閣閡閫鬮閱閬闍閾閹閶鬩閿閽閻閼闡闌闃闠闊闋闔闐闒闕闞闤隊陽陰陣階際陸隴陳陘陝隉隕險隨隱隸雋難雛讎靂霧霽黴靄靚靜靨韃鞽韉鞴韋韌韍韓韙韞韜韻頁頂頃頇項順須頊頑顧頓頎頒頌頏預顱領頗頸頡頰頲頜潁熲頦頤頻頮頹頷頴穎顆題顒顎顓顏額顳顢顛顙顥纇顫顬顰顴風颺颭颮颯颶颸颼颻飀飄飆飈飛饗饜飣飢飥餳飩餼飪飫飭飯飲餞飾飽飼飿飴餌饒餉餄餎餃餏餅餑餖餓餘餒餕餜餛餡館餷饋餶餿饞饁饃餺餾饈饉饅饊饌饢馬馭馱馴馳驅馹駁驢駔駛駟駙駒騶駐駝駑駕驛駘驍罵駰驕驊駱駭駢驫驪騁驗騂駸駿騏騎騍騅騌驌驂騙騭騤騷騖驁騮騫騸驃騾驄驏驟驥驦驤髏髖髕鬢魘魎魚魛魢魷魨魯魴魺鮁鮃鮎鱸鮋鮓鮒鮊鮑鱟鮍鮐鮭鮚鮳鮪鮞鮦鰂鮜鱠鱭鮫鮮鮺鯗鱘鯁鱺鰱鰹鯉鰣鰷鯀鯊鯇鮶鯽鯒鯖鯪鯕鯫鯡鯤鯧鯝鯢鮎鯛鯨鰺鯴鯔鱝鰈鰏鱨鯷鰮鰃鰓鱷鰍鰒鰉鰁鱂鯿鰠鰲鰭鰨鰥鰩鰟鰜鰳鰾鱈鱉鰻鰵鱅鰼鱖鱔鱗鱒鱯鱤鱧鱣鳥鳩雞鳶鳴鳲鷗鴉鶬鴇鴆鴣鶇鸕鴨鴞鴦鴒鴟鴝鴛鷽鴕鷥鷙鴯鴰鵂鴴鵃鴿鸞鴻鵐鵓鸝鵑鵠鵝鵒鷳鵜鵡鵲鶓鵪鵾鵯鵬鵮鶉鶊鵷鷫鶘鶡鶚鶻鶿鶥鶩鷊鷂鶲鶹鶺鷁鶼鶴鷖鸚鷓鷚鷯鷦鷲鷸鷺鸇鷹鸌鸏鸛鸘鹺麥麩黃黌黶黷黲黽黿鼂鼉鞀鼴齇齊齏齒齔齕齗齟齡齙齠齜齦齬齪齲齷龍龔龕龜志制諮只裏系範鬆沒嚐嚐鬧面準鍾別閒乾盡髒拼";function o(e,t){var r,o,a,s,l,c,u="";if(t?(l=n,c=i):(l=i,c=n),"string"!=typeof e)return e;for(r=0;r<e.length;r++)o=e.charAt(r),(a=e.charCodeAt(r))>13312&&a<40899||a>63744&&a<64106?u+=-1!==(s=l.indexOf(o))?c.charAt(s):o:u+=o;return u}var a={s2t:function(e){return o(e,!0)},t2s:function(e){return o(e,!1)}};e.exports=a},function(e,t,r){var n=r(9),i=n.extend({options:{},initialize:function(e){n.prototype.initialize.call(this,e)},destroy:function(){n.prototype.destroy.call(this)}});e.exports=i}])}));